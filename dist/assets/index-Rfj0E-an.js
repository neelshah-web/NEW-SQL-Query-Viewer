(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function XD(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var xE={exports:{}},Jd={},SE={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dc=Symbol.for("react.element"),JD=Symbol.for("react.portal"),ZD=Symbol.for("react.fragment"),eO=Symbol.for("react.strict_mode"),tO=Symbol.for("react.profiler"),nO=Symbol.for("react.provider"),rO=Symbol.for("react.context"),iO=Symbol.for("react.forward_ref"),sO=Symbol.for("react.suspense"),oO=Symbol.for("react.memo"),lO=Symbol.for("react.lazy"),E_=Symbol.iterator;function aO(n){return n===null||typeof n!="object"?null:(n=E_&&n[E_]||n["@@iterator"],typeof n=="function"?n:null)}var bE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},kE=Object.assign,EE={};function jl(n,e,t){this.props=n,this.context=e,this.refs=EE,this.updater=t||bE}jl.prototype.isReactComponent={};jl.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};jl.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function TE(){}TE.prototype=jl.prototype;function lv(n,e,t){this.props=n,this.context=e,this.refs=EE,this.updater=t||bE}var av=lv.prototype=new TE;av.constructor=lv;kE(av,jl.prototype);av.isPureReactComponent=!0;var T_=Array.isArray,CE=Object.prototype.hasOwnProperty,uv={current:null},AE={key:!0,ref:!0,__self:!0,__source:!0};function IE(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)CE.call(e,r)&&!AE.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var a=Array(l),u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:dc,type:n,key:s,ref:o,props:i,_owner:uv.current}}function uO(n,e){return{$$typeof:dc,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function cv(n){return typeof n=="object"&&n!==null&&n.$$typeof===dc}function cO(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var C_=/\/+/g;function vm(n,e){return typeof n=="object"&&n!==null&&n.key!=null?cO(""+n.key):e.toString(36)}function qh(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case dc:case JD:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+vm(o,0):r,T_(i)?(t="",n!=null&&(t=n.replace(C_,"$&/")+"/"),qh(i,e,t,"",function(u){return u})):i!=null&&(cv(i)&&(i=uO(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(C_,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",T_(n))for(var l=0;l<n.length;l++){s=n[l];var a=r+vm(s,l);o+=qh(s,e,t,a,i)}else if(a=aO(n),typeof a=="function")for(n=a.call(n),l=0;!(s=n.next()).done;)s=s.value,a=r+vm(s,l++),o+=qh(s,e,t,a,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gc(n,e,t){if(n==null)return n;var r=[],i=0;return qh(n,r,"","",function(s){return e.call(t,s,i++)}),r}function hO(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var ln={current:null},Kh={transition:null},fO={ReactCurrentDispatcher:ln,ReactCurrentBatchConfig:Kh,ReactCurrentOwner:uv};function PE(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:Gc,forEach:function(n,e,t){Gc(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Gc(n,function(){e++}),e},toArray:function(n){return Gc(n,function(e){return e})||[]},only:function(n){if(!cv(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};me.Component=jl;me.Fragment=ZD;me.Profiler=tO;me.PureComponent=lv;me.StrictMode=eO;me.Suspense=sO;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fO;me.act=PE;me.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=kE({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=uv.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(a in e)CE.call(e,a)&&!AE.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){l=Array(a);for(var u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:dc,type:n.type,key:i,ref:s,props:r,_owner:o}};me.createContext=function(n){return n={$$typeof:rO,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:nO,_context:n},n.Consumer=n};me.createElement=IE;me.createFactory=function(n){var e=IE.bind(null,n);return e.type=n,e};me.createRef=function(){return{current:null}};me.forwardRef=function(n){return{$$typeof:iO,render:n}};me.isValidElement=cv;me.lazy=function(n){return{$$typeof:lO,_payload:{_status:-1,_result:n},_init:hO}};me.memo=function(n,e){return{$$typeof:oO,type:n,compare:e===void 0?null:e}};me.startTransition=function(n){var e=Kh.transition;Kh.transition={};try{n()}finally{Kh.transition=e}};me.unstable_act=PE;me.useCallback=function(n,e){return ln.current.useCallback(n,e)};me.useContext=function(n){return ln.current.useContext(n)};me.useDebugValue=function(){};me.useDeferredValue=function(n){return ln.current.useDeferredValue(n)};me.useEffect=function(n,e){return ln.current.useEffect(n,e)};me.useId=function(){return ln.current.useId()};me.useImperativeHandle=function(n,e,t){return ln.current.useImperativeHandle(n,e,t)};me.useInsertionEffect=function(n,e){return ln.current.useInsertionEffect(n,e)};me.useLayoutEffect=function(n,e){return ln.current.useLayoutEffect(n,e)};me.useMemo=function(n,e){return ln.current.useMemo(n,e)};me.useReducer=function(n,e,t){return ln.current.useReducer(n,e,t)};me.useRef=function(n){return ln.current.useRef(n)};me.useState=function(n){return ln.current.useState(n)};me.useSyncExternalStore=function(n,e,t){return ln.current.useSyncExternalStore(n,e,t)};me.useTransition=function(){return ln.current.useTransition()};me.version="18.3.1";SE.exports=me;var se=SE.exports;const Tr=XD(se);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dO=se,pO=Symbol.for("react.element"),mO=Symbol.for("react.fragment"),gO=Object.prototype.hasOwnProperty,yO=dO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vO={key:!0,ref:!0,__self:!0,__source:!0};function RE(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)gO.call(e,r)&&!vO.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:pO,type:n,key:s,ref:o,props:i,_owner:yO.current}}Jd.Fragment=mO;Jd.jsx=RE;Jd.jsxs=RE;xE.exports=Jd;var Ee=xE.exports,Rg={},DE={exports:{}},Nn={},OE={exports:{}},ME={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(U,H){var J=U.length;U.push(H);e:for(;0<J;){var fe=J-1>>>1,ie=U[fe];if(0<i(ie,H))U[fe]=H,U[J]=ie,J=fe;else break e}}function t(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var H=U[0],J=U.pop();if(J!==H){U[0]=J;e:for(var fe=0,ie=U.length,ge=ie>>>1;fe<ge;){var tt=2*(fe+1)-1,nt=U[tt],ot=tt+1,Et=U[ot];if(0>i(nt,J))ot<ie&&0>i(Et,nt)?(U[fe]=Et,U[ot]=J,fe=ot):(U[fe]=nt,U[tt]=J,fe=tt);else if(ot<ie&&0>i(Et,J))U[fe]=Et,U[ot]=J,fe=ot;else break e}}return H}function i(U,H){var J=U.sortIndex-H.sortIndex;return J!==0?J:U.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var a=[],u=[],c=1,f=null,d=3,p=!1,y=!1,v=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(U){for(var H=t(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=U)r(u),H.sortIndex=H.expirationTime,e(a,H);else break;H=t(u)}}function I(U){if(v=!1,b(U),!y)if(t(a)!==null)y=!0,Te(D);else{var H=t(u);H!==null&&ae(I,H.startTime-U)}}function D(U,H){y=!1,v&&(v=!1,w(S),S=-1),p=!0;var J=d;try{for(b(H),f=t(a);f!==null&&(!(f.expirationTime>H)||U&&!P());){var fe=f.callback;if(typeof fe=="function"){f.callback=null,d=f.priorityLevel;var ie=fe(f.expirationTime<=H);H=n.unstable_now(),typeof ie=="function"?f.callback=ie:f===t(a)&&r(a),b(H)}else r(a);f=t(a)}if(f!==null)var ge=!0;else{var tt=t(u);tt!==null&&ae(I,tt.startTime-H),ge=!1}return ge}finally{f=null,d=J,p=!1}}var M=!1,x=null,S=-1,T=5,C=-1;function P(){return!(n.unstable_now()-C<T)}function R(){if(x!==null){var U=n.unstable_now();C=U;var H=!0;try{H=x(!0,U)}finally{H?A():(M=!1,x=null)}}else M=!1}var A;if(typeof _=="function")A=function(){_(R)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ce=re.port2;re.port1.onmessage=R,A=function(){ce.postMessage(null)}}else A=function(){E(R,0)};function Te(U){x=U,M||(M=!0,A())}function ae(U,H){S=E(function(){U(n.unstable_now())},H)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){y||p||(y=!0,Te(D))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(U){switch(d){case 1:case 2:case 3:var H=3;break;default:H=d}var J=d;d=H;try{return U()}finally{d=J}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,H){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var J=d;d=U;try{return H()}finally{d=J}},n.unstable_scheduleCallback=function(U,H,J){var fe=n.unstable_now();switch(typeof J=="object"&&J!==null?(J=J.delay,J=typeof J=="number"&&0<J?fe+J:fe):J=fe,U){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=J+ie,U={id:c++,callback:H,priorityLevel:U,startTime:J,expirationTime:ie,sortIndex:-1},J>fe?(U.sortIndex=J,e(u,U),t(a)===null&&U===t(u)&&(v?(w(S),S=-1):v=!0,ae(I,J-fe))):(U.sortIndex=ie,e(a,U),y||p||(y=!0,Te(D))),U},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(U){var H=d;return function(){var J=d;d=H;try{return U.apply(this,arguments)}finally{d=J}}}})(ME);OE.exports=ME;var wO=OE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _O=se,On=wO;function $(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NE=new Set,vu={};function fo(n,e){pl(n,e),pl(n+"Capture",e)}function pl(n,e){for(vu[n]=e,n=0;n<e.length;n++)NE.add(e[n])}var ti=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dg=Object.prototype.hasOwnProperty,xO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A_={},I_={};function SO(n){return Dg.call(I_,n)?!0:Dg.call(A_,n)?!1:xO.test(n)?I_[n]=!0:(A_[n]=!0,!1)}function bO(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function kO(n,e,t,r){if(e===null||typeof e>"u"||bO(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function an(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Mt[n]=new an(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Mt[e]=new an(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Mt[n]=new an(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Mt[n]=new an(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Mt[n]=new an(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Mt[n]=new an(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Mt[n]=new an(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Mt[n]=new an(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Mt[n]=new an(n,5,!1,n.toLowerCase(),null,!1,!1)});var hv=/[\-:]([a-z])/g;function fv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(hv,fv);Mt[e]=new an(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(hv,fv);Mt[e]=new an(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(hv,fv);Mt[e]=new an(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Mt[n]=new an(n,1,!1,n.toLowerCase(),null,!1,!1)});Mt.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Mt[n]=new an(n,1,!1,n.toLowerCase(),null,!0,!0)});function dv(n,e,t,r){var i=Mt.hasOwnProperty(e)?Mt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(kO(e,t,i,r)&&(t=null),r||i===null?SO(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var hi=_O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Yc=Symbol.for("react.element"),Bo=Symbol.for("react.portal"),Fo=Symbol.for("react.fragment"),pv=Symbol.for("react.strict_mode"),Og=Symbol.for("react.profiler"),VE=Symbol.for("react.provider"),LE=Symbol.for("react.context"),mv=Symbol.for("react.forward_ref"),Mg=Symbol.for("react.suspense"),Ng=Symbol.for("react.suspense_list"),gv=Symbol.for("react.memo"),xi=Symbol.for("react.lazy"),BE=Symbol.for("react.offscreen"),P_=Symbol.iterator;function ma(n){return n===null||typeof n!="object"?null:(n=P_&&n[P_]||n["@@iterator"],typeof n=="function"?n:null)}var Xe=Object.assign,wm;function Va(n){if(wm===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);wm=e&&e[1]||""}return`
`+wm+n}var _m=!1;function xm(n,e){if(!n||_m)return"";_m=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return n.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",n.displayName)),a}while(1<=o&&0<=l);break}}}finally{_m=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Va(n):""}function EO(n){switch(n.tag){case 5:return Va(n.type);case 16:return Va("Lazy");case 13:return Va("Suspense");case 19:return Va("SuspenseList");case 0:case 2:case 15:return n=xm(n.type,!1),n;case 11:return n=xm(n.type.render,!1),n;case 1:return n=xm(n.type,!0),n;default:return""}}function Vg(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Fo:return"Fragment";case Bo:return"Portal";case Og:return"Profiler";case pv:return"StrictMode";case Mg:return"Suspense";case Ng:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case LE:return(n.displayName||"Context")+".Consumer";case VE:return(n._context.displayName||"Context")+".Provider";case mv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case gv:return e=n.displayName||null,e!==null?e:Vg(n.type)||"Memo";case xi:e=n._payload,n=n._init;try{return Vg(n(e))}catch{}}return null}function TO(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vg(e);case 8:return e===pv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xi(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function FE(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function CO(n){var e=FE(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Xc(n){n._valueTracker||(n._valueTracker=CO(n))}function zE(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=FE(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Of(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Lg(n,e){var t=e.checked;return Xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function R_(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Xi(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $E(n,e){e=e.checked,e!=null&&dv(n,"checked",e,!1)}function Bg(n,e){$E(n,e);var t=Xi(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Fg(n,e.type,t):e.hasOwnProperty("defaultValue")&&Fg(n,e.type,Xi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function D_(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Fg(n,e,t){(e!=="number"||Of(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var La=Array.isArray;function el(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Xi(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function zg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Xe({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function O_(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error($(92));if(La(t)){if(1<t.length)throw Error($(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Xi(t)}}function UE(n,e){var t=Xi(e.value),r=Xi(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function M_(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function jE(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $g(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?jE(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Jc,HE=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Jc=Jc||document.createElement("div"),Jc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Jc.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function wu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Ya={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AO=["Webkit","ms","Moz","O"];Object.keys(Ya).forEach(function(n){AO.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Ya[e]=Ya[n]})});function WE(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Ya.hasOwnProperty(n)&&Ya[n]?(""+e).trim():e+"px"}function qE(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=WE(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var IO=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ug(n,e){if(e){if(IO[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function jg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hg=null;function yv(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Wg=null,tl=null,nl=null;function N_(n){if(n=gc(n)){if(typeof Wg!="function")throw Error($(280));var e=n.stateNode;e&&(e=rp(e),Wg(n.stateNode,n.type,e))}}function KE(n){tl?nl?nl.push(n):nl=[n]:tl=n}function QE(){if(tl){var n=tl,e=nl;if(nl=tl=null,N_(n),e)for(n=0;n<e.length;n++)N_(e[n])}}function GE(n,e){return n(e)}function YE(){}var Sm=!1;function XE(n,e,t){if(Sm)return n(e,t);Sm=!0;try{return GE(n,e,t)}finally{Sm=!1,(tl!==null||nl!==null)&&(YE(),QE())}}function _u(n,e){var t=n.stateNode;if(t===null)return null;var r=rp(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error($(231,e,typeof t));return t}var qg=!1;if(ti)try{var ga={};Object.defineProperty(ga,"passive",{get:function(){qg=!0}}),window.addEventListener("test",ga,ga),window.removeEventListener("test",ga,ga)}catch{qg=!1}function PO(n,e,t,r,i,s,o,l,a){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(c){this.onError(c)}}var Xa=!1,Mf=null,Nf=!1,Kg=null,RO={onError:function(n){Xa=!0,Mf=n}};function DO(n,e,t,r,i,s,o,l,a){Xa=!1,Mf=null,PO.apply(RO,arguments)}function OO(n,e,t,r,i,s,o,l,a){if(DO.apply(this,arguments),Xa){if(Xa){var u=Mf;Xa=!1,Mf=null}else throw Error($(198));Nf||(Nf=!0,Kg=u)}}function po(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function JE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function V_(n){if(po(n)!==n)throw Error($(188))}function MO(n){var e=n.alternate;if(!e){if(e=po(n),e===null)throw Error($(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return V_(i),n;if(s===r)return V_(i),e;s=s.sibling}throw Error($(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===t){o=!0,t=i,r=s;break}if(l===r){o=!0,r=i,t=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===t){o=!0,t=s,r=i;break}if(l===r){o=!0,r=s,t=i;break}l=l.sibling}if(!o)throw Error($(189))}}if(t.alternate!==r)throw Error($(190))}if(t.tag!==3)throw Error($(188));return t.stateNode.current===t?n:e}function ZE(n){return n=MO(n),n!==null?eT(n):null}function eT(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=eT(n);if(e!==null)return e;n=n.sibling}return null}var tT=On.unstable_scheduleCallback,L_=On.unstable_cancelCallback,NO=On.unstable_shouldYield,VO=On.unstable_requestPaint,it=On.unstable_now,LO=On.unstable_getCurrentPriorityLevel,vv=On.unstable_ImmediatePriority,nT=On.unstable_UserBlockingPriority,Vf=On.unstable_NormalPriority,BO=On.unstable_LowPriority,rT=On.unstable_IdlePriority,Zd=null,Rr=null;function FO(n){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(Zd,n,void 0,(n.current.flags&128)===128)}catch{}}var lr=Math.clz32?Math.clz32:UO,zO=Math.log,$O=Math.LN2;function UO(n){return n>>>=0,n===0?32:31-(zO(n)/$O|0)|0}var Zc=64,eh=4194304;function Ba(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Lf(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~i;l!==0?r=Ba(l):(s&=o,s!==0&&(r=Ba(s)))}else o=t&~i,o!==0?r=Ba(o):s!==0&&(r=Ba(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-lr(e),i=1<<t,r|=n[t],e&=~i;return r}function jO(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HO(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-lr(s),l=1<<o,a=i[o];a===-1?(!(l&t)||l&r)&&(i[o]=jO(l,e)):a<=e&&(n.expiredLanes|=l),s&=~l}}function Qg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function iT(){var n=Zc;return Zc<<=1,!(Zc&4194240)&&(Zc=64),n}function bm(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function pc(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-lr(e),n[e]=t}function WO(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-lr(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function wv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-lr(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Ie=0;function sT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var oT,_v,lT,aT,uT,Gg=!1,th=[],Li=null,Bi=null,Fi=null,xu=new Map,Su=new Map,Ei=[],qO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function B_(n,e){switch(n){case"focusin":case"focusout":Li=null;break;case"dragenter":case"dragleave":Bi=null;break;case"mouseover":case"mouseout":Fi=null;break;case"pointerover":case"pointerout":xu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Su.delete(e.pointerId)}}function ya(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=gc(e),e!==null&&_v(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function KO(n,e,t,r,i){switch(e){case"focusin":return Li=ya(Li,n,e,t,r,i),!0;case"dragenter":return Bi=ya(Bi,n,e,t,r,i),!0;case"mouseover":return Fi=ya(Fi,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return xu.set(s,ya(xu.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Su.set(s,ya(Su.get(s)||null,n,e,t,r,i)),!0}return!1}function cT(n){var e=Ms(n.target);if(e!==null){var t=po(e);if(t!==null){if(e=t.tag,e===13){if(e=JE(t),e!==null){n.blockedOn=e,uT(n.priority,function(){lT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Qh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Yg(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Hg=r,t.target.dispatchEvent(r),Hg=null}else return e=gc(t),e!==null&&_v(e),n.blockedOn=t,!1;e.shift()}return!0}function F_(n,e,t){Qh(n)&&t.delete(e)}function QO(){Gg=!1,Li!==null&&Qh(Li)&&(Li=null),Bi!==null&&Qh(Bi)&&(Bi=null),Fi!==null&&Qh(Fi)&&(Fi=null),xu.forEach(F_),Su.forEach(F_)}function va(n,e){n.blockedOn===e&&(n.blockedOn=null,Gg||(Gg=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,QO)))}function bu(n){function e(i){return va(i,n)}if(0<th.length){va(th[0],n);for(var t=1;t<th.length;t++){var r=th[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Li!==null&&va(Li,n),Bi!==null&&va(Bi,n),Fi!==null&&va(Fi,n),xu.forEach(e),Su.forEach(e),t=0;t<Ei.length;t++)r=Ei[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Ei.length&&(t=Ei[0],t.blockedOn===null);)cT(t),t.blockedOn===null&&Ei.shift()}var rl=hi.ReactCurrentBatchConfig,Bf=!0;function GO(n,e,t,r){var i=Ie,s=rl.transition;rl.transition=null;try{Ie=1,xv(n,e,t,r)}finally{Ie=i,rl.transition=s}}function YO(n,e,t,r){var i=Ie,s=rl.transition;rl.transition=null;try{Ie=4,xv(n,e,t,r)}finally{Ie=i,rl.transition=s}}function xv(n,e,t,r){if(Bf){var i=Yg(n,e,t,r);if(i===null)Om(n,e,r,Ff,t),B_(n,r);else if(KO(i,n,e,t,r))r.stopPropagation();else if(B_(n,r),e&4&&-1<qO.indexOf(n)){for(;i!==null;){var s=gc(i);if(s!==null&&oT(s),s=Yg(n,e,t,r),s===null&&Om(n,e,r,Ff,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else Om(n,e,r,null,t)}}var Ff=null;function Yg(n,e,t,r){if(Ff=null,n=yv(r),n=Ms(n),n!==null)if(e=po(n),e===null)n=null;else if(t=e.tag,t===13){if(n=JE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Ff=n,null}function hT(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LO()){case vv:return 1;case nT:return 4;case Vf:case BO:return 16;case rT:return 536870912;default:return 16}default:return 16}}var Pi=null,Sv=null,Gh=null;function fT(){if(Gh)return Gh;var n,e=Sv,t=e.length,r,i="value"in Pi?Pi.value:Pi.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return Gh=i.slice(n,1<r?1-r:void 0)}function Yh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function nh(){return!0}function z_(){return!1}function Vn(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?nh:z_,this.isPropagationStopped=z_,this}return Xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=nh)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=nh)},persist:function(){},isPersistent:nh}),e}var Hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bv=Vn(Hl),mc=Xe({},Hl,{view:0,detail:0}),XO=Vn(mc),km,Em,wa,ep=Xe({},mc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==wa&&(wa&&n.type==="mousemove"?(km=n.screenX-wa.screenX,Em=n.screenY-wa.screenY):Em=km=0,wa=n),km)},movementY:function(n){return"movementY"in n?n.movementY:Em}}),$_=Vn(ep),JO=Xe({},ep,{dataTransfer:0}),ZO=Vn(JO),eM=Xe({},mc,{relatedTarget:0}),Tm=Vn(eM),tM=Xe({},Hl,{animationName:0,elapsedTime:0,pseudoElement:0}),nM=Vn(tM),rM=Xe({},Hl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),iM=Vn(rM),sM=Xe({},Hl,{data:0}),U_=Vn(sM),oM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lM={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},aM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uM(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=aM[n])?!!e[n]:!1}function kv(){return uM}var cM=Xe({},mc,{key:function(n){if(n.key){var e=oM[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Yh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?lM[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kv,charCode:function(n){return n.type==="keypress"?Yh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Yh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),hM=Vn(cM),fM=Xe({},ep,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),j_=Vn(fM),dM=Xe({},mc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kv}),pM=Vn(dM),mM=Xe({},Hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),gM=Vn(mM),yM=Xe({},ep,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),vM=Vn(yM),wM=[9,13,27,32],Ev=ti&&"CompositionEvent"in window,Ja=null;ti&&"documentMode"in document&&(Ja=document.documentMode);var _M=ti&&"TextEvent"in window&&!Ja,dT=ti&&(!Ev||Ja&&8<Ja&&11>=Ja),H_=" ",W_=!1;function pT(n,e){switch(n){case"keyup":return wM.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var zo=!1;function xM(n,e){switch(n){case"compositionend":return mT(e);case"keypress":return e.which!==32?null:(W_=!0,H_);case"textInput":return n=e.data,n===H_&&W_?null:n;default:return null}}function SM(n,e){if(zo)return n==="compositionend"||!Ev&&pT(n,e)?(n=fT(),Gh=Sv=Pi=null,zo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return dT&&e.locale!=="ko"?null:e.data;default:return null}}var bM={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function q_(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!bM[n.type]:e==="textarea"}function gT(n,e,t,r){KE(r),e=zf(e,"onChange"),0<e.length&&(t=new bv("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Za=null,ku=null;function kM(n){CT(n,0)}function tp(n){var e=jo(n);if(zE(e))return n}function EM(n,e){if(n==="change")return e}var yT=!1;if(ti){var Cm;if(ti){var Am="oninput"in document;if(!Am){var K_=document.createElement("div");K_.setAttribute("oninput","return;"),Am=typeof K_.oninput=="function"}Cm=Am}else Cm=!1;yT=Cm&&(!document.documentMode||9<document.documentMode)}function Q_(){Za&&(Za.detachEvent("onpropertychange",vT),ku=Za=null)}function vT(n){if(n.propertyName==="value"&&tp(ku)){var e=[];gT(e,ku,n,yv(n)),XE(kM,e)}}function TM(n,e,t){n==="focusin"?(Q_(),Za=e,ku=t,Za.attachEvent("onpropertychange",vT)):n==="focusout"&&Q_()}function CM(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tp(ku)}function AM(n,e){if(n==="click")return tp(e)}function IM(n,e){if(n==="input"||n==="change")return tp(e)}function PM(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var hr=typeof Object.is=="function"?Object.is:PM;function Eu(n,e){if(hr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Dg.call(e,i)||!hr(n[i],e[i]))return!1}return!0}function G_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Y_(n,e){var t=G_(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=G_(t)}}function wT(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?wT(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function _T(){for(var n=window,e=Of();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Of(n.document)}return e}function Tv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function RM(n){var e=_T(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&wT(t.ownerDocument.documentElement,t)){if(r!==null&&Tv(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=Y_(t,s);var o=Y_(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var DM=ti&&"documentMode"in document&&11>=document.documentMode,$o=null,Xg=null,eu=null,Jg=!1;function X_(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Jg||$o==null||$o!==Of(r)||(r=$o,"selectionStart"in r&&Tv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),eu&&Eu(eu,r)||(eu=r,r=zf(Xg,"onSelect"),0<r.length&&(e=new bv("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=$o)))}function rh(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Uo={animationend:rh("Animation","AnimationEnd"),animationiteration:rh("Animation","AnimationIteration"),animationstart:rh("Animation","AnimationStart"),transitionend:rh("Transition","TransitionEnd")},Im={},xT={};ti&&(xT=document.createElement("div").style,"AnimationEvent"in window||(delete Uo.animationend.animation,delete Uo.animationiteration.animation,delete Uo.animationstart.animation),"TransitionEvent"in window||delete Uo.transitionend.transition);function np(n){if(Im[n])return Im[n];if(!Uo[n])return n;var e=Uo[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in xT)return Im[n]=e[t];return n}var ST=np("animationend"),bT=np("animationiteration"),kT=np("animationstart"),ET=np("transitionend"),TT=new Map,J_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ls(n,e){TT.set(n,e),fo(e,[n])}for(var Pm=0;Pm<J_.length;Pm++){var Rm=J_[Pm],OM=Rm.toLowerCase(),MM=Rm[0].toUpperCase()+Rm.slice(1);ls(OM,"on"+MM)}ls(ST,"onAnimationEnd");ls(bT,"onAnimationIteration");ls(kT,"onAnimationStart");ls("dblclick","onDoubleClick");ls("focusin","onFocus");ls("focusout","onBlur");ls(ET,"onTransitionEnd");pl("onMouseEnter",["mouseout","mouseover"]);pl("onMouseLeave",["mouseout","mouseover"]);pl("onPointerEnter",["pointerout","pointerover"]);pl("onPointerLeave",["pointerout","pointerover"]);fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NM=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fa));function Z_(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,OO(r,e,void 0,n),n.currentTarget=null}function CT(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,u=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;Z_(i,l,u),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,u=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;Z_(i,l,u),s=a}}}if(Nf)throw n=Kg,Nf=!1,Kg=null,n}function Be(n,e){var t=e[ry];t===void 0&&(t=e[ry]=new Set);var r=n+"__bubble";t.has(r)||(AT(e,n,2,!1),t.add(r))}function Dm(n,e,t){var r=0;e&&(r|=4),AT(t,n,r,e)}var ih="_reactListening"+Math.random().toString(36).slice(2);function Tu(n){if(!n[ih]){n[ih]=!0,NE.forEach(function(t){t!=="selectionchange"&&(NM.has(t)||Dm(t,!1,n),Dm(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[ih]||(e[ih]=!0,Dm("selectionchange",!1,e))}}function AT(n,e,t,r){switch(hT(e)){case 1:var i=GO;break;case 4:i=YO;break;default:i=xv}t=i.bind(null,e,t,n),i=void 0,!qg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Om(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Ms(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}XE(function(){var u=s,c=yv(t),f=[];e:{var d=TT.get(n);if(d!==void 0){var p=bv,y=n;switch(n){case"keypress":if(Yh(t)===0)break e;case"keydown":case"keyup":p=hM;break;case"focusin":y="focus",p=Tm;break;case"focusout":y="blur",p=Tm;break;case"beforeblur":case"afterblur":p=Tm;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=$_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=ZO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=pM;break;case ST:case bT:case kT:p=nM;break;case ET:p=gM;break;case"scroll":p=XO;break;case"wheel":p=vM;break;case"copy":case"cut":case"paste":p=iM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=j_}var v=(e&4)!==0,E=!v&&n==="scroll",w=v?d!==null?d+"Capture":null:d;v=[];for(var _=u,b;_!==null;){b=_;var I=b.stateNode;if(b.tag===5&&I!==null&&(b=I,w!==null&&(I=_u(_,w),I!=null&&v.push(Cu(_,I,b)))),E)break;_=_.return}0<v.length&&(d=new p(d,y,null,t,c),f.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=n==="mouseover"||n==="pointerover",p=n==="mouseout"||n==="pointerout",d&&t!==Hg&&(y=t.relatedTarget||t.fromElement)&&(Ms(y)||y[ni]))break e;if((p||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,p?(y=t.relatedTarget||t.toElement,p=u,y=y?Ms(y):null,y!==null&&(E=po(y),y!==E||y.tag!==5&&y.tag!==6)&&(y=null)):(p=null,y=u),p!==y)){if(v=$_,I="onMouseLeave",w="onMouseEnter",_="mouse",(n==="pointerout"||n==="pointerover")&&(v=j_,I="onPointerLeave",w="onPointerEnter",_="pointer"),E=p==null?d:jo(p),b=y==null?d:jo(y),d=new v(I,_+"leave",p,t,c),d.target=E,d.relatedTarget=b,I=null,Ms(c)===u&&(v=new v(w,_+"enter",y,t,c),v.target=b,v.relatedTarget=E,I=v),E=I,p&&y)t:{for(v=p,w=y,_=0,b=v;b;b=bo(b))_++;for(b=0,I=w;I;I=bo(I))b++;for(;0<_-b;)v=bo(v),_--;for(;0<b-_;)w=bo(w),b--;for(;_--;){if(v===w||w!==null&&v===w.alternate)break t;v=bo(v),w=bo(w)}v=null}else v=null;p!==null&&ex(f,d,p,v,!1),y!==null&&E!==null&&ex(f,E,y,v,!0)}}e:{if(d=u?jo(u):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var D=EM;else if(q_(d))if(yT)D=IM;else{D=CM;var M=TM}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(D=AM);if(D&&(D=D(n,u))){gT(f,D,t,c);break e}M&&M(n,d,u),n==="focusout"&&(M=d._wrapperState)&&M.controlled&&d.type==="number"&&Fg(d,"number",d.value)}switch(M=u?jo(u):window,n){case"focusin":(q_(M)||M.contentEditable==="true")&&($o=M,Xg=u,eu=null);break;case"focusout":eu=Xg=$o=null;break;case"mousedown":Jg=!0;break;case"contextmenu":case"mouseup":case"dragend":Jg=!1,X_(f,t,c);break;case"selectionchange":if(DM)break;case"keydown":case"keyup":X_(f,t,c)}var x;if(Ev)e:{switch(n){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else zo?pT(n,t)&&(S="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(S="onCompositionStart");S&&(dT&&t.locale!=="ko"&&(zo||S!=="onCompositionStart"?S==="onCompositionEnd"&&zo&&(x=fT()):(Pi=c,Sv="value"in Pi?Pi.value:Pi.textContent,zo=!0)),M=zf(u,S),0<M.length&&(S=new U_(S,n,null,t,c),f.push({event:S,listeners:M}),x?S.data=x:(x=mT(t),x!==null&&(S.data=x)))),(x=_M?xM(n,t):SM(n,t))&&(u=zf(u,"onBeforeInput"),0<u.length&&(c=new U_("onBeforeInput","beforeinput",null,t,c),f.push({event:c,listeners:u}),c.data=x))}CT(f,e)})}function Cu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function zf(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=_u(n,t),s!=null&&r.unshift(Cu(n,s,i)),s=_u(n,e),s!=null&&r.push(Cu(n,s,i))),n=n.return}return r}function bo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function ex(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var l=t,a=l.alternate,u=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&u!==null&&(l=u,i?(a=_u(t,s),a!=null&&o.unshift(Cu(t,a,l))):i||(a=_u(t,s),a!=null&&o.push(Cu(t,a,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var VM=/\r\n?/g,LM=/\u0000|\uFFFD/g;function tx(n){return(typeof n=="string"?n:""+n).replace(VM,`
`).replace(LM,"")}function sh(n,e,t){if(e=tx(e),tx(n)!==e&&t)throw Error($(425))}function $f(){}var Zg=null,ey=null;function ty(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ny=typeof setTimeout=="function"?setTimeout:void 0,BM=typeof clearTimeout=="function"?clearTimeout:void 0,nx=typeof Promise=="function"?Promise:void 0,FM=typeof queueMicrotask=="function"?queueMicrotask:typeof nx<"u"?function(n){return nx.resolve(null).then(n).catch(zM)}:ny;function zM(n){setTimeout(function(){throw n})}function Mm(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),bu(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);bu(e)}function zi(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function rx(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var Wl=Math.random().toString(36).slice(2),Sr="__reactFiber$"+Wl,Au="__reactProps$"+Wl,ni="__reactContainer$"+Wl,ry="__reactEvents$"+Wl,$M="__reactListeners$"+Wl,UM="__reactHandles$"+Wl;function Ms(n){var e=n[Sr];if(e)return e;for(var t=n.parentNode;t;){if(e=t[ni]||t[Sr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=rx(n);n!==null;){if(t=n[Sr])return t;n=rx(n)}return e}n=t,t=n.parentNode}return null}function gc(n){return n=n[Sr]||n[ni],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function jo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error($(33))}function rp(n){return n[Au]||null}var iy=[],Ho=-1;function as(n){return{current:n}}function $e(n){0>Ho||(n.current=iy[Ho],iy[Ho]=null,Ho--)}function Ve(n,e){Ho++,iy[Ho]=n.current,n.current=e}var Ji={},Kt=as(Ji),vn=as(!1),Qs=Ji;function ml(n,e){var t=n.type.contextTypes;if(!t)return Ji;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function wn(n){return n=n.childContextTypes,n!=null}function Uf(){$e(vn),$e(Kt)}function ix(n,e,t){if(Kt.current!==Ji)throw Error($(168));Ve(Kt,e),Ve(vn,t)}function IT(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error($(108,TO(n)||"Unknown",i));return Xe({},t,r)}function jf(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ji,Qs=Kt.current,Ve(Kt,n),Ve(vn,vn.current),!0}function sx(n,e,t){var r=n.stateNode;if(!r)throw Error($(169));t?(n=IT(n,e,Qs),r.__reactInternalMemoizedMergedChildContext=n,$e(vn),$e(Kt),Ve(Kt,n)):$e(vn),Ve(vn,t)}var qr=null,ip=!1,Nm=!1;function PT(n){qr===null?qr=[n]:qr.push(n)}function jM(n){ip=!0,PT(n)}function us(){if(!Nm&&qr!==null){Nm=!0;var n=0,e=Ie;try{var t=qr;for(Ie=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}qr=null,ip=!1}catch(i){throw qr!==null&&(qr=qr.slice(n+1)),tT(vv,us),i}finally{Ie=e,Nm=!1}}return null}var Wo=[],qo=0,Hf=null,Wf=0,Bn=[],Fn=0,Gs=null,Gr=1,Yr="";function bs(n,e){Wo[qo++]=Wf,Wo[qo++]=Hf,Hf=n,Wf=e}function RT(n,e,t){Bn[Fn++]=Gr,Bn[Fn++]=Yr,Bn[Fn++]=Gs,Gs=n;var r=Gr;n=Yr;var i=32-lr(r)-1;r&=~(1<<i),t+=1;var s=32-lr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Gr=1<<32-lr(e)+i|t<<i|r,Yr=s+n}else Gr=1<<s|t<<i|r,Yr=n}function Cv(n){n.return!==null&&(bs(n,1),RT(n,1,0))}function Av(n){for(;n===Hf;)Hf=Wo[--qo],Wo[qo]=null,Wf=Wo[--qo],Wo[qo]=null;for(;n===Gs;)Gs=Bn[--Fn],Bn[Fn]=null,Yr=Bn[--Fn],Bn[Fn]=null,Gr=Bn[--Fn],Bn[Fn]=null}var Dn=null,An=null,He=!1,sr=null;function DT(n,e){var t=$n(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function ox(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Dn=n,An=zi(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Dn=n,An=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Gs!==null?{id:Gr,overflow:Yr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=$n(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Dn=n,An=null,!0):!1;default:return!1}}function sy(n){return(n.mode&1)!==0&&(n.flags&128)===0}function oy(n){if(He){var e=An;if(e){var t=e;if(!ox(n,e)){if(sy(n))throw Error($(418));e=zi(t.nextSibling);var r=Dn;e&&ox(n,e)?DT(r,t):(n.flags=n.flags&-4097|2,He=!1,Dn=n)}}else{if(sy(n))throw Error($(418));n.flags=n.flags&-4097|2,He=!1,Dn=n}}}function lx(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Dn=n}function oh(n){if(n!==Dn)return!1;if(!He)return lx(n),He=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!ty(n.type,n.memoizedProps)),e&&(e=An)){if(sy(n))throw OT(),Error($(418));for(;e;)DT(n,e),e=zi(e.nextSibling)}if(lx(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error($(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){An=zi(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}An=null}}else An=Dn?zi(n.stateNode.nextSibling):null;return!0}function OT(){for(var n=An;n;)n=zi(n.nextSibling)}function gl(){An=Dn=null,He=!1}function Iv(n){sr===null?sr=[n]:sr.push(n)}var HM=hi.ReactCurrentBatchConfig;function _a(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error($(309));var r=t.stateNode}if(!r)throw Error($(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error($(284));if(!t._owner)throw Error($(290,n))}return n}function lh(n,e){throw n=Object.prototype.toString.call(e),Error($(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ax(n){var e=n._init;return e(n._payload)}function MT(n){function e(w,_){if(n){var b=w.deletions;b===null?(w.deletions=[_],w.flags|=16):b.push(_)}}function t(w,_){if(!n)return null;for(;_!==null;)e(w,_),_=_.sibling;return null}function r(w,_){for(w=new Map;_!==null;)_.key!==null?w.set(_.key,_):w.set(_.index,_),_=_.sibling;return w}function i(w,_){return w=Hi(w,_),w.index=0,w.sibling=null,w}function s(w,_,b){return w.index=b,n?(b=w.alternate,b!==null?(b=b.index,b<_?(w.flags|=2,_):b):(w.flags|=2,_)):(w.flags|=1048576,_)}function o(w){return n&&w.alternate===null&&(w.flags|=2),w}function l(w,_,b,I){return _===null||_.tag!==6?(_=Um(b,w.mode,I),_.return=w,_):(_=i(_,b),_.return=w,_)}function a(w,_,b,I){var D=b.type;return D===Fo?c(w,_,b.props.children,I,b.key):_!==null&&(_.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===xi&&ax(D)===_.type)?(I=i(_,b.props),I.ref=_a(w,_,b),I.return=w,I):(I=rf(b.type,b.key,b.props,null,w.mode,I),I.ref=_a(w,_,b),I.return=w,I)}function u(w,_,b,I){return _===null||_.tag!==4||_.stateNode.containerInfo!==b.containerInfo||_.stateNode.implementation!==b.implementation?(_=jm(b,w.mode,I),_.return=w,_):(_=i(_,b.children||[]),_.return=w,_)}function c(w,_,b,I,D){return _===null||_.tag!==7?(_=Us(b,w.mode,I,D),_.return=w,_):(_=i(_,b),_.return=w,_)}function f(w,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Um(""+_,w.mode,b),_.return=w,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Yc:return b=rf(_.type,_.key,_.props,null,w.mode,b),b.ref=_a(w,null,_),b.return=w,b;case Bo:return _=jm(_,w.mode,b),_.return=w,_;case xi:var I=_._init;return f(w,I(_._payload),b)}if(La(_)||ma(_))return _=Us(_,w.mode,b,null),_.return=w,_;lh(w,_)}return null}function d(w,_,b,I){var D=_!==null?_.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return D!==null?null:l(w,_,""+b,I);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Yc:return b.key===D?a(w,_,b,I):null;case Bo:return b.key===D?u(w,_,b,I):null;case xi:return D=b._init,d(w,_,D(b._payload),I)}if(La(b)||ma(b))return D!==null?null:c(w,_,b,I,null);lh(w,b)}return null}function p(w,_,b,I,D){if(typeof I=="string"&&I!==""||typeof I=="number")return w=w.get(b)||null,l(_,w,""+I,D);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case Yc:return w=w.get(I.key===null?b:I.key)||null,a(_,w,I,D);case Bo:return w=w.get(I.key===null?b:I.key)||null,u(_,w,I,D);case xi:var M=I._init;return p(w,_,b,M(I._payload),D)}if(La(I)||ma(I))return w=w.get(b)||null,c(_,w,I,D,null);lh(_,I)}return null}function y(w,_,b,I){for(var D=null,M=null,x=_,S=_=0,T=null;x!==null&&S<b.length;S++){x.index>S?(T=x,x=null):T=x.sibling;var C=d(w,x,b[S],I);if(C===null){x===null&&(x=T);break}n&&x&&C.alternate===null&&e(w,x),_=s(C,_,S),M===null?D=C:M.sibling=C,M=C,x=T}if(S===b.length)return t(w,x),He&&bs(w,S),D;if(x===null){for(;S<b.length;S++)x=f(w,b[S],I),x!==null&&(_=s(x,_,S),M===null?D=x:M.sibling=x,M=x);return He&&bs(w,S),D}for(x=r(w,x);S<b.length;S++)T=p(x,w,S,b[S],I),T!==null&&(n&&T.alternate!==null&&x.delete(T.key===null?S:T.key),_=s(T,_,S),M===null?D=T:M.sibling=T,M=T);return n&&x.forEach(function(P){return e(w,P)}),He&&bs(w,S),D}function v(w,_,b,I){var D=ma(b);if(typeof D!="function")throw Error($(150));if(b=D.call(b),b==null)throw Error($(151));for(var M=D=null,x=_,S=_=0,T=null,C=b.next();x!==null&&!C.done;S++,C=b.next()){x.index>S?(T=x,x=null):T=x.sibling;var P=d(w,x,C.value,I);if(P===null){x===null&&(x=T);break}n&&x&&P.alternate===null&&e(w,x),_=s(P,_,S),M===null?D=P:M.sibling=P,M=P,x=T}if(C.done)return t(w,x),He&&bs(w,S),D;if(x===null){for(;!C.done;S++,C=b.next())C=f(w,C.value,I),C!==null&&(_=s(C,_,S),M===null?D=C:M.sibling=C,M=C);return He&&bs(w,S),D}for(x=r(w,x);!C.done;S++,C=b.next())C=p(x,w,S,C.value,I),C!==null&&(n&&C.alternate!==null&&x.delete(C.key===null?S:C.key),_=s(C,_,S),M===null?D=C:M.sibling=C,M=C);return n&&x.forEach(function(R){return e(w,R)}),He&&bs(w,S),D}function E(w,_,b,I){if(typeof b=="object"&&b!==null&&b.type===Fo&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Yc:e:{for(var D=b.key,M=_;M!==null;){if(M.key===D){if(D=b.type,D===Fo){if(M.tag===7){t(w,M.sibling),_=i(M,b.props.children),_.return=w,w=_;break e}}else if(M.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===xi&&ax(D)===M.type){t(w,M.sibling),_=i(M,b.props),_.ref=_a(w,M,b),_.return=w,w=_;break e}t(w,M);break}else e(w,M);M=M.sibling}b.type===Fo?(_=Us(b.props.children,w.mode,I,b.key),_.return=w,w=_):(I=rf(b.type,b.key,b.props,null,w.mode,I),I.ref=_a(w,_,b),I.return=w,w=I)}return o(w);case Bo:e:{for(M=b.key;_!==null;){if(_.key===M)if(_.tag===4&&_.stateNode.containerInfo===b.containerInfo&&_.stateNode.implementation===b.implementation){t(w,_.sibling),_=i(_,b.children||[]),_.return=w,w=_;break e}else{t(w,_);break}else e(w,_);_=_.sibling}_=jm(b,w.mode,I),_.return=w,w=_}return o(w);case xi:return M=b._init,E(w,_,M(b._payload),I)}if(La(b))return y(w,_,b,I);if(ma(b))return v(w,_,b,I);lh(w,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,_!==null&&_.tag===6?(t(w,_.sibling),_=i(_,b),_.return=w,w=_):(t(w,_),_=Um(b,w.mode,I),_.return=w,w=_),o(w)):t(w,_)}return E}var yl=MT(!0),NT=MT(!1),qf=as(null),Kf=null,Ko=null,Pv=null;function Rv(){Pv=Ko=Kf=null}function Dv(n){var e=qf.current;$e(qf),n._currentValue=e}function ly(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function il(n,e){Kf=n,Pv=Ko=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(mn=!0),n.firstContext=null)}function Yn(n){var e=n._currentValue;if(Pv!==n)if(n={context:n,memoizedValue:e,next:null},Ko===null){if(Kf===null)throw Error($(308));Ko=n,Kf.dependencies={lanes:0,firstContext:n}}else Ko=Ko.next=n;return e}var Ns=null;function Ov(n){Ns===null?Ns=[n]:Ns.push(n)}function VT(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Ov(e)):(t.next=i.next,i.next=t),e.interleaved=t,ri(n,r)}function ri(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Si=!1;function Mv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function LT(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Jr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function $i(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,be&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ri(n,t)}return i=r.interleaved,i===null?(e.next=e,Ov(r)):(e.next=i.next,i.next=e),r.interleaved=e,ri(n,t)}function Xh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,wv(n,t)}}function ux(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Qf(n,e,t,r){var i=n.updateQueue;Si=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,u=a.next;a.next=null,o===null?s=u:o.next=u,o=a;var c=n.alternate;c!==null&&(c=c.updateQueue,l=c.lastBaseUpdate,l!==o&&(l===null?c.firstBaseUpdate=u:l.next=u,c.lastBaseUpdate=a))}if(s!==null){var f=i.baseState;o=0,c=u=a=null,l=s;do{var d=l.lane,p=l.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=n,v=l;switch(d=e,p=t,v.tag){case 1:if(y=v.payload,typeof y=="function"){f=y.call(p,f,d);break e}f=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=v.payload,d=typeof y=="function"?y.call(p,f,d):y,d==null)break e;f=Xe({},f,d);break e;case 2:Si=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,d=i.effects,d===null?i.effects=[l]:d.push(l))}else p={eventTime:p,lane:d,tag:l.tag,payload:l.payload,callback:l.callback,next:null},c===null?(u=c=p,a=f):c=c.next=p,o|=d;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;d=l,l=d.next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}while(!0);if(c===null&&(a=f),i.baseState=a,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Xs|=o,n.lanes=o,n.memoizedState=f}}function cx(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error($(191,i));i.call(r)}}}var yc={},Dr=as(yc),Iu=as(yc),Pu=as(yc);function Vs(n){if(n===yc)throw Error($(174));return n}function Nv(n,e){switch(Ve(Pu,e),Ve(Iu,n),Ve(Dr,yc),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$g(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=$g(e,n)}$e(Dr),Ve(Dr,e)}function vl(){$e(Dr),$e(Iu),$e(Pu)}function BT(n){Vs(Pu.current);var e=Vs(Dr.current),t=$g(e,n.type);e!==t&&(Ve(Iu,n),Ve(Dr,t))}function Vv(n){Iu.current===n&&($e(Dr),$e(Iu))}var Ke=as(0);function Gf(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Vm=[];function Lv(){for(var n=0;n<Vm.length;n++)Vm[n]._workInProgressVersionPrimary=null;Vm.length=0}var Jh=hi.ReactCurrentDispatcher,Lm=hi.ReactCurrentBatchConfig,Ys=0,Ge=null,dt=null,wt=null,Yf=!1,tu=!1,Ru=0,WM=0;function zt(){throw Error($(321))}function Bv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!hr(n[t],e[t]))return!1;return!0}function Fv(n,e,t,r,i,s){if(Ys=s,Ge=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Jh.current=n===null||n.memoizedState===null?GM:YM,n=t(r,i),tu){s=0;do{if(tu=!1,Ru=0,25<=s)throw Error($(301));s+=1,wt=dt=null,e.updateQueue=null,Jh.current=XM,n=t(r,i)}while(tu)}if(Jh.current=Xf,e=dt!==null&&dt.next!==null,Ys=0,wt=dt=Ge=null,Yf=!1,e)throw Error($(300));return n}function zv(){var n=Ru!==0;return Ru=0,n}function _r(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?Ge.memoizedState=wt=n:wt=wt.next=n,wt}function Xn(){if(dt===null){var n=Ge.alternate;n=n!==null?n.memoizedState:null}else n=dt.next;var e=wt===null?Ge.memoizedState:wt.next;if(e!==null)wt=e,dt=n;else{if(n===null)throw Error($(310));dt=n,n={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},wt===null?Ge.memoizedState=wt=n:wt=wt.next=n}return wt}function Du(n,e){return typeof e=="function"?e(n):e}function Bm(n){var e=Xn(),t=e.queue;if(t===null)throw Error($(311));t.lastRenderedReducer=n;var r=dt,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,u=s;do{var c=u.lane;if((Ys&c)===c)a!==null&&(a=a.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var f={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};a===null?(l=a=f,o=r):a=a.next=f,Ge.lanes|=c,Xs|=c}u=u.next}while(u!==null&&u!==s);a===null?o=r:a.next=l,hr(r,e.memoizedState)||(mn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Ge.lanes|=s,Xs|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Fm(n){var e=Xn(),t=e.queue;if(t===null)throw Error($(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);hr(s,e.memoizedState)||(mn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function FT(){}function zT(n,e){var t=Ge,r=Xn(),i=e(),s=!hr(r.memoizedState,i);if(s&&(r.memoizedState=i,mn=!0),r=r.queue,$v(jT.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||wt!==null&&wt.memoizedState.tag&1){if(t.flags|=2048,Ou(9,UT.bind(null,t,r,i,e),void 0,null),bt===null)throw Error($(349));Ys&30||$T(t,e,i)}return i}function $T(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function UT(n,e,t,r){e.value=t,e.getSnapshot=r,HT(e)&&WT(n)}function jT(n,e,t){return t(function(){HT(e)&&WT(n)})}function HT(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!hr(n,t)}catch{return!0}}function WT(n){var e=ri(n,1);e!==null&&ar(e,n,1,-1)}function hx(n){var e=_r();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Du,lastRenderedState:n},e.queue=n,n=n.dispatch=QM.bind(null,Ge,n),[e.memoizedState,n]}function Ou(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Ge.updateQueue,e===null?(e={lastEffect:null,stores:null},Ge.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function qT(){return Xn().memoizedState}function Zh(n,e,t,r){var i=_r();Ge.flags|=n,i.memoizedState=Ou(1|e,t,void 0,r===void 0?null:r)}function sp(n,e,t,r){var i=Xn();r=r===void 0?null:r;var s=void 0;if(dt!==null){var o=dt.memoizedState;if(s=o.destroy,r!==null&&Bv(r,o.deps)){i.memoizedState=Ou(e,t,s,r);return}}Ge.flags|=n,i.memoizedState=Ou(1|e,t,s,r)}function fx(n,e){return Zh(8390656,8,n,e)}function $v(n,e){return sp(2048,8,n,e)}function KT(n,e){return sp(4,2,n,e)}function QT(n,e){return sp(4,4,n,e)}function GT(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function YT(n,e,t){return t=t!=null?t.concat([n]):null,sp(4,4,GT.bind(null,e,n),t)}function Uv(){}function XT(n,e){var t=Xn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Bv(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function JT(n,e){var t=Xn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Bv(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function ZT(n,e,t){return Ys&21?(hr(t,e)||(t=iT(),Ge.lanes|=t,Xs|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,mn=!0),n.memoizedState=t)}function qM(n,e){var t=Ie;Ie=t!==0&&4>t?t:4,n(!0);var r=Lm.transition;Lm.transition={};try{n(!1),e()}finally{Ie=t,Lm.transition=r}}function eC(){return Xn().memoizedState}function KM(n,e,t){var r=ji(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},tC(n))nC(e,t);else if(t=VT(n,e,t,r),t!==null){var i=tn();ar(t,n,r,i),rC(t,e,r)}}function QM(n,e,t){var r=ji(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(tC(n))nC(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,t);if(i.hasEagerState=!0,i.eagerState=l,hr(l,o)){var a=e.interleaved;a===null?(i.next=i,Ov(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}t=VT(n,e,i,r),t!==null&&(i=tn(),ar(t,n,r,i),rC(t,e,r))}}function tC(n){var e=n.alternate;return n===Ge||e!==null&&e===Ge}function nC(n,e){tu=Yf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function rC(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,wv(n,t)}}var Xf={readContext:Yn,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},GM={readContext:Yn,useCallback:function(n,e){return _r().memoizedState=[n,e===void 0?null:e],n},useContext:Yn,useEffect:fx,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Zh(4194308,4,GT.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Zh(4194308,4,n,e)},useInsertionEffect:function(n,e){return Zh(4,2,n,e)},useMemo:function(n,e){var t=_r();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=_r();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=KM.bind(null,Ge,n),[r.memoizedState,n]},useRef:function(n){var e=_r();return n={current:n},e.memoizedState=n},useState:hx,useDebugValue:Uv,useDeferredValue:function(n){return _r().memoizedState=n},useTransition:function(){var n=hx(!1),e=n[0];return n=qM.bind(null,n[1]),_r().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Ge,i=_r();if(He){if(t===void 0)throw Error($(407));t=t()}else{if(t=e(),bt===null)throw Error($(349));Ys&30||$T(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,fx(jT.bind(null,r,s,n),[n]),r.flags|=2048,Ou(9,UT.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=_r(),e=bt.identifierPrefix;if(He){var t=Yr,r=Gr;t=(r&~(1<<32-lr(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ru++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=WM++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},YM={readContext:Yn,useCallback:XT,useContext:Yn,useEffect:$v,useImperativeHandle:YT,useInsertionEffect:KT,useLayoutEffect:QT,useMemo:JT,useReducer:Bm,useRef:qT,useState:function(){return Bm(Du)},useDebugValue:Uv,useDeferredValue:function(n){var e=Xn();return ZT(e,dt.memoizedState,n)},useTransition:function(){var n=Bm(Du)[0],e=Xn().memoizedState;return[n,e]},useMutableSource:FT,useSyncExternalStore:zT,useId:eC,unstable_isNewReconciler:!1},XM={readContext:Yn,useCallback:XT,useContext:Yn,useEffect:$v,useImperativeHandle:YT,useInsertionEffect:KT,useLayoutEffect:QT,useMemo:JT,useReducer:Fm,useRef:qT,useState:function(){return Fm(Du)},useDebugValue:Uv,useDeferredValue:function(n){var e=Xn();return dt===null?e.memoizedState=n:ZT(e,dt.memoizedState,n)},useTransition:function(){var n=Fm(Du)[0],e=Xn().memoizedState;return[n,e]},useMutableSource:FT,useSyncExternalStore:zT,useId:eC,unstable_isNewReconciler:!1};function rr(n,e){if(n&&n.defaultProps){e=Xe({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function ay(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Xe({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var op={isMounted:function(n){return(n=n._reactInternals)?po(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=tn(),i=ji(n),s=Jr(r,i);s.payload=e,t!=null&&(s.callback=t),e=$i(n,s,i),e!==null&&(ar(e,n,i,r),Xh(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=tn(),i=ji(n),s=Jr(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=$i(n,s,i),e!==null&&(ar(e,n,i,r),Xh(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=tn(),r=ji(n),i=Jr(t,r);i.tag=2,e!=null&&(i.callback=e),e=$i(n,i,r),e!==null&&(ar(e,n,r,t),Xh(e,n,r))}};function dx(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Eu(t,r)||!Eu(i,s):!0}function iC(n,e,t){var r=!1,i=Ji,s=e.contextType;return typeof s=="object"&&s!==null?s=Yn(s):(i=wn(e)?Qs:Kt.current,r=e.contextTypes,s=(r=r!=null)?ml(n,i):Ji),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=op,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function px(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&op.enqueueReplaceState(e,e.state,null)}function uy(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},Mv(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Yn(s):(s=wn(e)?Qs:Kt.current,i.context=ml(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ay(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&op.enqueueReplaceState(i,i.state,null),Qf(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function wl(n,e){try{var t="",r=e;do t+=EO(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function zm(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function cy(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var JM=typeof WeakMap=="function"?WeakMap:Map;function sC(n,e,t){t=Jr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Zf||(Zf=!0,_y=r),cy(n,e)},t}function oC(n,e,t){t=Jr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){cy(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){cy(n,e),typeof r!="function"&&(Ui===null?Ui=new Set([this]):Ui.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function mx(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new JM;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=fN.bind(null,n,e,t),e.then(n,n))}function gx(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function yx(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Jr(-1,1),e.tag=2,$i(t,e,1))),t.lanes|=1),n)}var ZM=hi.ReactCurrentOwner,mn=!1;function Xt(n,e,t,r){e.child=n===null?NT(e,null,t,r):yl(e,n.child,t,r)}function vx(n,e,t,r,i){t=t.render;var s=e.ref;return il(e,i),r=Fv(n,e,t,r,s,i),t=zv(),n!==null&&!mn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,ii(n,e,i)):(He&&t&&Cv(e),e.flags|=1,Xt(n,e,r,i),e.child)}function wx(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!Yv(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,lC(n,e,s,r,i)):(n=rf(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:Eu,t(o,r)&&n.ref===e.ref)return ii(n,e,i)}return e.flags|=1,n=Hi(s,r),n.ref=e.ref,n.return=e,e.child=n}function lC(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(Eu(s,r)&&n.ref===e.ref)if(mn=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(mn=!0);else return e.lanes=n.lanes,ii(n,e,i)}return hy(n,e,t,r,i)}function aC(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ve(Go,Tn),Tn|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ve(Go,Tn),Tn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,Ve(Go,Tn),Tn|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,Ve(Go,Tn),Tn|=r;return Xt(n,e,i,t),e.child}function uC(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function hy(n,e,t,r,i){var s=wn(t)?Qs:Kt.current;return s=ml(e,s),il(e,i),t=Fv(n,e,t,r,s,i),r=zv(),n!==null&&!mn?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,ii(n,e,i)):(He&&r&&Cv(e),e.flags|=1,Xt(n,e,t,i),e.child)}function _x(n,e,t,r,i){if(wn(t)){var s=!0;jf(e)}else s=!1;if(il(e,i),e.stateNode===null)ef(n,e),iC(e,t,r),uy(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Yn(u):(u=wn(t)?Qs:Kt.current,u=ml(e,u));var c=t.getDerivedStateFromProps,f=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==u)&&px(e,o,r,u),Si=!1;var d=e.memoizedState;o.state=d,Qf(e,r,o,i),a=e.memoizedState,l!==r||d!==a||vn.current||Si?(typeof c=="function"&&(ay(e,t,c,r),a=e.memoizedState),(l=Si||dx(e,t,l,r,d,a,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,LT(n,e),l=e.memoizedProps,u=e.type===e.elementType?l:rr(e.type,l),o.props=u,f=e.pendingProps,d=o.context,a=t.contextType,typeof a=="object"&&a!==null?a=Yn(a):(a=wn(t)?Qs:Kt.current,a=ml(e,a));var p=t.getDerivedStateFromProps;(c=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||d!==a)&&px(e,o,r,a),Si=!1,d=e.memoizedState,o.state=d,Qf(e,r,o,i);var y=e.memoizedState;l!==f||d!==y||vn.current||Si?(typeof p=="function"&&(ay(e,t,p,r),y=e.memoizedState),(u=Si||dx(e,t,u,r,d,y,a)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=a,r=u):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&d===n.memoizedState||(e.flags|=1024),r=!1)}return fy(n,e,t,r,s,i)}function fy(n,e,t,r,i,s){uC(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&sx(e,t,!1),ii(n,e,s);r=e.stateNode,ZM.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=yl(e,n.child,null,s),e.child=yl(e,null,l,s)):Xt(n,e,l,s),e.memoizedState=r.state,i&&sx(e,t,!0),e.child}function cC(n){var e=n.stateNode;e.pendingContext?ix(n,e.pendingContext,e.pendingContext!==e.context):e.context&&ix(n,e.context,!1),Nv(n,e.containerInfo)}function xx(n,e,t,r,i){return gl(),Iv(i),e.flags|=256,Xt(n,e,t,r),e.child}var dy={dehydrated:null,treeContext:null,retryLane:0};function py(n){return{baseLanes:n,cachePool:null,transitions:null}}function hC(n,e,t){var r=e.pendingProps,i=Ke.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Ve(Ke,i&1),n===null)return oy(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=up(o,r,0,null),n=Us(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=py(t),e.memoizedState=dy,n):jv(e,o));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return eN(n,e,o,r,l,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=Hi(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Hi(l,s):(s=Us(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?py(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=dy,r}return s=n.child,n=s.sibling,r=Hi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function jv(n,e){return e=up({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function ah(n,e,t,r){return r!==null&&Iv(r),yl(e,n.child,null,t),n=jv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function eN(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=zm(Error($(422))),ah(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=up({mode:"visible",children:r.children},i,0,null),s=Us(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&yl(e,n.child,null,o),e.child.memoizedState=py(o),e.memoizedState=dy,s);if(!(e.mode&1))return ah(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error($(419)),r=zm(s,r,void 0),ah(n,e,o,r)}if(l=(o&n.childLanes)!==0,mn||l){if(r=bt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ri(n,i),ar(r,n,i,-1))}return Gv(),r=zm(Error($(421))),ah(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=dN.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,An=zi(i.nextSibling),Dn=e,He=!0,sr=null,n!==null&&(Bn[Fn++]=Gr,Bn[Fn++]=Yr,Bn[Fn++]=Gs,Gr=n.id,Yr=n.overflow,Gs=e),e=jv(e,r.children),e.flags|=4096,e)}function Sx(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),ly(n.return,e,t)}function $m(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function fC(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Xt(n,e,r.children,t),r=Ke.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Sx(n,t,e);else if(n.tag===19)Sx(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Ve(Ke,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Gf(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),$m(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Gf(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}$m(e,!0,t,null,s);break;case"together":$m(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ef(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ii(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Xs|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error($(153));if(e.child!==null){for(n=e.child,t=Hi(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Hi(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function tN(n,e,t){switch(e.tag){case 3:cC(e),gl();break;case 5:BT(e);break;case 1:wn(e.type)&&jf(e);break;case 4:Nv(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ve(qf,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ve(Ke,Ke.current&1),e.flags|=128,null):t&e.child.childLanes?hC(n,e,t):(Ve(Ke,Ke.current&1),n=ii(n,e,t),n!==null?n.sibling:null);Ve(Ke,Ke.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return fC(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ve(Ke,Ke.current),r)break;return null;case 22:case 23:return e.lanes=0,aC(n,e,t)}return ii(n,e,t)}var dC,my,pC,mC;dC=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};my=function(){};pC=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Vs(Dr.current);var s=null;switch(t){case"input":i=Lg(n,i),r=Lg(n,r),s=[];break;case"select":i=Xe({},i,{value:void 0}),r=Xe({},r,{value:void 0}),s=[];break;case"textarea":i=zg(n,i),r=zg(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=$f)}Ug(t,r);var o;t=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(vu.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var a=r[u];if(l=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&a!==l&&(a!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(t||(t={}),t[o]=a[o])}else t||(s||(s=[]),s.push(u,t)),t=a;else u==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(u,a)):u==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(u,""+a):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(vu.hasOwnProperty(u)?(a!=null&&u==="onScroll"&&Be("scroll",n),s||l===a||(s=[])):(s=s||[]).push(u,a))}t&&(s=s||[]).push("style",t);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};mC=function(n,e,t,r){t!==r&&(e.flags|=4)};function xa(n,e){if(!He)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function $t(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function nN(n,e,t){var r=e.pendingProps;switch(Av(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(e),null;case 1:return wn(e.type)&&Uf(),$t(e),null;case 3:return r=e.stateNode,vl(),$e(vn),$e(Kt),Lv(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(oh(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,sr!==null&&(by(sr),sr=null))),my(n,e),$t(e),null;case 5:Vv(e);var i=Vs(Pu.current);if(t=e.type,n!==null&&e.stateNode!=null)pC(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return $t(e),null}if(n=Vs(Dr.current),oh(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Sr]=e,r[Au]=s,n=(e.mode&1)!==0,t){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(i=0;i<Fa.length;i++)Be(Fa[i],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":R_(r,s),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Be("invalid",r);break;case"textarea":O_(r,s),Be("invalid",r)}Ug(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&sh(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&sh(r.textContent,l,n),i=["children",""+l]):vu.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Be("scroll",r)}switch(t){case"input":Xc(r),D_(r,s,!0);break;case"textarea":Xc(r),M_(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=$f)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=jE(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Sr]=e,n[Au]=r,dC(n,e,!1,!1),e.stateNode=n;e:{switch(o=jg(t,r),t){case"dialog":Be("cancel",n),Be("close",n),i=r;break;case"iframe":case"object":case"embed":Be("load",n),i=r;break;case"video":case"audio":for(i=0;i<Fa.length;i++)Be(Fa[i],n);i=r;break;case"source":Be("error",n),i=r;break;case"img":case"image":case"link":Be("error",n),Be("load",n),i=r;break;case"details":Be("toggle",n),i=r;break;case"input":R_(n,r),i=Lg(n,r),Be("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Xe({},r,{value:void 0}),Be("invalid",n);break;case"textarea":O_(n,r),i=zg(n,r),Be("invalid",n);break;default:i=r}Ug(t,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?qE(n,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&HE(n,a)):s==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&wu(n,a):typeof a=="number"&&wu(n,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(vu.hasOwnProperty(s)?a!=null&&s==="onScroll"&&Be("scroll",n):a!=null&&dv(n,s,a,o))}switch(t){case"input":Xc(n),D_(n,r,!1);break;case"textarea":Xc(n),M_(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Xi(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?el(n,!!r.multiple,s,!1):r.defaultValue!=null&&el(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=$f)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return $t(e),null;case 6:if(n&&e.stateNode!=null)mC(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(t=Vs(Pu.current),Vs(Dr.current),oh(e)){if(r=e.stateNode,t=e.memoizedProps,r[Sr]=e,(s=r.nodeValue!==t)&&(n=Dn,n!==null))switch(n.tag){case 3:sh(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&sh(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Sr]=e,e.stateNode=r}return $t(e),null;case 13:if($e(Ke),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(He&&An!==null&&e.mode&1&&!(e.flags&128))OT(),gl(),e.flags|=98560,s=!1;else if(s=oh(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error($(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error($(317));s[Sr]=e}else gl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;$t(e),s=!1}else sr!==null&&(by(sr),sr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Ke.current&1?mt===0&&(mt=3):Gv())),e.updateQueue!==null&&(e.flags|=4),$t(e),null);case 4:return vl(),my(n,e),n===null&&Tu(e.stateNode.containerInfo),$t(e),null;case 10:return Dv(e.type._context),$t(e),null;case 17:return wn(e.type)&&Uf(),$t(e),null;case 19:if($e(Ke),s=e.memoizedState,s===null)return $t(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)xa(s,!1);else{if(mt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Gf(n),o!==null){for(e.flags|=128,xa(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ve(Ke,Ke.current&1|2),e.child}n=n.sibling}s.tail!==null&&it()>_l&&(e.flags|=128,r=!0,xa(s,!1),e.lanes=4194304)}else{if(!r)if(n=Gf(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),xa(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!He)return $t(e),null}else 2*it()-s.renderingStartTime>_l&&t!==1073741824&&(e.flags|=128,r=!0,xa(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=it(),e.sibling=null,t=Ke.current,Ve(Ke,r?t&1|2:t&1),e):($t(e),null);case 22:case 23:return Qv(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Tn&1073741824&&($t(e),e.subtreeFlags&6&&(e.flags|=8192)):$t(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function rN(n,e){switch(Av(e),e.tag){case 1:return wn(e.type)&&Uf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return vl(),$e(vn),$e(Kt),Lv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Vv(e),null;case 13:if($e(Ke),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error($(340));gl()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return $e(Ke),null;case 4:return vl(),null;case 10:return Dv(e.type._context),null;case 22:case 23:return Qv(),null;case 24:return null;default:return null}}var uh=!1,Ht=!1,iN=typeof WeakSet=="function"?WeakSet:Set,Y=null;function Qo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ze(n,e,r)}else t.current=null}function gy(n,e,t){try{t()}catch(r){Ze(n,e,r)}}var bx=!1;function sN(n,e){if(Zg=Bf,n=_T(),Tv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,l=-1,a=-1,u=0,c=0,f=n,d=null;t:for(;;){for(var p;f!==t||i!==0&&f.nodeType!==3||(l=o+i),f!==s||r!==0&&f.nodeType!==3||(a=o+r),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)d=f,f=p;for(;;){if(f===n)break t;if(d===t&&++u===i&&(l=o),d===s&&++c===r&&(a=o),(p=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=p}t=l===-1||a===-1?null:{start:l,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for(ey={focusedElem:n,selectionRange:t},Bf=!1,Y=e;Y!==null;)if(e=Y,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Y=n;else for(;Y!==null;){e=Y;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var v=y.memoizedProps,E=y.memoizedState,w=e.stateNode,_=w.getSnapshotBeforeUpdate(e.elementType===e.type?v:rr(e.type,v),E);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(I){Ze(e,e.return,I)}if(n=e.sibling,n!==null){n.return=e.return,Y=n;break}Y=e.return}return y=bx,bx=!1,y}function nu(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&gy(e,t,s)}i=i.next}while(i!==r)}}function lp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function yy(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function gC(n){var e=n.alternate;e!==null&&(n.alternate=null,gC(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Sr],delete e[Au],delete e[ry],delete e[$M],delete e[UM])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function yC(n){return n.tag===5||n.tag===3||n.tag===4}function kx(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||yC(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function vy(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=$f));else if(r!==4&&(n=n.child,n!==null))for(vy(n,e,t),n=n.sibling;n!==null;)vy(n,e,t),n=n.sibling}function wy(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(wy(n,e,t),n=n.sibling;n!==null;)wy(n,e,t),n=n.sibling}var Ct=null,ir=!1;function yi(n,e,t){for(t=t.child;t!==null;)vC(n,e,t),t=t.sibling}function vC(n,e,t){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(Zd,t)}catch{}switch(t.tag){case 5:Ht||Qo(t,e);case 6:var r=Ct,i=ir;Ct=null,yi(n,e,t),Ct=r,ir=i,Ct!==null&&(ir?(n=Ct,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Ct.removeChild(t.stateNode));break;case 18:Ct!==null&&(ir?(n=Ct,t=t.stateNode,n.nodeType===8?Mm(n.parentNode,t):n.nodeType===1&&Mm(n,t),bu(n)):Mm(Ct,t.stateNode));break;case 4:r=Ct,i=ir,Ct=t.stateNode.containerInfo,ir=!0,yi(n,e,t),Ct=r,ir=i;break;case 0:case 11:case 14:case 15:if(!Ht&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&gy(t,e,o),i=i.next}while(i!==r)}yi(n,e,t);break;case 1:if(!Ht&&(Qo(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Ze(t,e,l)}yi(n,e,t);break;case 21:yi(n,e,t);break;case 22:t.mode&1?(Ht=(r=Ht)||t.memoizedState!==null,yi(n,e,t),Ht=r):yi(n,e,t);break;default:yi(n,e,t)}}function Ex(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new iN),e.forEach(function(r){var i=pN.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function nr(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Ct=l.stateNode,ir=!1;break e;case 3:Ct=l.stateNode.containerInfo,ir=!0;break e;case 4:Ct=l.stateNode.containerInfo,ir=!0;break e}l=l.return}if(Ct===null)throw Error($(160));vC(s,o,i),Ct=null,ir=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(u){Ze(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wC(e,n),e=e.sibling}function wC(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(nr(e,n),mr(n),r&4){try{nu(3,n,n.return),lp(3,n)}catch(v){Ze(n,n.return,v)}try{nu(5,n,n.return)}catch(v){Ze(n,n.return,v)}}break;case 1:nr(e,n),mr(n),r&512&&t!==null&&Qo(t,t.return);break;case 5:if(nr(e,n),mr(n),r&512&&t!==null&&Qo(t,t.return),n.flags&32){var i=n.stateNode;try{wu(i,"")}catch(v){Ze(n,n.return,v)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,l=n.type,a=n.updateQueue;if(n.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&$E(i,s),jg(l,o);var u=jg(l,s);for(o=0;o<a.length;o+=2){var c=a[o],f=a[o+1];c==="style"?qE(i,f):c==="dangerouslySetInnerHTML"?HE(i,f):c==="children"?wu(i,f):dv(i,c,f,u)}switch(l){case"input":Bg(i,s);break;case"textarea":UE(i,s);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?el(i,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?el(i,!!s.multiple,s.defaultValue,!0):el(i,!!s.multiple,s.multiple?[]:"",!1))}i[Au]=s}catch(v){Ze(n,n.return,v)}}break;case 6:if(nr(e,n),mr(n),r&4){if(n.stateNode===null)throw Error($(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(v){Ze(n,n.return,v)}}break;case 3:if(nr(e,n),mr(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{bu(e.containerInfo)}catch(v){Ze(n,n.return,v)}break;case 4:nr(e,n),mr(n);break;case 13:nr(e,n),mr(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(qv=it())),r&4&&Ex(n);break;case 22:if(c=t!==null&&t.memoizedState!==null,n.mode&1?(Ht=(u=Ht)||c,nr(e,n),Ht=u):nr(e,n),mr(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!c&&n.mode&1)for(Y=n,c=n.child;c!==null;){for(f=Y=c;Y!==null;){switch(d=Y,p=d.child,d.tag){case 0:case 11:case 14:case 15:nu(4,d,d.return);break;case 1:Qo(d,d.return);var y=d.stateNode;if(typeof y.componentWillUnmount=="function"){r=d,t=d.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(v){Ze(r,t,v)}}break;case 5:Qo(d,d.return);break;case 22:if(d.memoizedState!==null){Cx(f);continue}}p!==null?(p.return=d,Y=p):Cx(f)}c=c.sibling}e:for(c=null,f=n;;){if(f.tag===5){if(c===null){c=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,a=f.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=WE("display",o))}catch(v){Ze(n,n.return,v)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(v){Ze(n,n.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:nr(e,n),mr(n),r&4&&Ex(n);break;case 21:break;default:nr(e,n),mr(n)}}function mr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(yC(t)){var r=t;break e}t=t.return}throw Error($(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(wu(i,""),r.flags&=-33);var s=kx(n);wy(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=kx(n);vy(n,l,o);break;default:throw Error($(161))}}catch(a){Ze(n,n.return,a)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function oN(n,e,t){Y=n,_C(n)}function _C(n,e,t){for(var r=(n.mode&1)!==0;Y!==null;){var i=Y,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||uh;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||Ht;l=uh;var u=Ht;if(uh=o,(Ht=a)&&!u)for(Y=i;Y!==null;)o=Y,a=o.child,o.tag===22&&o.memoizedState!==null?Ax(i):a!==null?(a.return=o,Y=a):Ax(i);for(;s!==null;)Y=s,_C(s),s=s.sibling;Y=i,uh=l,Ht=u}Tx(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Y=s):Tx(n)}}function Tx(n){for(;Y!==null;){var e=Y;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||lp(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ht)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:rr(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&cx(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}cx(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&bu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}Ht||e.flags&512&&yy(e)}catch(d){Ze(e,e.return,d)}}if(e===n){Y=null;break}if(t=e.sibling,t!==null){t.return=e.return,Y=t;break}Y=e.return}}function Cx(n){for(;Y!==null;){var e=Y;if(e===n){Y=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Y=t;break}Y=e.return}}function Ax(n){for(;Y!==null;){var e=Y;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{lp(4,e)}catch(a){Ze(e,t,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){Ze(e,i,a)}}var s=e.return;try{yy(e)}catch(a){Ze(e,s,a)}break;case 5:var o=e.return;try{yy(e)}catch(a){Ze(e,o,a)}}}catch(a){Ze(e,e.return,a)}if(e===n){Y=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Y=l;break}Y=e.return}}var lN=Math.ceil,Jf=hi.ReactCurrentDispatcher,Hv=hi.ReactCurrentOwner,qn=hi.ReactCurrentBatchConfig,be=0,bt=null,ct=null,Ot=0,Tn=0,Go=as(0),mt=0,Mu=null,Xs=0,ap=0,Wv=0,ru=null,cn=null,qv=0,_l=1/0,Hr=null,Zf=!1,_y=null,Ui=null,ch=!1,Ri=null,ed=0,iu=0,xy=null,tf=-1,nf=0;function tn(){return be&6?it():tf!==-1?tf:tf=it()}function ji(n){return n.mode&1?be&2&&Ot!==0?Ot&-Ot:HM.transition!==null?(nf===0&&(nf=iT()),nf):(n=Ie,n!==0||(n=window.event,n=n===void 0?16:hT(n.type)),n):1}function ar(n,e,t,r){if(50<iu)throw iu=0,xy=null,Error($(185));pc(n,t,r),(!(be&2)||n!==bt)&&(n===bt&&(!(be&2)&&(ap|=t),mt===4&&Ti(n,Ot)),_n(n,r),t===1&&be===0&&!(e.mode&1)&&(_l=it()+500,ip&&us()))}function _n(n,e){var t=n.callbackNode;HO(n,e);var r=Lf(n,n===bt?Ot:0);if(r===0)t!==null&&L_(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&L_(t),e===1)n.tag===0?jM(Ix.bind(null,n)):PT(Ix.bind(null,n)),FM(function(){!(be&6)&&us()}),t=null;else{switch(sT(r)){case 1:t=vv;break;case 4:t=nT;break;case 16:t=Vf;break;case 536870912:t=rT;break;default:t=Vf}t=AC(t,xC.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function xC(n,e){if(tf=-1,nf=0,be&6)throw Error($(327));var t=n.callbackNode;if(sl()&&n.callbackNode!==t)return null;var r=Lf(n,n===bt?Ot:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=td(n,r);else{e=r;var i=be;be|=2;var s=bC();(bt!==n||Ot!==e)&&(Hr=null,_l=it()+500,$s(n,e));do try{cN();break}catch(l){SC(n,l)}while(!0);Rv(),Jf.current=s,be=i,ct!==null?e=0:(bt=null,Ot=0,e=mt)}if(e!==0){if(e===2&&(i=Qg(n),i!==0&&(r=i,e=Sy(n,i))),e===1)throw t=Mu,$s(n,0),Ti(n,r),_n(n,it()),t;if(e===6)Ti(n,r);else{if(i=n.current.alternate,!(r&30)&&!aN(i)&&(e=td(n,r),e===2&&(s=Qg(n),s!==0&&(r=s,e=Sy(n,s))),e===1))throw t=Mu,$s(n,0),Ti(n,r),_n(n,it()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:ks(n,cn,Hr);break;case 3:if(Ti(n,r),(r&130023424)===r&&(e=qv+500-it(),10<e)){if(Lf(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){tn(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=ny(ks.bind(null,n,cn,Hr),e);break}ks(n,cn,Hr);break;case 4:if(Ti(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-lr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=it()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lN(r/1960))-r,10<r){n.timeoutHandle=ny(ks.bind(null,n,cn,Hr),r);break}ks(n,cn,Hr);break;case 5:ks(n,cn,Hr);break;default:throw Error($(329))}}}return _n(n,it()),n.callbackNode===t?xC.bind(null,n):null}function Sy(n,e){var t=ru;return n.current.memoizedState.isDehydrated&&($s(n,e).flags|=256),n=td(n,e),n!==2&&(e=cn,cn=t,e!==null&&by(e)),n}function by(n){cn===null?cn=n:cn.push.apply(cn,n)}function aN(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!hr(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ti(n,e){for(e&=~Wv,e&=~ap,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-lr(e),r=1<<t;n[t]=-1,e&=~r}}function Ix(n){if(be&6)throw Error($(327));sl();var e=Lf(n,0);if(!(e&1))return _n(n,it()),null;var t=td(n,e);if(n.tag!==0&&t===2){var r=Qg(n);r!==0&&(e=r,t=Sy(n,r))}if(t===1)throw t=Mu,$s(n,0),Ti(n,e),_n(n,it()),t;if(t===6)throw Error($(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ks(n,cn,Hr),_n(n,it()),null}function Kv(n,e){var t=be;be|=1;try{return n(e)}finally{be=t,be===0&&(_l=it()+500,ip&&us())}}function Js(n){Ri!==null&&Ri.tag===0&&!(be&6)&&sl();var e=be;be|=1;var t=qn.transition,r=Ie;try{if(qn.transition=null,Ie=1,n)return n()}finally{Ie=r,qn.transition=t,be=e,!(be&6)&&us()}}function Qv(){Tn=Go.current,$e(Go)}function $s(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,BM(t)),ct!==null)for(t=ct.return;t!==null;){var r=t;switch(Av(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Uf();break;case 3:vl(),$e(vn),$e(Kt),Lv();break;case 5:Vv(r);break;case 4:vl();break;case 13:$e(Ke);break;case 19:$e(Ke);break;case 10:Dv(r.type._context);break;case 22:case 23:Qv()}t=t.return}if(bt=n,ct=n=Hi(n.current,null),Ot=Tn=e,mt=0,Mu=null,Wv=ap=Xs=0,cn=ru=null,Ns!==null){for(e=0;e<Ns.length;e++)if(t=Ns[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}Ns=null}return n}function SC(n,e){do{var t=ct;try{if(Rv(),Jh.current=Xf,Yf){for(var r=Ge.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Yf=!1}if(Ys=0,wt=dt=Ge=null,tu=!1,Ru=0,Hv.current=null,t===null||t.return===null){mt=1,Mu=e,ct=null;break}e:{var s=n,o=t.return,l=t,a=e;if(e=Ot,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var u=a,c=l,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=gx(o);if(p!==null){p.flags&=-257,yx(p,o,l,s,e),p.mode&1&&mx(s,u,e),e=p,a=u;var y=e.updateQueue;if(y===null){var v=new Set;v.add(a),e.updateQueue=v}else y.add(a);break e}else{if(!(e&1)){mx(s,u,e),Gv();break e}a=Error($(426))}}else if(He&&l.mode&1){var E=gx(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),yx(E,o,l,s,e),Iv(wl(a,l));break e}}s=a=wl(a,l),mt!==4&&(mt=2),ru===null?ru=[s]:ru.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=sC(s,a,e);ux(s,w);break e;case 1:l=a;var _=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ui===null||!Ui.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var I=oC(s,l,e);ux(s,I);break e}}s=s.return}while(s!==null)}EC(t)}catch(D){e=D,ct===t&&t!==null&&(ct=t=t.return);continue}break}while(!0)}function bC(){var n=Jf.current;return Jf.current=Xf,n===null?Xf:n}function Gv(){(mt===0||mt===3||mt===2)&&(mt=4),bt===null||!(Xs&268435455)&&!(ap&268435455)||Ti(bt,Ot)}function td(n,e){var t=be;be|=2;var r=bC();(bt!==n||Ot!==e)&&(Hr=null,$s(n,e));do try{uN();break}catch(i){SC(n,i)}while(!0);if(Rv(),be=t,Jf.current=r,ct!==null)throw Error($(261));return bt=null,Ot=0,mt}function uN(){for(;ct!==null;)kC(ct)}function cN(){for(;ct!==null&&!NO();)kC(ct)}function kC(n){var e=CC(n.alternate,n,Tn);n.memoizedProps=n.pendingProps,e===null?EC(n):ct=e,Hv.current=null}function EC(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=rN(t,e),t!==null){t.flags&=32767,ct=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{mt=6,ct=null;return}}else if(t=nN(t,e,Tn),t!==null){ct=t;return}if(e=e.sibling,e!==null){ct=e;return}ct=e=n}while(e!==null);mt===0&&(mt=5)}function ks(n,e,t){var r=Ie,i=qn.transition;try{qn.transition=null,Ie=1,hN(n,e,t,r)}finally{qn.transition=i,Ie=r}return null}function hN(n,e,t,r){do sl();while(Ri!==null);if(be&6)throw Error($(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error($(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(WO(n,s),n===bt&&(ct=bt=null,Ot=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||ch||(ch=!0,AC(Vf,function(){return sl(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=qn.transition,qn.transition=null;var o=Ie;Ie=1;var l=be;be|=4,Hv.current=null,sN(n,t),wC(t,n),RM(ey),Bf=!!Zg,ey=Zg=null,n.current=t,oN(t),VO(),be=l,Ie=o,qn.transition=s}else n.current=t;if(ch&&(ch=!1,Ri=n,ed=i),s=n.pendingLanes,s===0&&(Ui=null),FO(t.stateNode),_n(n,it()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Zf)throw Zf=!1,n=_y,_y=null,n;return ed&1&&n.tag!==0&&sl(),s=n.pendingLanes,s&1?n===xy?iu++:(iu=0,xy=n):iu=0,us(),null}function sl(){if(Ri!==null){var n=sT(ed),e=qn.transition,t=Ie;try{if(qn.transition=null,Ie=16>n?16:n,Ri===null)var r=!1;else{if(n=Ri,Ri=null,ed=0,be&6)throw Error($(331));var i=be;for(be|=4,Y=n.current;Y!==null;){var s=Y,o=s.child;if(Y.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var u=l[a];for(Y=u;Y!==null;){var c=Y;switch(c.tag){case 0:case 11:case 15:nu(8,c,s)}var f=c.child;if(f!==null)f.return=c,Y=f;else for(;Y!==null;){c=Y;var d=c.sibling,p=c.return;if(gC(c),c===u){Y=null;break}if(d!==null){d.return=p,Y=d;break}Y=p}}}var y=s.alternate;if(y!==null){var v=y.child;if(v!==null){y.child=null;do{var E=v.sibling;v.sibling=null,v=E}while(v!==null)}}Y=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Y=o;else e:for(;Y!==null;){if(s=Y,s.flags&2048)switch(s.tag){case 0:case 11:case 15:nu(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,Y=w;break e}Y=s.return}}var _=n.current;for(Y=_;Y!==null;){o=Y;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Y=b;else e:for(o=_;Y!==null;){if(l=Y,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:lp(9,l)}}catch(D){Ze(l,l.return,D)}if(l===o){Y=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,Y=I;break e}Y=l.return}}if(be=i,us(),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(Zd,n)}catch{}r=!0}return r}finally{Ie=t,qn.transition=e}}return!1}function Px(n,e,t){e=wl(t,e),e=sC(n,e,1),n=$i(n,e,1),e=tn(),n!==null&&(pc(n,1,e),_n(n,e))}function Ze(n,e,t){if(n.tag===3)Px(n,n,t);else for(;e!==null;){if(e.tag===3){Px(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ui===null||!Ui.has(r))){n=wl(t,n),n=oC(e,n,1),e=$i(e,n,1),n=tn(),e!==null&&(pc(e,1,n),_n(e,n));break}}e=e.return}}function fN(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=tn(),n.pingedLanes|=n.suspendedLanes&t,bt===n&&(Ot&t)===t&&(mt===4||mt===3&&(Ot&130023424)===Ot&&500>it()-qv?$s(n,0):Wv|=t),_n(n,e)}function TC(n,e){e===0&&(n.mode&1?(e=eh,eh<<=1,!(eh&130023424)&&(eh=4194304)):e=1);var t=tn();n=ri(n,e),n!==null&&(pc(n,e,t),_n(n,t))}function dN(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),TC(n,t)}function pN(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),TC(n,t)}var CC;CC=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||vn.current)mn=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return mn=!1,tN(n,e,t);mn=!!(n.flags&131072)}else mn=!1,He&&e.flags&1048576&&RT(e,Wf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ef(n,e),n=e.pendingProps;var i=ml(e,Kt.current);il(e,t),i=Fv(null,e,r,n,i,t);var s=zv();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wn(r)?(s=!0,jf(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Mv(e),i.updater=op,e.stateNode=i,i._reactInternals=e,uy(e,r,n,t),e=fy(null,e,r,!0,s,t)):(e.tag=0,He&&s&&Cv(e),Xt(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(ef(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=gN(r),n=rr(r,n),i){case 0:e=hy(null,e,r,n,t);break e;case 1:e=_x(null,e,r,n,t);break e;case 11:e=vx(null,e,r,n,t);break e;case 14:e=wx(null,e,r,rr(r.type,n),t);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),hy(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),_x(n,e,r,i,t);case 3:e:{if(cC(e),n===null)throw Error($(387));r=e.pendingProps,s=e.memoizedState,i=s.element,LT(n,e),Qf(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=wl(Error($(423)),e),e=xx(n,e,r,t,i);break e}else if(r!==i){i=wl(Error($(424)),e),e=xx(n,e,r,t,i);break e}else for(An=zi(e.stateNode.containerInfo.firstChild),Dn=e,He=!0,sr=null,t=NT(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(gl(),r===i){e=ii(n,e,t);break e}Xt(n,e,r,t)}e=e.child}return e;case 5:return BT(e),n===null&&oy(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,ty(r,i)?o=null:s!==null&&ty(r,s)&&(e.flags|=32),uC(n,e),Xt(n,e,o,t),e.child;case 6:return n===null&&oy(e),null;case 13:return hC(n,e,t);case 4:return Nv(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=yl(e,null,r,t):Xt(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),vx(n,e,r,i,t);case 7:return Xt(n,e,e.pendingProps,t),e.child;case 8:return Xt(n,e,e.pendingProps.children,t),e.child;case 12:return Xt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ve(qf,r._currentValue),r._currentValue=o,s!==null)if(hr(s.value,o)){if(s.children===i.children&&!vn.current){e=ii(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Jr(-1,t&-t),a.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?a.next=a:(a.next=c.next,c.next=a),u.pending=a}}s.lanes|=t,a=s.alternate,a!==null&&(a.lanes|=t),ly(s.return,t,e),l.lanes|=t;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error($(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),ly(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Xt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,il(e,t),i=Yn(i),r=r(i),e.flags|=1,Xt(n,e,r,t),e.child;case 14:return r=e.type,i=rr(r,e.pendingProps),i=rr(r.type,i),wx(n,e,r,i,t);case 15:return lC(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:rr(r,i),ef(n,e),e.tag=1,wn(r)?(n=!0,jf(e)):n=!1,il(e,t),iC(e,r,i),uy(e,r,i,t),fy(null,e,r,!0,n,t);case 19:return fC(n,e,t);case 22:return aC(n,e,t)}throw Error($(156,e.tag))};function AC(n,e){return tT(n,e)}function mN(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(n,e,t,r){return new mN(n,e,t,r)}function Yv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function gN(n){if(typeof n=="function")return Yv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===mv)return 11;if(n===gv)return 14}return 2}function Hi(n,e){var t=n.alternate;return t===null?(t=$n(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function rf(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")Yv(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Fo:return Us(t.children,i,s,e);case pv:o=8,i|=8;break;case Og:return n=$n(12,t,e,i|2),n.elementType=Og,n.lanes=s,n;case Mg:return n=$n(13,t,e,i),n.elementType=Mg,n.lanes=s,n;case Ng:return n=$n(19,t,e,i),n.elementType=Ng,n.lanes=s,n;case BE:return up(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case VE:o=10;break e;case LE:o=9;break e;case mv:o=11;break e;case gv:o=14;break e;case xi:o=16,r=null;break e}throw Error($(130,n==null?n:typeof n,""))}return e=$n(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function Us(n,e,t,r){return n=$n(7,n,r,e),n.lanes=t,n}function up(n,e,t,r){return n=$n(22,n,r,e),n.elementType=BE,n.lanes=t,n.stateNode={isHidden:!1},n}function Um(n,e,t){return n=$n(6,n,null,e),n.lanes=t,n}function jm(n,e,t){return e=$n(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function yN(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=bm(0),this.expirationTimes=bm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bm(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Xv(n,e,t,r,i,s,o,l,a){return n=new yN(n,e,t,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=$n(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Mv(s),n}function vN(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bo,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function IC(n){if(!n)return Ji;n=n._reactInternals;e:{if(po(n)!==n||n.tag!==1)throw Error($(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(n.tag===1){var t=n.type;if(wn(t))return IT(n,t,e)}return e}function PC(n,e,t,r,i,s,o,l,a){return n=Xv(t,r,!0,n,i,s,o,l,a),n.context=IC(null),t=n.current,r=tn(),i=ji(t),s=Jr(r,i),s.callback=e??null,$i(t,s,i),n.current.lanes=i,pc(n,i,r),_n(n,r),n}function cp(n,e,t,r){var i=e.current,s=tn(),o=ji(i);return t=IC(t),e.context===null?e.context=t:e.pendingContext=t,e=Jr(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=$i(i,e,o),n!==null&&(ar(n,i,o,s),Xh(n,i,o)),o}function nd(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Rx(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Jv(n,e){Rx(n,e),(n=n.alternate)&&Rx(n,e)}function wN(){return null}var RC=typeof reportError=="function"?reportError:function(n){console.error(n)};function Zv(n){this._internalRoot=n}hp.prototype.render=Zv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error($(409));cp(n,e,null,null)};hp.prototype.unmount=Zv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Js(function(){cp(null,n,null,null)}),e[ni]=null}};function hp(n){this._internalRoot=n}hp.prototype.unstable_scheduleHydration=function(n){if(n){var e=aT();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ei.length&&e!==0&&e<Ei[t].priority;t++);Ei.splice(t,0,n),t===0&&cT(n)}};function e1(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function fp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Dx(){}function _N(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=nd(o);s.call(u)}}var o=PC(e,r,n,0,null,!1,!1,"",Dx);return n._reactRootContainer=o,n[ni]=o.current,Tu(n.nodeType===8?n.parentNode:n),Js(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var u=nd(a);l.call(u)}}var a=Xv(n,0,!1,null,null,!1,!1,"",Dx);return n._reactRootContainer=a,n[ni]=a.current,Tu(n.nodeType===8?n.parentNode:n),Js(function(){cp(e,a,t,r)}),a}function dp(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=nd(o);l.call(a)}}cp(e,o,n,i)}else o=_N(t,e,n,i,r);return nd(o)}oT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ba(e.pendingLanes);t!==0&&(wv(e,t|1),_n(e,it()),!(be&6)&&(_l=it()+500,us()))}break;case 13:Js(function(){var r=ri(n,1);if(r!==null){var i=tn();ar(r,n,1,i)}}),Jv(n,1)}};_v=function(n){if(n.tag===13){var e=ri(n,134217728);if(e!==null){var t=tn();ar(e,n,134217728,t)}Jv(n,134217728)}};lT=function(n){if(n.tag===13){var e=ji(n),t=ri(n,e);if(t!==null){var r=tn();ar(t,n,e,r)}Jv(n,e)}};aT=function(){return Ie};uT=function(n,e){var t=Ie;try{return Ie=n,e()}finally{Ie=t}};Wg=function(n,e,t){switch(e){case"input":if(Bg(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=rp(r);if(!i)throw Error($(90));zE(r),Bg(r,i)}}}break;case"textarea":UE(n,t);break;case"select":e=t.value,e!=null&&el(n,!!t.multiple,e,!1)}};GE=Kv;YE=Js;var xN={usingClientEntryPoint:!1,Events:[gc,jo,rp,KE,QE,Kv]},Sa={findFiberByHostInstance:Ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},SN={bundleType:Sa.bundleType,version:Sa.version,rendererPackageName:Sa.rendererPackageName,rendererConfig:Sa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hi.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=ZE(n),n===null?null:n.stateNode},findFiberByHostInstance:Sa.findFiberByHostInstance||wN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{Zd=hh.inject(SN),Rr=hh}catch{}}Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xN;Nn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e1(e))throw Error($(200));return vN(n,e,null,t)};Nn.createRoot=function(n,e){if(!e1(n))throw Error($(299));var t=!1,r="",i=RC;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Xv(n,1,!1,null,null,t,!1,r,i),n[ni]=e.current,Tu(n.nodeType===8?n.parentNode:n),new Zv(e)};Nn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error($(188)):(n=Object.keys(n).join(","),Error($(268,n)));return n=ZE(e),n=n===null?null:n.stateNode,n};Nn.flushSync=function(n){return Js(n)};Nn.hydrate=function(n,e,t){if(!fp(e))throw Error($(200));return dp(null,n,e,!0,t)};Nn.hydrateRoot=function(n,e,t){if(!e1(n))throw Error($(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=RC;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=PC(e,null,n,1,t??null,i,!1,s,o),n[ni]=e.current,Tu(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new hp(e)};Nn.render=function(n,e,t){if(!fp(e))throw Error($(200));return dp(null,n,e,!1,t)};Nn.unmountComponentAtNode=function(n){if(!fp(n))throw Error($(40));return n._reactRootContainer?(Js(function(){dp(null,null,n,!1,function(){n._reactRootContainer=null,n[ni]=null})}),!0):!1};Nn.unstable_batchedUpdates=Kv;Nn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!fp(t))throw Error($(200));if(n==null||n._reactInternals===void 0)throw Error($(38));return dp(n,e,t,!1,r)};Nn.version="18.3.1-next-f1338f8080-20240426";function DC(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(DC)}catch(n){console.error(n)}}DC(),DE.exports=Nn;var bN=DE.exports,Ox=bN;Rg.createRoot=Ox.createRoot,Rg.hydrateRoot=Ox.hydrateRoot;var qt=function(){return qt=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},qt.apply(this,arguments)};function Nu(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}var Fe="-ms-",su="-moz-",Ce="-webkit-",OC="comm",pp="rule",t1="decl",kN="@import",MC="@keyframes",EN="@layer",NC=Math.abs,n1=String.fromCharCode,ky=Object.assign;function TN(n,e){return _t(n,0)^45?(((e<<2^_t(n,0))<<2^_t(n,1))<<2^_t(n,2))<<2^_t(n,3):0}function VC(n){return n.trim()}function Wr(n,e){return(n=e.exec(n))?n[0]:n}function he(n,e,t){return n.replace(e,t)}function sf(n,e,t){return n.indexOf(e,t)}function _t(n,e){return n.charCodeAt(e)|0}function xl(n,e,t){return n.slice(e,t)}function xr(n){return n.length}function LC(n){return n.length}function za(n,e){return e.push(n),n}function CN(n,e){return n.map(e).join("")}function Mx(n,e){return n.filter(function(t){return!Wr(t,e)})}var mp=1,Sl=1,BC=0,Jn=0,ut=0,ql="";function gp(n,e,t,r,i,s,o,l){return{value:n,root:e,parent:t,type:r,props:i,children:s,line:mp,column:Sl,length:o,return:"",siblings:l}}function _i(n,e){return ky(gp("",null,null,"",null,null,0,n.siblings),n,{length:-n.length},e)}function ko(n){for(;n.root;)n=_i(n.root,{children:[n]});za(n,n.siblings)}function AN(){return ut}function IN(){return ut=Jn>0?_t(ql,--Jn):0,Sl--,ut===10&&(Sl=1,mp--),ut}function ur(){return ut=Jn<BC?_t(ql,Jn++):0,Sl++,ut===10&&(Sl=1,mp++),ut}function js(){return _t(ql,Jn)}function of(){return Jn}function yp(n,e){return xl(ql,n,e)}function Ey(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function PN(n){return mp=Sl=1,BC=xr(ql=n),Jn=0,[]}function RN(n){return ql="",n}function Hm(n){return VC(yp(Jn-1,Ty(n===91?n+2:n===40?n+1:n)))}function DN(n){for(;(ut=js())&&ut<33;)ur();return Ey(n)>2||Ey(ut)>3?"":" "}function ON(n,e){for(;--e&&ur()&&!(ut<48||ut>102||ut>57&&ut<65||ut>70&&ut<97););return yp(n,of()+(e<6&&js()==32&&ur()==32))}function Ty(n){for(;ur();)switch(ut){case n:return Jn;case 34:case 39:n!==34&&n!==39&&Ty(ut);break;case 40:n===41&&Ty(n);break;case 92:ur();break}return Jn}function MN(n,e){for(;ur()&&n+ut!==57;)if(n+ut===84&&js()===47)break;return"/*"+yp(e,Jn-1)+"*"+n1(n===47?n:ur())}function NN(n){for(;!Ey(js());)ur();return yp(n,Jn)}function VN(n){return RN(lf("",null,null,null,[""],n=PN(n),0,[0],n))}function lf(n,e,t,r,i,s,o,l,a){for(var u=0,c=0,f=o,d=0,p=0,y=0,v=1,E=1,w=1,_=0,b="",I=i,D=s,M=r,x=b;E;)switch(y=_,_=ur()){case 40:if(y!=108&&_t(x,f-1)==58){sf(x+=he(Hm(_),"&","&\f"),"&\f",NC(u?l[u-1]:0))!=-1&&(w=-1);break}case 34:case 39:case 91:x+=Hm(_);break;case 9:case 10:case 13:case 32:x+=DN(y);break;case 92:x+=ON(of()-1,7);continue;case 47:switch(js()){case 42:case 47:za(LN(MN(ur(),of()),e,t,a),a);break;default:x+="/"}break;case 123*v:l[u++]=xr(x)*w;case 125*v:case 59:case 0:switch(_){case 0:case 125:E=0;case 59+c:w==-1&&(x=he(x,/\f/g,"")),p>0&&xr(x)-f&&za(p>32?Vx(x+";",r,t,f-1,a):Vx(he(x," ","")+";",r,t,f-2,a),a);break;case 59:x+=";";default:if(za(M=Nx(x,e,t,u,c,i,l,b,I=[],D=[],f,s),s),_===123)if(c===0)lf(x,e,M,M,I,s,f,l,D);else switch(d===99&&_t(x,3)===110?100:d){case 100:case 108:case 109:case 115:lf(n,M,M,r&&za(Nx(n,M,M,0,0,i,l,b,i,I=[],f,D),D),i,D,f,l,r?I:D);break;default:lf(x,M,M,M,[""],D,0,l,D)}}u=c=p=0,v=w=1,b=x="",f=o;break;case 58:f=1+xr(x),p=y;default:if(v<1){if(_==123)--v;else if(_==125&&v++==0&&IN()==125)continue}switch(x+=n1(_),_*v){case 38:w=c>0?1:(x+="\f",-1);break;case 44:l[u++]=(xr(x)-1)*w,w=1;break;case 64:js()===45&&(x+=Hm(ur())),d=js(),c=f=xr(b=x+=NN(of())),_++;break;case 45:y===45&&xr(x)==2&&(v=0)}}return s}function Nx(n,e,t,r,i,s,o,l,a,u,c,f){for(var d=i-1,p=i===0?s:[""],y=LC(p),v=0,E=0,w=0;v<r;++v)for(var _=0,b=xl(n,d+1,d=NC(E=o[v])),I=n;_<y;++_)(I=VC(E>0?p[_]+" "+b:he(b,/&\f/g,p[_])))&&(a[w++]=I);return gp(n,e,t,i===0?pp:l,a,u,c,f)}function LN(n,e,t,r){return gp(n,e,t,OC,n1(AN()),xl(n,2,-2),0,r)}function Vx(n,e,t,r,i){return gp(n,e,t,t1,xl(n,0,r),xl(n,r+1,-1),r,i)}function FC(n,e,t){switch(TN(n,e)){case 5103:return Ce+"print-"+n+n;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Ce+n+n;case 4789:return su+n+n;case 5349:case 4246:case 4810:case 6968:case 2756:return Ce+n+su+n+Fe+n+n;case 5936:switch(_t(n,e+11)){case 114:return Ce+n+Fe+he(n,/[svh]\w+-[tblr]{2}/,"tb")+n;case 108:return Ce+n+Fe+he(n,/[svh]\w+-[tblr]{2}/,"tb-rl")+n;case 45:return Ce+n+Fe+he(n,/[svh]\w+-[tblr]{2}/,"lr")+n}case 6828:case 4268:case 2903:return Ce+n+Fe+n+n;case 6165:return Ce+n+Fe+"flex-"+n+n;case 5187:return Ce+n+he(n,/(\w+).+(:[^]+)/,Ce+"box-$1$2"+Fe+"flex-$1$2")+n;case 5443:return Ce+n+Fe+"flex-item-"+he(n,/flex-|-self/g,"")+(Wr(n,/flex-|baseline/)?"":Fe+"grid-row-"+he(n,/flex-|-self/g,""))+n;case 4675:return Ce+n+Fe+"flex-line-pack"+he(n,/align-content|flex-|-self/g,"")+n;case 5548:return Ce+n+Fe+he(n,"shrink","negative")+n;case 5292:return Ce+n+Fe+he(n,"basis","preferred-size")+n;case 6060:return Ce+"box-"+he(n,"-grow","")+Ce+n+Fe+he(n,"grow","positive")+n;case 4554:return Ce+he(n,/([^-])(transform)/g,"$1"+Ce+"$2")+n;case 6187:return he(he(he(n,/(zoom-|grab)/,Ce+"$1"),/(image-set)/,Ce+"$1"),n,"")+n;case 5495:case 3959:return he(n,/(image-set\([^]*)/,Ce+"$1$`$1");case 4968:return he(he(n,/(.+:)(flex-)?(.*)/,Ce+"box-pack:$3"+Fe+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Ce+n+n;case 4200:if(!Wr(n,/flex-|baseline/))return Fe+"grid-column-align"+xl(n,e)+n;break;case 2592:case 3360:return Fe+he(n,"template-","")+n;case 4384:case 3616:return t&&t.some(function(r,i){return e=i,Wr(r.props,/grid-\w+-end/)})?~sf(n+(t=t[e].value),"span",0)?n:Fe+he(n,"-start","")+n+Fe+"grid-row-span:"+(~sf(t,"span",0)?Wr(t,/\d+/):+Wr(t,/\d+/)-+Wr(n,/\d+/))+";":Fe+he(n,"-start","")+n;case 4896:case 4128:return t&&t.some(function(r){return Wr(r.props,/grid-\w+-start/)})?n:Fe+he(he(n,"-end","-span"),"span ","")+n;case 4095:case 3583:case 4068:case 2532:return he(n,/(.+)-inline(.+)/,Ce+"$1$2")+n;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(xr(n)-1-e>6)switch(_t(n,e+1)){case 109:if(_t(n,e+4)!==45)break;case 102:return he(n,/(.+:)(.+)-([^]+)/,"$1"+Ce+"$2-$3$1"+su+(_t(n,e+3)==108?"$3":"$2-$3"))+n;case 115:return~sf(n,"stretch",0)?FC(he(n,"stretch","fill-available"),e,t)+n:n}break;case 5152:case 5920:return he(n,/(.+?):(\d+)(\s*\/\s*(span)?\s*(\d+))?(.*)/,function(r,i,s,o,l,a,u){return Fe+i+":"+s+u+(o?Fe+i+"-span:"+(l?a:+a-+s)+u:"")+n});case 4949:if(_t(n,e+6)===121)return he(n,":",":"+Ce)+n;break;case 6444:switch(_t(n,_t(n,14)===45?18:11)){case 120:return he(n,/(.+:)([^;\s!]+)(;|(\s+)?!.+)?/,"$1"+Ce+(_t(n,14)===45?"inline-":"")+"box$3$1"+Ce+"$2$3$1"+Fe+"$2box$3")+n;case 100:return he(n,":",":"+Fe)+n}break;case 5719:case 2647:case 2135:case 3927:case 2391:return he(n,"scroll-","scroll-snap-")+n}return n}function rd(n,e){for(var t="",r=0;r<n.length;r++)t+=e(n[r],r,n,e)||"";return t}function BN(n,e,t,r){switch(n.type){case EN:if(n.children.length)break;case kN:case t1:return n.return=n.return||n.value;case OC:return"";case MC:return n.return=n.value+"{"+rd(n.children,r)+"}";case pp:if(!xr(n.value=n.props.join(",")))return""}return xr(t=rd(n.children,r))?n.return=n.value+"{"+t+"}":""}function FN(n){var e=LC(n);return function(t,r,i,s){for(var o="",l=0;l<e;l++)o+=n[l](t,r,i,s)||"";return o}}function zN(n){return function(e){e.root||(e=e.return)&&n(e)}}function $N(n,e,t,r){if(n.length>-1&&!n.return)switch(n.type){case t1:n.return=FC(n.value,n.length,t);return;case MC:return rd([_i(n,{value:he(n.value,"@","@"+Ce)})],r);case pp:if(n.length)return CN(t=n.props,function(i){switch(Wr(i,r=/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":ko(_i(n,{props:[he(i,/:(read-\w+)/,":"+su+"$1")]})),ko(_i(n,{props:[i]})),ky(n,{props:Mx(t,r)});break;case"::placeholder":ko(_i(n,{props:[he(i,/:(plac\w+)/,":"+Ce+"input-$1")]})),ko(_i(n,{props:[he(i,/:(plac\w+)/,":"+su+"$1")]})),ko(_i(n,{props:[he(i,/:(plac\w+)/,Fe+"input-$1")]})),ko(_i(n,{props:[i]})),ky(n,{props:Mx(t,r)});break}return""})}}var UN={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},En={},bl=typeof process<"u"&&En!==void 0&&(En.REACT_APP_SC_ATTR||En.SC_ATTR)||"data-styled",zC="active",$C="data-styled-version",vp="6.1.16",r1=`/*!sc*/
`,id=typeof window<"u"&&"HTMLElement"in window,jN=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&En!==void 0&&En.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&En.REACT_APP_SC_DISABLE_SPEEDY!==""?En.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&En.REACT_APP_SC_DISABLE_SPEEDY:typeof process<"u"&&En!==void 0&&En.SC_DISABLE_SPEEDY!==void 0&&En.SC_DISABLE_SPEEDY!==""&&En.SC_DISABLE_SPEEDY!=="false"&&En.SC_DISABLE_SPEEDY),HN={},wp=Object.freeze([]),kl=Object.freeze({});function UC(n,e,t){return t===void 0&&(t=kl),n.theme!==t.theme&&n.theme||e||t.theme}var jC=new Set(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","use","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"]),WN=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,qN=/(^-|-$)/g;function Lx(n){return n.replace(WN,"-").replace(qN,"")}var KN=/(a)(d)/gi,fh=52,Bx=function(n){return String.fromCharCode(n+(n>25?39:97))};function Cy(n){var e,t="";for(e=Math.abs(n);e>fh;e=e/fh|0)t=Bx(e%fh)+t;return(Bx(e%fh)+t).replace(KN,"$1-$2")}var Wm,HC=5381,Yo=function(n,e){for(var t=e.length;t;)n=33*n^e.charCodeAt(--t);return n},WC=function(n){return Yo(HC,n)};function qC(n){return Cy(WC(n)>>>0)}function QN(n){return n.displayName||n.name||"Component"}function qm(n){return typeof n=="string"&&!0}var KC=typeof Symbol=="function"&&Symbol.for,QC=KC?Symbol.for("react.memo"):60115,GN=KC?Symbol.for("react.forward_ref"):60112,YN={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},XN={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},GC={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},JN=((Wm={})[GN]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Wm[QC]=GC,Wm);function Fx(n){return("type"in(e=n)&&e.type.$$typeof)===QC?GC:"$$typeof"in n?JN[n.$$typeof]:YN;var e}var ZN=Object.defineProperty,eV=Object.getOwnPropertyNames,zx=Object.getOwnPropertySymbols,tV=Object.getOwnPropertyDescriptor,nV=Object.getPrototypeOf,$x=Object.prototype;function YC(n,e,t){if(typeof e!="string"){if($x){var r=nV(e);r&&r!==$x&&YC(n,r,t)}var i=eV(e);zx&&(i=i.concat(zx(e)));for(var s=Fx(n),o=Fx(e),l=0;l<i.length;++l){var a=i[l];if(!(a in XN||t&&t[a]||o&&a in o||s&&a in s)){var u=tV(e,a);try{ZN(n,a,u)}catch{}}}}return n}function El(n){return typeof n=="function"}function i1(n){return typeof n=="object"&&"styledComponentId"in n}function Ls(n,e){return n&&e?"".concat(n," ").concat(e):n||e||""}function Ay(n,e){if(n.length===0)return"";for(var t=n[0],r=1;r<n.length;r++)t+=n[r];return t}function Vu(n){return n!==null&&typeof n=="object"&&n.constructor.name===Object.name&&!("props"in n&&n.$$typeof)}function Iy(n,e,t){if(t===void 0&&(t=!1),!t&&!Vu(n)&&!Array.isArray(n))return e;if(Array.isArray(e))for(var r=0;r<e.length;r++)n[r]=Iy(n[r],e[r]);else if(Vu(e))for(var r in e)n[r]=Iy(n[r],e[r]);return n}function s1(n,e){Object.defineProperty(n,"toString",{value:e})}function vc(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return new Error("An error occurred. See https://github.com/styled-components/styled-components/blob/main/packages/styled-components/src/utils/errors.md#".concat(n," for more information.").concat(e.length>0?" Args: ".concat(e.join(", ")):""))}var rV=function(){function n(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}return n.prototype.indexOfGroup=function(e){for(var t=0,r=0;r<e;r++)t+=this.groupSizes[r];return t},n.prototype.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var r=this.groupSizes,i=r.length,s=i;e>=s;)if((s<<=1)<0)throw vc(16,"".concat(e));this.groupSizes=new Uint32Array(s),this.groupSizes.set(r),this.length=s;for(var o=i;o<s;o++)this.groupSizes[o]=0}for(var l=this.indexOfGroup(e+1),a=(o=0,t.length);o<a;o++)this.tag.insertRule(l,t[o])&&(this.groupSizes[e]++,l++)},n.prototype.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],r=this.indexOfGroup(e),i=r+t;this.groupSizes[e]=0;for(var s=r;s<i;s++)this.tag.deleteRule(r)}},n.prototype.getGroup=function(e){var t="";if(e>=this.length||this.groupSizes[e]===0)return t;for(var r=this.groupSizes[e],i=this.indexOfGroup(e),s=i+r,o=i;o<s;o++)t+="".concat(this.tag.getRule(o)).concat(r1);return t},n}(),af=new Map,sd=new Map,uf=1,dh=function(n){if(af.has(n))return af.get(n);for(;sd.has(uf);)uf++;var e=uf++;return af.set(n,e),sd.set(e,n),e},iV=function(n,e){uf=e+1,af.set(n,e),sd.set(e,n)},sV="style[".concat(bl,"][").concat($C,'="').concat(vp,'"]'),oV=new RegExp("^".concat(bl,'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)')),lV=function(n,e,t){for(var r,i=t.split(","),s=0,o=i.length;s<o;s++)(r=i[s])&&n.registerName(e,r)},aV=function(n,e){for(var t,r=((t=e.textContent)!==null&&t!==void 0?t:"").split(r1),i=[],s=0,o=r.length;s<o;s++){var l=r[s].trim();if(l){var a=l.match(oV);if(a){var u=0|parseInt(a[1],10),c=a[2];u!==0&&(iV(c,u),lV(n,c,a[3]),n.getTag().insertRules(u,i)),i.length=0}else i.push(l)}}},Ux=function(n){for(var e=document.querySelectorAll(sV),t=0,r=e.length;t<r;t++){var i=e[t];i&&i.getAttribute(bl)!==zC&&(aV(n,i),i.parentNode&&i.parentNode.removeChild(i))}};function uV(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null}var XC=function(n){var e=document.head,t=n||e,r=document.createElement("style"),i=function(l){var a=Array.from(l.querySelectorAll("style[".concat(bl,"]")));return a[a.length-1]}(t),s=i!==void 0?i.nextSibling:null;r.setAttribute(bl,zC),r.setAttribute($C,vp);var o=uV();return o&&r.setAttribute("nonce",o),t.insertBefore(r,s),r},cV=function(){function n(e){this.element=XC(e),this.element.appendChild(document.createTextNode("")),this.sheet=function(t){if(t.sheet)return t.sheet;for(var r=document.styleSheets,i=0,s=r.length;i<s;i++){var o=r[i];if(o.ownerNode===t)return o}throw vc(17)}(this.element),this.length=0}return n.prototype.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch{return!1}},n.prototype.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},n.prototype.getRule=function(e){var t=this.sheet.cssRules[e];return t&&t.cssText?t.cssText:""},n}(),hV=function(){function n(e){this.element=XC(e),this.nodes=this.element.childNodes,this.length=0}return n.prototype.insertRule=function(e,t){if(e<=this.length&&e>=0){var r=document.createTextNode(t);return this.element.insertBefore(r,this.nodes[e]||null),this.length++,!0}return!1},n.prototype.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},n.prototype.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},n}(),fV=function(){function n(e){this.rules=[],this.length=0}return n.prototype.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},n.prototype.deleteRule=function(e){this.rules.splice(e,1),this.length--},n.prototype.getRule=function(e){return e<this.length?this.rules[e]:""},n}(),jx=id,dV={isServer:!id,useCSSOMInjection:!jN},od=function(){function n(e,t,r){e===void 0&&(e=kl),t===void 0&&(t={});var i=this;this.options=qt(qt({},dV),e),this.gs=t,this.names=new Map(r),this.server=!!e.isServer,!this.server&&id&&jx&&(jx=!1,Ux(this)),s1(this,function(){return function(s){for(var o=s.getTag(),l=o.length,a="",u=function(f){var d=function(w){return sd.get(w)}(f);if(d===void 0)return"continue";var p=s.names.get(d),y=o.getGroup(f);if(p===void 0||!p.size||y.length===0)return"continue";var v="".concat(bl,".g").concat(f,'[id="').concat(d,'"]'),E="";p!==void 0&&p.forEach(function(w){w.length>0&&(E+="".concat(w,","))}),a+="".concat(y).concat(v,'{content:"').concat(E,'"}').concat(r1)},c=0;c<l;c++)u(c);return a}(i)})}return n.registerId=function(e){return dh(e)},n.prototype.rehydrate=function(){!this.server&&id&&Ux(this)},n.prototype.reconstructWithOptions=function(e,t){return t===void 0&&(t=!0),new n(qt(qt({},this.options),e),this.gs,t&&this.names||void 0)},n.prototype.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},n.prototype.getTag=function(){return this.tag||(this.tag=(e=function(t){var r=t.useCSSOMInjection,i=t.target;return t.isServer?new fV(i):r?new cV(i):new hV(i)}(this.options),new rV(e)));var e},n.prototype.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},n.prototype.registerName=function(e,t){if(dh(e),this.names.has(e))this.names.get(e).add(t);else{var r=new Set;r.add(t),this.names.set(e,r)}},n.prototype.insertRules=function(e,t,r){this.registerName(e,t),this.getTag().insertRules(dh(e),r)},n.prototype.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},n.prototype.clearRules=function(e){this.getTag().clearGroup(dh(e)),this.clearNames(e)},n.prototype.clearTag=function(){this.tag=void 0},n}(),pV=/&/g,mV=/^\s*\/\/.*$/gm;function JC(n,e){return n.map(function(t){return t.type==="rule"&&(t.value="".concat(e," ").concat(t.value),t.value=t.value.replaceAll(",",",".concat(e," ")),t.props=t.props.map(function(r){return"".concat(e," ").concat(r)})),Array.isArray(t.children)&&t.type!=="@keyframes"&&(t.children=JC(t.children,e)),t})}function gV(n){var e,t,r,i=kl,s=i.options,o=s===void 0?kl:s,l=i.plugins,a=l===void 0?wp:l,u=function(d,p,y){return y.startsWith(t)&&y.endsWith(t)&&y.replaceAll(t,"").length>0?".".concat(e):d},c=a.slice();c.push(function(d){d.type===pp&&d.value.includes("&")&&(d.props[0]=d.props[0].replace(pV,t).replace(r,u))}),o.prefix&&c.push($N),c.push(BN);var f=function(d,p,y,v){p===void 0&&(p=""),y===void 0&&(y=""),v===void 0&&(v="&"),e=v,t=p,r=new RegExp("\\".concat(t,"\\b"),"g");var E=d.replace(mV,""),w=VN(y||p?"".concat(y," ").concat(p," { ").concat(E," }"):E);o.namespace&&(w=JC(w,o.namespace));var _=[];return rd(w,FN(c.concat(zN(function(b){return _.push(b)})))),_};return f.hash=a.length?a.reduce(function(d,p){return p.name||vc(15),Yo(d,p.name)},HC).toString():"",f}var yV=new od,Py=gV(),ZC=Tr.createContext({shouldForwardProp:void 0,styleSheet:yV,stylis:Py});ZC.Consumer;Tr.createContext(void 0);function Ry(){return se.useContext(ZC)}var vV=function(){function n(e,t){var r=this;this.inject=function(i,s){s===void 0&&(s=Py);var o=r.name+s.hash;i.hasNameForId(r.id,o)||i.insertRules(r.id,o,s(r.rules,o,"@keyframes"))},this.name=e,this.id="sc-keyframes-".concat(e),this.rules=t,s1(this,function(){throw vc(12,String(r.name))})}return n.prototype.getName=function(e){return e===void 0&&(e=Py),this.name+e.hash},n}(),wV=function(n){return n>="A"&&n<="Z"};function Hx(n){for(var e="",t=0;t<n.length;t++){var r=n[t];if(t===1&&r==="-"&&n[0]==="-")return n;wV(r)?e+="-"+r.toLowerCase():e+=r}return e.startsWith("ms-")?"-"+e:e}var eA=function(n){return n==null||n===!1||n===""},tA=function(n){var e,t,r=[];for(var i in n){var s=n[i];n.hasOwnProperty(i)&&!eA(s)&&(Array.isArray(s)&&s.isCss||El(s)?r.push("".concat(Hx(i),":"),s,";"):Vu(s)?r.push.apply(r,Nu(Nu(["".concat(i," {")],tA(s),!1),["}"],!1)):r.push("".concat(Hx(i),": ").concat((e=i,(t=s)==null||typeof t=="boolean"||t===""?"":typeof t!="number"||t===0||e in UN||e.startsWith("--")?String(t).trim():"".concat(t,"px")),";")))}return r};function Wi(n,e,t,r){if(eA(n))return[];if(i1(n))return[".".concat(n.styledComponentId)];if(El(n)){if(!El(s=n)||s.prototype&&s.prototype.isReactComponent||!e)return[n];var i=n(e);return Wi(i,e,t,r)}var s;return n instanceof vV?t?(n.inject(t,r),[n.getName(r)]):[n]:Vu(n)?tA(n):Array.isArray(n)?Array.prototype.concat.apply(wp,n.map(function(o){return Wi(o,e,t,r)})):[n.toString()]}function nA(n){for(var e=0;e<n.length;e+=1){var t=n[e];if(El(t)&&!i1(t))return!1}return!0}var _V=WC(vp),xV=function(){function n(e,t,r){this.rules=e,this.staticRulesId="",this.isStatic=(r===void 0||r.isStatic)&&nA(e),this.componentId=t,this.baseHash=Yo(_V,t),this.baseStyle=r,od.registerId(t)}return n.prototype.generateAndInjectStyles=function(e,t,r){var i=this.baseStyle?this.baseStyle.generateAndInjectStyles(e,t,r):"";if(this.isStatic&&!r.hash)if(this.staticRulesId&&t.hasNameForId(this.componentId,this.staticRulesId))i=Ls(i,this.staticRulesId);else{var s=Ay(Wi(this.rules,e,t,r)),o=Cy(Yo(this.baseHash,s)>>>0);if(!t.hasNameForId(this.componentId,o)){var l=r(s,".".concat(o),void 0,this.componentId);t.insertRules(this.componentId,o,l)}i=Ls(i,o),this.staticRulesId=o}else{for(var a=Yo(this.baseHash,r.hash),u="",c=0;c<this.rules.length;c++){var f=this.rules[c];if(typeof f=="string")u+=f;else if(f){var d=Ay(Wi(f,e,t,r));a=Yo(a,d+c),u+=d}}if(u){var p=Cy(a>>>0);t.hasNameForId(this.componentId,p)||t.insertRules(this.componentId,p,r(u,".".concat(p),void 0,this.componentId)),i=Ls(i,p)}}return i},n}(),o1=Tr.createContext(void 0);o1.Consumer;var Km={};function SV(n,e,t){var r=i1(n),i=n,s=!qm(n),o=e.attrs,l=o===void 0?wp:o,a=e.componentId,u=a===void 0?function(I,D){var M=typeof I!="string"?"sc":Lx(I);Km[M]=(Km[M]||0)+1;var x="".concat(M,"-").concat(qC(vp+M+Km[M]));return D?"".concat(D,"-").concat(x):x}(e.displayName,e.parentComponentId):a,c=e.displayName,f=c===void 0?function(I){return qm(I)?"styled.".concat(I):"Styled(".concat(QN(I),")")}(n):c,d=e.displayName&&e.componentId?"".concat(Lx(e.displayName),"-").concat(e.componentId):e.componentId||u,p=r&&i.attrs?i.attrs.concat(l).filter(Boolean):l,y=e.shouldForwardProp;if(r&&i.shouldForwardProp){var v=i.shouldForwardProp;if(e.shouldForwardProp){var E=e.shouldForwardProp;y=function(I,D){return v(I,D)&&E(I,D)}}else y=v}var w=new xV(t,d,r?i.componentStyle:void 0);function _(I,D){return function(M,x,S){var T=M.attrs,C=M.componentStyle,P=M.defaultProps,R=M.foldedComponentIds,A=M.styledComponentId,re=M.target,ce=Tr.useContext(o1),Te=Ry(),ae=M.shouldForwardProp||Te.shouldForwardProp,U=UC(x,ce,P)||kl,H=function(nt,ot,Et){for(var ms,Fr=qt(qt({},ot),{className:void 0,theme:Et}),di=0;di<nt.length;di+=1){var zr=El(ms=nt[di])?ms(Fr):ms;for(var Ln in zr)Fr[Ln]=Ln==="className"?Ls(Fr[Ln],zr[Ln]):Ln==="style"?qt(qt({},Fr[Ln]),zr[Ln]):zr[Ln]}return ot.className&&(Fr.className=Ls(Fr.className,ot.className)),Fr}(T,x,U),J=H.as||re,fe={};for(var ie in H)H[ie]===void 0||ie[0]==="$"||ie==="as"||ie==="theme"&&H.theme===U||(ie==="forwardedAs"?fe.as=H.forwardedAs:ae&&!ae(ie,J)||(fe[ie]=H[ie]));var ge=function(nt,ot){var Et=Ry(),ms=nt.generateAndInjectStyles(ot,Et.styleSheet,Et.stylis);return ms}(C,H),tt=Ls(R,A);return ge&&(tt+=" "+ge),H.className&&(tt+=" "+H.className),fe[qm(J)&&!jC.has(J)?"class":"className"]=tt,S&&(fe.ref=S),se.createElement(J,fe)}(b,I,D)}_.displayName=f;var b=Tr.forwardRef(_);return b.attrs=p,b.componentStyle=w,b.displayName=f,b.shouldForwardProp=y,b.foldedComponentIds=r?Ls(i.foldedComponentIds,i.styledComponentId):"",b.styledComponentId=d,b.target=r?i.target:n,Object.defineProperty(b,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(I){this._foldedDefaultProps=r?function(D){for(var M=[],x=1;x<arguments.length;x++)M[x-1]=arguments[x];for(var S=0,T=M;S<T.length;S++)Iy(D,T[S],!0);return D}({},i.defaultProps,I):I}}),s1(b,function(){return".".concat(b.styledComponentId)}),s&&YC(b,n,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0}),b}function Wx(n,e){for(var t=[n[0]],r=0,i=e.length;r<i;r+=1)t.push(e[r],n[r+1]);return t}var qx=function(n){return Object.assign(n,{isCss:!0})};function rA(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];if(El(n)||Vu(n))return qx(Wi(Wx(wp,Nu([n],e,!0))));var r=n;return e.length===0&&r.length===1&&typeof r[0]=="string"?Wi(r):qx(Wi(Wx(r,e)))}function Dy(n,e,t){if(t===void 0&&(t=kl),!e)throw vc(1,e);var r=function(i){for(var s=[],o=1;o<arguments.length;o++)s[o-1]=arguments[o];return n(e,t,rA.apply(void 0,Nu([i],s,!1)))};return r.attrs=function(i){return Dy(n,e,qt(qt({},t),{attrs:Array.prototype.concat(t.attrs,i).filter(Boolean)}))},r.withConfig=function(i){return Dy(n,e,qt(qt({},t),i))},r}var iA=function(n){return Dy(SV,n)},Nt=iA;jC.forEach(function(n){Nt[n]=iA(n)});var bV=function(){function n(e,t){this.rules=e,this.componentId=t,this.isStatic=nA(e),od.registerId(this.componentId+1)}return n.prototype.createStyles=function(e,t,r,i){var s=i(Ay(Wi(this.rules,t,r,i)),""),o=this.componentId+e;r.insertRules(o,o,s)},n.prototype.removeStyles=function(e,t){t.clearRules(this.componentId+e)},n.prototype.renderStyles=function(e,t,r,i){e>2&&od.registerId(this.componentId+e),this.removeStyles(e,r),this.createStyles(e,t,r,i)},n}();function kV(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var r=rA.apply(void 0,Nu([n],e,!1)),i="sc-global-".concat(qC(JSON.stringify(r))),s=new bV(r,i),o=function(a){var u=Ry(),c=Tr.useContext(o1),f=Tr.useRef(u.styleSheet.allocateGSInstance(i)).current;return u.styleSheet.server&&l(f,a,u.styleSheet,c,u.stylis),Tr.useLayoutEffect(function(){if(!u.styleSheet.server)return l(f,a,u.styleSheet,c,u.stylis),function(){return s.removeStyles(f,u.styleSheet)}},[f,a,u.styleSheet,c,u.stylis]),null};function l(a,u,c,f,d){if(s.isStatic)s.renderStyles(a,HN,c,d);else{var p=qt(qt({},u),{theme:UC(u,f,o.defaultProps)});s.renderStyles(a,p,c,d)}}return Tr.memo(o)}function Lu(){return Lu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Lu.apply(null,arguments)}function EV(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}let Oy=[],sA=[];(()=>{let n="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(e=>e?parseInt(e,36):1);for(let e=0,t=0;e<n.length;e++)(e%2?sA:Oy).push(t=t+n[e])})();function TV(n){if(n<768)return!1;for(let e=0,t=Oy.length;;){let r=e+t>>1;if(n<Oy[r])t=r;else if(n>=sA[r])e=r+1;else return!0;if(e==t)return!1}}function Kx(n){return n>=127462&&n<=127487}const Qx=8205;function CV(n,e,t=!0,r=!0){return(t?oA:AV)(n,e,r)}function oA(n,e,t){if(e==n.length)return e;e&&lA(n.charCodeAt(e))&&aA(n.charCodeAt(e-1))&&e--;let r=Qm(n,e);for(e+=Gx(r);e<n.length;){let i=Qm(n,e);if(r==Qx||i==Qx||t&&TV(i))e+=Gx(i),r=i;else if(Kx(i)){let s=0,o=e-2;for(;o>=0&&Kx(Qm(n,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function AV(n,e,t){for(;e>0;){let r=oA(n,e-2,t);if(r<e)return r;e--}return 0}function Qm(n,e){let t=n.charCodeAt(e);if(!aA(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return lA(r)?(t-55296<<10)+(r-56320)+65536:t}function lA(n){return n>=56320&&n<57344}function aA(n){return n>=55296&&n<56320}function Gx(n){return n<65536?1:2}class Se{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,t,r){[e,t]=Tl(this,e,t);let i=[];return this.decompose(0,e,i,2),r.length&&r.decompose(0,r.length,i,3),this.decompose(t,this.length,i,1),br.from(i,this.length-(t-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,t=this.length){[e,t]=Tl(this,e,t);let r=[];return this.decompose(e,t,r,0),br.from(r,t-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let t=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),i=new ou(this),s=new ou(e);for(let o=t,l=t;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(l+=i.value.length,i.done||l>=r)return!0}}iter(e=1){return new ou(this,e)}iterRange(e,t=this.length){return new uA(this,e,t)}iterLines(e,t){let r;if(e==null)r=this.iter();else{t==null&&(t=this.lines+1);let i=this.line(e).from;r=this.iterRange(i,Math.max(i,t==this.lines+1?this.length:t<=1?0:this.line(t-1).to))}return new cA(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Se.empty:e.length<=32?new rt(e):br.from(rt.split(e,[]))}}class rt extends Se{constructor(e,t=IV(e)){super(),this.text=e,this.length=t}get lines(){return this.text.length}get children(){return null}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.text[s],l=i+o.length;if((t?r:l)>=e)return new PV(i,l,r,o);i=l+1,r++}}decompose(e,t,r,i){let s=e<=0&&t>=this.length?this:new rt(Yx(this.text,e,t),Math.min(t,this.length)-Math.max(0,e));if(i&1){let o=r.pop(),l=cf(s.text,o.text.slice(),0,s.length);if(l.length<=32)r.push(new rt(l,o.length+s.length));else{let a=l.length>>1;r.push(new rt(l.slice(0,a)),new rt(l.slice(a)))}}else r.push(s)}replace(e,t,r){if(!(r instanceof rt))return super.replace(e,t,r);[e,t]=Tl(this,e,t);let i=cf(this.text,cf(r.text,Yx(this.text,0,e)),t),s=this.length+r.length-(t-e);return i.length<=32?new rt(i,s):br.from(rt.split(i,[]),s)}sliceString(e,t=this.length,r=`
`){[e,t]=Tl(this,e,t);let i="";for(let s=0,o=0;s<=t&&o<this.text.length;o++){let l=this.text[o],a=s+l.length;s>e&&o&&(i+=r),e<a&&t>s&&(i+=l.slice(Math.max(0,e-s),t-s)),s=a+1}return i}flatten(e){for(let t of this.text)e.push(t)}scanIdentical(){return 0}static split(e,t){let r=[],i=-1;for(let s of e)r.push(s),i+=s.length+1,r.length==32&&(t.push(new rt(r,i)),r=[],i=-1);return i>-1&&t.push(new rt(r,i)),t}}class br extends Se{constructor(e,t){super(),this.children=e,this.length=t,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,t,r,i){for(let s=0;;s++){let o=this.children[s],l=i+o.length,a=r+o.lines-1;if((t?a:l)>=e)return o.lineInner(e,t,r,i);i=l+1,r=a+1}}decompose(e,t,r,i){for(let s=0,o=0;o<=t&&s<this.children.length;s++){let l=this.children[s],a=o+l.length;if(e<=a&&t>=o){let u=i&((o<=e?1:0)|(a>=t?2:0));o>=e&&a<=t&&!u?r.push(l):l.decompose(e-o,t-o,r,u)}o=a+1}}replace(e,t,r){if([e,t]=Tl(this,e,t),r.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],l=s+o.length;if(e>=s&&t<=l){let a=o.replace(e-s,t-s,r),u=this.lines-o.lines+a.lines;if(a.lines<u>>4&&a.lines>u>>6){let c=this.children.slice();return c[i]=a,new br(c,this.length-(t-e)+r.length)}return super.replace(s,l,a)}s=l+1}return super.replace(e,t,r)}sliceString(e,t=this.length,r=`
`){[e,t]=Tl(this,e,t);let i="";for(let s=0,o=0;s<this.children.length&&o<=t;s++){let l=this.children[s],a=o+l.length;o>e&&s&&(i+=r),e<a&&t>o&&(i+=l.sliceString(e-o,t-o,r)),o=a+1}return i}flatten(e){for(let t of this.children)t.flatten(e)}scanIdentical(e,t){if(!(e instanceof br))return 0;let r=0,[i,s,o,l]=t>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=t,s+=t){if(i==o||s==l)return r;let a=this.children[i],u=e.children[s];if(a!=u)return r+a.scanIdentical(u,t);r+=a.length+1}}static from(e,t=e.reduce((r,i)=>r+i.length+1,-1)){let r=0;for(let p of e)r+=p.lines;if(r<32){let p=[];for(let y of e)y.flatten(p);return new rt(p,t)}let i=Math.max(32,r>>5),s=i<<1,o=i>>1,l=[],a=0,u=-1,c=[];function f(p){let y;if(p.lines>s&&p instanceof br)for(let v of p.children)f(v);else p.lines>o&&(a>o||!a)?(d(),l.push(p)):p instanceof rt&&a&&(y=c[c.length-1])instanceof rt&&p.lines+y.lines<=32?(a+=p.lines,u+=p.length+1,c[c.length-1]=new rt(y.text.concat(p.text),y.length+1+p.length)):(a+p.lines>i&&d(),a+=p.lines,u+=p.length+1,c.push(p))}function d(){a!=0&&(l.push(c.length==1?c[0]:br.from(c,u)),u=-1,a=c.length=0)}for(let p of e)f(p);return d(),l.length==1?l[0]:new br(l,t)}}Se.empty=new rt([""],0);function IV(n){let e=-1;for(let t of n)e+=t.length+1;return e}function cf(n,e,t=0,r=1e9){for(let i=0,s=0,o=!0;s<n.length&&i<=r;s++){let l=n[s],a=i+l.length;a>=t&&(a>r&&(l=l.slice(0,r-i)),i<t&&(l=l.slice(t-i)),o?(e[e.length-1]+=l,o=!1):e.push(l)),i=a+1}return e}function Yx(n,e,t){return cf(n,[""],e,t)}class ou{constructor(e,t=1){this.dir=t,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[t>0?1:(e instanceof rt?e.text.length:e.children.length)<<1]}nextInner(e,t){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,i=this.nodes[r],s=this.offsets[r],o=s>>1,l=i instanceof rt?i.text.length:i.children.length;if(o==(t>0?l:0)){if(r==0)return this.done=!0,this.value="",this;t>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(t>0?0:1)){if(this.offsets[r]+=t,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof rt){let a=i.text[o+(t<0?-1:0)];if(this.offsets[r]+=t,a.length>Math.max(0,e))return this.value=e==0?a:t>0?a.slice(e):a.slice(0,a.length-e),this;e-=a.length}else{let a=i.children[o+(t<0?-1:0)];e>a.length?(e-=a.length,this.offsets[r]+=t):(t<0&&this.offsets[r]--,this.nodes.push(a),this.offsets.push(t>0?1:(a instanceof rt?a.text.length:a.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class uA{constructor(e,t,r){this.value="",this.done=!1,this.cursor=new ou(e,t>r?-1:1),this.pos=t>r?e.length:0,this.from=Math.min(t,r),this.to=Math.max(t,r)}nextInner(e,t){if(t<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,t<0?this.pos-this.to:this.from-this.pos);let r=t<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*t,this.value=i.length<=r?i:t<0?i.slice(i.length-r):i.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class cA{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:t,lineBreak:r,value:i}=this.inner.next(e);return t&&this.afterBreak?(this.value="",this.afterBreak=!1):t?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Se.prototype[Symbol.iterator]=function(){return this.iter()},ou.prototype[Symbol.iterator]=uA.prototype[Symbol.iterator]=cA.prototype[Symbol.iterator]=function(){return this});class PV{constructor(e,t,r,i){this.from=e,this.to=t,this.number=r,this.text=i}get length(){return this.to-this.from}}function Tl(n,e,t){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,t))]}function Dt(n,e,t=!0,r=!0){return CV(n,e,t,r)}function RV(n){return n>=56320&&n<57344}function DV(n){return n>=55296&&n<56320}function hn(n,e){let t=n.charCodeAt(e);if(!DV(t)||e+1==n.length)return t;let r=n.charCodeAt(e+1);return RV(r)?(t-55296<<10)+(r-56320)+65536:t}function l1(n){return n<=65535?String.fromCharCode(n):(n-=65536,String.fromCharCode((n>>10)+55296,(n&1023)+56320))}function kr(n){return n<65536?1:2}const My=/\r\n?|\n/;var Zt=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(Zt||(Zt={}));class Or{constructor(e){this.sections=e}get length(){let e=0;for(let t=0;t<this.sections.length;t+=2)e+=this.sections[t];return e}get newLength(){let e=0;for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t+1];e+=r<0?this.sections[t]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let t=0,r=0,i=0;t<this.sections.length;){let s=this.sections[t++],o=this.sections[t++];o<0?(e(r,i,s),i+=s):i+=o,r+=s}}iterChangedRanges(e,t=!1){Ny(this,e,t)}get invertedDesc(){let e=[];for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];i<0?e.push(r,i):e.push(i,r)}return new Or(e)}composeDesc(e){return this.empty?e:e.empty?this:hA(this,e)}mapDesc(e,t=!1){return e.empty?this:Vy(this,e,t)}mapPos(e,t=-1,r=Zt.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let l=this.sections[o++],a=this.sections[o++],u=i+l;if(a<0){if(u>e)return s+(e-i);s+=l}else{if(r!=Zt.Simple&&u>=e&&(r==Zt.TrackDel&&i<e&&u>e||r==Zt.TrackBefore&&i<e||r==Zt.TrackAfter&&u>e))return null;if(u>e||u==e&&t<0&&!l)return e==i||t<0?s:s+a;s+=a}i=u}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,t=e){for(let r=0,i=0;r<this.sections.length&&i<=t;){let s=this.sections[r++],o=this.sections[r++],l=i+s;if(o>=0&&i<=t&&l>=e)return i<e&&l>t?"cover":!0;i=l}return!1}toString(){let e="";for(let t=0;t<this.sections.length;){let r=this.sections[t++],i=this.sections[t++];e+=(e?" ":"")+r+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(t=>typeof t!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Or(e)}static create(e){return new Or(e)}}class pt extends Or{constructor(e,t){super(e),this.inserted=t}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Ny(this,(t,r,i,s,o)=>e=e.replace(i,i+(r-t),o),!1),e}mapDesc(e,t=!1){return Vy(this,e,t,!0)}invert(e){let t=this.sections.slice(),r=[];for(let i=0,s=0;i<t.length;i+=2){let o=t[i],l=t[i+1];if(l>=0){t[i]=l,t[i+1]=o;let a=i>>1;for(;r.length<a;)r.push(Se.empty);r.push(o?e.slice(s,s+o):Se.empty)}s+=o}return new pt(t,r)}compose(e){return this.empty?e:e.empty?this:hA(this,e,!0)}map(e,t=!1){return e.empty?this:Vy(this,e,t,!0)}iterChanges(e,t=!1){Ny(this,e,t)}get desc(){return Or.create(this.sections)}filter(e){let t=[],r=[],i=[],s=new Bu(this);e:for(let o=0,l=0;;){let a=o==e.length?1e9:e[o++];for(;l<a||l==a&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,a-l);jt(i,c,-1);let f=s.ins==-1?-1:s.off==0?s.ins:0;jt(t,c,f),f>0&&Di(r,t,s.text),s.forward(c),l+=c}let u=e[o++];for(;l<u;){if(s.done)break e;let c=Math.min(s.len,u-l);jt(t,c,-1),jt(i,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),l+=c}}return{changes:new pt(t,r),filtered:Or.create(i)}}toJSON(){let e=[];for(let t=0;t<this.sections.length;t+=2){let r=this.sections[t],i=this.sections[t+1];i<0?e.push(r):i==0?e.push([r]):e.push([r].concat(this.inserted[t>>1].toJSON()))}return e}static of(e,t,r){let i=[],s=[],o=0,l=null;function a(c=!1){if(!c&&!i.length)return;o<t&&jt(i,t-o,-1);let f=new pt(i,s);l=l?l.compose(f.map(l)):f,i=[],s=[],o=0}function u(c){if(Array.isArray(c))for(let f of c)u(f);else if(c instanceof pt){if(c.length!=t)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${t})`);a(),l=l?l.compose(c.map(l)):c}else{let{from:f,to:d=f,insert:p}=c;if(f>d||f<0||d>t)throw new RangeError(`Invalid change range ${f} to ${d} (in doc of length ${t})`);let y=p?typeof p=="string"?Se.of(p.split(r||My)):p:Se.empty,v=y.length;if(f==d&&v==0)return;f<o&&a(),f>o&&jt(i,f-o,-1),jt(i,d-f,v),Di(s,i,y),o=d}}return u(e),a(!l),l}static empty(e){return new pt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let t=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")t.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,l)=>l&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)t.push(s[0],0);else{for(;r.length<i;)r.push(Se.empty);r[i]=Se.of(s.slice(1)),t.push(s[0],r[i].length)}}}return new pt(t,r)}static createSet(e,t){return new pt(e,t)}}function jt(n,e,t,r=!1){if(e==0&&t<=0)return;let i=n.length-2;i>=0&&t<=0&&t==n[i+1]?n[i]+=e:i>=0&&e==0&&n[i]==0?n[i+1]+=t:r?(n[i]+=e,n[i+1]+=t):n.push(e,t)}function Di(n,e,t){if(t.length==0)return;let r=e.length-2>>1;if(r<n.length)n[n.length-1]=n[n.length-1].append(t);else{for(;n.length<r;)n.push(Se.empty);n.push(t)}}function Ny(n,e,t){let r=n.inserted;for(let i=0,s=0,o=0;o<n.sections.length;){let l=n.sections[o++],a=n.sections[o++];if(a<0)i+=l,s+=l;else{let u=i,c=s,f=Se.empty;for(;u+=l,c+=a,a&&r&&(f=f.append(r[o-2>>1])),!(t||o==n.sections.length||n.sections[o+1]<0);)l=n.sections[o++],a=n.sections[o++];e(i,u,s,c,f),i=u,s=c}}}function Vy(n,e,t,r=!1){let i=[],s=r?[]:null,o=new Bu(n),l=new Bu(e);for(let a=-1;;){if(o.done&&l.len||l.done&&o.len)throw new Error("Mismatched change set lengths");if(o.ins==-1&&l.ins==-1){let u=Math.min(o.len,l.len);jt(i,u,-1),o.forward(u),l.forward(u)}else if(l.ins>=0&&(o.ins<0||a==o.i||o.off==0&&(l.len<o.len||l.len==o.len&&!t))){let u=l.len;for(jt(i,l.ins,-1);u;){let c=Math.min(o.len,u);o.ins>=0&&a<o.i&&o.len<=c&&(jt(i,0,o.ins),s&&Di(s,i,o.text),a=o.i),o.forward(c),u-=c}l.next()}else if(o.ins>=0){let u=0,c=o.len;for(;c;)if(l.ins==-1){let f=Math.min(c,l.len);u+=f,c-=f,l.forward(f)}else if(l.ins==0&&l.len<c)c-=l.len,l.next();else break;jt(i,u,a<o.i?o.ins:0),s&&a<o.i&&Di(s,i,o.text),a=o.i,o.forward(o.len-c)}else{if(o.done&&l.done)return s?pt.createSet(i,s):Or.create(i);throw new Error("Mismatched change set lengths")}}}function hA(n,e,t=!1){let r=[],i=t?[]:null,s=new Bu(n),o=new Bu(e);for(let l=!1;;){if(s.done&&o.done)return i?pt.createSet(r,i):Or.create(r);if(s.ins==0)jt(r,s.len,0,l),s.next();else if(o.len==0&&!o.done)jt(r,0,o.ins,l),i&&Di(i,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let a=Math.min(s.len2,o.len),u=r.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;jt(r,a,c,l),i&&c&&Di(i,r,o.text)}else o.ins==-1?(jt(r,s.off?0:s.len,a,l),i&&Di(i,r,s.textBit(a))):(jt(r,s.off?0:s.len,o.off?0:o.ins,l),i&&!o.off&&Di(i,r,o.text));l=(s.ins>a||o.ins>=0&&o.len>a)&&(l||r.length>u),s.forward2(a),o.forward(a)}}}}class Bu{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,t=this.i-2>>1;return t>=e.length?Se.empty:e[t]}textBit(e){let{inserted:t}=this.set,r=this.i-2>>1;return r>=t.length&&!e?Se.empty:t[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Bs{constructor(e,t,r){this.from=e,this.to=t,this.flags=r}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,t=-1){let r,i;return this.empty?r=i=e.mapPos(this.from,t):(r=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new Bs(r,i,this.flags)}extend(e,t=e){if(e<=this.anchor&&t>=this.anchor)return B.range(e,t);let r=Math.abs(e-this.anchor)>Math.abs(t-this.anchor)?e:t;return B.range(this.anchor,r)}eq(e,t=!1){return this.anchor==e.anchor&&this.head==e.head&&(!t||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return B.range(e.anchor,e.head)}static create(e,t,r){return new Bs(e,t,r)}}class B{constructor(e,t){this.ranges=e,this.mainIndex=t}map(e,t=-1){return e.empty?this:B.create(this.ranges.map(r=>r.map(e,t)),this.mainIndex)}eq(e,t=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let r=0;r<this.ranges.length;r++)if(!this.ranges[r].eq(e.ranges[r],t))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new B([this.main],0)}addRange(e,t=!0){return B.create([e].concat(this.ranges),t?0:this.mainIndex+1)}replaceRange(e,t=this.mainIndex){let r=this.ranges.slice();return r[t]=e,B.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new B(e.ranges.map(t=>Bs.fromJSON(t)),e.main)}static single(e,t=e){return new B([B.range(e,t)],0)}static create(e,t=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=r:s.from<r)return B.normalized(e.slice(),t);r=s.to}return new B(e,t)}static cursor(e,t=0,r,i){return Bs.create(e,e,(t==0?0:t<0?8:16)|(r==null?7:Math.min(6,r))|(i??16777215)<<6)}static range(e,t,r,i){let s=(r??16777215)<<6|(i==null?7:Math.min(6,i));return t<e?Bs.create(t,e,48|s):Bs.create(e,t,(t>e?8:0)|s)}static normalized(e,t=0){let r=e[t];e.sort((i,s)=>i.from-s.from),t=e.indexOf(r);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let l=o.from,a=Math.max(s.to,o.to);i<=t&&t--,e.splice(--i,2,s.anchor>s.head?B.range(a,l):B.range(l,a))}}return new B(e,t)}}function fA(n,e){for(let t of n.ranges)if(t.to>e)throw new RangeError("Selection points outside of document")}let a1=0;class G{constructor(e,t,r,i,s){this.combine=e,this.compareInput=t,this.compare=r,this.isStatic=i,this.id=a1++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}get reader(){return this}static define(e={}){return new G(e.combine||(t=>t),e.compareInput||((t,r)=>t===r),e.compare||(e.combine?(t,r)=>t===r:u1),!!e.static,e.enables)}of(e){return new hf([],this,0,e)}compute(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new hf(e,this,1,t)}computeN(e,t){if(this.isStatic)throw new Error("Can't compute a static facet");return new hf(e,this,2,t)}from(e,t){return t||(t=r=>r),this.compute([e],r=>t(r.field(e)))}}function u1(n,e){return n==e||n.length==e.length&&n.every((t,r)=>t===e[r])}class hf{constructor(e,t,r,i){this.dependencies=e,this.facet=t,this.type=r,this.value=i,this.id=a1++}dynamicSlot(e){var t;let r=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,l=this.type==2,a=!1,u=!1,c=[];for(let f of this.dependencies)f=="doc"?a=!0:f=="selection"?u=!0:((t=e[f.id])!==null&&t!==void 0?t:1)&1||c.push(e[f.id]);return{create(f){return f.values[o]=r(f),1},update(f,d){if(a&&d.docChanged||u&&(d.docChanged||d.selection)||Ly(f,c)){let p=r(f);if(l?!Xx(p,f.values[o],i):!i(p,f.values[o]))return f.values[o]=p,1}return 0},reconfigure:(f,d)=>{let p,y=d.config.address[s];if(y!=null){let v=ad(d,y);if(this.dependencies.every(E=>E instanceof G?d.facet(E)===f.facet(E):E instanceof Vt?d.field(E,!1)==f.field(E,!1):!0)||(l?Xx(p=r(f),v,i):i(p=r(f),v)))return f.values[o]=v,0}else p=r(f);return f.values[o]=p,1}}}}function Xx(n,e,t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!t(n[r],e[r]))return!1;return!0}function Ly(n,e){let t=!1;for(let r of e)lu(n,r)&1&&(t=!0);return t}function OV(n,e,t){let r=t.map(a=>n[a.id]),i=t.map(a=>a.type),s=r.filter(a=>!(a&1)),o=n[e.id]>>1;function l(a){let u=[];for(let c=0;c<r.length;c++){let f=ad(a,r[c]);if(i[c]==2)for(let d of f)u.push(d);else u.push(f)}return e.combine(u)}return{create(a){for(let u of r)lu(a,u);return a.values[o]=l(a),1},update(a,u){if(!Ly(a,s))return 0;let c=l(a);return e.compare(c,a.values[o])?0:(a.values[o]=c,1)},reconfigure(a,u){let c=Ly(a,r),f=u.config.facets[e.id],d=u.facet(e);if(f&&!c&&u1(t,f))return a.values[o]=d,0;let p=l(a);return e.compare(p,d)?(a.values[o]=d,0):(a.values[o]=p,1)}}}const ph=G.define({static:!0});class Vt{constructor(e,t,r,i,s){this.id=e,this.createF=t,this.updateF=r,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let t=new Vt(a1++,e.create,e.update,e.compare||((r,i)=>r===i),e);return e.provide&&(t.provides=e.provide(t)),t}create(e){let t=e.facet(ph).find(r=>r.field==this);return((t==null?void 0:t.create)||this.createF)(e)}slot(e){let t=e[this.id]>>1;return{create:r=>(r.values[t]=this.create(r),1),update:(r,i)=>{let s=r.values[t],o=this.updateF(s,i);return this.compareF(s,o)?0:(r.values[t]=o,1)},reconfigure:(r,i)=>{let s=r.facet(ph),o=i.facet(ph),l;return(l=s.find(a=>a.field==this))&&l!=o.find(a=>a.field==this)?(r.values[t]=l.create(r),1):i.config.address[this.id]!=null?(r.values[t]=i.field(this),0):(r.values[t]=this.create(r),1)}}}init(e){return[this,ph.of({field:this,create:e})]}get extension(){return this}}const As={lowest:4,low:3,default:2,high:1,highest:0};function ba(n){return e=>new dA(e,n)}const mo={highest:ba(As.highest),high:ba(As.high),default:ba(As.default),low:ba(As.low),lowest:ba(As.lowest)};class dA{constructor(e,t){this.inner=e,this.prec=t}}class _p{of(e){return new By(this,e)}reconfigure(e){return _p.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class By{constructor(e,t){this.compartment=e,this.inner=t}}class ld{constructor(e,t,r,i,s,o){for(this.base=e,this.compartments=t,this.dynamicSlots=r,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let t=this.address[e.id];return t==null?e.default:this.staticValues[t>>1]}static resolve(e,t,r){let i=[],s=Object.create(null),o=new Map;for(let d of MV(e,t,o))d instanceof Vt?i.push(d):(s[d.facet.id]||(s[d.facet.id]=[])).push(d);let l=Object.create(null),a=[],u=[];for(let d of i)l[d.id]=u.length<<1,u.push(p=>d.slot(p));let c=r==null?void 0:r.config.facets;for(let d in s){let p=s[d],y=p[0].facet,v=c&&c[d]||[];if(p.every(E=>E.type==0))if(l[y.id]=a.length<<1|1,u1(v,p))a.push(r.facet(y));else{let E=y.combine(p.map(w=>w.value));a.push(r&&y.compare(E,r.facet(y))?r.facet(y):E)}else{for(let E of p)E.type==0?(l[E.id]=a.length<<1|1,a.push(E.value)):(l[E.id]=u.length<<1,u.push(w=>E.dynamicSlot(w)));l[y.id]=u.length<<1,u.push(E=>OV(E,y,p))}}let f=u.map(d=>d(l));return new ld(e,o,f,l,a,s)}}function MV(n,e,t){let r=[[],[],[],[],[]],i=new Map;function s(o,l){let a=i.get(o);if(a!=null){if(a<=l)return;let u=r[a].indexOf(o);u>-1&&r[a].splice(u,1),o instanceof By&&t.delete(o.compartment)}if(i.set(o,l),Array.isArray(o))for(let u of o)s(u,l);else if(o instanceof By){if(t.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;t.set(o.compartment,u),s(u,l)}else if(o instanceof dA)s(o.inner,o.prec);else if(o instanceof Vt)r[l].push(o),o.provides&&s(o.provides,l);else if(o instanceof hf)r[l].push(o),o.facet.extensions&&s(o.facet.extensions,As.default);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,l)}}return s(n,As.default),r.reduce((o,l)=>o.concat(l))}function lu(n,e){if(e&1)return 2;let t=e>>1,r=n.status[t];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;n.status[t]=4;let i=n.computeSlot(n,n.config.dynamicSlots[t]);return n.status[t]=2|i}function ad(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const pA=G.define(),Fy=G.define({combine:n=>n.some(e=>e),static:!0}),mA=G.define({combine:n=>n.length?n[0]:void 0,static:!0}),gA=G.define(),yA=G.define(),vA=G.define(),wA=G.define({combine:n=>n.length?n[0]:!1});class Vr{constructor(e,t){this.type=e,this.value=t}static define(){return new NV}}class NV{of(e){return new Vr(this,e)}}class VV{constructor(e){this.map=e}of(e){return new ue(this,e)}}class ue{constructor(e,t){this.type=e,this.value=t}map(e){let t=this.type.map(this.value,e);return t===void 0?void 0:t==this.value?this:new ue(this.type,t)}is(e){return this.type==e}static define(e={}){return new VV(e.map||(t=>t))}static mapEffects(e,t){if(!e.length)return e;let r=[];for(let i of e){let s=i.map(t);s&&r.push(s)}return r}}ue.reconfigure=ue.define();ue.appendConfig=ue.define();class gt{constructor(e,t,r,i,s,o){this.startState=e,this.changes=t,this.selection=r,this.effects=i,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&fA(r,t.newLength),s.some(l=>l.type==gt.time)||(this.annotations=s.concat(gt.time.of(Date.now())))}static create(e,t,r,i,s,o){return new gt(e,t,r,i,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let t of this.annotations)if(t.type==e)return t.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let t=this.annotation(gt.userEvent);return!!(t&&(t==e||t.length>e.length&&t.slice(0,e.length)==e&&t[e.length]=="."))}}gt.time=Vr.define();gt.userEvent=Vr.define();gt.addToHistory=Vr.define();gt.remote=Vr.define();function LV(n,e){let t=[];for(let r=0,i=0;;){let s,o;if(r<n.length&&(i==e.length||e[i]>=n[r]))s=n[r++],o=n[r++];else if(i<e.length)s=e[i++],o=e[i++];else return t;!t.length||t[t.length-1]<s?t.push(s,o):t[t.length-1]<o&&(t[t.length-1]=o)}}function _A(n,e,t){var r;let i,s,o;return t?(i=e.changes,s=pt.empty(e.changes.length),o=n.changes.compose(e.changes)):(i=e.changes.map(n.changes),s=n.changes.mapDesc(e.changes,!0),o=n.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):(r=n.selection)===null||r===void 0?void 0:r.map(i),effects:ue.mapEffects(n.effects,i).concat(ue.mapEffects(e.effects,s)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function zy(n,e,t){let r=e.selection,i=ol(e.annotations);return e.userEvent&&(i=i.concat(gt.userEvent.of(e.userEvent))),{changes:e.changes instanceof pt?e.changes:pt.of(e.changes||[],t,n.facet(mA)),selection:r&&(r instanceof B?r:B.single(r.anchor,r.head)),effects:ol(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function xA(n,e,t){let r=zy(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(t=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(t=!1);let o=!!e[s].sequential;r=_A(r,zy(n,e[s],o?r.changes.newLength:n.doc.length),o)}let i=gt.create(n,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return FV(t?BV(i):i)}function BV(n){let e=n.startState,t=!0;for(let i of e.facet(gA)){let s=i(n);if(s===!1){t=!1;break}Array.isArray(s)&&(t=t===!0?s:LV(t,s))}if(t!==!0){let i,s;if(t===!1)s=n.changes.invertedDesc,i=pt.empty(e.doc.length);else{let o=n.changes.filter(t);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}n=gt.create(e,i,n.selection&&n.selection.map(s),ue.mapEffects(n.effects,s),n.annotations,n.scrollIntoView)}let r=e.facet(yA);for(let i=r.length-1;i>=0;i--){let s=r[i](n);s instanceof gt?n=s:Array.isArray(s)&&s.length==1&&s[0]instanceof gt?n=s[0]:n=xA(e,ol(s),!1)}return n}function FV(n){let e=n.startState,t=e.facet(vA),r=n;for(let i=t.length-1;i>=0;i--){let s=t[i](n);s&&Object.keys(s).length&&(r=_A(r,zy(e,s,n.changes.newLength),!0))}return r==n?n:gt.create(e,n.changes,n.selection,r.effects,r.annotations,r.scrollIntoView)}const zV=[];function ol(n){return n==null?zV:Array.isArray(n)?n:[n]}var We=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(We||(We={}));const $V=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let $y;try{$y=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function UV(n){if($y)return $y.test(n);for(let e=0;e<n.length;e++){let t=n[e];if(/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||$V.test(t)))return!0}return!1}function jV(n){return e=>{if(!/\S/.test(e))return We.Space;if(UV(e))return We.Word;for(let t=0;t<n.length;t++)if(e.indexOf(n[t])>-1)return We.Word;return We.Other}}class ye{constructor(e,t,r,i,s,o){this.config=e,this.doc=t,this.selection=r,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let l=0;l<this.config.dynamicSlots.length;l++)lu(this,l<<1);this.computeSlot=null}field(e,t=!0){let r=this.config.address[e.id];if(r==null){if(t)throw new RangeError("Field is not present in this state");return}return lu(this,r),ad(this,r)}update(...e){return xA(this,e,!0)}applyTransaction(e){let t=this.config,{base:r,compartments:i}=t;for(let l of e.effects)l.is(_p.reconfigure)?(t&&(i=new Map,t.compartments.forEach((a,u)=>i.set(u,a)),t=null),i.set(l.value.compartment,l.value.extension)):l.is(ue.reconfigure)?(t=null,r=l.value):l.is(ue.appendConfig)&&(t=null,r=ol(r).concat(l.value));let s;t?s=e.startState.values.slice():(t=ld.resolve(r,i,this),s=new ye(t,this.doc,this.selection,t.dynamicSlots.map(()=>null),(a,u)=>u.reconfigure(a,this),null).values);let o=e.startState.facet(Fy)?e.newSelection:e.newSelection.asSingle();new ye(t,e.newDoc,o,s,(l,a)=>a.update(l,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(t=>({changes:{from:t.from,to:t.to,insert:e},range:B.cursor(t.from+e.length)}))}changeByRange(e){let t=this.selection,r=e(t.ranges[0]),i=this.changes(r.changes),s=[r.range],o=ol(r.effects);for(let l=1;l<t.ranges.length;l++){let a=e(t.ranges[l]),u=this.changes(a.changes),c=u.map(i);for(let d=0;d<l;d++)s[d]=s[d].map(c);let f=i.mapDesc(u,!0);s.push(a.range.map(f)),i=i.compose(c),o=ue.mapEffects(o,c).concat(ue.mapEffects(ol(a.effects),f))}return{changes:i,selection:B.create(s,t.mainIndex),effects:o}}changes(e=[]){return e instanceof pt?e:pt.of(e,this.doc.length,this.facet(ye.lineSeparator))}toText(e){return Se.of(e.split(this.facet(ye.lineSeparator)||My))}sliceDoc(e=0,t=this.doc.length){return this.doc.sliceString(e,t,this.lineBreak)}facet(e){let t=this.config.address[e.id];return t==null?e.default:(lu(this,t),ad(this,t))}toJSON(e){let t={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let i=e[r];i instanceof Vt&&this.config.address[i.id]!=null&&(t[r]=i.spec.toJSON(this.field(e[r]),this))}return t}static fromJSON(e,t={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],l=e[s];i.push(o.init(a=>o.spec.fromJSON(l,a)))}}return ye.create({doc:e.doc,selection:B.fromJSON(e.selection),extensions:t.extensions?i.concat([t.extensions]):i})}static create(e={}){let t=ld.resolve(e.extensions||[],new Map),r=e.doc instanceof Se?e.doc:Se.of((e.doc||"").split(t.staticFacet(ye.lineSeparator)||My)),i=e.selection?e.selection instanceof B?e.selection:B.single(e.selection.anchor,e.selection.head):B.single(0);return fA(i,r.length),t.staticFacet(Fy)||(i=i.asSingle()),new ye(t,r,i,t.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(ye.tabSize)}get lineBreak(){return this.facet(ye.lineSeparator)||`
`}get readOnly(){return this.facet(wA)}phrase(e,...t){for(let r of this.facet(ye.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return t.length&&(e=e.replace(/\$(\$|\d*)/g,(r,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>t.length?r:t[s-1]})),e}languageDataAt(e,t,r=-1){let i=[];for(let s of this.facet(pA))for(let o of s(this,t,r))Object.prototype.hasOwnProperty.call(o,e)&&i.push(o[e]);return i}charCategorizer(e){return jV(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:t,from:r,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,l=e-r;for(;o>0;){let a=Dt(t,o,!1);if(s(t.slice(a,o))!=We.Word)break;o=a}for(;l<i;){let a=Dt(t,l);if(s(t.slice(l,a))!=We.Word)break;l=a}return o==l?null:B.range(o+r,l+r)}}ye.allowMultipleSelections=Fy;ye.tabSize=G.define({combine:n=>n.length?n[0]:4});ye.lineSeparator=mA;ye.readOnly=wA;ye.phrases=G.define({compare(n,e){let t=Object.keys(n),r=Object.keys(e);return t.length==r.length&&t.every(i=>n[i]==e[i])}});ye.languageData=pA;ye.changeFilter=gA;ye.transactionFilter=yA;ye.transactionExtender=vA;_p.reconfigure=ue.define();function Lr(n,e,t={}){let r={};for(let i of n)for(let s of Object.keys(i)){let o=i[s],l=r[s];if(l===void 0)r[s]=o;else if(!(l===o||o===void 0))if(Object.hasOwnProperty.call(t,s))r[s]=t[s](l,o);else throw new Error("Config merge conflict for field "+s)}for(let i in e)r[i]===void 0&&(r[i]=e[i]);return r}class Zs{eq(e){return this==e}range(e,t=e){return Uy.create(e,t,this)}}Zs.prototype.startSide=Zs.prototype.endSide=0;Zs.prototype.point=!1;Zs.prototype.mapMode=Zt.TrackDel;let Uy=class SA{constructor(e,t,r){this.from=e,this.to=t,this.value=r}static create(e,t,r){return new SA(e,t,r)}};function jy(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class c1{constructor(e,t,r,i){this.from=e,this.to=t,this.value=r,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,t,r,i=0){let s=r?this.to:this.from;for(let o=i,l=s.length;;){if(o==l)return o;let a=o+l>>1,u=s[a]-e||(r?this.value[a].endSide:this.value[a].startSide)-t;if(a==o)return u>=0?o:l;u>=0?l=a:o=a+1}}between(e,t,r,i){for(let s=this.findIndex(t,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,t){let r=[],i=[],s=[],o=-1,l=-1;for(let a=0;a<this.value.length;a++){let u=this.value[a],c=this.from[a]+e,f=this.to[a]+e,d,p;if(c==f){let y=t.mapPos(c,u.startSide,u.mapMode);if(y==null||(d=p=y,u.startSide!=u.endSide&&(p=t.mapPos(c,u.endSide),p<d)))continue}else if(d=t.mapPos(c,u.startSide),p=t.mapPos(f,u.endSide),d>p||d==p&&u.startSide>0&&u.endSide<=0)continue;(p-d||u.endSide-u.startSide)<0||(o<0&&(o=d),u.point&&(l=Math.max(l,p-d)),r.push(u),i.push(d-o),s.push(p-o))}return{mapped:r.length?new c1(i,s,r,l):null,pos:o}}}class xe{constructor(e,t,r,i){this.chunkPos=e,this.chunk=t,this.nextLayer=r,this.maxPoint=i}static create(e,t,r,i){return new xe(e,t,r,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let t of this.chunk)e+=t.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:t=[],sort:r=!1,filterFrom:i=0,filterTo:s=this.length}=e,o=e.filter;if(t.length==0&&!o)return this;if(r&&(t=t.slice().sort(jy)),this.isEmpty)return t.length?xe.of(t):this;let l=new bA(this,null,-1).goto(0),a=0,u=[],c=new si;for(;l.value||a<t.length;)if(a<t.length&&(l.from-t[a].from||l.startSide-t[a].value.startSide)>=0){let f=t[a++];c.addInner(f.from,f.to,f.value)||u.push(f)}else l.rangeIndex==1&&l.chunkIndex<this.chunk.length&&(a==t.length||this.chunkEnd(l.chunkIndex)<t[a].from)&&(!o||i>this.chunkEnd(l.chunkIndex)||s<this.chunkPos[l.chunkIndex])&&c.addChunk(this.chunkPos[l.chunkIndex],this.chunk[l.chunkIndex])?l.nextChunk():((!o||i>l.to||s<l.from||o(l.from,l.to,l.value))&&(c.addInner(l.from,l.to,l.value)||u.push(Uy.create(l.from,l.to,l.value))),l.next());return c.finishInner(this.nextLayer.isEmpty&&!u.length?xe.empty:this.nextLayer.update({add:u,filter:o,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let t=[],r=[],i=-1;for(let o=0;o<this.chunk.length;o++){let l=this.chunkPos[o],a=this.chunk[o],u=e.touchesRange(l,l+a.length);if(u===!1)i=Math.max(i,a.maxPoint),t.push(a),r.push(e.mapPos(l));else if(u===!0){let{mapped:c,pos:f}=a.map(l,e);c&&(i=Math.max(i,c.maxPoint),t.push(c),r.push(f))}}let s=this.nextLayer.map(e);return t.length==0?s:new xe(r,t,s||xe.empty,i)}between(e,t,r){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i];if(t>=s&&e<=s+o.length&&o.between(s,e-s,t-s,r)===!1)return}this.nextLayer.between(e,t,r)}}iter(e=0){return Fu.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,t=0){return Fu.from(e).goto(t)}static compare(e,t,r,i,s=-1){let o=e.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),l=t.filter(f=>f.maxPoint>0||!f.isEmpty&&f.maxPoint>=s),a=Jx(o,l,r),u=new ka(o,a,s),c=new ka(l,a,s);r.iterGaps((f,d,p)=>Zx(u,f,c,d,p,i)),r.empty&&r.length==0&&Zx(u,0,c,0,0,i)}static eq(e,t,r=0,i){i==null&&(i=999999999);let s=e.filter(c=>!c.isEmpty&&t.indexOf(c)<0),o=t.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let l=Jx(s,o),a=new ka(s,l,0).goto(r),u=new ka(o,l,0).goto(r);for(;;){if(a.to!=u.to||!Hy(a.active,u.active)||a.point&&(!u.point||!a.point.eq(u.point)))return!1;if(a.to>i)return!0;a.next(),u.next()}}static spans(e,t,r,i,s=-1){let o=new ka(e,null,s).goto(t),l=t,a=o.openStart;for(;;){let u=Math.min(o.to,r);if(o.point){let c=o.activeForPoint(o.to),f=o.pointFrom<t?c.length+1:o.point.startSide<0?c.length:Math.min(c.length,a);i.point(l,u,o.point,c,f,o.pointRank),a=Math.min(o.openEnd(u),c.length)}else u>l&&(i.span(l,u,o.active,a),a=o.openEnd(u));if(o.to>r)return a+(o.point&&o.to>r?1:0);l=o.to,o.next()}}static of(e,t=!1){let r=new si;for(let i of e instanceof Uy?[e]:t?HV(e):e)r.add(i.from,i.to,i.value);return r.finish()}static join(e){if(!e.length)return xe.empty;let t=e[e.length-1];for(let r=e.length-2;r>=0;r--)for(let i=e[r];i!=xe.empty;i=i.nextLayer)t=new xe(i.chunkPos,i.chunk,t,Math.max(i.maxPoint,t.maxPoint));return t}}xe.empty=new xe([],[],null,-1);function HV(n){if(n.length>1)for(let e=n[0],t=1;t<n.length;t++){let r=n[t];if(jy(e,r)>0)return n.slice().sort(jy);e=r}return n}xe.empty.nextLayer=xe.empty;class si{finishChunk(e){this.chunks.push(new c1(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,t,r){this.addInner(e,t,r)||(this.nextLayer||(this.nextLayer=new si)).add(e,t,r)}addInner(e,t,r){let i=e-this.lastTo||r.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(t-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=t,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,t-e)),!0)}addChunk(e,t){if((e-this.lastTo||t.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,t.maxPoint),this.chunks.push(t),this.chunkPos.push(e);let r=t.value.length-1;return this.last=t.value[r],this.lastFrom=t.from[r]+e,this.lastTo=t.to[r]+e,!0}finish(){return this.finishInner(xe.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let t=xe.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,t}}function Jx(n,e,t){let r=new Map;for(let s of n)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let l=r.get(s.chunk[o]);l!=null&&(t?t.mapPos(l):l)==s.chunkPos[o]&&!(t!=null&&t.touchesRange(l,l+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class bA{constructor(e,t,r,i=0){this.layer=e,this.skip=t,this.minPoint=r,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,t=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,t,!1),this}gotoInner(e,t,r){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],t,!0);(!r||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,t){(this.to-e||this.endSide-t)<0&&this.gotoInner(e,t,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],t=this.layer.chunk[this.chunkIndex],r=e+t.from[this.rangeIndex];if(this.from=r,this.to=e+t.to[this.rangeIndex],this.value=t.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Fu{constructor(e){this.heap=e}static from(e,t=null,r=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&i.push(new bA(o,t,r,s));return i.length==1?i[0]:new Fu(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,t=-1e9){for(let r of this.heap)r.goto(e,t);for(let r=this.heap.length>>1;r>=0;r--)Gm(this.heap,r);return this.next(),this}forward(e,t){for(let r of this.heap)r.forward(e,t);for(let r=this.heap.length>>1;r>=0;r--)Gm(this.heap,r);(this.to-e||this.value.endSide-t)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Gm(this.heap,0)}}}function Gm(n,e){for(let t=n[e];;){let r=(e<<1)+1;if(r>=n.length)break;let i=n[r];if(r+1<n.length&&i.compare(n[r+1])>=0&&(i=n[r+1],r++),t.compare(i)<0)break;n[r]=t,n[e]=i,e=r}}class ka{constructor(e,t,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Fu.from(e,t,r)}goto(e,t=-1e9){return this.cursor.goto(e,t),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=t,this.openStart=-1,this.next(),this}forward(e,t){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-t)<0;)this.removeActive(this.minActive);this.cursor.forward(e,t)}removeActive(e){mh(this.active,e),mh(this.activeTo,e),mh(this.activeRank,e),this.minActive=eS(this.active,this.activeTo)}addActive(e){let t=0,{value:r,to:i,rank:s}=this.cursor;for(;t<this.activeRank.length&&(s-this.activeRank[t]||i-this.activeTo[t])>0;)t++;gh(this.active,t,r),gh(this.activeTo,t,i),gh(this.activeRank,t,s),e&&gh(e,t,this.cursor.from),this.minActive=eS(this.active,this.activeTo)}next(){let e=this.to,t=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),r&&mh(r,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(r),this.cursor.next();else if(t&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let i=r.length-1;i>=0&&r[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let t=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&t.push(this.active[r]);return t.reverse()}openEnd(e){let t=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)t++;return t}}function Zx(n,e,t,r,i,s){n.goto(e),t.goto(r);let o=r+i,l=r,a=r-e;for(;;){let u=n.to+a-t.to,c=u||n.endSide-t.endSide,f=c<0?n.to+a:t.to,d=Math.min(f,o);if(n.point||t.point?n.point&&t.point&&(n.point==t.point||n.point.eq(t.point))&&Hy(n.activeForPoint(n.to),t.activeForPoint(t.to))||s.comparePoint(l,d,n.point,t.point):d>l&&!Hy(n.active,t.active)&&s.compareRange(l,d,n.active,t.active),f>o)break;(u||n.openEnd!=t.openEnd)&&s.boundChange&&s.boundChange(f),l=f,c<=0&&n.next(),c>=0&&t.next()}}function Hy(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!=e[t]&&!n[t].eq(e[t]))return!1;return!0}function mh(n,e){for(let t=e,r=n.length-1;t<r;t++)n[t]=n[t+1];n.pop()}function gh(n,e,t){for(let r=n.length-1;r>=e;r--)n[r+1]=n[r];n[e]=t}function eS(n,e){let t=-1,r=1e9;for(let i=0;i<e.length;i++)(e[i]-r||n[i].endSide-n[t].endSide)<0&&(t=i,r=e[i]);return t}function Kl(n,e,t=n.length){let r=0;for(let i=0;i<t&&i<n.length;)n.charCodeAt(i)==9?(r+=e-r%e,i++):(r++,i=Dt(n,i));return r}function Wy(n,e,t,r){for(let i=0,s=0;;){if(s>=e)return i;if(i==n.length)break;s+=n.charCodeAt(i)==9?t-s%t:1,i=Dt(n,i)}return r===!0?-1:n.length}const qy="",tS=typeof Symbol>"u"?"__"+qy:Symbol.for(qy),Ky=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),nS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Zi{constructor(e,t){this.rules=[];let{finish:r}=t||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,l,a,u){let c=[],f=/^@(\w+)\b/.exec(o[0]),d=f&&f[1]=="keyframes";if(f&&l==null)return a.push(o[0]+";");for(let p in l){let y=l[p];if(/&/.test(p))s(p.split(/,\s*/).map(v=>o.map(E=>v.replace(/&/,E))).reduce((v,E)=>v.concat(E)),y,a);else if(y&&typeof y=="object"){if(!f)throw new RangeError("The value of a property ("+p+") should be a primitive value.");s(i(p),y,c,d)}else y!=null&&c.push(p.replace(/_.*/,"").replace(/[A-Z]/g,v=>"-"+v.toLowerCase())+": "+y+";")}(c.length||d)&&a.push((r&&!f&&!u?o.map(r):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=nS[tS]||1;return nS[tS]=e+1,qy+e.toString(36)}static mount(e,t,r){let i=e[Ky],s=r&&r.nonce;i?s&&i.setNonce(s):i=new WV(e,s),i.mount(Array.isArray(t)?t:[t],e)}}let rS=new Map;class WV{constructor(e,t){let r=e.ownerDocument||e,i=r.defaultView;if(!e.head&&e.adoptedStyleSheets&&i.CSSStyleSheet){let s=rS.get(r);if(s)return e[Ky]=s;this.sheet=new i.CSSStyleSheet,rS.set(r,this)}else this.styleTag=r.createElement("style"),t&&this.styleTag.setAttribute("nonce",t);this.modules=[],e[Ky]=this}mount(e,t){let r=this.sheet,i=0,s=0;for(let o=0;o<e.length;o++){let l=e[o],a=this.modules.indexOf(l);if(a<s&&a>-1&&(this.modules.splice(a,1),s--,a=-1),a==-1){if(this.modules.splice(s++,0,l),r)for(let u=0;u<l.rules.length;u++)r.insertRule(l.rules[u],i++)}else{for(;s<a;)i+=this.modules[s++].rules.length;i+=l.rules.length,s++}}if(r)t.adoptedStyleSheets.indexOf(this.sheet)<0&&(t.adoptedStyleSheets=[this.sheet,...t.adoptedStyleSheets]);else{let o="";for(let a=0;a<this.modules.length;a++)o+=this.modules[a].getRules()+`
`;this.styleTag.textContent=o;let l=t.head||t;this.styleTag.parentNode!=l&&l.insertBefore(this.styleTag,l.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var es={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},zu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},qV=typeof navigator<"u"&&/Mac/.test(navigator.platform),KV=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Rt=0;Rt<10;Rt++)es[48+Rt]=es[96+Rt]=String(Rt);for(var Rt=1;Rt<=24;Rt++)es[Rt+111]="F"+Rt;for(var Rt=65;Rt<=90;Rt++)es[Rt]=String.fromCharCode(Rt+32),zu[Rt]=String.fromCharCode(Rt);for(var Ym in es)zu.hasOwnProperty(Ym)||(zu[Ym]=es[Ym]);function QV(n){var e=qV&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||KV&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?zu:es)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function $u(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function Qy(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function ff(n,e){if(!e.anchorNode)return!1;try{return Qy(n,e.anchorNode)}catch{return!1}}function Cl(n){return n.nodeType==3?to(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function au(n,e,t,r){return t?iS(n,e,t,r,-1)||iS(n,e,t,r,1):!1}function eo(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function ud(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}function iS(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:Mr(n))){if(n.nodeName=="DIV")return!1;let s=n.parentNode;if(!s||s.nodeType!=1)return!1;e=eo(n)+(i<0?0:1),n=s}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=i<0?Mr(n):0}else return!1}}function Mr(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function wc(n,e){let t=e?n.left:n.right;return{left:t,right:t,top:n.top,bottom:n.bottom}}function GV(n){let e=n.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function kA(n,e){let t=e.width/n.offsetWidth,r=e.height/n.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-n.offsetWidth)<1)&&(t=1),(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.height-n.offsetHeight)<1)&&(r=1),{scaleX:t,scaleY:r}}function YV(n,e,t,r,i,s,o,l){let a=n.ownerDocument,u=a.defaultView||window;for(let c=n,f=!1;c&&!f;)if(c.nodeType==1){let d,p=c==a.body,y=1,v=1;if(p)d=GV(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(f=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let _=c.getBoundingClientRect();({scaleX:y,scaleY:v}=kA(c,_)),d={left:_.left,right:_.left+c.clientWidth*y,top:_.top,bottom:_.top+c.clientHeight*v}}let E=0,w=0;if(i=="nearest")e.top<d.top?(w=e.top-(d.top+o),t>0&&e.bottom>d.bottom+w&&(w=e.bottom-d.bottom+o)):e.bottom>d.bottom&&(w=e.bottom-d.bottom+o,t<0&&e.top-w<d.top&&(w=e.top-(d.top+o)));else{let _=e.bottom-e.top,b=d.bottom-d.top;w=(i=="center"&&_<=b?e.top+_/2-b/2:i=="start"||i=="center"&&t<0?e.top-o:e.bottom-b+o)-d.top}if(r=="nearest"?e.left<d.left?(E=e.left-(d.left+s),t>0&&e.right>d.right+E&&(E=e.right-d.right+s)):e.right>d.right&&(E=e.right-d.right+s,t<0&&e.left<d.left+E&&(E=e.left-(d.left+s))):E=(r=="center"?e.left+(e.right-e.left)/2-(d.right-d.left)/2:r=="start"==l?e.left-s:e.right-(d.right-d.left)+s)-d.left,E||w)if(p)u.scrollBy(E,w);else{let _=0,b=0;if(w){let I=c.scrollTop;c.scrollTop+=w/v,b=(c.scrollTop-I)*v}if(E){let I=c.scrollLeft;c.scrollLeft+=E/y,_=(c.scrollLeft-I)*y}e={left:e.left-_,top:e.top-b,right:e.right-_,bottom:e.bottom-b},_&&Math.abs(_-E)<1&&(r="nearest"),b&&Math.abs(b-w)<1&&(i="nearest")}if(p)break;(e.top<d.top||e.bottom>d.bottom||e.left<d.left||e.right>d.right)&&(e={left:Math.max(e.left,d.left),right:Math.min(e.right,d.right),top:Math.max(e.top,d.top),bottom:Math.min(e.bottom,d.bottom)}),c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function XV(n){let e=n.ownerDocument,t,r;for(let i=n.parentNode;i&&!(i==e.body||t&&r);)if(i.nodeType==1)!r&&i.scrollHeight>i.clientHeight&&(r=i),!t&&i.scrollWidth>i.clientWidth&&(t=i),i=i.assignedSlot||i.parentNode;else if(i.nodeType==11)i=i.host;else break;return{x:t,y:r}}class JV{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:r}=e;this.set(t,Math.min(e.anchorOffset,t?Mr(t):0),r,Math.min(e.focusOffset,r?Mr(r):0))}set(e,t,r,i){this.anchorNode=e,this.anchorOffset=t,this.focusNode=r,this.focusOffset=i}}let Eo=null;function EA(n){if(n.setActive)return n.setActive();if(Eo)return n.focus(Eo);let e=[];for(let t=n;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(n.focus(Eo==null?{get preventScroll(){return Eo={preventScroll:!0},!0}}:void 0),!Eo){Eo=!1;for(let t=0;t<e.length;){let r=e[t++],i=e[t++],s=e[t++];r.scrollTop!=i&&(r.scrollTop=i),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let sS;function to(n,e,t=e){let r=sS||(sS=document.createRange());return r.setEnd(n,t),r.setStart(n,e),r}function ll(n,e,t,r){let i={key:e,code:e,keyCode:t,which:t,cancelable:!0};r&&({altKey:i.altKey,ctrlKey:i.ctrlKey,shiftKey:i.shiftKey,metaKey:i.metaKey}=r);let s=new KeyboardEvent("keydown",i);s.synthetic=!0,n.dispatchEvent(s);let o=new KeyboardEvent("keyup",i);return o.synthetic=!0,n.dispatchEvent(o),s.defaultPrevented||o.defaultPrevented}function ZV(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function TA(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function eL(n,e){let t=e.focusNode,r=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=r)return!1;for(r=Math.min(r,Mr(t));;)if(r){if(t.nodeType!=1)return!1;let i=t.childNodes[r-1];i.contentEditable=="false"?r--:(t=i,r=Mr(t))}else{if(t==n)return!0;r=eo(t),t=t.parentNode}}function CA(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}function AA(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r>0)return{node:t,offset:r};if(t.nodeType==1&&r>0){if(t.contentEditable=="false")return null;t=t.childNodes[r-1],r=Mr(t)}else if(t.parentNode&&!ud(t))r=eo(t),t=t.parentNode;else return null}}function IA(n,e){for(let t=n,r=e;;){if(t.nodeType==3&&r<t.nodeValue.length)return{node:t,offset:r};if(t.nodeType==1&&r<t.childNodes.length){if(t.contentEditable=="false")return null;t=t.childNodes[r],r=0}else if(t.parentNode&&!ud(t))r=eo(t)+1,t=t.parentNode;else return null}}class Wt{constructor(e,t,r=!0){this.node=e,this.offset=t,this.precise=r}static before(e,t){return new Wt(e.parentNode,eo(e),t)}static after(e,t){return new Wt(e.parentNode,eo(e)+1,t)}}const h1=[];class Ne{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let r of this.children){if(r==e)return t;t+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let r=this.dom,i=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=i?i.nextSibling:r.firstChild)){let l=Ne.get(s);(!l||!l.parent&&l.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,t),o.flags&=-8}if(s=i?i.nextSibling:r.firstChild,t&&!t.written&&t.node==r&&s!=o.dom&&(t.written=!0),o.dom.parentNode==r)for(;s&&s!=o.dom;)s=oS(s);else r.insertBefore(o.dom,s);i=o.dom}for(s=i?i.nextSibling:r.firstChild,s&&t&&t.node==r&&(t.written=!0);s;)s=oS(s)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(e,t),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let r;if(e==this.dom)r=this.dom.childNodes[t];else{let i=Mr(e)==0?0:t==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?r=e:r=e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!Ne.get(r);)r=r.nextSibling;if(!r)return this.length;for(let i=0,s=0;;i++){let o=this.children[i];if(o.dom==r)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,t,r=0){let i=-1,s=-1,o=-1,l=-1;for(let a=0,u=r,c=r;a<this.children.length;a++){let f=this.children[a],d=u+f.length;if(u<e&&d>t)return f.domBoundsAround(e,t,u);if(d>=e&&i==-1&&(i=a,s=u),u>t&&f.dom.parentNode==this.dom){o=a,l=c;break}c=d,u=d+f.breakAfter}return{from:s,to:l<0?r+this.length:l,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,r=h1){this.markDirty();for(let i=e;i<t;i++){let s=this.children[i];s.parent==this&&r.indexOf(s)<0&&s.destroy()}r.length<250?this.children.splice(e,t-e,...r):this.children=[].concat(this.children.slice(0,e),r,this.children.slice(t));for(let i=0;i<r.length;i++)r[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new PA(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,r,i,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Ne.prototype.breakAfter=0;function oS(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class PA{constructor(e,t,r){this.children=e,this.pos=t,this.i=r,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function RA(n,e,t,r,i,s,o,l,a){let{children:u}=n,c=u.length?u[e]:null,f=s.length?s[s.length-1]:null,d=f?f.breakAfter:o;if(!(e==r&&c&&!o&&!d&&s.length<2&&c.merge(t,i,s.length?f:null,t==0,l,a))){if(r<u.length){let p=u[r];p&&(i<p.length||p.breakAfter&&(f!=null&&f.breakAfter))?(e==r&&(p=p.split(i),i=0),!d&&f&&p.merge(0,i,f,!0,0,a)?s[s.length-1]=p:((i||p.children.length&&!p.children[0].length)&&p.merge(0,i,null,!1,0,a),s.push(p))):p!=null&&p.breakAfter&&(f?f.breakAfter=1:o=1),r++}for(c&&(c.breakAfter=o,t>0&&(!o&&s.length&&c.merge(t,c.length,s[0],!1,l,0)?c.breakAfter=s.shift().breakAfter:(t<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(t,c.length,null,!1,l,0),e++));e<r&&s.length;)if(u[r-1].become(s[s.length-1]))r--,s.pop(),a=s.length?0:l;else if(u[e].become(s[0]))e++,s.shift(),l=s.length?0:a;else break;!s.length&&e&&r<u.length&&!u[e-1].breakAfter&&u[r].merge(0,0,u[e-1],!1,l,a)&&e--,(e<r||s.length)&&n.replaceChildren(e,r,s)}}function DA(n,e,t,r,i,s){let o=n.childCursor(),{i:l,off:a}=o.findPos(t,1),{i:u,off:c}=o.findPos(e,-1),f=e-t;for(let d of r)f+=d.length;n.length+=f,RA(n,u,c,l,a,r,0,i,s)}let fn=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Gy=typeof document<"u"?document:{documentElement:{style:{}}};const Yy=/Edge\/(\d+)/.exec(fn.userAgent),OA=/MSIE \d/.test(fn.userAgent),Xy=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fn.userAgent),xp=!!(OA||Xy||Yy),lS=!xp&&/gecko\/(\d+)/i.test(fn.userAgent),Xm=!xp&&/Chrome\/(\d+)/.exec(fn.userAgent),aS="webkitFontSmoothing"in Gy.documentElement.style,MA=!xp&&/Apple Computer/.test(fn.vendor),uS=MA&&(/Mobile\/\w+/.test(fn.userAgent)||fn.maxTouchPoints>2);var Q={mac:uS||/Mac/.test(fn.platform),windows:/Win/.test(fn.platform),linux:/Linux|X11/.test(fn.platform),ie:xp,ie_version:OA?Gy.documentMode||6:Xy?+Xy[1]:Yy?+Yy[1]:0,gecko:lS,gecko_version:lS?+(/Firefox\/(\d+)/.exec(fn.userAgent)||[0,0])[1]:0,chrome:!!Xm,chrome_version:Xm?+Xm[1]:0,ios:uS,android:/Android\b/.test(fn.userAgent),webkit:aS,safari:MA,webkit_version:aS?+(/\bAppleWebKit\/(\d+)/.exec(fn.userAgent)||[0,0])[1]:0,tabSize:Gy.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const tL=256;class fr extends Ne{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,r){return this.flags&8||r&&(!(r instanceof fr)||this.length-(t-e)+r.length>tL||r.flags&8)?!1:(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new fr(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Wt(this.dom,e)}domBoundsAround(e,t,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return nL(this.dom,e,t)}}class oi extends Ne{constructor(e,t=[],r=0){super(),this.mark=e,this.children=t,this.length=r;for(let i of t)i.setParent(this)}setAttrs(e){if(TA(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,r,i,s,o){return r&&(!(r instanceof oi&&r.mark.eq(this.mark))||e&&s<=0||t<this.length&&o<=0)?!1:(DA(this,e,t,r?r.children.slice():[],s-1,o-1),this.markDirty(),!0)}split(e){let t=[],r=0,i=-1,s=0;for(let l of this.children){let a=r+l.length;a>e&&t.push(r<e?l.split(e-r):l),i<0&&r>=e&&(i=s),r=a,s++}let o=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new oi(this.mark,t,o)}domAtPos(e){return NA(this,e)}coordsAt(e,t){return LA(this,e,t)}}function nL(n,e,t){let r=n.nodeValue.length;e>r&&(e=r);let i=e,s=e,o=0;e==0&&t<0||e==r&&t>=0?Q.chrome||Q.gecko||(e?(i--,o=1):s<r&&(s++,o=-1)):t<0?i--:s<r&&s++;let l=to(n,i,s).getClientRects();if(!l.length)return null;let a=l[(o?o<0:t>=0)?0:l.length-1];return Q.safari&&!o&&a.width==0&&(a=Array.prototype.find.call(l,u=>u.width)||a),o?wc(a,o<0):a||null}class Oi extends Ne{static create(e,t,r){return new Oi(e,t,r)}constructor(e,t,r){super(),this.widget=e,this.length=t,this.side=r,this.prevWidget=null}split(e){let t=Oi.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,t,r,i,s,o){return r&&(!(r instanceof Oi)||!this.widget.compare(r.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}become(e){return e instanceof Oi&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Se.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,r=t&&t.state.doc,i=this.posAtStart;return r?r.slice(i,i+this.length):Se.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Wt.before(this.dom):Wt.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);if(r)return r;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let o=this.side?this.side<0:e>0;for(let l=o?i.length-1:0;s=i[l],!(e>0?l==0:l==i.length-1||s.top<s.bottom);l+=o?-1:1);return wc(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Al extends Ne{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Al&&e.side==this.side}split(){return new Al(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Wt.before(this.dom):Wt.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Se.empty}get isHidden(){return!0}}fr.prototype.children=Oi.prototype.children=Al.prototype.children=h1;function NA(n,e){let t=n.dom,{children:r}=n,i=0;for(let s=0;i<r.length;i++){let o=r[i],l=s+o.length;if(!(l==s&&o.getSide()<=0)){if(e>s&&e<l&&o.dom.parentNode==t)return o.domAtPos(e-s);if(e<=s)break;s=l}}for(let s=i;s>0;s--){let o=r[s-1];if(o.dom.parentNode==t)return o.domAtPos(o.length)}for(let s=i;s<r.length;s++){let o=r[s];if(o.dom.parentNode==t)return o.domAtPos(0)}return new Wt(t,0)}function VA(n,e,t){let r,{children:i}=n;t>0&&e instanceof oi&&i.length&&(r=i[i.length-1])instanceof oi&&r.mark.eq(e.mark)?VA(r,e.children[0],t-1):(i.push(e),e.setParent(n)),n.length+=e.length}function LA(n,e,t){let r=null,i=-1,s=null,o=-1;function l(u,c){for(let f=0,d=0;f<u.children.length&&d<=c;f++){let p=u.children[f],y=d+p.length;y>=c&&(p.children.length?l(p,c-d):(!s||s.isHidden&&t>0)&&(y>c||d==y&&p.getSide()>0)?(s=p,o=c-d):(d<c||d==y&&p.getSide()<0&&!p.isHidden)&&(r=p,i=c-d)),d=y}}l(n,e);let a=(t<0?r:s)||r||s;return a?a.coordsAt(Math.max(0,a==r?i:o),t):rL(n)}function rL(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let t=Cl(e);return t[t.length-1]||null}function Jy(n,e){for(let t in n)t=="class"&&e.class?e.class+=" "+n.class:t=="style"&&e.style?e.style+=";"+n.style:e[t]=n[t];return e}const cS=Object.create(null);function cd(n,e,t){if(n==e)return!0;n||(n=cS),e||(e=cS);let r=Object.keys(n),i=Object.keys(e);if(r.length-(t&&r.indexOf(t)>-1?1:0)!=i.length-(t&&i.indexOf(t)>-1?1:0))return!1;for(let s of r)if(s!=t&&(i.indexOf(s)==-1||n[s]!==e[s]))return!1;return!0}function Zy(n,e,t){let r=!1;if(e)for(let i in e)t&&i in t||(r=!0,i=="style"?n.style.cssText="":n.removeAttribute(i));if(t)for(let i in t)e&&e[i]==t[i]||(r=!0,i=="style"?n.style.cssText=t[i]:n.setAttribute(i,t[i]));return r}function iL(n){let e=Object.create(null);for(let t=0;t<n.attributes.length;t++){let r=n.attributes[t];e[r.name]=r.value}return e}class fi{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,r){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var nn=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(nn||(nn={}));class ne extends Zs{constructor(e,t,r,i){super(),this.startSide=e,this.endSide=t,this.widget=r,this.spec=i}get heightRelevant(){return!1}static mark(e){return new _c(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return t+=r&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new ts(e,t,t,r,e.widget||null,!1)}static replace(e){let t=!!e.block,r,i;if(e.isBlockGap)r=-5e8,i=4e8;else{let{start:s,end:o}=BA(e,t);r=(s?t?-3e8:-1:5e8)-1,i=(o?t?2e8:1:-6e8)+1}return new ts(e,r,i,t,e.widget||null,!0)}static line(e){return new xc(e)}static set(e,t=!1){return xe.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ne.none=xe.empty;class _c extends ne{constructor(e){let{start:t,end:r}=BA(e);super(t?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,r;return this==e||e instanceof _c&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((r=e.attrs)===null||r===void 0?void 0:r.class))&&cd(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}_c.prototype.point=!1;class xc extends ne{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof xc&&this.spec.class==e.spec.class&&cd(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}xc.prototype.mapMode=Zt.TrackBefore;xc.prototype.point=!0;class ts extends ne{constructor(e,t,r,i,s,o){super(t,r,s,e),this.block=i,this.isReplace=o,this.mapMode=i?t<=0?Zt.TrackBefore:Zt.TrackAfter:Zt.TrackDel}get type(){return this.startSide!=this.endSide?nn.WidgetRange:this.startSide<=0?nn.WidgetBefore:nn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof ts&&sL(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}ts.prototype.point=!0;function BA(n,e=!1){let{inclusiveStart:t,inclusiveEnd:r}=n;return t==null&&(t=n.inclusive),r==null&&(r=n.inclusive),{start:t??e,end:r??e}}function sL(n,e){return n==e||!!(n&&e&&n.compare(e))}function df(n,e,t,r=0){let i=t.length-1;i>=0&&t[i]+r>=n?t[i]=Math.max(t[i],e):t.push(n,e)}class at extends Ne{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,r,i,s,o){if(r){if(!(r instanceof at))return!1;this.dom||r.transferDOM(this)}return i&&this.setDeco(r?r.attrs:null),DA(this,e,t,r?r.children.slice():[],s,o),!0}split(e){let t=new at;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:r,off:i}=this.childPos(e);i&&(t.append(this.children[r].split(i),0),this.children[r].merge(i,this.children[r].length,null,!1,0,0),r++);for(let s=r;s<this.children.length;s++)t.append(this.children[s],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){cd(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){VA(this,e,t)}addLineDeco(e){let t=e.spec.attributes,r=e.spec.class;t&&(this.attrs=Jy(t,this.attrs||{})),r&&(this.attrs=Jy({class:r},this.attrs||{}))}domAtPos(e){return NA(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var r;this.dom?this.flags&4&&(TA(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Zy(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let i=this.dom.lastChild;for(;i&&Ne.get(i)instanceof oi;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((r=Ne.get(i))===null||r===void 0?void 0:r.isEditable)==!1&&(!Q.ios||!this.children.some(s=>s instanceof fr))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let r of this.children){if(!(r instanceof fr)||/[^ -~]/.test(r.text))return null;let i=Cl(r.dom);if(i.length!=1)return null;e+=i[0].width,t=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let r=LA(this,e,t);if(!this.children.length&&r&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=r.bottom-r.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let o=(s-i.textHeight)/2;return{top:r.top+o,bottom:r.bottom-o,left:r.left,right:r.left}}}return r}become(e){return e instanceof at&&this.children.length==0&&e.children.length==0&&cd(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,t){for(let r=0,i=0;r<e.children.length;r++){let s=e.children[r],o=i+s.length;if(o>=t){if(s instanceof at)return s;if(o>t)break}i=o+s.breakAfter}return null}}class Zr extends Ne{constructor(e,t,r){super(),this.widget=e,this.length=t,this.deco=r,this.breakAfter=0,this.prevWidget=null}merge(e,t,r,i,s,o){return r&&(!(r instanceof Zr)||!this.widget.compare(r.widget)||e>0&&s<=0||t<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Wt.before(this.dom):Wt.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let r=new Zr(this.widget,t,this.deco);return r.breakAfter=this.breakAfter,r}get children(){return h1}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Se.empty}domBoundsAround(){return null}become(e){return e instanceof Zr&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){let r=this.widget.coordsAt(this.dom,e,t);return r||(this.widget instanceof e0?null:wc(this.dom.getBoundingClientRect(),this.length?e==0:t<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:r}=this.deco;return t==r?!1:e<0?t<0:r>0}}class e0 extends fi{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class uu{constructor(e,t,r,i){this.doc=e,this.pos=t,this.end=r,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Zr&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new at),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(yh(new Al(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Zr)&&this.getLine()}buildText(e,t,r){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:l}=this.cursor.next(this.skip);if(this.skip=0,l)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-r)),this.getLine().append(yh(new fr(this.text.slice(this.textOff,this.textOff+i)),t),r),this.atCursorPos=!0,this.textOff+=i,e-=i,r=0}}span(e,t,r,i){this.buildText(t-e,r,i),this.pos=t,this.openStart<0&&(this.openStart=i)}point(e,t,r,i,s,o){if(this.disallowBlockEffectsFor[o]&&r instanceof ts){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let l=t-e;if(r instanceof ts)if(r.block)r.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Zr(r.widget||Il.block,l,r));else{let a=Oi.create(r.widget||Il.inline,l,l?0:r.startSide),u=this.atCursorPos&&!a.isEditable&&s<=i.length&&(e<t||r.startSide>0),c=!a.isEditable&&(e<t||s>i.length||r.startSide<=0),f=this.getLine();this.pendingBuffer==2&&!u&&!a.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),u&&(f.append(yh(new Al(1),i),s),s=i.length+Math.max(0,s-i.length)),f.append(yh(a,i),s),this.atCursorPos=c,this.pendingBuffer=c?e<t||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);l&&(this.textOff+l<=this.text.length?this.textOff+=l:(this.skip+=l-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=s)}static build(e,t,r,i,s){let o=new uu(e,t,r,s);return o.openEnd=xe.spans(i,t,r,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function yh(n,e){for(let t of e)n=new oi(t,[n],n.length);return n}class Il extends fi{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Il.inline=new Il("span");Il.block=new Il("div");var Ue=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(Ue||(Ue={}));const no=Ue.LTR,f1=Ue.RTL;function FA(n){let e=[];for(let t=0;t<n.length;t++)e.push(1<<+n[t]);return e}const oL=FA("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),lL=FA("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),t0=Object.create(null),gr=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),t=n.charCodeAt(1);t0[e]=t,t0[t]=-e}function zA(n){return n<=247?oL[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?lL[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const aL=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Mi{get dir(){return this.level%2?f1:no}constructor(e,t,r){this.from=e,this.to=t,this.level=r}side(e,t){return this.dir==t==e?this.to:this.from}forward(e,t){return e==(this.dir==t)}static find(e,t,r,i){let s=-1;for(let o=0;o<e.length;o++){let l=e[o];if(l.from<=t&&l.to>=t){if(l.level==r)return o;(s<0||(i!=0?i<0?l.from<t:l.to>t:e[s].level>l.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}function $A(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++){let r=n[t],i=e[t];if(r.from!=i.from||r.to!=i.to||r.direction!=i.direction||!$A(r.inner,i.inner))return!1}return!0}const Me=[];function uL(n,e,t,r,i){for(let s=0;s<=r.length;s++){let o=s?r[s-1].to:e,l=s<r.length?r[s].from:t,a=s?256:i;for(let u=o,c=a,f=a;u<l;u++){let d=zA(n.charCodeAt(u));d==512?d=c:d==8&&f==4&&(d=16),Me[u]=d==4?2:d,d&7&&(f=d),c=d}for(let u=o,c=a,f=a;u<l;u++){let d=Me[u];if(d==128)u<l-1&&c==Me[u+1]&&c&24?d=Me[u]=c:Me[u]=256;else if(d==64){let p=u+1;for(;p<l&&Me[p]==64;)p++;let y=u&&c==8||p<t&&Me[p]==8?f==1?1:8:256;for(let v=u;v<p;v++)Me[v]=y;u=p-1}else d==8&&f==1&&(Me[u]=1);c=d,d&7&&(f=d)}}}function cL(n,e,t,r,i){let s=i==1?2:1;for(let o=0,l=0,a=0;o<=r.length;o++){let u=o?r[o-1].to:e,c=o<r.length?r[o].from:t;for(let f=u,d,p,y;f<c;f++)if(p=t0[d=n.charCodeAt(f)])if(p<0){for(let v=l-3;v>=0;v-=3)if(gr[v+1]==-p){let E=gr[v+2],w=E&2?i:E&4?E&1?s:i:0;w&&(Me[f]=Me[gr[v]]=w),l=v;break}}else{if(gr.length==189)break;gr[l++]=f,gr[l++]=d,gr[l++]=a}else if((y=Me[f])==2||y==1){let v=y==i;a=v?0:1;for(let E=l-3;E>=0;E-=3){let w=gr[E+2];if(w&2)break;if(v)gr[E+2]|=2;else{if(w&4)break;gr[E+2]|=4}}}}}function hL(n,e,t,r){for(let i=0,s=r;i<=t.length;i++){let o=i?t[i-1].to:n,l=i<t.length?t[i].from:e;for(let a=o;a<l;){let u=Me[a];if(u==256){let c=a+1;for(;;)if(c==l){if(i==t.length)break;c=t[i++].to,l=i<t.length?t[i].from:e}else if(Me[c]==256)c++;else break;let f=s==1,d=(c<e?Me[c]:r)==1,p=f==d?f?1:2:r;for(let y=c,v=i,E=v?t[v-1].to:n;y>a;)y==E&&(y=t[--v].from,E=v?t[v-1].to:n),Me[--y]=p;a=c}else s=u,a++}}}function n0(n,e,t,r,i,s,o){let l=r%2?2:1;if(r%2==i%2)for(let a=e,u=0;a<t;){let c=!0,f=!1;if(u==s.length||a<s[u].from){let v=Me[a];v!=l&&(c=!1,f=v==16)}let d=!c&&l==1?[]:null,p=c?r:r+1,y=a;e:for(;;)if(u<s.length&&y==s[u].from){if(f)break e;let v=s[u];if(!c)for(let E=v.to,w=u+1;;){if(E==t)break e;if(w<s.length&&s[w].from==E)E=s[w++].to;else{if(Me[E]==l)break e;break}}if(u++,d)d.push(v);else{v.from>a&&o.push(new Mi(a,v.from,p));let E=v.direction==no!=!(p%2);r0(n,E?r+1:r,i,v.inner,v.from,v.to,o),a=v.to}y=v.to}else{if(y==t||(c?Me[y]!=l:Me[y]==l))break;y++}d?n0(n,a,y,r+1,i,d,o):a<y&&o.push(new Mi(a,y,p)),a=y}else for(let a=t,u=s.length;a>e;){let c=!0,f=!1;if(!u||a>s[u-1].to){let v=Me[a-1];v!=l&&(c=!1,f=v==16)}let d=!c&&l==1?[]:null,p=c?r:r+1,y=a;e:for(;;)if(u&&y==s[u-1].to){if(f)break e;let v=s[--u];if(!c)for(let E=v.from,w=u;;){if(E==e)break e;if(w&&s[w-1].to==E)E=s[--w].from;else{if(Me[E-1]==l)break e;break}}if(d)d.push(v);else{v.to<a&&o.push(new Mi(v.to,a,p));let E=v.direction==no!=!(p%2);r0(n,E?r+1:r,i,v.inner,v.from,v.to,o),a=v.from}y=v.from}else{if(y==e||(c?Me[y-1]!=l:Me[y-1]==l))break;y--}d?n0(n,y,a,r+1,i,d,o):y<a&&o.push(new Mi(y,a,p)),a=y}}function r0(n,e,t,r,i,s,o){let l=e%2?2:1;uL(n,i,s,r,l),cL(n,i,s,r,l),hL(i,s,r,l),n0(n,i,s,e,t,r,o)}function fL(n,e,t){if(!n)return[new Mi(0,0,e==f1?1:0)];if(e==no&&!t.length&&!aL.test(n))return UA(n.length);if(t.length)for(;n.length>Me.length;)Me[Me.length]=256;let r=[],i=e==no?0:1;return r0(n,i,i,t,0,n.length,r),r}function UA(n){return[new Mi(0,n,0)]}let jA="";function dL(n,e,t,r,i){var s;let o=r.head-n.from,l=Mi.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc),a=e[l],u=a.side(i,t);if(o==u){let d=l+=i?1:-1;if(d<0||d>=e.length)return null;a=e[l=d],o=a.side(!i,t),u=a.side(i,t)}let c=Dt(n.text,o,a.forward(i,t));(c<a.from||c>a.to)&&(c=u),jA=n.text.slice(Math.min(o,c),Math.max(o,c));let f=l==(i?e.length-1:0)?null:e[l+(i?1:-1)];return f&&c==u&&f.level+(i?0:1)<a.level?B.cursor(f.side(!i,t)+n.from,f.forward(i,t)?1:-1,f.level):B.cursor(c+n.from,a.forward(i,t)?-1:1,a.level)}function pL(n,e,t){for(let r=e;r<t;r++){let i=zA(n.charCodeAt(r));if(i==1)return no;if(i==2||i==4)return f1}return no}const HA=G.define(),WA=G.define(),qA=G.define(),KA=G.define(),i0=G.define(),QA=G.define(),GA=G.define(),d1=G.define(),p1=G.define(),YA=G.define({combine:n=>n.some(e=>e)}),XA=G.define({combine:n=>n.some(e=>e)}),JA=G.define();class al{constructor(e,t="nearest",r="nearest",i=5,s=5,o=!1){this.range=e,this.y=t,this.x=r,this.yMargin=i,this.xMargin=s,this.isSnapshot=o}map(e){return e.empty?this:new al(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new al(B.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const vh=ue.define({map:(n,e)=>n.map(e)}),ZA=ue.define();function gn(n,e,t){let r=n.facet(KA);r.length?r[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Qr=G.define({combine:n=>n.length?n[0]:!0});let mL=0;const $a=G.define();class st{constructor(e,t,r,i,s){this.id=e,this.create=t,this.domEventHandlers=r,this.domEventObservers=i,this.extension=s(this)}static define(e,t){const{eventHandlers:r,eventObservers:i,provide:s,decorations:o}=t||{};return new st(mL++,e,r,i,l=>{let a=[$a.of(l)];return o&&a.push(Uu.of(u=>{let c=u.plugin(l);return c?o(c):ne.none})),s&&a.push(s(l)),a})}static fromClass(e,t){return st.define(r=>new e(r),t)}}class Jm{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(r){if(gn(t.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){gn(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(r){gn(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const eI=G.define(),m1=G.define(),Uu=G.define(),tI=G.define(),g1=G.define(),nI=G.define();function hS(n,e){let t=n.state.facet(nI);if(!t.length)return t;let r=t.map(s=>s instanceof Function?s(n):s),i=[];return xe.spans(r,e.from,e.to,{point(){},span(s,o,l,a){let u=s-e.from,c=o-e.from,f=i;for(let d=l.length-1;d>=0;d--,a--){let p=l[d].spec.bidiIsolate,y;if(p==null&&(p=pL(e.text,u,c)),a>0&&f.length&&(y=f[f.length-1]).to==u&&y.direction==p)y.to=c,f=y.inner;else{let v={from:u,to:c,direction:p,inner:[]};f.push(v),f=v.inner}}}}),i}const rI=G.define();function y1(n){let e=0,t=0,r=0,i=0;for(let s of n.state.facet(rI)){let o=s(n);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(t=Math.max(t,o.right)),o.top!=null&&(r=Math.max(r,o.top)),o.bottom!=null&&(i=Math.max(i,o.bottom)))}return{left:e,right:t,top:r,bottom:i}}const Ua=G.define();class Kn{constructor(e,t,r,i){this.fromA=e,this.toA=t,this.fromB=r,this.toB=i}join(e){return new Kn(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,r=this;for(;t>0;t--){let i=e[t-1];if(!(i.fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),e.splice(t-1,1)}}return e.splice(t,0,r),e}static extendWithRanges(e,t){if(t.length==0)return e;let r=[];for(let i=0,s=0,o=0,l=0;;i++){let a=i==e.length?null:e[i],u=o-l,c=a?a.fromB:1e9;for(;s<t.length&&t[s]<c;){let f=t[s],d=t[s+1],p=Math.max(l,f),y=Math.min(c,d);if(p<=y&&new Kn(p+u,y+u,p,y).addToSet(r),d>c)break;s+=2}if(!a)return r;new Kn(a.fromA,a.toA,a.fromB,a.toB).addToSet(r),o=a.toA,l=a.toB}}}class hd{constructor(e,t,r){this.view=e,this.state=t,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=pt.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,o,l,a)=>i.push(new Kn(s,o,l,a))),this.changedRanges=i}static create(e,t,r){return new hd(e,t,r)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class fS extends Ne{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ne.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new at],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Kn(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let r=e.changedRanges;this.minWidth>0&&r.length&&(r.every(({fromA:u,toA:c})=>c<this.minWidthFrom||u>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let i=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?i=this.domChanged.newSel.head:!SL(e.changes,this.hasComposition)&&!e.selectionSet&&(i=e.state.selection.main.head));let s=i>-1?yL(this.view,e.changes,i):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:u,to:c}=this.hasComposition;r=new Kn(u,c,e.changes.mapPos(u,-1),e.changes.mapPos(c,1)).addToSet(r.slice())}this.hasComposition=s?{from:s.range.fromB,to:s.range.toB}:null,(Q.ie||Q.chrome)&&!s&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,l=this.updateDeco(),a=_L(o,l,e.changes);return r=Kn.extendWithRanges(r,a),!(this.flags&7)&&r.length==0?!1:(this.updateInner(r,e.startState.doc.length,s),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,r);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Q.chrome||Q.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||i.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Zr&&o.widget instanceof e0&&s.push(o.dom);i.updateGaps(s)}updateChildren(e,t,r){let i=r?r.range.addToSet(e.slice()):e,s=this.childCursor(t);for(let o=i.length-1;;o--){let l=o>=0?i[o]:null;if(!l)break;let{fromA:a,toA:u,fromB:c,toB:f}=l,d,p,y,v;if(r&&r.range.fromB<f&&r.range.toB>c){let I=uu.build(this.view.state.doc,c,r.range.fromB,this.decorations,this.dynamicDecorationMap),D=uu.build(this.view.state.doc,r.range.toB,f,this.decorations,this.dynamicDecorationMap);p=I.breakAtStart,y=I.openStart,v=D.openEnd;let M=this.compositionView(r);D.breakAtStart?M.breakAfter=1:D.content.length&&M.merge(M.length,M.length,D.content[0],!1,D.openStart,0)&&(M.breakAfter=D.content[0].breakAfter,D.content.shift()),I.content.length&&M.merge(0,0,I.content[I.content.length-1],!0,0,I.openEnd)&&I.content.pop(),d=I.content.concat(M).concat(D.content)}else({content:d,breakAtStart:p,openStart:y,openEnd:v}=uu.build(this.view.state.doc,c,f,this.decorations,this.dynamicDecorationMap));let{i:E,off:w}=s.findPos(u,1),{i:_,off:b}=s.findPos(a,-1);RA(this,_,b,E,w,d,p,y,v)}r&&this.fixCompositionDOM(r)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let t of e.transactions)for(let r of t.effects)r.is(ZA)&&(this.editContextFormatting=r.value)}compositionView(e){let t=new fr(e.text.nodeValue);t.flags|=8;for(let{deco:i}of e.marks)t=new oi(i,[t],t.length);let r=new at;return r.append(t,0),r}fixCompositionDOM(e){let t=(s,o)=>{o.flags|=8|(o.children.some(a=>a.flags&7)?1:0),this.markedForComposition.add(o);let l=Ne.get(s);l&&l!=o&&(l.dom=null),o.setDOM(s)},r=this.childPos(e.range.fromB,1),i=this.children[r.i];t(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)r=i.childPos(r.off,1),i=i.children[r.i],t(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,i=r==this.dom,s=!i&&!(this.view.state.facet(Qr)||this.dom.tabIndex>-1)&&ff(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(i||t||s))return;let o=this.forceSelection;this.forceSelection=!1;let l=this.view.state.selection.main,a=this.moveToLine(this.domAtPos(l.anchor)),u=l.empty?a:this.moveToLine(this.domAtPos(l.head));if(Q.gecko&&l.empty&&!this.hasComposition&&gL(a)){let f=document.createTextNode("");this.view.observer.ignore(()=>a.node.insertBefore(f,a.node.childNodes[a.offset]||null)),a=u=new Wt(f,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||(!au(a.node,a.offset,c.anchorNode,c.anchorOffset)||!au(u.node,u.offset,c.focusNode,c.focusOffset))&&!this.suppressWidgetCursorChange(c,l))&&(this.view.observer.ignore(()=>{Q.android&&Q.chrome&&this.dom.contains(c.focusNode)&&xL(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let f=$u(this.view.root);if(f)if(l.empty){if(Q.gecko){let d=vL(a.node,a.offset);if(d&&d!=3){let p=(d==1?AA:IA)(a.node,a.offset);p&&(a=new Wt(p.node,p.offset))}}f.collapse(a.node,a.offset),l.bidiLevel!=null&&f.caretBidiLevel!==void 0&&(f.caretBidiLevel=l.bidiLevel)}else if(f.extend){f.collapse(a.node,a.offset);try{f.extend(u.node,u.offset)}catch{}}else{let d=document.createRange();l.anchor>l.head&&([a,u]=[u,a]),d.setEnd(u.node,u.offset),d.setStart(a.node,a.offset),f.removeAllRanges(),f.addRange(d)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(a,u)),this.impreciseAnchor=a.precise?null:new Wt(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new Wt(c.focusNode,c.focusOffset)}suppressWidgetCursorChange(e,t){return this.hasComposition&&t.empty&&au(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==t.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,r=$u(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!r||!t.empty||!t.assoc||!r.modify)return;let o=at.find(this,t.head);if(!o)return;let l=o.posAtStart;if(t.head==l||t.head==l+o.length)return;let a=this.coordsAt(t.head,-1),u=this.coordsAt(t.head,1);if(!a||!u||a.bottom>u.top)return;let c=this.domAtPos(t.head+t.assoc);r.collapse(c.node,c.offset),r.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let f=e.observer.selectionRange;e.docView.posFromDOM(f.anchorNode,f.anchorOffset)!=t.from&&r.collapse(i,s)}moveToLine(e){let t=this.dom,r;if(e.node!=t)return e;for(let i=e.offset;!r&&i<t.childNodes.length;i++){let s=Ne.get(t.childNodes[i]);s instanceof at&&(r=s.domAtPos(0))}for(let i=e.offset-1;!r&&i>=0;i--){let s=Ne.get(t.childNodes[i]);s instanceof at&&(r=s.domAtPos(s.length))}return r?new Wt(r.node,r.offset,!0):e}nearest(e){for(let t=e;t;){let r=Ne.get(t);if(r&&r.rootView==this)return r;t=t.parentNode}return null}posFromDOM(e,t){let r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,t)+r.posAtStart}domAtPos(e){let{i:t,off:r}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let i=this.children[t];if(r<i.length||i instanceof at)break;t++,r=0}return this.children[t].domAtPos(r)}coordsAt(e,t){let r=null,i=0;for(let s=this.length,o=this.children.length-1;o>=0;o--){let l=this.children[o],a=s-l.breakAfter,u=a-l.length;if(a<e)break;if(u<=e&&(u<e||l.covers(-1))&&(a>e||l.covers(1))&&(!r||l instanceof at&&!(r instanceof at&&t>=0)))r=l,i=u;else if(r&&u==e&&a==e&&l instanceof Zr&&Math.abs(t)<2){if(l.deco.startSide<0)break;o&&(r=null)}s=u}return r?r.coordsAt(e-i,t):null}coordsForChar(e){let{i:t,off:r}=this.childPos(e,1),i=this.children[t];if(!(i instanceof at))return null;for(;i.children.length;){let{i:l,off:a}=i.childPos(r,1);for(;;l++){if(l==i.children.length)return null;if((i=i.children[l]).length)break}r=a}if(!(i instanceof fr))return null;let s=Dt(i.text,r);if(s==r)return null;let o=to(i.dom,r,s).getClientRects();for(let l=0;l<o.length;l++){let a=o[l];if(l==o.length-1||a.top<a.bottom&&a.left<a.right)return a}return null}measureVisibleLineHeights(e){let t=[],{from:r,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,l=-1,a=this.view.textDirection==Ue.LTR;for(let u=0,c=0;c<this.children.length;c++){let f=this.children[c],d=u+f.length;if(d>i)break;if(u>=r){let p=f.dom.getBoundingClientRect();if(t.push(p.height),o){let y=f.dom.lastChild,v=y?Cl(y):[];if(v.length){let E=v[v.length-1],w=a?E.right-p.left:p.right-E.left;w>l&&(l=w,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=d)}}}u=d+f.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?Ue.RTL:Ue.LTR}measureTextSize(){for(let s of this.children)if(s instanceof at){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),t,r,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Cl(e.firstChild)[0];t=e.getBoundingClientRect().height,r=s?s.width/27:7,i=s?s.height:t,e.remove()}),{lineHeight:t,charWidth:r,textHeight:i}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new PA(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let r=0,i=0;;i++){let s=i==t.viewports.length?null:t.viewports[i],o=s?s.from-1:this.length;if(o>r){let l=(t.lineBlockAt(o).bottom-t.lineBlockAt(r).top)/this.view.scaleY;e.push(ne.replace({widget:new e0(l),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return ne.set(e)}updateDeco(){let e=1,t=this.view.state.facet(Uu).map(s=>(this.dynamicDecorationMap[e++]=typeof s=="function")?s(this.view):s),r=!1,i=this.view.state.facet(tI).map((s,o)=>{let l=typeof s=="function";return l&&(r=!0),l?s(this.view):s});for(i.length&&(this.dynamicDecorationMap[e++]=r,t.push(xe.join(i))),this.decorations=[this.editContextFormatting,...t,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let u=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=u.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let u of this.view.state.facet(JA))try{if(u(this.view,e.range,e))return!0}catch(c){gn(this.view.state,c,"scroll handler")}let{range:t}=e,r=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),i;if(!r)return;!t.empty&&(i=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(r={left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)});let s=y1(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom},{offsetWidth:l,offsetHeight:a}=this.view.scrollDOM;YV(this.view.scrollDOM,o,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,l),-l),Math.max(Math.min(e.yMargin,a),-a),this.view.textDirection==Ue.LTR)}}function gL(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}function iI(n,e){let t=n.observer.selectionRange;if(!t.focusNode)return null;let r=AA(t.focusNode,t.focusOffset),i=IA(t.focusNode,t.focusOffset),s=r||i;if(i&&r&&i.node!=r.node){let l=Ne.get(i.node);if(!l||l instanceof fr&&l.text!=i.node.nodeValue)s=i;else if(n.docView.lastCompositionAfterCursor){let a=Ne.get(r.node);!a||a instanceof fr&&a.text!=r.node.nodeValue||(s=i)}}if(n.docView.lastCompositionAfterCursor=s!=r,!s)return null;let o=e-s.offset;return{from:o,to:o+s.node.nodeValue.length,node:s.node}}function yL(n,e,t){let r=iI(n,t);if(!r)return null;let{node:i,from:s,to:o}=r,l=i.nodeValue;if(/[\n\r]/.test(l)||n.state.doc.sliceString(r.from,r.to)!=l)return null;let a=e.invertedDesc,u=new Kn(a.mapPos(s),a.mapPos(o),s,o),c=[];for(let f=i.parentNode;;f=f.parentNode){let d=Ne.get(f);if(d instanceof oi)c.push({node:f,deco:d.mark});else{if(d instanceof at||f.nodeName=="DIV"&&f.parentNode==n.contentDOM)return{range:u,text:i,marks:c,line:f};if(f!=n.contentDOM)c.push({node:f,deco:new _c({inclusive:!0,attributes:iL(f),tagName:f.tagName.toLowerCase()})});else return null}}}function vL(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let wL=class{constructor(){this.changes=[]}compareRange(e,t){df(e,t,this.changes)}comparePoint(e,t){df(e,t,this.changes)}boundChange(e){df(e,e,this.changes)}};function _L(n,e,t){let r=new wL;return xe.compare(n,e,t,r),r.changes}function xL(n,e){for(let t=n;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function SL(n,e){let t=!1;return e&&n.iterChangedRanges((r,i)=>{r<e.to&&i>e.from&&(t=!0)}),t}function bL(n,e,t=1){let r=n.charCategorizer(e),i=n.doc.lineAt(e),s=e-i.from;if(i.length==0)return B.cursor(e);s==0?t=1:s==i.length&&(t=-1);let o=s,l=s;t<0?o=Dt(i.text,s,!1):l=Dt(i.text,s);let a=r(i.text.slice(o,l));for(;o>0;){let u=Dt(i.text,o,!1);if(r(i.text.slice(u,o))!=a)break;o=u}for(;l<i.length;){let u=Dt(i.text,l);if(r(i.text.slice(l,u))!=a)break;l=u}return B.range(o+i.from,l+i.from)}function kL(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function EL(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function Zm(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function dS(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function pS(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function s0(n,e,t){let r,i,s,o,l=!1,a,u,c,f;for(let y=n.firstChild;y;y=y.nextSibling){let v=Cl(y);for(let E=0;E<v.length;E++){let w=v[E];i&&Zm(i,w)&&(w=dS(pS(w,i.bottom),i.top));let _=kL(e,w),b=EL(t,w);if(_==0&&b==0)return y.nodeType==3?mS(y,e,t):s0(y,e,t);if(!r||o>b||o==b&&s>_){r=y,i=w,s=_,o=b;let I=b?t<w.top?-1:1:_?e<w.left?-1:1:0;l=!I||(I>0?E<v.length-1:E>0)}_==0?t>w.bottom&&(!c||c.bottom<w.bottom)?(a=y,c=w):t<w.top&&(!f||f.top>w.top)&&(u=y,f=w):c&&Zm(c,w)?c=pS(c,w.bottom):f&&Zm(f,w)&&(f=dS(f,w.top))}}if(c&&c.bottom>=t?(r=a,i=c):f&&f.top<=t&&(r=u,i=f),!r)return{node:n,offset:0};let d=Math.max(i.left,Math.min(i.right,e));if(r.nodeType==3)return mS(r,d,t);if(l&&r.contentEditable!="false")return s0(r,d,t);let p=Array.prototype.indexOf.call(n.childNodes,r)+(e>=(i.left+i.right)/2?1:0);return{node:n,offset:p}}function mS(n,e,t){let r=n.nodeValue.length,i=-1,s=1e9,o=0;for(let l=0;l<r;l++){let a=to(n,l,l+1).getClientRects();for(let u=0;u<a.length;u++){let c=a[u];if(c.top==c.bottom)continue;o||(o=e-c.left);let f=(c.top>t?c.top-t:t-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&f<s){let d=e>=(c.left+c.right)/2,p=d;if((Q.chrome||Q.gecko)&&to(n,l).getBoundingClientRect().left==c.right&&(p=!d),f<=0)return{node:n,offset:l+(p?1:0)};i=l+(p?1:0),s=f}}}return{node:n,offset:i>-1?i:o>0?n.nodeValue.length:0}}function sI(n,e,t,r=-1){var i,s;let o=n.contentDOM.getBoundingClientRect(),l=o.top+n.viewState.paddingTop,a,{docHeight:u}=n.viewState,{x:c,y:f}=e,d=f-l;if(d<0)return 0;if(d>u)return n.state.doc.length;for(let I=n.viewState.heightOracle.textHeight/2,D=!1;a=n.elementAtHeight(d),a.type!=nn.Text;)for(;d=r>0?a.bottom+I:a.top-I,!(d>=0&&d<=u);){if(D)return t?null:0;D=!0,r=-r}f=l+d;let p=a.from;if(p<n.viewport.from)return n.viewport.from==0?0:t?null:gS(n,o,a,c,f);if(p>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:t?null:gS(n,o,a,c,f);let y=n.dom.ownerDocument,v=n.root.elementFromPoint?n.root:y,E=v.elementFromPoint(c,f);E&&!n.contentDOM.contains(E)&&(E=null),E||(c=Math.max(o.left+1,Math.min(o.right-1,c)),E=v.elementFromPoint(c,f),E&&!n.contentDOM.contains(E)&&(E=null));let w,_=-1;if(E&&((i=n.docView.nearest(E))===null||i===void 0?void 0:i.isEditable)!=!1){if(y.caretPositionFromPoint){let I=y.caretPositionFromPoint(c,f);I&&({offsetNode:w,offset:_}=I)}else if(y.caretRangeFromPoint){let I=y.caretRangeFromPoint(c,f);I&&({startContainer:w,startOffset:_}=I,(!n.contentDOM.contains(w)||Q.safari&&TL(w,_,c)||Q.chrome&&CL(w,_,c))&&(w=void 0))}w&&(_=Math.min(Mr(w),_))}if(!w||!n.docView.dom.contains(w)){let I=at.find(n.docView,p);if(!I)return d>a.top+a.height/2?a.to:a.from;({node:w,offset:_}=s0(I.dom,c,f))}let b=n.docView.nearest(w);if(!b)return null;if(b.isWidget&&((s=b.dom)===null||s===void 0?void 0:s.nodeType)==1){let I=b.dom.getBoundingClientRect();return e.y<I.top||e.y<=I.bottom&&e.x<=(I.left+I.right)/2?b.posAtStart:b.posAtEnd}else return b.localPosFromDOM(w,_)+b.posAtStart}function gS(n,e,t,r,i){let s=Math.round((r-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&t.height>n.defaultLineHeight*1.5){let l=n.viewState.heightOracle.textHeight,a=Math.floor((i-t.top-(n.defaultLineHeight-l)*.5)/l);s+=a*n.viewState.heightOracle.lineLength}let o=n.state.sliceDoc(t.from,t.to);return t.from+Wy(o,s,n.state.tabSize)}function TL(n,e,t){let r;if(n.nodeType!=3||e!=(r=n.nodeValue.length))return!1;for(let i=n.nextSibling;i;i=i.nextSibling)if(i.nodeType!=1||i.nodeName!="BR")return!1;return to(n,r-1,r).getBoundingClientRect().left>t}function CL(n,e,t){if(e!=0)return!1;for(let i=n;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let r=n.nodeType==1?n.getBoundingClientRect():to(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return t-r.left>5}function o0(n,e){let t=n.lineBlockAt(e);if(Array.isArray(t.type)){for(let r of t.type)if(r.to>e||r.to==e&&(r.to==t.to||r.type==nn.Text))return r}return t}function AL(n,e,t,r){let i=o0(n,e.head),s=!r||i.type!=nn.Text||!(n.lineWrapping||i.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let o=n.dom.getBoundingClientRect(),l=n.textDirectionAt(i.from),a=n.posAtCoords({x:t==(l==Ue.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(a!=null)return B.cursor(a,t?-1:1)}return B.cursor(t?i.to:i.from,t?-1:1)}function yS(n,e,t,r){let i=n.state.doc.lineAt(e.head),s=n.bidiSpans(i),o=n.textDirectionAt(i.from);for(let l=e,a=null;;){let u=dL(i,s,o,l,t),c=jA;if(!u){if(i.number==(t?n.state.doc.lines:1))return l;c=`
`,i=n.state.doc.line(i.number+(t?1:-1)),s=n.bidiSpans(i),u=n.visualLineSide(i,!t)}if(a){if(!a(c))return l}else{if(!r)return u;a=r(c)}l=u}}function IL(n,e,t){let r=n.state.charCategorizer(e),i=r(t);return s=>{let o=r(s);return i==We.Space&&(i=o),i==o}}function PL(n,e,t,r){let i=e.head,s=t?1:-1;if(i==(t?n.state.doc.length:0))return B.cursor(i,e.assoc);let o=e.goalColumn,l,a=n.contentDOM.getBoundingClientRect(),u=n.coordsAtPos(i,e.assoc||-1),c=n.documentTop;if(u)o==null&&(o=u.left-a.left),l=s<0?u.top:u.bottom;else{let p=n.viewState.lineBlockAt(i);o==null&&(o=Math.min(a.right-a.left,n.defaultCharacterWidth*(i-p.from))),l=(s<0?p.top:p.bottom)+c}let f=a.left+o,d=r??n.viewState.heightOracle.textHeight>>1;for(let p=0;;p+=10){let y=l+(d+p)*s,v=sI(n,{x:f,y},!1,s);if(y<a.top||y>a.bottom||(s<0?v<i:v>i)){let E=n.docView.coordsForChar(v),w=!E||y<E.top?-1:1;return B.cursor(v,w,void 0,o)}}}function pf(n,e,t){for(;;){let r=0;for(let i of n)i.between(e-1,e+1,(s,o,l)=>{if(e>s&&e<o){let a=r||t||(e-s<o-e?-1:1);e=a<0?s:o,r=a}});if(!r)return e}}function eg(n,e,t){let r=pf(n.state.facet(g1).map(i=>i(n)),t.from,e.head>t.from?-1:1);return r==t.from?t:B.cursor(r,r<t.from?1:-1)}const ja="";class RL{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(ye.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=ja}readRange(e,t){if(!e)return this;let r=e.parentNode;for(let i=e;;){this.findPointBefore(r,i);let s=this.text.length;this.readNode(i);let o=i.nextSibling;if(o==t)break;let l=Ne.get(i),a=Ne.get(o);(l&&a?l.breakAfter:(l?l.breakAfter:ud(i))||ud(o)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>s)&&this.lineBreak(),i=o}return this.findPointBefore(r,t),this}readTextNode(e){let t=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,t.length));for(let r=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,l;if(this.lineSeparator?(s=t.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(l=i.exec(t))&&(s=l.index,o=l[0].length),this.append(t.slice(r,s<0?t.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let a of this.points)a.node==e&&a.pos>this.text.length&&(a.pos-=o-1);r=s+o}}readNode(e){if(e.cmIgnore)return;let t=Ne.get(e),r=t&&t.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let i=r.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==t&&(r.pos=this.text.length)}findPointInside(e,t){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+(DL(e,r.node,r.offset)?t:0))}}function DL(n,e,t){for(;;){if(!e||t<Mr(e))return!1;if(e==n)return!0;t=eo(e)+1,e=e.parentNode}}class vS{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class OL{constructor(e,t,r,i){this.typeOver=i,this.bounds=null,this.text="",this.domChanged=t>-1;let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,r,0))){let l=s||o?[]:VL(e),a=new RL(l,e.state);a.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=a.text,this.newSel=LL(l,this.bounds.from)}else{let l=e.observer.selectionRange,a=s&&s.node==l.focusNode&&s.offset==l.focusOffset||!Qy(e.contentDOM,l.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(l.focusNode,l.focusOffset),u=o&&o.node==l.anchorNode&&o.offset==l.anchorOffset||!Qy(e.contentDOM,l.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(l.anchorNode,l.anchorOffset),c=e.viewport;if((Q.ios||Q.chrome)&&e.state.selection.main.empty&&a!=u&&(c.from>0||c.to<e.state.doc.length)){let f=Math.min(a,u),d=Math.max(a,u),p=c.from-f,y=c.to-d;(p==0||p==1||f==0)&&(y==0||y==-1||d==e.state.doc.length)&&(a=0,u=e.state.doc.length)}this.newSel=B.single(u,a)}}}function oI(n,e){let t,{newSel:r}=e,i=n.state.selection.main,s=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:l}=e.bounds,a=i.from,u=null;(s===8||Q.android&&e.text.length<l-o)&&(a=i.to,u="end");let c=NL(n.state.doc.sliceString(o,l,ja),e.text,a-o,u);c&&(Q.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==ja+ja&&c.toB--,t={from:o+c.from,to:o+c.toA,insert:Se.of(e.text.slice(c.from,c.toB).split(ja))})}else r&&(!n.hasFocus&&n.state.facet(Qr)||r.main.eq(i))&&(r=null);if(!t&&!r)return!1;if(!t&&e.typeOver&&!i.empty&&r&&r.main.empty?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,i.to)}:(Q.mac||Q.android)&&t&&t.from==t.to&&t.from==i.head-1&&/^\. ?$/.test(t.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(r&&t.insert.length==2&&(r=B.single(r.main.anchor-1,r.main.head-1)),t={from:t.from,to:t.to,insert:Se.of([t.insert.toString().replace("."," ")])}):t&&t.from>=i.from&&t.to<=i.to&&(t.from!=i.from||t.to!=i.to)&&i.to-i.from-(t.to-t.from)<=4?t={from:i.from,to:i.to,insert:n.state.doc.slice(i.from,t.from).append(t.insert).append(n.state.doc.slice(t.to,i.to))}:Q.chrome&&t&&t.from==t.to&&t.from==i.head&&t.insert.toString()==`
 `&&n.lineWrapping&&(r&&(r=B.single(r.main.anchor-1,r.main.head-1)),t={from:i.from,to:i.to,insert:Se.of([" "])}),t)return v1(n,t,r,s);if(r&&!r.main.eq(i)){let o=!1,l="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(o=!0),l=n.inputState.lastSelectionOrigin),n.dispatch({selection:r,scrollIntoView:o,userEvent:l}),!0}else return!1}function v1(n,e,t,r=-1){if(Q.ios&&n.inputState.flushIOSKey(e))return!0;let i=n.state.selection.main;if(Q.android&&(e.to==i.to&&(e.from==i.from||e.from==i.from-1&&n.state.sliceDoc(e.from,i.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&ll(n.contentDOM,"Enter",13)||(e.from==i.from-1&&e.to==i.to&&e.insert.length==0||r==8&&e.insert.length<e.to-e.from&&e.to>i.head)&&ll(n.contentDOM,"Backspace",8)||e.from==i.from&&e.to==i.to+1&&e.insert.length==0&&ll(n.contentDOM,"Delete",46)))return!0;let s=e.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let o,l=()=>o||(o=ML(n,e,t));return n.state.facet(QA).some(a=>a(n,e.from,e.to,s,l))||n.dispatch(l()),!0}function ML(n,e,t){let r,i=n.state,s=i.selection.main;if(e.from>=s.from&&e.to<=s.to&&e.to-e.from>=(s.to-s.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let l=s.from<e.from?i.sliceDoc(s.from,e.from):"",a=s.to>e.to?i.sliceDoc(e.to,s.to):"";r=i.replaceSelection(n.state.toText(l+e.insert.sliceString(0,void 0,n.state.lineBreak)+a))}else{let l=i.changes(e),a=t&&t.main.to<=l.newLength?t.main:void 0;if(i.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=s.to&&e.to>=s.to-10){let u=n.state.sliceDoc(e.from,e.to),c,f=t&&iI(n,t.main.head);if(f){let y=e.insert.length-(e.to-e.from);c={from:f.from,to:f.to-y}}else c=n.state.doc.lineAt(s.head);let d=s.to-e.to,p=s.to-s.from;r=i.changeByRange(y=>{if(y.from==s.from&&y.to==s.to)return{changes:l,range:a||y.map(l)};let v=y.to-d,E=v-u.length;if(y.to-y.from!=p||n.state.sliceDoc(E,v)!=u||y.to>=c.from&&y.from<=c.to)return{range:y};let w=i.changes({from:E,to:v,insert:e.insert}),_=y.to-s.to;return{changes:w,range:a?B.range(Math.max(0,a.anchor+_),Math.max(0,a.head+_)):y.map(w)}})}else r={changes:l,selection:a&&i.selection.replaceRange(a)}}let o="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,o+=".compose",n.inputState.compositionFirstChange&&(o+=".start",n.inputState.compositionFirstChange=!1)),i.update(r,{userEvent:o,scrollIntoView:!0})}function NL(n,e,t,r){let i=Math.min(n.length,e.length),s=0;for(;s<i&&n.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&n.length==e.length)return null;let o=n.length,l=e.length;for(;o>0&&l>0&&n.charCodeAt(o-1)==e.charCodeAt(l-1);)o--,l--;if(r=="end"){let a=Math.max(0,s-Math.min(o,l));t-=o+a-s}if(o<s&&n.length<e.length){let a=t<=s&&t>=o?s-t:0;s-=a,l=s+(l-o),o=s}else if(l<s){let a=t<=s&&t>=l?s-t:0;s-=a,o=s+(o-l),l=s}return{from:s,toA:o,toB:l}}function VL(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}=n.observer.selectionRange;return t&&(e.push(new vS(t,r)),(i!=t||s!=r)&&e.push(new vS(i,s))),e}function LL(n,e){if(n.length==0)return null;let t=n[0].pos,r=n.length==2?n[1].pos:t;return t>-1&&r>-1?B.single(t+e,r+e):null}class BL{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Q.safari&&e.contentDOM.addEventListener("input",()=>null),Q.gecko&&e4(e.contentDOM.ownerDocument)}handleEvent(e){!qL(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(e.type,e)):this.runHandlers(e.type,e))}runHandlers(e,t){let r=this.handlers[e];if(r){for(let i of r.observers)i(this.view,t);for(let i of r.handlers){if(t.defaultPrevented)break;if(i(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=FL(e),r=this.handlers,i=this.view.contentDOM;for(let s in t)if(s!="scroll"){let o=!t[s].handlers.length,l=r[s];l&&o!=!l.handlers.length&&(i.removeEventListener(s,this.handleEvent),l=null),l||i.addEventListener(s,this.handleEvent,{passive:o})}for(let s in r)s!="scroll"&&!t[s]&&i.removeEventListener(s,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&aI.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Q.android&&Q.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return Q.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=lI.find(r=>r.keyCode==e.keyCode))&&!e.ctrlKey||zL.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let t=this.pendingIOSKey;return!t||t.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,ll(this.view.contentDOM,t.key,t.keyCode,t instanceof KeyboardEvent?t:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Q.safari&&!Q.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function wS(n,e){return(t,r)=>{try{return e.call(n,r,t)}catch(i){gn(t.state,i)}}}function FL(n){let e=Object.create(null);function t(r){return e[r]||(e[r]={observers:[],handlers:[]})}for(let r of n){let i=r.spec;if(i&&i.domEventHandlers)for(let s in i.domEventHandlers){let o=i.domEventHandlers[s];o&&t(s).handlers.push(wS(r.value,o))}if(i&&i.domEventObservers)for(let s in i.domEventObservers){let o=i.domEventObservers[s];o&&t(s).observers.push(wS(r.value,o))}}for(let r in dr)t(r).handlers.push(dr[r]);for(let r in Zn)t(r).observers.push(Zn[r]);return e}const lI=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],zL="dthko",aI=[16,17,18,20,91,92,224,225],wh=6;function _h(n){return Math.max(0,n)*.7+8}function $L(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class UL{constructor(e,t,r,i){this.view=e,this.startEvent=t,this.style=r,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParents=XV(e.contentDOM),this.atoms=e.state.facet(g1).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(ye.allowMultipleSelections)&&jL(e,t),this.dragging=WL(e,t)&&hI(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&$L(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let t=0,r=0,i=0,s=0,o=this.view.win.innerWidth,l=this.view.win.innerHeight;this.scrollParents.x&&({left:i,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:s,bottom:l}=this.scrollParents.y.getBoundingClientRect());let a=y1(this.view);e.clientX-a.left<=i+wh?t=-_h(i-e.clientX):e.clientX+a.right>=o-wh&&(t=_h(e.clientX-o)),e.clientY-a.top<=s+wh?r=-_h(s-e.clientY):e.clientY+a.bottom>=l-wh&&(r=_h(e.clientY-l)),this.setScrollSpeed(t,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:t}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),t&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=t,t=0),(e||t)&&this.view.win.scrollBy(e,t),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let r=0;r<e.ranges.length;r++){let i=e.ranges[r],s=null;if(i.empty){let o=pf(this.atoms,i.from,0);o!=i.from&&(s=B.cursor(o,-1))}else{let o=pf(this.atoms,i.from,-1),l=pf(this.atoms,i.to,1);(o!=i.from||l!=i.to)&&(s=B.range(i.from==i.anchor?o:l,i.from==i.head?o:l))}s&&(t||(t=e.ranges.slice()),t[r]=s)}return t?B.create(t,e.mainIndex):e}select(e){let{view:t}=this,r=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(t.state.selection,this.dragging===!1))&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(t=>t.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function jL(n,e){let t=n.state.facet(HA);return t.length?t[0](e):Q.mac?e.metaKey:e.ctrlKey}function HL(n,e){let t=n.state.facet(WA);return t.length?t[0](e):Q.mac?!e.altKey:!e.ctrlKey}function WL(n,e){let{main:t}=n.state.selection;if(t.empty)return!1;let r=$u(n.root);if(!r||r.rangeCount==0)return!0;let i=r.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function qL(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,r;t!=n.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(r=Ne.get(t))&&r.ignoreEvent(e))return!1;return!0}const dr=Object.create(null),Zn=Object.create(null),uI=Q.ie&&Q.ie_version<15||Q.ios&&Q.webkit_version<604;function KL(n){let e=n.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{n.focus(),t.remove(),cI(n,t.value)},50)}function Sp(n,e,t){for(let r of n.facet(e))t=r(t,n);return t}function cI(n,e){e=Sp(n.state,d1,e);let{state:t}=n,r,i=1,s=t.toText(e),o=s.lines==t.selection.ranges.length;if(l0!=null&&t.selection.ranges.every(a=>a.empty)&&l0==s.toString()){let a=-1;r=t.changeByRange(u=>{let c=t.doc.lineAt(u.from);if(c.from==a)return{range:u};a=c.from;let f=t.toText((o?s.line(i++).text:e)+t.lineBreak);return{changes:{from:c.from,insert:f},range:B.cursor(u.from+f.length)}})}else o?r=t.changeByRange(a=>{let u=s.line(i++);return{changes:{from:a.from,to:a.to,insert:u.text},range:B.cursor(a.from+u.length)}}):r=t.replaceSelection(s);n.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}Zn.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};dr.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&n.inputState.tabFocusMode!=0&&(n.inputState.tabFocusMode=Date.now()+2e3),!1);Zn.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};Zn.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};dr.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let r of n.state.facet(qA))if(t=r(n,e),t)break;if(!t&&e.button==0&&(t=YL(n,e)),t){let r=!n.hasFocus;n.inputState.startMouseSelection(new UL(n,e,t,r)),r&&n.observer.ignore(()=>{EA(n.contentDOM);let s=n.root.activeElement;s&&!s.contains(n.contentDOM)&&s.blur()});let i=n.inputState.mouseSelection;if(i)return i.start(e),i.dragging===!1}return!1};function _S(n,e,t,r){if(r==1)return B.cursor(e,t);if(r==2)return bL(n.state,e,t);{let i=at.find(n.docView,e),s=n.state.doc.lineAt(i?i.posAtEnd:e),o=i?i.posAtStart:s.from,l=i?i.posAtEnd:s.to;return l<n.state.doc.length&&l==s.to&&l++,B.range(o,l)}}let xS=(n,e,t)=>e>=t.top&&e<=t.bottom&&n>=t.left&&n<=t.right;function QL(n,e,t,r){let i=at.find(n.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let o=i.coordsAt(s,-1);if(o&&xS(t,r,o))return-1;let l=i.coordsAt(s,1);return l&&xS(t,r,l)?1:o&&o.bottom>=r?-1:1}function SS(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:QL(n,t,e.clientX,e.clientY)}}const GL=Q.ie&&Q.ie_version<=11;let bS=null,kS=0,ES=0;function hI(n){if(!GL)return n.detail;let e=bS,t=ES;return bS=n,ES=Date.now(),kS=!e||t>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(kS+1)%3:1}function YL(n,e){let t=SS(n,e),r=hI(e),i=n.state.selection;return{update(s){s.docChanged&&(t.pos=s.changes.mapPos(t.pos),i=i.map(s.changes))},get(s,o,l){let a=SS(n,s),u,c=_S(n,a.pos,a.bias,r);if(t.pos!=a.pos&&!o){let f=_S(n,t.pos,t.bias,r),d=Math.min(f.from,c.from),p=Math.max(f.to,c.to);c=d<c.from?B.range(d,p):B.range(p,d)}return o?i.replaceRange(i.main.extend(c.from,c.to)):l&&r==1&&i.ranges.length>1&&(u=XL(i,a.pos))?u:l?i.addRange(c):B.create([c])}}}function XL(n,e){for(let t=0;t<n.ranges.length;t++){let{from:r,to:i}=n.ranges[t];if(r<=e&&i>=e)return B.create(n.ranges.slice(0,t).concat(n.ranges.slice(t+1)),n.mainIndex==t?0:n.mainIndex-(n.mainIndex>t?1:0))}return null}dr.dragstart=(n,e)=>{let{selection:{main:t}}=n.state;if(e.target.draggable){let i=n.docView.nearest(e.target);if(i&&i.isWidget){let s=i.posAtStart,o=s+i.length;(s>=t.to||o<=t.from)&&(t=B.range(s,o))}}let{inputState:r}=n;return r.mouseSelection&&(r.mouseSelection.dragging=!0),r.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",Sp(n.state,p1,n.state.sliceDoc(t.from,t.to))),e.dataTransfer.effectAllowed="copyMove"),!1};dr.dragend=n=>(n.inputState.draggedContent=null,!1);function TS(n,e,t,r){if(t=Sp(n.state,d1,t),!t)return;let i=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:s}=n.inputState,o=r&&s&&HL(n,e)?{from:s.from,to:s.to}:null,l={from:i,insert:t},a=n.state.changes(o?[o,l]:l);n.focus(),n.dispatch({changes:a,selection:{anchor:a.mapPos(i,-1),head:a.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"}),n.inputState.draggedContent=null}dr.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let r=Array(t.length),i=0,s=()=>{++i==t.length&&TS(n,e,r.filter(o=>o!=null).join(n.state.lineBreak),!1)};for(let o=0;o<t.length;o++){let l=new FileReader;l.onerror=s,l.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(l.result)||(r[o]=l.result),s()},l.readAsText(t[o])}return!0}else{let r=e.dataTransfer.getData("Text");if(r)return TS(n,e,r,!0),!0}return!1};dr.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let t=uI?null:e.clipboardData;return t?(cI(n,t.getData("text/plain")||t.getData("text/uri-list")),!0):(KL(n),!1)};function JL(n,e){let t=n.dom.parentNode;if(!t)return;let r=t.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),n.focus()},50)}function ZL(n){let e=[],t=[],r=!1;for(let i of n.selection.ranges)i.empty||(e.push(n.sliceDoc(i.from,i.to)),t.push(i));if(!e.length){let i=-1;for(let{from:s}of n.selection.ranges){let o=n.doc.lineAt(s);o.number>i&&(e.push(o.text),t.push({from:o.from,to:Math.min(n.doc.length,o.to+1)})),i=o.number}r=!0}return{text:Sp(n,p1,e.join(n.lineBreak)),ranges:t,linewise:r}}let l0=null;dr.copy=dr.cut=(n,e)=>{let{text:t,ranges:r,linewise:i}=ZL(n.state);if(!t&&!i)return!1;l0=i?t:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"});let s=uI?null:e.clipboardData;return s?(s.clearData(),s.setData("text/plain",t),!0):(JL(n,t),!1)};const fI=Vr.define();function dI(n,e){let t=[];for(let r of n.facet(GA)){let i=r(n,e);i&&t.push(i)}return t?n.update({effects:t,annotations:fI.of(!0)}):null}function pI(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let t=dI(n.state,e);t?n.dispatch(t):n.update([])}},10)}Zn.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),pI(n)};Zn.blur=n=>{n.observer.clearSelectionRange(),pI(n)};Zn.compositionstart=Zn.compositionupdate=n=>{n.observer.editContext||(n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0))};Zn.compositionend=n=>{n.observer.editContext||(n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Q.chrome&&Q.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50))};Zn.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};dr.beforeinput=(n,e)=>{var t,r;if(e.inputType=="insertReplacementText"&&n.observer.editContext){let s=(t=e.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain"),o=e.getTargetRanges();if(s&&o.length){let l=o[0],a=n.posAtDOM(l.startContainer,l.startOffset),u=n.posAtDOM(l.endContainer,l.endOffset);return v1(n,{from:a,to:u,insert:n.state.toText(s)},null),!0}}let i;if(Q.chrome&&Q.android&&(i=lI.find(s=>s.inputType==e.inputType))&&(n.observer.delayAndroidKey(i.key,i.keyCode),i.key=="Backspace"||i.key=="Delete")){let s=((r=window.visualViewport)===null||r===void 0?void 0:r.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>s+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return Q.ios&&e.inputType=="deleteContentForward"&&n.observer.flushSoon(),Q.safari&&e.inputType=="insertText"&&n.inputState.composing>=0&&setTimeout(()=>Zn.compositionend(n,e),20),!1};const CS=new Set;function e4(n){CS.has(n)||(CS.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const AS=["pre-wrap","normal","pre-line","break-spaces"];let Pl=!1;function IS(){Pl=!1}class t4{constructor(e){this.lineWrapping=e,this.doc=Se.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,t){let r=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((t-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return AS.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let r=0;r<e.length;r++){let i=e[r];i<0?r++:this.heightSamples[Math.floor(i*10)]||(t=!0,this.heightSamples[Math.floor(i*10)]=!0)}return t}refresh(e,t,r,i,s,o){let l=AS.indexOf(e)>-1,a=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=l;if(this.lineWrapping=l,this.lineHeight=t,this.charWidth=r,this.textHeight=i,this.lineLength=s,a){this.heightSamples={};for(let u=0;u<o.length;u++){let c=o[u];c<0?u++:this.heightSamples[Math.floor(c*10)]=!0}}return a}}class n4{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class Er{constructor(e,t,r,i,s){this.from=e,this.length=t,this.top=r,this.height=i,this._content=s}get type(){return typeof this._content=="number"?nn.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ts?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Er(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var ze=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(ze||(ze={}));const mf=.001;class rn{constructor(e,t,r=2){this.length=e,this.height=t,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>mf&&(Pl=!0),this.height=e)}replace(e,t,r){return rn.of(r)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,r,i){let s=this,o=r.doc;for(let l=i.length-1;l>=0;l--){let{fromA:a,toA:u,fromB:c,toB:f}=i[l],d=s.lineAt(a,ze.ByPosNoHeight,r.setDoc(t),0,0),p=d.to>=u?d:s.lineAt(u,ze.ByPosNoHeight,r,0,0);for(f+=p.to-u,u=p.to;l>0&&d.from<=i[l-1].toA;)a=i[l-1].fromA,c=i[l-1].fromB,l--,a<d.from&&(d=s.lineAt(a,ze.ByPosNoHeight,r,0,0));c+=d.from-a,a=d.from;let y=w1.build(r.setDoc(o),e,c,f);s=fd(s,s.replace(a,u,y))}return s.updateHeight(r,0)}static empty(){return new Cn(0,0)}static of(e){if(e.length==1)return e[0];let t=0,r=e.length,i=0,s=0;for(;;)if(t==r)if(i>s*2){let l=e[t-1];l.break?e.splice(--t,1,l.left,null,l.right):e.splice(--t,1,l.left,l.right),r+=1+l.break,i-=l.size}else if(s>i*2){let l=e[r];l.break?e.splice(r,1,l.left,null,l.right):e.splice(r,1,l.left,l.right),r+=2+l.break,s-=l.size}else break;else if(i<s){let l=e[t++];l&&(i+=l.size)}else{let l=e[--r];l&&(s+=l.size)}let o=0;return e[t-1]==null?(o=1,t--):e[t]==null&&(o=1,r++),new r4(rn.of(e.slice(0,t)),o,rn.of(e.slice(r)))}}function fd(n,e){return n==e?n:(n.constructor!=e.constructor&&(Pl=!0),e)}rn.prototype.size=1;class mI extends rn{constructor(e,t,r){super(e,t),this.deco=r}blockAt(e,t,r,i){return new Er(i,this.length,r,this.height,this.deco||0)}lineAt(e,t,r,i,s){return this.blockAt(0,r,i,s)}forEachLine(e,t,r,i,s,o){e<=s+this.length&&t>=s&&o(this.blockAt(0,r,i,s))}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more&&this.setHeight(i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Cn extends mI{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,r,i){return new Er(i,this.length,r,this.height,this.breaks)}replace(e,t,r){let i=r[0];return r.length==1&&(i instanceof Cn||i instanceof At&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof At?i=new Cn(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):rn.of(r)}updateHeight(e,t=0,r=!1,i){return i&&i.from<=t&&i.more?this.setHeight(i.heights[i.index++]):(r||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class At extends rn{constructor(e){super(e,0)}heightMetrics(e,t){let r=e.doc.lineAt(t).number,i=e.doc.lineAt(t+this.length).number,s=i-r+1,o,l=0;if(e.lineWrapping){let a=Math.min(this.height,e.lineHeight*s);o=a/s,this.length>s+1&&(l=(this.height-a)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:i,perLine:o,perChar:l}}blockAt(e,t,r,i){let{firstLine:s,lastLine:o,perLine:l,perChar:a}=this.heightMetrics(t,i);if(t.lineWrapping){let u=i+(e<t.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length)),c=t.doc.lineAt(u),f=l+c.length*a,d=Math.max(r,e-f/2);return new Er(c.from,c.length,d,f,0)}else{let u=Math.max(0,Math.min(o-s,Math.floor((e-r)/l))),{from:c,length:f}=t.doc.line(s+u);return new Er(c,f,r+l*u,l,0)}}lineAt(e,t,r,i,s){if(t==ze.ByHeight)return this.blockAt(e,r,i,s);if(t==ze.ByPosNoHeight){let{from:p,to:y}=r.doc.lineAt(e);return new Er(p,y-p,0,0,0)}let{firstLine:o,perLine:l,perChar:a}=this.heightMetrics(r,s),u=r.doc.lineAt(e),c=l+u.length*a,f=u.number-o,d=i+l*f+a*(u.from-s-f);return new Er(u.from,u.length,Math.max(i,Math.min(d,i+this.height-c)),c,0)}forEachLine(e,t,r,i,s,o){e=Math.max(e,s),t=Math.min(t,s+this.length);let{firstLine:l,perLine:a,perChar:u}=this.heightMetrics(r,s);for(let c=e,f=i;c<=t;){let d=r.doc.lineAt(c);if(c==e){let y=d.number-l;f+=a*y+u*(e-s-y)}let p=a+u*d.length;o(new Er(d.from,d.length,f,p,0)),f+=p,c=d.to+1}}replace(e,t,r){let i=this.length-t;if(i>0){let s=r[r.length-1];s instanceof At?r[r.length-1]=new At(s.length+i):r.push(null,new At(i-1))}if(e>0){let s=r[0];s instanceof At?r[0]=new At(e+s.length):r.unshift(new At(e-1),null)}return rn.of(r)}decomposeLeft(e,t){t.push(new At(e-1),null)}decomposeRight(e,t){t.push(null,new At(this.length-e-1))}updateHeight(e,t=0,r=!1,i){let s=t+this.length;if(i&&i.from<=t+this.length&&i.more){let o=[],l=Math.max(t,i.from),a=-1;for(i.from>t&&o.push(new At(i.from-t-1).updateHeight(e,t));l<=s&&i.more;){let c=e.doc.lineAt(l).length;o.length&&o.push(null);let f=i.heights[i.index++];a==-1?a=f:Math.abs(f-a)>=mf&&(a=-2);let d=new Cn(c,f);d.outdated=!1,o.push(d),l+=c+1}l<=s&&o.push(null,new At(s-l).updateHeight(e,l));let u=rn.of(o);return(a<0||Math.abs(u.height-this.height)>=mf||Math.abs(a-this.heightMetrics(e,t).perLine)>=mf)&&(Pl=!0),fd(this,u)}else(r||this.outdated)&&(this.setHeight(e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class r4 extends rn{constructor(e,t,r){super(e.length+t+r.length,e.height+r.height,t|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,t,r,i){let s=r+this.left.height;return e<s?this.left.blockAt(e,t,r,i):this.right.blockAt(e,t,s,i+this.left.length+this.break)}lineAt(e,t,r,i,s){let o=i+this.left.height,l=s+this.left.length+this.break,a=t==ze.ByHeight?e<o:e<l,u=a?this.left.lineAt(e,t,r,i,s):this.right.lineAt(e,t,r,o,l);if(this.break||(a?u.to<l:u.from>l))return u;let c=t==ze.ByPosNoHeight?ze.ByPosNoHeight:ze.ByPos;return a?u.join(this.right.lineAt(l,c,r,o,l)):this.left.lineAt(l,c,r,i,s).join(u)}forEachLine(e,t,r,i,s,o){let l=i+this.left.height,a=s+this.left.length+this.break;if(this.break)e<a&&this.left.forEachLine(e,t,r,i,s,o),t>=a&&this.right.forEachLine(e,t,r,l,a,o);else{let u=this.lineAt(a,ze.ByPos,r,i,s);e<u.from&&this.left.forEachLine(e,u.from-1,r,i,s,o),u.to>=e&&u.from<=t&&o(u),t>u.to&&this.right.forEachLine(u.to+1,t,r,l,a,o)}}replace(e,t,r){let i=this.left.length+this.break;if(t<i)return this.balanced(this.left.replace(e,t,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,t-i,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let l of r)s.push(l);if(e>0&&PS(s,o-1),t<this.length){let l=s.length;this.decomposeRight(t,s),PS(s,l)}return rn.of(s)}decomposeLeft(e,t){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(r++,e>=r&&t.push(null)),e>r&&this.right.decomposeLeft(e-r,t)}decomposeRight(e,t){let r=this.left.length,i=r+this.break;if(e>=i)return this.right.decomposeRight(e-i,t);e<r&&this.left.decomposeRight(e,t),this.break&&e<i&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?rn.of(this.break?[e,null,t]:[e,t]):(this.left=fd(this.left,e),this.right=fd(this.right,t),this.setHeight(e.height+t.height),this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,r=!1,i){let{left:s,right:o}=this,l=t+s.length+this.break,a=null;return i&&i.from<=t+s.length&&i.more?a=s=s.updateHeight(e,t,r,i):s.updateHeight(e,t,r),i&&i.from<=l+o.length&&i.more?a=o=o.updateHeight(e,l,r,i):o.updateHeight(e,l,r),a?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function PS(n,e){let t,r;n[e]==null&&(t=n[e-1])instanceof At&&(r=n[e+1])instanceof At&&n.splice(e-1,3,new At(t.length+1+r.length))}const i4=5;class w1{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let r=Math.min(t,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof Cn?i.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new Cn(r-this.pos,-1)),this.writtenTo=r,t>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,r){if(e<t||r.heightRelevant){let i=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=t-e;r.block?this.addBlock(new mI(o,i,r)):(o||s||i>=i4)&&this.addLineDeco(i,s,o)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Cn(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let r=new At(t-e);return this.oracle.doc.lineAt(e).to==t&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Cn)return e;let t=new Cn(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,r){let i=this.ensureLine();i.length+=r,i.collapsed+=r,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=t,this.writtenTo=this.pos=this.pos+r}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof Cn)&&!this.isCovered?this.nodes.push(new Cn(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let i of this.nodes)i instanceof Cn&&i.updateHeight(this.oracle,r),r+=i?i.length:1;return this.nodes}static build(e,t,r,i){let s=new w1(r,e);return xe.spans(t,r,i,s,0),s.finish(r)}}function s4(n,e,t){let r=new o4;return xe.compare(n,e,t,r,0),r.changes}class o4{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,r,i){(e<t||r&&r.heightRelevant||i&&i.heightRelevant)&&df(e,t,this.changes,5)}}function l4(n,e){let t=n.getBoundingClientRect(),r=n.ownerDocument,i=r.defaultView||window,s=Math.max(0,t.left),o=Math.min(i.innerWidth,t.right),l=Math.max(0,t.top),a=Math.min(i.innerHeight,t.bottom);for(let u=n.parentNode;u&&u!=r.body;)if(u.nodeType==1){let c=u,f=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&f.overflow!="visible"){let d=c.getBoundingClientRect();s=Math.max(s,d.left),o=Math.min(o,d.right),l=Math.max(l,d.top),a=Math.min(u==n.parentNode?i.innerHeight:a,d.bottom)}u=f.position=="absolute"||f.position=="fixed"?c.offsetParent:c.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:s-t.left,right:Math.max(s,o)-t.left,top:l-(t.top+e),bottom:Math.max(l,a)-(t.top+e)}}function a4(n){let e=n.getBoundingClientRect(),t=n.ownerDocument.defaultView||window;return e.left<t.innerWidth&&e.right>0&&e.top<t.innerHeight&&e.bottom>0}function u4(n,e){let t=n.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class tg{constructor(e,t,r,i){this.from=e,this.to=t,this.size=r,this.displaySize=i}static same(e,t){if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=t[r];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e,t){return ne.replace({widget:new c4(this.displaySize*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class c4 extends fi{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class RS{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=DS,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Ue.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(m1).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new t4(t),this.stateDeco=e.facet(Uu).filter(r=>typeof r!="function"),this.heightMap=rn.empty().applyChanges(this.stateDeco,Se.empty,this.heightOracle.setDoc(e.doc),[new Kn(0,0,0,e.doc.length)]);for(let r=0;r<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());r++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ne.set(this.lineGaps.map(r=>r.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let r=0;r<=1;r++){let i=r?t.head:t.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new xh(s,o))}}return this.viewports=e.sort((r,i)=>r.from-i.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?DS:new _1(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(Ha(e,this.scaler))})}update(e,t=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=this.state.facet(Uu).filter(c=>typeof c!="function");let i=e.changedRanges,s=Kn.extendWithRanges(i,s4(r,this.stateDeco,e?e.changes:pt.empty(this.state.doc.length))),o=this.heightMap.height,l=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);IS(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),(this.heightMap.height!=o||Pl)&&(e.flags|=2),l?(this.scrollAnchorPos=e.changes.mapPos(l.from,-1),this.scrollAnchorHeight=l.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let a=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<a.from||t.range.head>a.to)||!this.viewportIsAppropriate(a))&&(a=this.getViewport(0,t));let u=a.from!=this.viewport.from||a.to!=this.viewport.to;this.viewport=a,e.flags|=this.updateForViewport(),(u||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(e.changes),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(XA)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,r=window.getComputedStyle(t),i=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?Ue.RTL:Ue.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),l=t.getBoundingClientRect(),a=o||this.mustMeasureContent||this.contentDOMHeight!=l.height;this.contentDOMHeight=l.height,this.mustMeasureContent=!1;let u=0,c=0;if(l.width&&l.height){let{scaleX:I,scaleY:D}=kA(t,l);(I>.005&&Math.abs(this.scaleX-I)>.005||D>.005&&Math.abs(this.scaleY-D)>.005)&&(this.scaleX=I,this.scaleY=D,u|=16,o=a=!0)}let f=(parseInt(r.paddingTop)||0)*this.scaleY,d=(parseInt(r.paddingBottom)||0)*this.scaleY;(this.paddingTop!=f||this.paddingBottom!=d)&&(this.paddingTop=f,this.paddingBottom=d,u|=18),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(a=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=16);let p=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=p&&(this.scrollAnchorHeight=-1,this.scrollTop=p),this.scrolledToBottom=CA(e.scrollDOM);let y=(this.printing?u4:l4)(t,this.paddingTop),v=y.top-this.pixelViewport.top,E=y.bottom-this.pixelViewport.bottom;this.pixelViewport=y;let w=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(w!=this.inView&&(this.inView=w,w&&(a=!0)),!this.inView&&!this.scrollTarget&&!a4(e.dom))return 0;let _=l.width;if((this.contentDOMWidth!=_||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=l.width,this.editorHeight=e.scrollDOM.clientHeight,u|=16),a){let I=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(I)&&(o=!0),o||i.lineWrapping&&Math.abs(_-this.contentDOMWidth)>i.charWidth){let{lineHeight:D,charWidth:M,textHeight:x}=e.docView.measureTextSize();o=D>0&&i.refresh(s,D,M,x,_/M,I),o&&(e.docView.minWidth=0,u|=16)}v>0&&E>0?c=Math.max(v,E):v<0&&E<0&&(c=Math.min(v,E)),IS();for(let D of this.viewports){let M=D.from==this.viewport.from?I:e.docView.measureVisibleLineHeights(D);this.heightMap=(o?rn.empty().applyChanges(this.stateDeco,Se.empty,this.heightOracle,[new Kn(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new n4(D.from,M))}Pl&&(u|=2)}let b=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return b&&(u&2&&(u|=this.updateScaler()),this.viewport=this.getViewport(c,this.scrollTarget),u|=this.updateForViewport()),(u&2||b)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:l}=this,a=new xh(i.lineAt(o-r*1e3,ze.ByHeight,s,0,0).from,i.lineAt(l+(1-r)*1e3,ze.ByHeight,s,0,0).to);if(t){let{head:u}=t.range;if(u<a.from||u>a.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),f=i.lineAt(u,ze.ByPos,s,0,0),d;t.y=="center"?d=(f.top+f.bottom)/2-c/2:t.y=="start"||t.y=="nearest"&&u<a.from?d=f.top:d=f.bottom-c,a=new xh(i.lineAt(d-1e3/2,ze.ByHeight,s,0,0).from,i.lineAt(d+c+1e3/2,ze.ByHeight,s,0,0).to)}}return a}mapViewport(e,t){let r=t.mapPos(e.from,-1),i=t.mapPos(e.to,1);return new xh(this.heightMap.lineAt(r,ze.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,ze.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},r=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,ze.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(t,ze.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:l}=this;return(e==0||i<=o-Math.max(10,Math.min(-r,250)))&&(t==this.state.doc.length||s>=l+Math.max(10,Math.min(r,250)))&&i>o-2*1e3&&s<l+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let r=[];for(let i of e)t.touchesRange(i.from,i.to)||r.push(new tg(t.mapPos(i.from),t.mapPos(i.to),i.size,i.displaySize));return r}ensureLineGaps(e,t){let r=this.heightOracle.lineWrapping,i=r?1e4:2e3,s=i>>1,o=i<<1;if(this.defaultTextDirection!=Ue.LTR&&!r)return[];let l=[],a=(c,f,d,p)=>{if(f-c<s)return;let y=this.state.selection.main,v=[y.from];y.empty||v.push(y.to);for(let w of v)if(w>c&&w<f){a(c,w-10,d,p),a(w+10,f,d,p);return}let E=f4(e,w=>w.from>=d.from&&w.to<=d.to&&Math.abs(w.from-c)<s&&Math.abs(w.to-f)<s&&!v.some(_=>w.from<_&&w.to>_));if(!E){if(f<d.to&&t&&r&&t.visibleRanges.some(b=>b.from<=f&&b.to>=f)){let b=t.moveToLineBoundary(B.cursor(f),!1,!0).head;b>c&&(f=b)}let w=this.gapSize(d,c,f,p),_=r||w<2e6?w:2e6;E=new tg(c,f,w,_)}l.push(E)},u=c=>{if(c.length<o||c.type!=nn.Text)return;let f=h4(c.from,c.to,this.stateDeco);if(f.total<o)return;let d=this.scrollTarget?this.scrollTarget.range.head:null,p,y;if(r){let v=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,E,w;if(d!=null){let _=bh(f,d),b=((this.visibleBottom-this.visibleTop)/2+v)/c.height;E=_-b,w=_+b}else E=(this.visibleTop-c.top-v)/c.height,w=(this.visibleBottom-c.top+v)/c.height;p=Sh(f,E),y=Sh(f,w)}else{let v=f.total*this.heightOracle.charWidth,E=i*this.heightOracle.charWidth,w=0;if(v>2e6)for(let M of e)M.from>=c.from&&M.from<c.to&&M.size!=M.displaySize&&M.from*this.heightOracle.charWidth+w<this.pixelViewport.left&&(w=M.size-M.displaySize);let _=this.pixelViewport.left+w,b=this.pixelViewport.right+w,I,D;if(d!=null){let M=bh(f,d),x=((b-_)/2+E)/v;I=M-x,D=M+x}else I=(_-E)/v,D=(b+E)/v;p=Sh(f,I),y=Sh(f,D)}p>c.from&&a(c.from,p,c,f),y<c.to&&a(y,c.to,c,f)};for(let c of this.viewportLines)Array.isArray(c.type)?c.type.forEach(u):u(c);return l}gapSize(e,t,r,i){let s=bh(i,r)-bh(i,t);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){tg.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=ne.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(e){let t=this.stateDeco;this.lineGaps.length&&(t=t.concat(this.lineGapDeco));let r=[];xe.spans(t,this.viewport.from,this.viewport.to,{span(s,o){r.push({from:s,to:o})},point(){}},20);let i=0;if(r.length!=this.visibleRanges.length)i=12;else for(let s=0;s<r.length&&!(i&8);s++){let o=this.visibleRanges[s],l=r[s];(o.from!=l.from||o.to!=l.to)&&(i|=4,e&&e.mapPos(o.from,-1)==l.from&&e.mapPos(o.to,1)==l.to||(i|=8))}return this.visibleRanges=r,i}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||Ha(this.heightMap.lineAt(e,ze.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(t=>t.top<=e&&t.bottom>=e)||Ha(this.heightMap.lineAt(this.scaler.fromDOM(e),ze.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return Ha(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class xh{constructor(e,t){this.from=e,this.to=t}}function h4(n,e,t){let r=[],i=n,s=0;return xe.spans(t,n,e,{span(){},point(o,l){o>i&&(r.push({from:i,to:o}),s+=o-i),i=l}},20),i<e&&(r.push({from:i,to:e}),s+=e-i),{total:s,ranges:r}}function Sh({total:n,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let r=Math.floor(n*t);for(let i=0;;i++){let{from:s,to:o}=e[i],l=o-s;if(r<=l)return s+r;r-=l}}function bh(n,e){let t=0;for(let{from:r,to:i}of n.ranges){if(e<=i){t+=e-r;break}t+=i-r}return t/n.total}function f4(n,e){for(let t of n)if(e(t))return t}const DS={toDOM(n){return n},fromDOM(n){return n},scale:1,eq(n){return n==this}};class _1{constructor(e,t,r){let i=0,s=0,o=0;this.viewports=r.map(({from:l,to:a})=>{let u=t.lineAt(l,ze.ByPos,e,0,0).top,c=t.lineAt(a,ze.ByPos,e,0,0).bottom;return i+=c-u,{from:l,to:a,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(t.height-i);for(let l of this.viewports)l.domTop=o+(l.top-s)*this.scale,o=l.domBottom=l.domTop+(l.bottom-l.top),s=l.bottom}toDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.top)return i+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,i=s.domBottom}}fromDOM(e){for(let t=0,r=0,i=0;;t++){let s=t<this.viewports.length?this.viewports[t]:null;if(!s||e<s.domTop)return r+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,i=s.domBottom}}eq(e){return e instanceof _1?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((t,r)=>t.from==e.viewports[r].from&&t.to==e.viewports[r].to):!1}}function Ha(n,e){if(e.scale==1)return n;let t=e.toDOM(n.top),r=e.toDOM(n.bottom);return new Er(n.from,n.length,t,r-t,Array.isArray(n._content)?n._content.map(i=>Ha(i,e)):n._content)}const kh=G.define({combine:n=>n.join(" ")}),a0=G.define({combine:n=>n.indexOf(!0)>-1}),u0=Zi.newName(),gI=Zi.newName(),yI=Zi.newName(),vI={"&light":"."+gI,"&dark":"."+yI};function c0(n,e,t){return new Zi(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,i=>{if(i=="&")return n;if(!t||!t[i])throw new RangeError(`Unsupported selector: ${i}`);return t[i]}):n+" "+r}})}const d4=c0("."+u0,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},vI),p4={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},ng=Q.ie&&Q.ie_version<=11;class m4{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new JV,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let r of t)this.queue.push(r);(Q.ie&&Q.ie_version<=11||Q.ios&&e.composing)&&t.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(Q.chrome&&Q.chrome_version<126)&&(this.editContext=new y4(e),e.state.facet(Qr)&&(e.contentDOM.editContext=this.editContext.editContext)),ng&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,r)=>t!=e[r]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,i=this.selectionRange;if(r.state.facet(Qr)?r.root.activeElement!=this.dom:!ff(this.dom,i))return;let s=i.anchorNode&&r.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(Q.ie&&Q.ie_version<=11||Q.android&&Q.chrome)&&!r.state.selection.main.empty&&i.focusNode&&au(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=$u(e.root);if(!t)return!1;let r=Q.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&g4(this.view,t)||t;if(!r||this.selectionRange.eq(r))return!1;let i=ff(this.dom,r);return i&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&eL(this.dom,r)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(r),i&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let r=this.dom;r;)if(r.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=t)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,p4),ng&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),ng&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var r;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&ll(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,r=-1,i=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(i=!0),t==-1?{from:t,to:r}=o:(t=Math.min(o.from,t),r=Math.max(o.to,r)))}return{from:t,to:r,typeOver:i}}readChange(){let{from:e,to:t,typeOver:r}=this.processRecords(),i=this.selectionChanged&&ff(this.dom,this.selectionRange);if(e<0&&!i)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let s=new OL(this.view,e,t,r);return this.view.docView.domChanged={newSel:s.newSel?s.newSel.main:null},s}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let r=this.view.state,i=oI(this.view,t);return this.view.state==r&&(t.domChanged||t.newSel&&!t.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),i}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let r=OS(t,e.previousSibling||e.target.previousSibling,-1),i=OS(t,e.nextSibling||e.target.nextSibling,1);return{from:r?t.posAfter(r):t.posAtStart,to:i?t.posBefore(i):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(Qr)!=e.state.facet(Qr)&&(e.view.contentDOM.editContext=e.state.facet(Qr)?this.editContext.editContext:null))}destroy(){var e,t,r;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect();for(let i of this.scrollTargets)i.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function OS(n,e,t){for(;e;){let r=Ne.get(e);if(r&&r.parent==n)return r;let i=e.parentNode;e=i!=n.dom?i:t>0?e.nextSibling:e.previousSibling}return null}function MS(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,s=e.endOffset,o=n.docView.domAtPos(n.state.selection.main.anchor);return au(o.node,o.offset,i,s)&&([t,r,i,s]=[i,s,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:s}}function g4(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return MS(n,i)}let t=null;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.contentDOM.addEventListener("beforeinput",r,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",r,!0),t?MS(n,t):null}class y4{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let t=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=r=>{let i=e.state.selection.main,{anchor:s,head:o}=i,l=this.toEditorPos(r.updateRangeStart),a=this.toEditorPos(r.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:r.updateRangeStart,editorBase:l,drifted:!1});let u={from:l,to:a,insert:Se.of(r.text.split(`
`))};if(u.from==this.from&&s<this.from?u.from=s:u.to==this.to&&s>this.to&&(u.to=s),u.from==u.to&&!u.insert.length){let c=B.single(this.toEditorPos(r.selectionStart),this.toEditorPos(r.selectionEnd));c.main.eq(i)||e.dispatch({selection:c,userEvent:"select"});return}if((Q.mac||Q.android)&&u.from==o-1&&/^\. ?$/.test(r.text)&&e.contentDOM.getAttribute("autocorrect")=="off"&&(u={from:l,to:a,insert:Se.of([r.text.replace("."," ")])}),this.pendingContextChange=u,!e.state.readOnly){let c=this.to-this.from+(u.to-u.from+u.insert.length);v1(e,u,B.single(this.toEditorPos(r.selectionStart,c),this.toEditorPos(r.selectionEnd,c)))}this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state))},this.handlers.characterboundsupdate=r=>{let i=[],s=null;for(let o=this.toEditorPos(r.rangeStart),l=this.toEditorPos(r.rangeEnd);o<l;o++){let a=e.coordsForChar(o);s=a&&new DOMRect(a.left,a.top,a.right-a.left,a.bottom-a.top)||s||new DOMRect,i.push(s)}t.updateCharacterBounds(r.rangeStart,i)},this.handlers.textformatupdate=r=>{let i=[];for(let s of r.getTextFormats()){let o=s.underlineStyle,l=s.underlineThickness;if(o!="None"&&l!="None"){let a=this.toEditorPos(s.rangeStart),u=this.toEditorPos(s.rangeEnd);if(a<u){let c=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${l=="Thin"?1:2}px`;i.push(ne.mark({attributes:{style:c}}).range(a,u))}}}e.dispatch({effects:ZA.of(ne.set(i))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:r}=this.composing;this.composing=null,r&&this.reset(e.state)}};for(let r in this.handlers)t.addEventListener(r,this.handlers[r]);this.measureReq={read:r=>{this.editContext.updateControlBounds(r.contentDOM.getBoundingClientRect());let i=$u(r.root);i&&i.rangeCount&&this.editContext.updateSelectionBounds(i.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let t=0,r=!1,i=this.pendingContextChange;return e.changes.iterChanges((s,o,l,a,u)=>{if(r)return;let c=u.length-(o-s);if(i&&o>=i.to)if(i.from==s&&i.to==o&&i.insert.eq(u)){i=this.pendingContextChange=null,t+=c,this.to+=c;return}else i=null,this.revertPending(e.state);if(s+=t,o+=t,o<=this.from)this.from+=c,this.to+=c;else if(s<this.to){if(s<this.from||o>this.to||this.to-this.from+u.length>3e4){r=!0;return}this.editContext.updateText(this.toContextPos(s),this.toContextPos(o),u.toString()),this.to+=c}t+=c}),i&&!r&&this.revertPending(e.state),!r}update(e){let t=this.pendingContextChange,r=e.startState.selection.main;this.composing&&(this.composing.drifted||!e.changes.touchesRange(r.from,r.to)&&e.transactions.some(i=>!i.isUserEvent("input.type")&&i.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||t)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:t}=e.selection.main;this.from=Math.max(0,t-1e4),this.to=Math.min(e.doc.length,t+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let t=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(t.from),this.toContextPos(t.from+t.insert.length),e.doc.sliceString(t.from,t.to))}setSelection(e){let{main:t}=e.selection,r=this.toContextPos(Math.max(this.from,Math.min(this.to,t.anchor))),i=this.toContextPos(t.head);(this.editContext.selectionStart!=r||this.editContext.selectionEnd!=i)&&this.editContext.updateSelection(r,i)}rangeIsValid(e){let{head:t}=e.selection.main;return!(this.from>0&&t-this.from<500||this.to<e.doc.length&&this.to-t<500||this.to-this.from>1e4*3)}toEditorPos(e,t=this.to-this.from){e=Math.min(e,t);let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let t=this.composing;return t&&t.drifted?t.contextBase+(e-t.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class q{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var t;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:r}=e;this.dispatchTransactions=e.dispatchTransactions||r&&(i=>i.forEach(s=>r(s,this)))||(i=>this.update(i)),this.dispatch=this.dispatch.bind(this),this._root=e.root||ZV(e.parent)||document,this.viewState=new RS(e.state||ye.create(e)),e.scrollTo&&e.scrollTo.is(vh)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet($a).map(i=>new Jm(i));for(let i of this.plugins)i.update(this);this.observer=new m4(this),this.inputState=new BL(this),this.inputState.ensureHandlers(this.plugins),this.docView=new fS(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((t=document.fonts)===null||t===void 0)&&t.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let t=e.length==1&&e[0]instanceof gt?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,r=!1,i,s=this.state;for(let d of e){if(d.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=d.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,l=0,a=null;e.some(d=>d.annotation(fI))?(this.inputState.notifiedFocused=o,l=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,a=dI(s,o),a||(l=1));let u=this.observer.delayedAndroidKey,c=null;if(u?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(ye.phrases)!=this.state.facet(ye.phrases))return this.setState(s);i=hd.create(this,s,e),i.flags|=l;let f=this.viewState.scrollTarget;try{this.updateState=2;for(let d of e){if(f&&(f=f.map(d.changes)),d.scrollIntoView){let{main:p}=d.state.selection;f=new al(p.empty?p:B.cursor(p.head,p.head>p.anchor?-1:1))}for(let p of d.effects)p.is(vh)&&(f=p.value.clip(this.state))}this.viewState.update(i,f),this.bidiCache=dd.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),t=this.docView.update(i),this.state.facet(Ua)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some(d=>d.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(kh)!=i.state.facet(kh)&&(this.viewState.mustMeasureContent=!0),(t||r||f||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),t&&this.docViewUpdate(),!i.empty)for(let d of this.state.facet(i0))try{d(i)}catch(p){gn(this.state,p,"update listener")}(a||c)&&Promise.resolve().then(()=>{a&&this.state==a.startState&&this.dispatch(a),c&&!oI(this,c)&&u.force&&ll(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new RS(e),this.plugins=e.facet($a).map(r=>new Jm(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView.destroy(),this.docView=new fS(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet($a),r=e.state.facet($a);if(t!=r){let i=[];for(let s of r){let o=t.indexOf(s);if(o<0)i.push(new Jm(s));else{let l=this.plugins[o];l.mustUpdate=e,i.push(l)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear()}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this);t!=r&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let t=e.value;if(t&&t.docViewUpdate)try{t.docViewUpdate(this)}catch(r){gn(this.state,r,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,r=this.scrollDOM,i=r.scrollTop*this.scaleY,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;Math.abs(i-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let l=0;;l++){if(o<0)if(CA(r))s=-1,o=this.viewState.heightMap.height;else{let p=this.viewState.scrollAnchorAt(i);s=p.from,o=p.top}this.updateState=1;let a=this.viewState.measure(this);if(!a&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(l>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];a&4||([this.measureRequests,u]=[u,this.measureRequests]);let c=u.map(p=>{try{return p.read(this)}catch(y){return gn(this.state,y),NS}}),f=hd.create(this,this.state,[]),d=!1;f.flags|=a,t?t.flags|=a:t=f,this.updateState=2,f.empty||(this.updatePlugins(f),this.inputState.update(f),this.updateAttrs(),d=this.docView.update(f),d&&this.docViewUpdate());for(let p=0;p<u.length;p++)if(c[p]!=NS)try{let y=u[p];y.write&&y.write(c[p],this)}catch(y){gn(this.state,y)}if(d&&this.docView.updateSelection(!0),!f.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let y=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(y>1||y<-1){i=i+y,r.scrollTop=i/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let l of this.state.facet(i0))l(t)}get themeClasses(){return u0+" "+(this.state.facet(a0)?yI:gI)+" "+this.state.facet(kh)}updateAttrs(){let e=VS(this,eI,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(Qr)?"true":"false",class:"cm-content",style:`${Q.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),VS(this,m1,t);let r=this.observer.ignore(()=>{let i=Zy(this.contentDOM,this.contentAttrs,t),s=Zy(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=t,r}showAnnouncements(e){let t=!0;for(let r of e)for(let i of r.effects)if(i.is(q.announce)){t&&(this.announceDOM.textContent=""),t=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(Ua);let e=this.state.facet(q.cspNonce);Zi.mount(this.root,this.styleModules.concat(d4).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(r=>r.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,r){return eg(this,e,yS(this,e,t,r))}moveByGroup(e,t){return eg(this,e,yS(this,e,t,r=>IL(this,e.head,r)))}visualLineSide(e,t){let r=this.bidiSpans(e),i=this.textDirectionAt(e.from),s=r[t?r.length-1:0];return B.cursor(s.side(t,i)+e.from,s.forward(!t,i)?1:-1)}moveToLineBoundary(e,t,r=!0){return AL(this,e,t,r)}moveVertically(e,t,r){return eg(this,e,PL(this,e,t,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),sI(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let r=this.docView.coordsAt(e,t);if(!r||r.left==r.right)return r;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),o=s[Mi.find(s,e-i.from,-1,t)];return wc(r,o.dir==Ue.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(YA)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>v4)return UA(e.length);let t=this.textDirectionAt(e.from),r;for(let s of this.bidiCache)if(s.from==e.from&&s.dir==t&&(s.fresh||$A(s.isolates,r=hS(this,e))))return s.order;r||(r=hS(this,e));let i=fL(e.text,t,r);return this.bidiCache.push(new dd(e.from,e.to,t,r,!0,i)),i}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Q.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{EA(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return vh.of(new al(typeof e=="number"?B.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,r=this.viewState.scrollAnchorAt(e);return vh.of(new al(B.cursor(r.from),"start","start",r.top-e,t,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return st.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return st.define(()=>({}),{eventObservers:e})}static theme(e,t){let r=Zi.newName(),i=[kh.of(r),Ua.of(c0(`.${r}`,e))];return t&&t.dark&&i.push(a0.of(!0)),i}static baseTheme(e){return mo.lowest(Ua.of(c0("."+u0,e,vI)))}static findFromDOM(e){var t;let r=e.querySelector(".cm-content"),i=r&&Ne.get(r)||Ne.get(e);return((t=i==null?void 0:i.rootView)===null||t===void 0?void 0:t.view)||null}}q.styleModule=Ua;q.inputHandler=QA;q.clipboardInputFilter=d1;q.clipboardOutputFilter=p1;q.scrollHandler=JA;q.focusChangeEffect=GA;q.perLineTextDirection=YA;q.exceptionSink=KA;q.updateListener=i0;q.editable=Qr;q.mouseSelectionStyle=qA;q.dragMovesSelection=WA;q.clickAddsSelectionRange=HA;q.decorations=Uu;q.outerDecorations=tI;q.atomicRanges=g1;q.bidiIsolatedRanges=nI;q.scrollMargins=rI;q.darkTheme=a0;q.cspNonce=G.define({combine:n=>n.length?n[0]:""});q.contentAttributes=m1;q.editorAttributes=eI;q.lineWrapping=q.contentAttributes.of({class:"cm-lineWrapping"});q.announce=ue.define();const v4=4096,NS={};class dd{constructor(e,t,r,i,s,o){this.from=e,this.to=t,this.dir=r,this.isolates=i,this.fresh=s,this.order=o}static update(e,t){if(t.empty&&!e.some(s=>s.fresh))return e;let r=[],i=e.length?e[e.length-1].dir:Ue.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!t.touchesRange(o.from,o.to)&&r.push(new dd(t.mapPos(o.from,1),t.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return r}}function VS(n,e,t){for(let r=n.state.facet(e),i=r.length-1;i>=0;i--){let s=r[i],o=typeof s=="function"?s(n):s;o&&Jy(o,t)}return t}const w4=Q.mac?"mac":Q.windows?"win":Q.linux?"linux":"key";function _4(n,e){const t=n.split(/-(?!$)/);let r=t[t.length-1];r=="Space"&&(r=" ");let i,s,o,l;for(let a=0;a<t.length-1;++a){const u=t[a];if(/^(cmd|meta|m)$/i.test(u))l=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))e=="mac"?l=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return i&&(r="Alt-"+r),s&&(r="Ctrl-"+r),l&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function Eh(n,e,t){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t!==!1&&e.shiftKey&&(n="Shift-"+n),n}const x4=mo.default(q.domEventHandlers({keydown(n,e){return _I(wI(e.state),n,e,"editor")}})),bp=G.define({enables:x4}),LS=new WeakMap;function wI(n){let e=n.facet(bp),t=LS.get(e);return t||LS.set(e,t=k4(e.reduce((r,i)=>r.concat(i),[]))),t}function S4(n,e,t){return _I(wI(n.state),e,n,t)}let Ci=null;const b4=4e3;function k4(n,e=w4){let t=Object.create(null),r=Object.create(null),i=(o,l)=>{let a=r[o];if(a==null)r[o]=l;else if(a!=l)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,l,a,u,c)=>{var f,d;let p=t[o]||(t[o]=Object.create(null)),y=l.split(/ (?!$)/).map(w=>_4(w,e));for(let w=1;w<y.length;w++){let _=y.slice(0,w).join(" ");i(_,!0),p[_]||(p[_]={preventDefault:!0,stopPropagation:!1,run:[b=>{let I=Ci={view:b,prefix:_,scope:o};return setTimeout(()=>{Ci==I&&(Ci=null)},b4),!0}]})}let v=y.join(" ");i(v,!1);let E=p[v]||(p[v]={preventDefault:!1,stopPropagation:!1,run:((d=(f=p._any)===null||f===void 0?void 0:f.run)===null||d===void 0?void 0:d.slice())||[]});a&&E.run.push(a),u&&(E.preventDefault=!0),c&&(E.stopPropagation=!0)};for(let o of n){let l=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of l){let c=t[u]||(t[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:f}=o;for(let d in c)c[d].run.push(p=>f(p,h0))}let a=o[e]||o.key;if(a)for(let u of l)s(u,a,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+a,o.shift,o.preventDefault,o.stopPropagation)}return t}let h0=null;function _I(n,e,t,r){h0=e;let i=QV(e),s=hn(i,0),o=kr(s)==i.length&&i!=" ",l="",a=!1,u=!1,c=!1;Ci&&Ci.view==t&&Ci.scope==r&&(l=Ci.prefix+" ",aI.indexOf(e.keyCode)<0&&(u=!0,Ci=null));let f=new Set,d=E=>{if(E){for(let w of E.run)if(!f.has(w)&&(f.add(w),w(t)))return E.stopPropagation&&(c=!0),!0;E.preventDefault&&(E.stopPropagation&&(c=!0),u=!0)}return!1},p=n[r],y,v;return p&&(d(p[l+Eh(i,e,!o)])?a=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Q.windows&&e.ctrlKey&&e.altKey)&&(y=es[e.keyCode])&&y!=i?(d(p[l+Eh(y,e,!0)])||e.shiftKey&&(v=zu[e.keyCode])!=i&&v!=y&&d(p[l+Eh(v,e,!1)]))&&(a=!0):o&&e.shiftKey&&d(p[l+Eh(i,e,!0)])&&(a=!0),!a&&d(p._any)&&(a=!0)),u&&(a=!0),a&&c&&e.stopPropagation(),h0=null,a}class Sc{constructor(e,t,r,i,s){this.className=e,this.left=t,this.top=r,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,r){if(r.empty){let i=e.coordsAtPos(r.head,r.assoc||1);if(!i)return[];let s=xI(e);return[new Sc(t,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return E4(e,t,r)}}function xI(n){let e=n.scrollDOM.getBoundingClientRect();return{left:(n.textDirection==Ue.LTR?e.left:e.right-n.scrollDOM.clientWidth*n.scaleX)-n.scrollDOM.scrollLeft*n.scaleX,top:e.top-n.scrollDOM.scrollTop*n.scaleY}}function BS(n,e,t,r){let i=n.coordsAtPos(e,t*2);if(!i)return r;let s=n.dom.getBoundingClientRect(),o=(i.top+i.bottom)/2,l=n.posAtCoords({x:s.left+1,y:o}),a=n.posAtCoords({x:s.right-1,y:o});return l==null||a==null?r:{from:Math.max(r.from,Math.min(l,a)),to:Math.min(r.to,Math.max(l,a))}}function E4(n,e,t){if(t.to<=n.viewport.from||t.from>=n.viewport.to)return[];let r=Math.max(t.from,n.viewport.from),i=Math.min(t.to,n.viewport.to),s=n.textDirection==Ue.LTR,o=n.contentDOM,l=o.getBoundingClientRect(),a=xI(n),u=o.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),f=l.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),d=l.right-(c?parseInt(c.paddingRight):0),p=o0(n,r),y=o0(n,i),v=p.type==nn.Text?p:null,E=y.type==nn.Text?y:null;if(v&&(n.lineWrapping||p.widgetLineBreaks)&&(v=BS(n,r,1,v)),E&&(n.lineWrapping||y.widgetLineBreaks)&&(E=BS(n,i,-1,E)),v&&E&&v.from==E.from&&v.to==E.to)return _(b(t.from,t.to,v));{let D=v?b(t.from,null,v):I(p,!1),M=E?b(null,t.to,E):I(y,!0),x=[];return(v||p).to<(E||y).from-(v&&E?1:0)||p.widgetLineBreaks>1&&D.bottom+n.defaultLineHeight/2<M.top?x.push(w(f,D.bottom,d,M.top)):D.bottom<M.top&&n.elementAtHeight((D.bottom+M.top)/2).type==nn.Text&&(D.bottom=M.top=(D.bottom+M.top)/2),_(D).concat(x).concat(_(M))}function w(D,M,x,S){return new Sc(e,D-a.left,M-a.top,x-D,S-M)}function _({top:D,bottom:M,horizontal:x}){let S=[];for(let T=0;T<x.length;T+=2)S.push(w(x[T],D,x[T+1],M));return S}function b(D,M,x){let S=1e9,T=-1e9,C=[];function P(re,ce,Te,ae,U){let H=n.coordsAtPos(re,re==x.to?-2:2),J=n.coordsAtPos(Te,Te==x.from?2:-2);!H||!J||(S=Math.min(H.top,J.top,S),T=Math.max(H.bottom,J.bottom,T),U==Ue.LTR?C.push(s&&ce?f:H.left,s&&ae?d:J.right):C.push(!s&&ae?f:J.left,!s&&ce?d:H.right))}let R=D??x.from,A=M??x.to;for(let re of n.visibleRanges)if(re.to>R&&re.from<A)for(let ce=Math.max(re.from,R),Te=Math.min(re.to,A);;){let ae=n.state.doc.lineAt(ce);for(let U of n.bidiSpans(ae)){let H=U.from+ae.from,J=U.to+ae.from;if(H>=Te)break;J>ce&&P(Math.max(H,ce),D==null&&H<=R,Math.min(J,Te),M==null&&J>=A,U.dir)}if(ce=ae.to+1,ce>=Te)break}return C.length==0&&P(R,D==null,A,M==null,n.textDirection),{top:S,bottom:T,horizontal:C}}function I(D,M){let x=l.top+(M?D.top:D.bottom);return{top:x,bottom:x,horizontal:[]}}}function T4(n,e){return n.constructor==e.constructor&&n.eq(e)}class C4{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(gf)!=e.state.facet(gf)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let t=0,r=e.facet(gf);for(;t<r.length&&r[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,r)=>!T4(t,this.drawn[r]))){let t=this.dom.firstChild,r=0;for(let i of e)i.update&&t&&i.constructor&&this.drawn[r].constructor&&i.update(t,this.drawn[r])?(t=t.nextSibling,r++):this.dom.insertBefore(i.draw(),t);for(;t;){let i=t.nextSibling;t.remove(),t=i}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const gf=G.define();function SI(n){return[st.define(e=>new C4(e,n)),gf.of(n)]}const bI=!(Q.ios&&Q.webkit&&Q.webkit_version<534),ju=G.define({combine(n){return Lr(n,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function A4(n={}){return[ju.of(n),I4,P4,R4,XA.of(!0)]}function kI(n){return n.startState.facet(ju)!=n.state.facet(ju)}const I4=SI({above:!0,markers(n){let{state:e}=n,t=e.facet(ju),r=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty?!s||bI:t.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",l=i.empty?i:B.cursor(i.head,i.head>i.anchor?-1:1);for(let a of Sc.forRange(n,o,l))r.push(a)}}return r},update(n,e){n.transactions.some(r=>r.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=kI(n);return t&&FS(n.state,e),n.docChanged||n.selectionSet||t},mount(n,e){FS(e.state,n)},class:"cm-cursorLayer"});function FS(n,e){e.style.animationDuration=n.facet(ju).cursorBlinkRate+"ms"}const P4=SI({above:!1,markers(n){return n.state.selection.ranges.map(e=>e.empty?[]:Sc.forRange(n,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(n,e){return n.docChanged||n.selectionSet||n.viewportChanged||kI(n)},class:"cm-selectionLayer"}),f0={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};bI&&(f0[".cm-line"].caretColor=f0[".cm-content"].caretColor="transparent !important");const R4=mo.highest(q.theme(f0)),EI=ue.define({map(n,e){return n==null?null:e.mapPos(n)}}),Wa=Vt.define({create(){return null},update(n,e){return n!=null&&(n=e.changes.mapPos(n)),e.effects.reduce((t,r)=>r.is(EI)?r.value:t,n)}}),D4=st.fromClass(class{constructor(n){this.view=n,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(n){var e;let t=n.state.field(Wa);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(n.startState.field(Wa)!=t||n.docChanged||n.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:n}=this,e=n.state.field(Wa),t=e!=null&&n.coordsAtPos(e);if(!t)return null;let r=n.scrollDOM.getBoundingClientRect();return{left:t.left-r.left+n.scrollDOM.scrollLeft*n.scaleX,top:t.top-r.top+n.scrollDOM.scrollTop*n.scaleY,height:t.bottom-t.top}}drawCursor(n){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;n?(this.cursor.style.left=n.left/e+"px",this.cursor.style.top=n.top/t+"px",this.cursor.style.height=n.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(n){this.view.state.field(Wa)!=n&&this.view.dispatch({effects:EI.of(n)})}},{eventObservers:{dragover(n){this.setDropPos(this.view.posAtCoords({x:n.clientX,y:n.clientY}))},dragleave(n){(n.target==this.view.contentDOM||!this.view.contentDOM.contains(n.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function O4(){return[Wa,D4]}function zS(n,e,t,r,i){e.lastIndex=0;for(let s=n.iterRange(t,r),o=t,l;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;l=e.exec(s.value);)i(o+l.index,l)}function M4(n,e){let t=n.visibleRanges;if(t.length==1&&t[0].from==n.viewport.from&&t[0].to==n.viewport.to)return t;let r=[];for(let{from:i,to:s}of t)i=Math.max(n.state.doc.lineAt(i).from,i-e),s=Math.min(n.state.doc.lineAt(s).to,s+e),r.length&&r[r.length-1].to>=i?r[r.length-1].to=s:r.push({from:i,to:s});return r}class N4{constructor(e){const{regexp:t,decoration:r,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,i)this.addMatch=(l,a,u,c)=>i(c,u,u+l[0].length,l,a);else if(typeof r=="function")this.addMatch=(l,a,u,c)=>{let f=r(l,a,u);f&&c(u,u+l[0].length,f)};else if(r)this.addMatch=(l,a,u,c)=>c(u,u+l[0].length,r);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let t=new si,r=t.add.bind(t);for(let{from:i,to:s}of M4(e,this.maxLength))zS(e.state.doc,this.regexp,i,s,(o,l)=>this.addMatch(l,e,o,r));return t.finish()}updateDeco(e,t){let r=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,l,a)=>{a>=e.view.viewport.from&&l<=e.view.viewport.to&&(r=Math.min(l,r),i=Math.max(a,i))}),e.viewportMoved||i-r>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,t.map(e.changes),r,i):t}updateRange(e,t,r,i){for(let s of e.visibleRanges){let o=Math.max(s.from,r),l=Math.min(s.to,i);if(l>o){let a=e.state.doc.lineAt(o),u=a.to<l?e.state.doc.lineAt(l):a,c=Math.max(s.from,a.from),f=Math.min(s.to,u.to);if(this.boundary){for(;o>a.from;o--)if(this.boundary.test(a.text[o-1-a.from])){c=o;break}for(;l<u.to;l++)if(this.boundary.test(u.text[l-u.from])){f=l;break}}let d=[],p,y=(v,E,w)=>d.push(w.range(v,E));if(a==u)for(this.regexp.lastIndex=c-a.from;(p=this.regexp.exec(a.text))&&p.index<f-a.from;)this.addMatch(p,e,p.index+a.from,y);else zS(e.state.doc,this.regexp,c,f,(v,E)=>this.addMatch(E,e,v,y));t=t.update({filterFrom:c,filterTo:f,filter:(v,E)=>v<c||E>f,add:d})}}return t}}const d0=/x/.unicode!=null?"gu":"g",V4=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,d0),L4={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let rg=null;function B4(){var n;if(rg==null&&typeof document<"u"&&document.body){let e=document.body.style;rg=((n=e.tabSize)!==null&&n!==void 0?n:e.MozTabSize)!=null}return rg||!1}const yf=G.define({combine(n){let e=Lr(n,{render:null,specialChars:V4,addSpecialChars:null});return(e.replaceTabs=!B4())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,d0)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,d0)),e}});function F4(n={}){return[yf.of(n),z4()]}let $S=null;function z4(){return $S||($S=st.fromClass(class{constructor(n){this.view=n,this.decorations=ne.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(n.state.facet(yf)),this.decorations=this.decorator.createDeco(n)}makeDecorator(n){return new N4({regexp:n.specialChars,decoration:(e,t,r)=>{let{doc:i}=t.state,s=hn(e[0],0);if(s==9){let o=i.lineAt(r),l=t.state.tabSize,a=Kl(o.text,l,r-o.from);return ne.replace({widget:new H4((l-a%l)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[s]||(this.decorationCache[s]=ne.replace({widget:new j4(n,s)}))},boundary:n.replaceTabs?void 0:/[^]/})}update(n){let e=n.state.facet(yf);n.startState.facet(yf)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(n.view)):this.decorations=this.decorator.updateDeco(n,this.decorations)}},{decorations:n=>n.decorations}))}const $4="";function U4(n){return n>=32?$4:n==10?"":String.fromCharCode(9216+n)}class j4 extends fi{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=U4(this.code),r=e.state.phrase("Control character")+" "+(L4[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,t);if(i)return i;let s=document.createElement("span");return s.textContent=t,s.title=r,s.setAttribute("aria-label",r),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class H4 extends fi{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function W4(){return K4}const q4=ne.line({class:"cm-activeLine"}),K4=st.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.docChanged||n.selectionSet)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=-1,t=[];for(let r of n.state.selection.ranges){let i=n.lineBlockAt(r.head);i.from>e&&(t.push(q4.range(i.from)),e=i.from)}return ne.set(t)}},{decorations:n=>n.decorations});class Q4 extends fi{constructor(e){super(),this.content=e}toDOM(e){let t=document.createElement("span");return t.className="cm-placeholder",t.style.pointerEvents="none",t.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(e):this.content.cloneNode(!0)),typeof this.content=="string"?t.setAttribute("aria-label","placeholder "+this.content):t.setAttribute("aria-hidden","true"),t}coordsAt(e){let t=e.firstChild?Cl(e.firstChild):[];if(!t.length)return null;let r=window.getComputedStyle(e.parentNode),i=wc(t[0],r.direction!="rtl"),s=parseInt(r.lineHeight);return i.bottom-i.top>s*1.5?{left:i.left,right:i.right,top:i.top,bottom:i.top+s}:i}ignoreEvent(){return!1}}function G4(n){return st.fromClass(class{constructor(e){this.view=e,this.placeholder=n?ne.set([ne.widget({widget:new Q4(n),side:1}).range(0)]):ne.none}get decorations(){return this.view.state.doc.length?ne.none:this.placeholder}},{decorations:e=>e.decorations})}const p0=2e3;function Y4(n,e,t){let r=Math.min(e.line,t.line),i=Math.max(e.line,t.line),s=[];if(e.off>p0||t.off>p0||e.col<0||t.col<0){let o=Math.min(e.off,t.off),l=Math.max(e.off,t.off);for(let a=r;a<=i;a++){let u=n.doc.line(a);u.length<=l&&s.push(B.range(u.from+o,u.to+l))}}else{let o=Math.min(e.col,t.col),l=Math.max(e.col,t.col);for(let a=r;a<=i;a++){let u=n.doc.line(a),c=Wy(u.text,o,n.tabSize,!0);if(c<0)s.push(B.cursor(u.to));else{let f=Wy(u.text,l,n.tabSize);s.push(B.range(u.from+c,u.from+f))}}}return s}function X4(n,e){let t=n.coordsAtPos(n.viewport.from);return t?Math.round(Math.abs((t.left-e)/n.defaultCharacterWidth)):-1}function US(n,e){let t=n.posAtCoords({x:e.clientX,y:e.clientY},!1),r=n.state.doc.lineAt(t),i=t-r.from,s=i>p0?-1:i==r.length?X4(n,e.clientX):Kl(r.text,n.state.tabSize,t-r.from);return{line:r.number,col:s,off:i}}function J4(n,e){let t=US(n,e),r=n.state.selection;return t?{update(i){if(i.docChanged){let s=i.changes.mapPos(i.startState.doc.line(t.line).from),o=i.state.doc.lineAt(s);t={line:o.number,col:t.col,off:Math.min(t.off,o.length)},r=r.map(i.changes)}},get(i,s,o){let l=US(n,i);if(!l)return r;let a=Y4(n.state,t,l);return a.length?o?B.create(a.concat(r.ranges)):B.create(a):r}}:null}function Z4(n){let e=t=>t.altKey&&t.button==0;return q.mouseSelectionStyle.of((t,r)=>e(r)?J4(t,r):null)}const eB={Alt:[18,n=>!!n.altKey],Control:[17,n=>!!n.ctrlKey],Shift:[16,n=>!!n.shiftKey],Meta:[91,n=>!!n.metaKey]},tB={style:"cursor: crosshair"};function nB(n={}){let[e,t]=eB[n.key||"Alt"],r=st.fromClass(class{constructor(i){this.view=i,this.isDown=!1}set(i){this.isDown!=i&&(this.isDown=i,this.view.update([]))}},{eventObservers:{keydown(i){this.set(i.keyCode==e||t(i))},keyup(i){(i.keyCode==e||!t(i))&&this.set(!1)},mousemove(i){this.set(t(i))}}});return[r,q.contentAttributes.of(i=>{var s;return!((s=i.plugin(r))===null||s===void 0)&&s.isDown?tB:null})]}const Ea="-10000px";class TI{constructor(e,t,r,i){this.facet=t,this.createTooltipView=r,this.removeTooltipView=i,this.input=e.state.facet(t),this.tooltips=this.input.filter(o=>o);let s=null;this.tooltipViews=this.tooltips.map(o=>s=r(o,s))}update(e,t){var r;let i=e.state.facet(this.facet),s=i.filter(a=>a);if(i===this.input){for(let a of this.tooltipViews)a.update&&a.update(e);return!1}let o=[],l=t?[]:null;for(let a=0;a<s.length;a++){let u=s[a],c=-1;if(u){for(let f=0;f<this.tooltips.length;f++){let d=this.tooltips[f];d&&d.create==u.create&&(c=f)}if(c<0)o[a]=this.createTooltipView(u,a?o[a-1]:null),l&&(l[a]=!!u.above);else{let f=o[a]=this.tooltipViews[c];l&&(l[a]=t[c]),f.update&&f.update(e)}}}for(let a of this.tooltipViews)o.indexOf(a)<0&&(this.removeTooltipView(a),(r=a.destroy)===null||r===void 0||r.call(a));return t&&(l.forEach((a,u)=>t[u]=a),t.length=l.length),this.input=i,this.tooltips=s,this.tooltipViews=o,!0}}function rB(n){let e=n.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:e.clientHeight,right:e.clientWidth}}const ig=G.define({combine:n=>{var e,t,r;return{position:Q.ios?"absolute":((e=n.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=n.find(i=>i.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((r=n.find(i=>i.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||rB}}}),jS=new WeakMap,x1=st.fromClass(class{constructor(n){this.view=n,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=n.state.facet(ig);this.position=e.position,this.parent=e.parent,this.classes=n.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new TI(n,S1,(t,r)=>this.createTooltip(t,r),t=>{this.resizeObserver&&this.resizeObserver.unobserve(t.dom),t.dom.remove()}),this.above=this.manager.tooltips.map(t=>!!t.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),n.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let n of this.manager.tooltipViews)this.intersectionObserver.observe(n.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(n){n.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(n,this.above);e&&this.observeIntersection();let t=e||n.geometryChanged,r=n.state.facet(ig);if(r.position!=this.position&&!this.madeAbsolute){this.position=r.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;t=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(n,e){let t=n.create(this.view),r=e?e.dom:null;if(t.dom.classList.add("cm-tooltip"),n.arrow&&!t.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let i=document.createElement("div");i.className="cm-tooltip-arrow",t.dom.appendChild(i)}return t.dom.style.position=this.position,t.dom.style.top=Ea,t.dom.style.left="0px",this.container.insertBefore(t.dom,r),t.mount&&t.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(t.dom),t}destroy(){var n,e,t;this.view.win.removeEventListener("resize",this.measureSoon);for(let r of this.manager.tooltipViews)r.dom.remove(),(n=r.destroy)===null||n===void 0||n.call(r);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.intersectionObserver)===null||t===void 0||t.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let n=1,e=1,t=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(Q.gecko)t=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Ea&&s.style.left=="0px"){let o=s.getBoundingClientRect();t=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(t||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(n=s.width/this.parent.offsetWidth,e=s.height/this.parent.offsetHeight)}else({scaleX:n,scaleY:e}=this.view.viewState);let r=this.view.scrollDOM.getBoundingClientRect(),i=y1(this.view);return{visible:{left:r.left+i.left,top:r.top+i.top,right:r.right-i.right,bottom:r.bottom-i.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((s,o)=>{let l=this.manager.tooltipViews[o];return l.getCoords?l.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(ig).tooltipSpace(this.view),scaleX:n,scaleY:e,makeAbsolute:t}}writeMeasure(n){var e;if(n.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let l of this.manager.tooltipViews)l.dom.style.position="absolute"}let{visible:t,space:r,scaleX:i,scaleY:s}=n,o=[];for(let l=0;l<this.manager.tooltips.length;l++){let a=this.manager.tooltips[l],u=this.manager.tooltipViews[l],{dom:c}=u,f=n.pos[l],d=n.size[l];if(!f||a.clip!==!1&&(f.bottom<=Math.max(t.top,r.top)||f.top>=Math.min(t.bottom,r.bottom)||f.right<Math.max(t.left,r.left)-.1||f.left>Math.min(t.right,r.right)+.1)){c.style.top=Ea;continue}let p=a.arrow?u.dom.querySelector(".cm-tooltip-arrow"):null,y=p?7:0,v=d.right-d.left,E=(e=jS.get(u))!==null&&e!==void 0?e:d.bottom-d.top,w=u.offset||sB,_=this.view.textDirection==Ue.LTR,b=d.width>r.right-r.left?_?r.left:r.right-d.width:_?Math.max(r.left,Math.min(f.left-(p?14:0)+w.x,r.right-v)):Math.min(Math.max(r.left,f.left-v+(p?14:0)-w.x),r.right-v),I=this.above[l];!a.strictSide&&(I?f.top-E-y-w.y<r.top:f.bottom+E+y+w.y>r.bottom)&&I==r.bottom-f.bottom>f.top-r.top&&(I=this.above[l]=!I);let D=(I?f.top-r.top:r.bottom-f.bottom)-y;if(D<E&&u.resize!==!1){if(D<this.view.defaultLineHeight){c.style.top=Ea;continue}jS.set(u,E),c.style.height=(E=D)/s+"px"}else c.style.height&&(c.style.height="");let M=I?f.top-E-y-w.y:f.bottom+y+w.y,x=b+v;if(u.overlap!==!0)for(let S of o)S.left<x&&S.right>b&&S.top<M+E&&S.bottom>M&&(M=I?S.top-E-2-y:S.bottom+y+2);if(this.position=="absolute"?(c.style.top=(M-n.parent.top)/s+"px",HS(c,(b-n.parent.left)/i)):(c.style.top=M/s+"px",HS(c,b/i)),p){let S=f.left+(_?w.x:-w.x)-(b+14-7);p.style.left=S/i+"px"}u.overlap!==!0&&o.push({left:b,top:M,right:x,bottom:M+E}),c.classList.toggle("cm-tooltip-above",I),c.classList.toggle("cm-tooltip-below",!I),u.positioned&&u.positioned(n.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let n of this.manager.tooltipViews)n.dom.style.top=Ea}},{eventObservers:{scroll(){this.maybeMeasure()}}});function HS(n,e){let t=parseInt(n.style.left,10);(isNaN(t)||Math.abs(e-t)>1)&&(n.style.left=e+"px")}const iB=q.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),sB={x:0,y:0},S1=G.define({enables:[x1,iB]}),pd=G.define({combine:n=>n.reduce((e,t)=>e.concat(t),[])});class kp{static create(e){return new kp(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new TI(e,pd,(t,r)=>this.createHostedView(t,r),t=>t.dom.remove())}createHostedView(e,t){let r=e.create(this.view);return r.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(r.dom,t?t.dom.nextSibling:this.dom.firstChild),this.mounted&&r.mount&&r.mount(this.view),r}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let r of this.manager.tooltipViews){let i=r[e];if(i!==void 0){if(t===void 0)t=i;else if(t!==i)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const oB=S1.compute([pd],n=>{let e=n.facet(pd);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var r;return(r=t.end)!==null&&r!==void 0?r:t.pos})),create:kp.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class lB{constructor(e,t,r,i,s){this.view=e,this.source=t,this.field=r,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,r=e.docView.nearest(t.target);if(!r)return;let i,s=1;if(r instanceof Oi)i=r.posAtStart;else{if(i=e.posAtCoords(t),i==null)return;let l=e.coordsAtPos(i);if(!l||t.y<l.top||t.y>l.bottom||t.x<l.left-e.defaultCharacterWidth||t.x>l.right+e.defaultCharacterWidth)return;let a=e.bidiSpans(e.state.doc.lineAt(i)).find(c=>c.from<=i&&c.to>=i),u=a&&a.dir==Ue.RTL?-1:1;s=t.x<l.left?-u:u}let o=this.source(e,i,s);if(o!=null&&o.then){let l=this.pending={pos:i};o.then(a=>{this.pending==l&&(this.pending=null,a&&!(Array.isArray(a)&&!a.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(a)?a:[a])}))},a=>gn(e.state,a,"hover tooltip"))}else o&&!(Array.isArray(o)&&!o.length)&&e.dispatch({effects:this.setHover.of(Array.isArray(o)?o:[o])})}get tooltip(){let e=this.view.plugin(x1),t=e?e.manager.tooltips.findIndex(r=>r.create==kp.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t,r;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:i,tooltip:s}=this;if(i.length&&s&&!aB(s.dom,e)||this.pending){let{pos:o}=i[0]||this.pending,l=(r=(t=i[0])===null||t===void 0?void 0:t.end)!==null&&r!==void 0?r:o;(o==l?this.view.posAtCoords(this.lastMove)!=o:!uB(this.view,o,l,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t.length){let{tooltip:r}=this;r&&r.dom.contains(e.relatedTarget)?this.watchTooltipLeave(r.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(e){let t=r=>{e.removeEventListener("mouseleave",t),this.active.length&&!this.view.dom.contains(r.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Th=4;function aB(n,e){let{left:t,right:r,top:i,bottom:s}=n.getBoundingClientRect(),o;if(o=n.querySelector(".cm-tooltip-arrow")){let l=o.getBoundingClientRect();i=Math.min(l.top,i),s=Math.max(l.bottom,s)}return e.clientX>=t-Th&&e.clientX<=r+Th&&e.clientY>=i-Th&&e.clientY<=s+Th}function uB(n,e,t,r,i,s){let o=n.scrollDOM.getBoundingClientRect(),l=n.documentTop+n.documentPadding.top+n.contentHeight;if(o.left>r||o.right<r||o.top>i||Math.min(o.bottom,l)<i)return!1;let a=n.posAtCoords({x:r,y:i},!1);return a>=e&&a<=t}function cB(n,e={}){let t=ue.define(),r=Vt.define({create(){return[]},update(i,s){if(i.length&&(e.hideOnChange&&(s.docChanged||s.selection)?i=[]:e.hideOn&&(i=i.filter(o=>!e.hideOn(s,o))),s.docChanged)){let o=[];for(let l of i){let a=s.changes.mapPos(l.pos,-1,Zt.TrackDel);if(a!=null){let u=Object.assign(Object.create(null),l);u.pos=a,u.end!=null&&(u.end=s.changes.mapPos(u.end)),o.push(u)}}i=o}for(let o of s.effects)o.is(t)&&(i=o.value),o.is(hB)&&(i=[]);return i},provide:i=>pd.from(i)});return{active:r,extension:[r,st.define(i=>new lB(i,n,r,t,e.hoverTime||300)),oB]}}function CI(n,e){let t=n.plugin(x1);if(!t)return null;let r=t.manager.tooltips.indexOf(e);return r<0?null:t.manager.tooltipViews[r]}const hB=ue.define(),WS=G.define({combine(n){let e,t;for(let r of n)e=e||r.topContainer,t=t||r.bottomContainer;return{topContainer:e,bottomContainer:t}}});function Hu(n,e){let t=n.plugin(AI),r=t?t.specs.indexOf(e):-1;return r>-1?t.panels[r]:null}const AI=st.fromClass(class{constructor(n){this.input=n.state.facet(Wu),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(n));let e=n.state.facet(WS);this.top=new Ch(n,!0,e.topContainer),this.bottom=new Ch(n,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(n){let e=n.state.facet(WS);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Ch(n.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Ch(n.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=n.state.facet(Wu);if(t!=this.input){let r=t.filter(a=>a),i=[],s=[],o=[],l=[];for(let a of r){let u=this.specs.indexOf(a),c;u<0?(c=a(n.view),l.push(c)):(c=this.panels[u],c.update&&c.update(n)),i.push(c),(c.top?s:o).push(c)}this.specs=r,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let a of l)a.dom.classList.add("cm-panel"),a.mount&&a.mount()}else for(let r of this.panels)r.update&&r.update(n)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:n=>q.scrollMargins.of(e=>{let t=e.plugin(n);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Ch{constructor(e,t,r){this.view=e,this.top=t,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=qS(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=qS(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function qS(n){let e=n.nextSibling;return n.remove(),e}const Wu=G.define({enables:AI});class li extends Zs{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}li.prototype.elementClass="";li.prototype.toDOM=void 0;li.prototype.mapMode=Zt.TrackBefore;li.prototype.startSide=li.prototype.endSide=-1;li.prototype.point=!0;const vf=G.define(),fB=G.define(),dB={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>xe.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},cu=G.define();function pB(n){return[II(),cu.of(Object.assign(Object.assign({},dB),n))]}const KS=G.define({combine:n=>n.some(e=>e)});function II(n){return[mB]}const mB=st.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(cu).map(e=>new GS(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(KS),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,t=n.view.viewport,r=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(r<(t.to-t.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(KS)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let t=xe.iter(this.view.state.facet(vf),this.view.viewport.from),r=[],i=this.gutters.map(s=>new gB(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(s.type)){let o=!0;for(let l of s.type)if(l.type==nn.Text&&o){m0(t,r,l.from);for(let a of i)a.line(this.view,l,r);o=!1}else if(l.widget)for(let a of i)a.widget(this.view,l)}else if(s.type==nn.Text){m0(t,r,s.from);for(let o of i)o.line(this.view,s,r)}else if(s.widget)for(let o of i)o.widget(this.view,s);for(let s of i)s.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(cu),t=n.state.facet(cu),r=n.docChanged||n.heightChanged||n.viewportChanged||!xe.eq(n.startState.facet(vf),n.state.facet(vf),n.view.viewport.from,n.view.viewport.to);if(e==t)for(let i of this.gutters)i.update(n)&&(r=!0);else{r=!0;let i=[];for(let s of t){let o=e.indexOf(s);o<0?i.push(new GS(this.view,s)):(this.gutters[o].update(n),i.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)this.dom.appendChild(s.dom);this.gutters=i}return r}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>q.scrollMargins.of(e=>{let t=e.plugin(n);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==Ue.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function QS(n){return Array.isArray(n)?n:[n]}function m0(n,e,t){for(;n.value&&n.from<=t;)n.from==t&&e.push(n.value),n.next()}class gB{constructor(e,t,r){this.gutter=e,this.height=r,this.i=0,this.cursor=xe.iter(e.markers,t.from)}addElement(e,t,r){let{gutter:i}=this,s=(t.top-this.height)/e.scaleY,o=t.height/e.scaleY;if(this.i==i.elements.length){let l=new PI(e,o,s,r);i.elements.push(l),i.dom.appendChild(l.dom)}else i.elements[this.i].update(e,o,s,r);this.height=t.bottom,this.i++}line(e,t,r){let i=[];m0(this.cursor,i,t.from),r.length&&(i=i.concat(r));let s=this.gutter.config.lineMarker(e,t,i);s&&i.unshift(s);let o=this.gutter;i.length==0&&!o.config.renderEmptyElements||this.addElement(e,t,i)}widget(e,t){let r=this.gutter.config.widgetMarker(e,t.widget,t),i=r?[r]:null;for(let s of e.state.facet(fB)){let o=s(e,t.widget,t);o&&(i||(i=[])).push(o)}i&&this.addElement(e,t,i)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class GS{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in t.domEventHandlers)this.dom.addEventListener(r,i=>{let s=i.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let a=s.getBoundingClientRect();o=(a.top+a.bottom)/2}else o=i.clientY;let l=e.lineBlockAtHeight(o-e.documentTop);t.domEventHandlers[r](e,l,i)&&i.preventDefault()});this.markers=QS(t.markers(e)),t.initialSpacer&&(this.spacer=new PI(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=QS(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let r=e.view.viewport;return!xe.eq(this.markers,t,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class PI{constructor(e,t,r,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,r,i)}update(e,t,r,i){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),yB(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,t){let r="cm-gutterElement",i=this.dom.firstChild;for(let s=0,o=0;;){let l=o,a=s<t.length?t[s++]:null,u=!1;if(a){let c=a.elementClass;c&&(r+=" "+c);for(let f=o;f<this.markers.length;f++)if(this.markers[f].compare(a)){l=f,u=!0;break}}else l=this.markers.length;for(;o<l;){let c=this.markers[o++];if(c.toDOM){c.destroy(i);let f=i.nextSibling;i.remove(),i=f}}if(!a)break;a.toDOM&&(u?i=i.nextSibling:this.dom.insertBefore(a.toDOM(e),i)),u&&o++}this.dom.className=r,this.markers=t}destroy(){this.setMarkers(null,[])}}function yB(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].compare(e[t]))return!1;return!0}const vB=G.define(),wB=G.define(),Xo=G.define({combine(n){return Lr(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let r=Object.assign({},e);for(let i in t){let s=r[i],o=t[i];r[i]=s?(l,a,u)=>s(l,a,u)||o(l,a,u):o}return r}})}});class sg extends li{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function og(n,e){return n.state.facet(Xo).formatNumber(e,n.state)}const _B=cu.compute([Xo],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(vB)},lineMarker(e,t,r){return r.some(i=>i.toDOM)?null:new sg(og(e,e.state.doc.lineAt(t.from).number))},widgetMarker:(e,t,r)=>{for(let i of e.state.facet(wB)){let s=i(e,t,r);if(s)return s}return null},lineMarkerChange:e=>e.startState.facet(Xo)!=e.state.facet(Xo),initialSpacer(e){return new sg(og(e,YS(e.state.doc.lines)))},updateSpacer(e,t){let r=og(t.view,YS(t.view.state.doc.lines));return r==e.number?e:new sg(r)},domEventHandlers:n.facet(Xo).domEventHandlers}));function xB(n={}){return[Xo.of(n),II(),_B]}function YS(n){let e=9;for(;e<n;)e=e*10+9;return e}const SB=new class extends li{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},bB=vf.compute(["selection"],n=>{let e=[],t=-1;for(let r of n.selection.ranges){let i=n.doc.lineAt(r.head).from;i>t&&(t=i,e.push(SB.range(i)))}return xe.of(e)});function kB(){return bB}const RI=1024;let EB=0;class lg{constructor(e,t){this.from=e,this.to=t}}class pe{constructor(e={}){this.id=EB++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=xn.match(e)),t=>{let r=e(t);return r===void 0?null:[this,r]}}}pe.closedBy=new pe({deserialize:n=>n.split(" ")});pe.openedBy=new pe({deserialize:n=>n.split(" ")});pe.group=new pe({deserialize:n=>n.split(" ")});pe.isolate=new pe({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});pe.contextHash=new pe({perNode:!0});pe.lookAhead=new pe({perNode:!0});pe.mounted=new pe({perNode:!0});class md{constructor(e,t,r){this.tree=e,this.overlay=t,this.parser=r}static get(e){return e&&e.props&&e.props[pe.mounted.id]}}const TB=Object.create(null);class xn{constructor(e,t,r,i=0){this.name=e,this.props=t,this.id=r,this.flags=i}static define(e){let t=e.props&&e.props.length?Object.create(null):TB,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new xn(e.name||"",t,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");t[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let t=this.prop(pe.group);return t?t.indexOf(e)>-1:!1}return this.id==e}static match(e){let t=Object.create(null);for(let r in e)for(let i of r.split(" "))t[i]=e[r];return r=>{for(let i=r.prop(pe.group),s=-1;s<(i?i.length:0);s++){let o=t[s<0?r.name:i[s]];if(o)return o}}}}xn.none=new xn("",Object.create(null),0,8);class b1{constructor(e){this.types=e;for(let t=0;t<e.length;t++)if(e[t].id!=t)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let t=[];for(let r of this.types){let i=null;for(let s of e){let o=s(r);o&&(i||(i=Object.assign({},r.props)),i[o[0].id]=o[1])}t.push(i?new xn(r.name,i,r.id,r.flags):r)}return new b1(t)}}const Ah=new WeakMap,XS=new WeakMap;var xt;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(xt||(xt={}));class ht{constructor(e,t,r,i,s){if(this.type=e,this.children=t,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,l]of s)this.props[typeof o=="number"?o:o.id]=l}}toString(){let e=md.get(this);if(e&&!e.overlay)return e.tree.toString();let t="";for(let r of this.children){let i=r.toString();i&&(t&&(t+=","),t+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(t.length?"("+t+")":""):t}cursor(e=0){return new y0(this.topNode,e)}cursorAt(e,t=0,r=0){let i=Ah.get(this)||this.topNode,s=new y0(i);return s.moveTo(e,t),Ah.set(this,s._tree),s}get topNode(){return new Qn(this,0,0,null)}resolve(e,t=0){let r=qu(Ah.get(this)||this.topNode,e,t,!1);return Ah.set(this,r),r}resolveInner(e,t=0){let r=qu(XS.get(this)||this.topNode,e,t,!0);return XS.set(this,r),r}resolveStack(e,t=0){return IB(this,e,t)}iterate(e){let{enter:t,leave:r,from:i=0,to:s=this.length}=e,o=e.mode||0,l=(o&xt.IncludeAnonymous)>0;for(let a=this.cursor(o|xt.IncludeAnonymous);;){let u=!1;if(a.from<=s&&a.to>=i&&(!l&&a.type.isAnonymous||t(a)!==!1)){if(a.firstChild())continue;u=!0}for(;u&&r&&(l||!a.type.isAnonymous)&&r(a),!a.nextSibling();){if(!a.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let t in this.props)e.push([+t,this.props[t]]);return e}balance(e={}){return this.children.length<=8?this:T1(xn.none,this.children,this.positions,0,this.children.length,0,this.length,(t,r,i)=>new ht(this.type,t,r,i,this.propValues),e.makeTree||((t,r,i)=>new ht(xn.none,t,r,i)))}static build(e){return PB(e)}}ht.empty=new ht(xn.none,[],[],0);class k1{constructor(e,t){this.buffer=e,this.index=t}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new k1(this.buffer,this.index)}}class ns{constructor(e,t,r){this.buffer=e,this.length=t,this.set=r}get type(){return xn.none}toString(){let e=[];for(let t=0;t<this.buffer.length;)e.push(this.childString(t)),t=this.buffer[t+3];return e.join(",")}childString(e){let t=this.buffer[e],r=this.buffer[e+3],i=this.set.types[t],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,t,r,i,s){let{buffer:o}=this,l=-1;for(let a=e;a!=t&&!(DI(s,i,o[a+1],o[a+2])&&(l=a,r>0));a=o[a+3]);return l}slice(e,t,r){let i=this.buffer,s=new Uint16Array(t-e),o=0;for(let l=e,a=0;l<t;){s[a++]=i[l++],s[a++]=i[l++]-r;let u=s[a++]=i[l++]-r;s[a++]=i[l++]-e,o=Math.max(o,u)}return new ns(s,o,this.set)}}function DI(n,e,t,r){switch(n){case-2:return t<e;case-1:return r>=e&&t<e;case 0:return t<e&&r>e;case 1:return t<=e&&r>e;case 2:return r>e;case 4:return!0}}function qu(n,e,t,r){for(var i;n.from==n.to||(t<1?n.from>=e:n.from>e)||(t>-1?n.to<=e:n.to<e);){let o=!r&&n instanceof Qn&&n.index<0?null:n.parent;if(!o)return n;n=o}let s=r?0:xt.IgnoreOverlays;if(r)for(let o=n,l=o.parent;l;o=l,l=o.parent)o instanceof Qn&&o.index<0&&((i=l.enter(e,t,s))===null||i===void 0?void 0:i.from)!=o.from&&(n=l);for(;;){let o=n.enter(e,t,s);if(!o)return n;n=o}}class OI{cursor(e=0){return new y0(this,e)}getChild(e,t=null,r=null){let i=JS(this,e,t,r);return i.length?i[0]:null}getChildren(e,t=null,r=null){return JS(this,e,t,r)}resolve(e,t=0){return qu(this,e,t,!1)}resolveInner(e,t=0){return qu(this,e,t,!0)}matchContext(e){return g0(this.parent,e)}enterUnfinishedNodesBefore(e){let t=this.childBefore(e),r=this;for(;t;){let i=t.lastChild;if(!i||i.to!=t.to)break;i.type.isError&&i.from==i.to?(r=t,t=i.prevSibling):t=i}return r}get node(){return this}get next(){return this.parent}}class Qn extends OI{constructor(e,t,r,i){super(),this._tree=e,this.from=t,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,t,r,i,s=0){for(let o=this;;){for(let{children:l,positions:a}=o._tree,u=t>0?l.length:-1;e!=u;e+=t){let c=l[e],f=a[e]+o.from;if(DI(i,r,f,f+c.length)){if(c instanceof ns){if(s&xt.ExcludeBuffers)continue;let d=c.findChild(0,c.buffer.length,t,r-f,i);if(d>-1)return new Ni(new CB(o,c,e,f),null,d)}else if(s&xt.IncludeAnonymous||!c.type.isAnonymous||E1(c)){let d;if(!(s&xt.IgnoreMounts)&&(d=md.get(c))&&!d.overlay)return new Qn(d.tree,f,e,o);let p=new Qn(c,f,e,o);return s&xt.IncludeAnonymous||!p.type.isAnonymous?p:p.nextChild(t<0?c.children.length-1:0,t,r,i)}}}if(s&xt.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+t:e=t<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,t,r=0){let i;if(!(r&xt.IgnoreOverlays)&&(i=md.get(this._tree))&&i.overlay){let s=e-this.from;for(let{from:o,to:l}of i.overlay)if((t>0?o<=s:o<s)&&(t<0?l>=s:l>s))return new Qn(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,t,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function JS(n,e,t,r){let i=n.cursor(),s=[];if(!i.firstChild())return s;if(t!=null){for(let o=!1;!o;)if(o=i.type.is(t),!i.nextSibling())return s}for(;;){if(r!=null&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return r==null?s:[]}}function g0(n,e,t=e.length-1){for(let r=n;t>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[t]&&e[t]!=r.name)return!1;t--}}return!0}class CB{constructor(e,t,r,i){this.parent=e,this.buffer=t,this.index=r,this.start=i}}class Ni extends OI{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,t,r){super(),this.context=e,this._parent=t,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,t,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.context.start,r);return s<0?null:new Ni(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,t,r=0){if(r&xt.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],t>0?1:-1,e-this.context.start,t);return s<0?null:new Ni(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,t=e.buffer[this.index+3];return t<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Ni(this.context,this._parent,t):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,t=this._parent?this._parent.index+4:0;return this.index==t?this.externalSibling(-1):new Ni(this.context,this._parent,e.findChild(t,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],t=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];if(s>i){let o=r.buffer[this.index+1];e.push(r.slice(i,s,o)),t.push(0)}return new ht(this.type,e,t,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function MI(n){if(!n.length)return null;let e=0,t=n[0];for(let s=1;s<n.length;s++){let o=n[s];(o.from>t.from||o.to<t.to)&&(t=o,e=s)}let r=t instanceof Qn&&t.index<0?null:t.parent,i=n.slice();return r?i[e]=r:i.splice(e,1),new AB(i,t)}class AB{constructor(e,t){this.heads=e,this.node=t}get next(){return MI(this.heads)}}function IB(n,e,t){let r=n.resolveInner(e,t),i=null;for(let s=r instanceof Qn?r:r.context.parent;s;s=s.parent)if(s.index<0){let o=s.parent;(i||(i=[r])).push(o.resolve(e,t)),s=o}else{let o=md.get(s.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let l=new Qn(o.tree,o.overlay[0].from+s.from,-1,s);(i||(i=[r])).push(qu(l,e,t,!1))}}return i?MI(i):r}class y0{get name(){return this.type.name}constructor(e,t=0){if(this.mode=t,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Qn)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,t){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=t||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return e?e instanceof Qn?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,t,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,t,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,t-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,t,r=this.mode){return this.buffer?r&xt.ExcludeBuffers?!1:this.enterChild(1,e,t):this.yield(this._tree.enter(e,t,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&xt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&xt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:t}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(t.findChild(i,this.index,-1,0,4))}else{let i=t.buffer[this.index+3];if(i<(r<0?t.buffer.length:t.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let t,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:t,parent:r}=i)}else({index:t,_parent:r}=this._tree);for(;r;{index:t,_parent:r}=r)if(t>-1)for(let s=t+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let l=r._tree.children[s];if(this.mode&xt.IncludeAnonymous||l instanceof ns||!l.type.isAnonymous||E1(l))return!1}return!0}move(e,t){if(t&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,t=0){for(;(this.from==this.to||(t<1?this.from>=e:this.from>e)||(t>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,t););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,t=null,r=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;t=o,r=s+1;break e}i=this.stack[--s]}for(let i=r;i<this.stack.length;i++)t=new Ni(this.buffer,t,this.stack[i]);return this.bufferNode=new Ni(this.buffer,t,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,t){for(let r=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;;){if(i&&t&&t(this),i=this.type.isAnonymous,!r)return;if(this.nextSibling())break;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return g0(this.node.parent,e);let{buffer:t}=this.buffer,{types:r}=t.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return g0(this._tree,e,i);let o=r[t.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function E1(n){return n.children.some(e=>e instanceof ns||!e.type.isAnonymous||E1(e))}function PB(n){var e;let{buffer:t,nodeSet:r,maxBufferLength:i=RI,reused:s=[],minRepeatType:o=r.types.length}=n,l=Array.isArray(t)?new k1(t,t.length):t,a=r.types,u=0,c=0;function f(D,M,x,S,T,C){let{id:P,start:R,end:A,size:re}=l,ce=c,Te=u;for(;re<0;)if(l.next(),re==-1){let fe=s[P];x.push(fe),S.push(R-D);return}else if(re==-3){u=P;return}else if(re==-4){c=P;return}else throw new RangeError(`Unrecognized record size: ${re}`);let ae=a[P],U,H,J=R-D;if(A-R<=i&&(H=E(l.pos-M,T))){let fe=new Uint16Array(H.size-H.skip),ie=l.pos-H.size,ge=fe.length;for(;l.pos>ie;)ge=w(H.start,fe,ge);U=new ns(fe,A-H.start,r),J=H.start-D}else{let fe=l.pos-re;l.next();let ie=[],ge=[],tt=P>=o?P:-1,nt=0,ot=A;for(;l.pos>fe;)tt>=0&&l.id==tt&&l.size>=0?(l.end<=ot-i&&(y(ie,ge,R,nt,l.end,ot,tt,ce,Te),nt=ie.length,ot=l.end),l.next()):C>2500?d(R,fe,ie,ge):f(R,fe,ie,ge,tt,C+1);if(tt>=0&&nt>0&&nt<ie.length&&y(ie,ge,R,nt,R,ot,tt,ce,Te),ie.reverse(),ge.reverse(),tt>-1&&nt>0){let Et=p(ae,Te);U=T1(ae,ie,ge,0,ie.length,0,A-R,Et,Et)}else U=v(ae,ie,ge,A-R,ce-A,Te)}x.push(U),S.push(J)}function d(D,M,x,S){let T=[],C=0,P=-1;for(;l.pos>M;){let{id:R,start:A,end:re,size:ce}=l;if(ce>4)l.next();else{if(P>-1&&A<P)break;P<0&&(P=re-i),T.push(R,A,re),C++,l.next()}}if(C){let R=new Uint16Array(C*4),A=T[T.length-2];for(let re=T.length-3,ce=0;re>=0;re-=3)R[ce++]=T[re],R[ce++]=T[re+1]-A,R[ce++]=T[re+2]-A,R[ce++]=ce;x.push(new ns(R,T[2]-A,r)),S.push(A-D)}}function p(D,M){return(x,S,T)=>{let C=0,P=x.length-1,R,A;if(P>=0&&(R=x[P])instanceof ht){if(!P&&R.type==D&&R.length==T)return R;(A=R.prop(pe.lookAhead))&&(C=S[P]+R.length+A)}return v(D,x,S,T,C,M)}}function y(D,M,x,S,T,C,P,R,A){let re=[],ce=[];for(;D.length>S;)re.push(D.pop()),ce.push(M.pop()+x-T);D.push(v(r.types[P],re,ce,C-T,R-C,A)),M.push(T-x)}function v(D,M,x,S,T,C,P){if(C){let R=[pe.contextHash,C];P=P?[R].concat(P):[R]}if(T>25){let R=[pe.lookAhead,T];P=P?[R].concat(P):[R]}return new ht(D,M,x,S,P)}function E(D,M){let x=l.fork(),S=0,T=0,C=0,P=x.end-i,R={size:0,start:0,skip:0};e:for(let A=x.pos-D;x.pos>A;){let re=x.size;if(x.id==M&&re>=0){R.size=S,R.start=T,R.skip=C,C+=4,S+=4,x.next();continue}let ce=x.pos-re;if(re<0||ce<A||x.start<P)break;let Te=x.id>=o?4:0,ae=x.start;for(x.next();x.pos>ce;){if(x.size<0)if(x.size==-3)Te+=4;else break e;else x.id>=o&&(Te+=4);x.next()}T=ae,S+=re,C+=Te}return(M<0||S==D)&&(R.size=S,R.start=T,R.skip=C),R.size>4?R:void 0}function w(D,M,x){let{id:S,start:T,end:C,size:P}=l;if(l.next(),P>=0&&S<o){let R=x;if(P>4){let A=l.pos-(P-4);for(;l.pos>A;)x=w(D,M,x)}M[--x]=R,M[--x]=C-D,M[--x]=T-D,M[--x]=S}else P==-3?u=S:P==-4&&(c=S);return x}let _=[],b=[];for(;l.pos>0;)f(n.start||0,n.bufferStart||0,_,b,-1,0);let I=(e=n.length)!==null&&e!==void 0?e:_.length?b[0]+_[0].length:0;return new ht(a[n.topID],_.reverse(),b.reverse(),I)}const ZS=new WeakMap;function wf(n,e){if(!n.isAnonymous||e instanceof ns||e.type!=n)return 1;let t=ZS.get(e);if(t==null){t=1;for(let r of e.children){if(r.type!=n||!(r instanceof ht)){t=1;break}t+=wf(n,r)}ZS.set(e,t)}return t}function T1(n,e,t,r,i,s,o,l,a){let u=0;for(let y=r;y<i;y++)u+=wf(n,e[y]);let c=Math.ceil(u*1.5/8),f=[],d=[];function p(y,v,E,w,_){for(let b=E;b<w;){let I=b,D=v[b],M=wf(n,y[b]);for(b++;b<w;b++){let x=wf(n,y[b]);if(M+x>=c)break;M+=x}if(b==I+1){if(M>c){let x=y[I];p(x.children,x.positions,0,x.children.length,v[I]+_);continue}f.push(y[I])}else{let x=v[b-1]+y[b-1].length-D;f.push(T1(n,y,v,I,b,D,x,null,a))}d.push(D+_-s)}}return p(e,t,r,i,0),(l||a)(f,d,o)}class Hs{constructor(e,t,r,i,s=!1,o=!1){this.from=e,this.to=t,this.tree=r,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,t=[],r=!1){let i=[new Hs(0,e.length,e,0,!1,r)];for(let s of t)s.to>e.length&&i.push(s);return i}static applyChanges(e,t,r=128){if(!t.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let l=0,a=0,u=0;;l++){let c=l<t.length?t[l]:null,f=c?c.fromA:1e9;if(f-a>=r)for(;o&&o.from<f;){let d=o;if(a>=d.from||f<=d.to||u){let p=Math.max(d.from,a)-u,y=Math.min(d.to,f)-u;d=p>=y?null:new Hs(p,y,d.tree,d.offset+u,l>0,!!c)}if(d&&i.push(d),o.to>f)break;o=s<e.length?e[s++]:null}if(!c)break;a=c.toA,u=c.toA-c.toB}return i}}class NI{startParse(e,t,r){return typeof e=="string"&&(e=new RB(e)),r=r?r.length?r.map(i=>new lg(i.from,i.to)):[new lg(0,0)]:[new lg(0,e.length)],this.createParse(e,t||[],r)}parse(e,t,r){let i=this.startParse(e,t,r);for(;;){let s=i.advance();if(s)return s}}}class RB{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,t){return this.string.slice(e,t)}}new pe({perNode:!0});let DB=0;class zn{constructor(e,t,r,i){this.name=e,this.set=t,this.base=r,this.modified=i,this.id=DB++}toString(){let{name:e}=this;for(let t of this.modified)t.name&&(e=`${t.name}(${e})`);return e}static define(e,t){let r=typeof e=="string"?e:"?";if(e instanceof zn&&(t=e),t!=null&&t.base)throw new Error("Can not derive from a modified tag");let i=new zn(r,[],null,[]);if(i.set.push(i),t)for(let s of t.set)i.set.push(s);return i}static defineModifier(e){let t=new gd(e);return r=>r.modified.indexOf(t)>-1?r:gd.get(r.base||r,r.modified.concat(t).sort((i,s)=>i.id-s.id))}}let OB=0;class gd{constructor(e){this.name=e,this.instances=[],this.id=OB++}static get(e,t){if(!t.length)return e;let r=t[0].instances.find(l=>l.base==e&&MB(t,l.modified));if(r)return r;let i=[],s=new zn(e.name,i,e,t);for(let l of t)l.instances.push(s);let o=NB(t);for(let l of e.set)if(!l.modified.length)for(let a of o)i.push(gd.get(l,a));return s}}function MB(n,e){return n.length==e.length&&n.every((t,r)=>t==e[r])}function NB(n){let e=[[]];for(let t=0;t<n.length;t++)for(let r=0,i=e.length;r<i;r++)e.push(e[r].concat(n[t]));return e.sort((t,r)=>r.length-t.length)}function VI(n){let e=Object.create(null);for(let t in n){let r=n[t];Array.isArray(r)||(r=[r]);for(let i of t.split(" "))if(i){let s=[],o=2,l=i;for(let f=0;;){if(l=="..."&&f>0&&f+3==i.length){o=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(l);if(!d)throw new RangeError("Invalid path: "+i);if(s.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),f+=d[0].length,f==i.length)break;let p=i[f++];if(f==i.length&&p=="!"){o=0;break}if(p!="/")throw new RangeError("Invalid path: "+i);l=i.slice(f)}let a=s.length-1,u=s[a];if(!u)throw new RangeError("Invalid path: "+i);let c=new yd(r,o,a>0?s.slice(0,a):null);e[u]=c.sort(e[u])}}return LI.add(e)}const LI=new pe;class yd{constructor(e,t,r,i){this.tags=e,this.mode=t,this.context=r,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}yd.empty=new yd([],2,null);function BI(n,e){let t=Object.create(null);for(let s of n)if(!Array.isArray(s.tag))t[s.tag.id]=s.class;else for(let o of s.tag)t[o.id]=s.class;let{scope:r,all:i=null}=e||{};return{style:s=>{let o=i;for(let l of s)for(let a of l.set){let u=t[a.id];if(u){o=o?o+" "+u:u;break}}return o},scope:r}}function VB(n,e){let t=null;for(let r of n){let i=r.style(e);i&&(t=t?t+" "+i:i)}return t}function LB(n,e,t,r=0,i=n.length){let s=new BB(r,Array.isArray(e)?e:[e],t);s.highlightRange(n.cursor(),r,i,"",s.highlighters),s.flush(i)}class BB{constructor(e,t,r){this.at=e,this.highlighters=t,this.span=r,this.class=""}startSpan(e,t){t!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=t)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,t,r,i,s){let{type:o,from:l,to:a}=e;if(l>=r||a<=t)return;o.isTop&&(s=this.highlighters.filter(p=>!p.scope||p.scope(o)));let u=i,c=FB(e)||yd.empty,f=VB(s,c.tags);if(f&&(u&&(u+=" "),u+=f,c.mode==1&&(i+=(i?" ":"")+f)),this.startSpan(Math.max(t,l),u),c.opaque)return;let d=e.tree&&e.tree.prop(pe.mounted);if(d&&d.overlay){let p=e.node.enter(d.overlay[0].from+l,1),y=this.highlighters.filter(E=>!E.scope||E.scope(d.tree.type)),v=e.firstChild();for(let E=0,w=l;;E++){let _=E<d.overlay.length?d.overlay[E]:null,b=_?_.from+l:a,I=Math.max(t,w),D=Math.min(r,b);if(I<D&&v)for(;e.from<D&&(this.highlightRange(e,I,D,i,s),this.startSpan(Math.min(D,e.to),u),!(e.to>=b||!e.nextSibling())););if(!_||b>r)break;w=_.to+l,w>t&&(this.highlightRange(p.cursor(),Math.max(t,_.from+l),Math.min(r,w),"",y),this.startSpan(Math.min(r,w),u))}v&&e.parent()}else if(e.firstChild()){d&&(i="");do if(!(e.to<=t)){if(e.from>=r)break;this.highlightRange(e,t,r,i,s),this.startSpan(Math.min(r,e.to),u)}while(e.nextSibling());e.parent()}}}function FB(n){let e=n.type.prop(LI);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const W=zn.define,Ih=W(),bi=W(),eb=W(bi),tb=W(bi),ki=W(),Ph=W(ki),ag=W(ki),wr=W(),_s=W(wr),yr=W(),vr=W(),v0=W(),Ta=W(v0),Rh=W(),O={comment:Ih,lineComment:W(Ih),blockComment:W(Ih),docComment:W(Ih),name:bi,variableName:W(bi),typeName:eb,tagName:W(eb),propertyName:tb,attributeName:W(tb),className:W(bi),labelName:W(bi),namespace:W(bi),macroName:W(bi),literal:ki,string:Ph,docString:W(Ph),character:W(Ph),attributeValue:W(Ph),number:ag,integer:W(ag),float:W(ag),bool:W(ki),regexp:W(ki),escape:W(ki),color:W(ki),url:W(ki),keyword:yr,self:W(yr),null:W(yr),atom:W(yr),unit:W(yr),modifier:W(yr),operatorKeyword:W(yr),controlKeyword:W(yr),definitionKeyword:W(yr),moduleKeyword:W(yr),operator:vr,derefOperator:W(vr),arithmeticOperator:W(vr),logicOperator:W(vr),bitwiseOperator:W(vr),compareOperator:W(vr),updateOperator:W(vr),definitionOperator:W(vr),typeOperator:W(vr),controlOperator:W(vr),punctuation:v0,separator:W(v0),bracket:Ta,angleBracket:W(Ta),squareBracket:W(Ta),paren:W(Ta),brace:W(Ta),content:wr,heading:_s,heading1:W(_s),heading2:W(_s),heading3:W(_s),heading4:W(_s),heading5:W(_s),heading6:W(_s),contentSeparator:W(wr),list:W(wr),quote:W(wr),emphasis:W(wr),strong:W(wr),link:W(wr),monospace:W(wr),strikethrough:W(wr),inserted:W(),deleted:W(),changed:W(),invalid:W(),meta:Rh,documentMeta:W(Rh),annotation:W(Rh),processingInstruction:W(Rh),definition:zn.defineModifier("definition"),constant:zn.defineModifier("constant"),function:zn.defineModifier("function"),standard:zn.defineModifier("standard"),local:zn.defineModifier("local"),special:zn.defineModifier("special")};for(let n in O){let e=O[n];e instanceof zn&&(e.name=n)}BI([{tag:O.link,class:"tok-link"},{tag:O.heading,class:"tok-heading"},{tag:O.emphasis,class:"tok-emphasis"},{tag:O.strong,class:"tok-strong"},{tag:O.keyword,class:"tok-keyword"},{tag:O.atom,class:"tok-atom"},{tag:O.bool,class:"tok-bool"},{tag:O.url,class:"tok-url"},{tag:O.labelName,class:"tok-labelName"},{tag:O.inserted,class:"tok-inserted"},{tag:O.deleted,class:"tok-deleted"},{tag:O.literal,class:"tok-literal"},{tag:O.string,class:"tok-string"},{tag:O.number,class:"tok-number"},{tag:[O.regexp,O.escape,O.special(O.string)],class:"tok-string2"},{tag:O.variableName,class:"tok-variableName"},{tag:O.local(O.variableName),class:"tok-variableName tok-local"},{tag:O.definition(O.variableName),class:"tok-variableName tok-definition"},{tag:O.special(O.variableName),class:"tok-variableName2"},{tag:O.definition(O.propertyName),class:"tok-propertyName tok-definition"},{tag:O.typeName,class:"tok-typeName"},{tag:O.namespace,class:"tok-namespace"},{tag:O.className,class:"tok-className"},{tag:O.macroName,class:"tok-macroName"},{tag:O.propertyName,class:"tok-propertyName"},{tag:O.operator,class:"tok-operator"},{tag:O.comment,class:"tok-comment"},{tag:O.meta,class:"tok-meta"},{tag:O.invalid,class:"tok-invalid"},{tag:O.punctuation,class:"tok-punctuation"}]);var ug;const Jo=new pe;function zB(n){return G.define({combine:n?e=>e.concat(n):void 0})}const $B=new pe;class or{constructor(e,t,r=[],i=""){this.data=e,this.name=i,ye.prototype.hasOwnProperty("tree")||Object.defineProperty(ye.prototype,"tree",{get(){return kt(this)}}),this.parser=t,this.extension=[rs.of(this),ye.languageData.of((s,o,l)=>{let a=nb(s,o,l),u=a.type.prop(Jo);if(!u)return[];let c=s.facet(u),f=a.type.prop($B);if(f){let d=a.resolve(o-a.from,l);for(let p of f)if(p.test(d,s)){let y=s.facet(p.facet);return p.type=="replace"?y:y.concat(c)}}return c})].concat(r)}isActiveAt(e,t,r=-1){return nb(e,t,r).type.prop(Jo)==this.data}findRegions(e){let t=e.facet(rs);if((t==null?void 0:t.data)==this.data)return[{from:0,to:e.doc.length}];if(!t||!t.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(Jo)==this.data){r.push({from:o,to:o+s.length});return}let l=s.prop(pe.mounted);if(l){if(l.tree.prop(Jo)==this.data){if(l.overlay)for(let a of l.overlay)r.push({from:a.from+o,to:a.to+o});else r.push({from:o,to:o+s.length});return}else if(l.overlay){let a=r.length;if(i(l.tree,l.overlay[0].from+o),r.length>a)return}}for(let a=0;a<s.children.length;a++){let u=s.children[a];u instanceof ht&&i(u,s.positions[a]+o)}};return i(kt(e),0),r}get allowsNesting(){return!0}}or.setState=ue.define();function nb(n,e,t){let r=n.facet(rs),i=kt(n).topNode;if(!r||r.allowsNesting)for(let s=i;s;s=s.enter(e,t,xt.ExcludeBuffers))s.type.isTop&&(i=s);return i}class vd extends or{constructor(e,t,r){super(e,t,[],r),this.parser=t}static define(e){let t=zB(e.languageData);return new vd(t,e.parser.configure({props:[Jo.add(r=>r.isTop?t:void 0)]}),e.name)}configure(e,t){return new vd(this.data,this.parser.configure(e),t||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function kt(n){let e=n.field(or.state,!1);return e?e.tree:ht.empty}class UB{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,t){let r=this.cursorPos-this.string.length;return e<r||t>=this.cursorPos?this.doc.sliceString(e,t):this.string.slice(e-r,t-r)}}let Ca=null;class wd{constructor(e,t,r=[],i,s,o,l,a){this.parser=e,this.state=t,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=l,this.scheduleOn=a,this.parse=null,this.tempSkipped=[]}static create(e,t,r){return new wd(e,t,[],ht.empty,0,r,[],null)}startParse(){return this.parser.startParse(new UB(this.state.doc),this.fragments)}work(e,t){return t!=null&&t>=this.state.doc.length&&(t=void 0),this.tree!=ht.empty&&this.isDone(t??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),t!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>t)&&t<this.state.doc.length&&this.parse.stopAt(t);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(Hs.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(t??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,t;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(t=this.parse.advance()););}),this.treeLen=e,this.tree=t,this.fragments=this.withoutTempSkipped(Hs.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let t=Ca;Ca=this;try{return e()}finally{Ca=t}}withoutTempSkipped(e){for(let t;t=this.tempSkipped.pop();)e=rb(e,t.from,t.to);return e}changes(e,t){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:l}=this;if(this.takeTree(),!e.empty){let a=[];if(e.iterChangedRanges((u,c,f,d)=>a.push({fromA:u,toA:c,fromB:f,toB:d})),r=Hs.applyChanges(r,a),i=ht.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){l=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),f=e.mapPos(u.to,-1);c<f&&l.push({from:c,to:f})}}}return new wd(this.parser,t,r,i,s,o,l,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let t=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=rb(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=t?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,t){this.skipped.push({from:e,to:t})}static getSkippingParser(e){return new class extends NI{createParse(t,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let a=Ca;if(a){for(let u of i)a.tempSkipped.push(u);e&&(a.scheduleOn=a.scheduleOn?Promise.all([a.scheduleOn,e]):e)}return this.parsedPos=o,new ht(xn.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let t=this.fragments;return this.treeLen>=e&&t.length&&t[0].from==0&&t[0].to>=e}static get(){return Ca}}function rb(n,e,t){return Hs.applyChanges(n,[{fromA:e,toA:t,fromB:e,toB:t}])}class Rl{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let t=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),t.viewport.to);return t.work(20,r)||t.takeTree(),new Rl(t)}static init(e){let t=Math.min(3e3,e.doc.length),r=wd.create(e.facet(rs).parser,e,{from:0,to:t});return r.work(20,t)||r.takeTree(),new Rl(r)}}or.state=Vt.define({create:Rl.init,update(n,e){for(let t of e.effects)if(t.is(or.setState))return t.value;return e.startState.facet(rs)!=e.state.facet(rs)?Rl.init(e.state):n.apply(e)}});let FI=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(FI=n=>{let e=-1,t=setTimeout(()=>{e=requestIdleCallback(n,{timeout:400})},100);return()=>e<0?clearTimeout(t):cancelIdleCallback(e)});const cg=typeof navigator<"u"&&(!((ug=navigator.scheduling)===null||ug===void 0)&&ug.isInputPending)?()=>navigator.scheduling.isInputPending():null,jB=st.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let t=this.view.state.field(or.state).context;(t.updateViewport(e.view.viewport)||this.view.viewport.to>t.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(t)}scheduleWork(){if(this.working)return;let{state:e}=this.view,t=e.field(or.state);(t.tree!=t.context.tree||!t.context.isDone(e.doc.length))&&(this.working=FI(this.work))}work(e){this.working=null;let t=Date.now();if(this.chunkEnd<t&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=t+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(or.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!cg?Math.max(25,e.timeRemaining()-5):1e9),l=s.context.treeLen<i&&r.doc.length>i+1e3,a=s.context.work(()=>cg&&cg()||Date.now()>o,i+(l?0:1e5));this.chunkBudget-=Date.now()-t,(a||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:or.setState.of(new Rl(s.context))})),this.chunkBudget>0&&!(a&&!l)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(t=>gn(this.view.state,t)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),rs=G.define({combine(n){return n.length?n[0]:null},enables:n=>[or.state,jB,q.contentAttributes.compute([n],e=>{let t=e.facet(n);return t&&t.name?{"data-language":t.name}:{}})]});class HB{constructor(e,t=[]){this.language=e,this.support=t,this.extension=[e,t]}}const WB=G.define(),Ep=G.define({combine:n=>{if(!n.length)return"  ";let e=n[0];if(!e||/\S/.test(e)||Array.from(e).some(t=>t!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(n[0]));return e}});function _d(n){let e=n.facet(Ep);return e.charCodeAt(0)==9?n.tabSize*e.length:e.length}function Ku(n,e){let t="",r=n.tabSize,i=n.facet(Ep)[0];if(i=="	"){for(;e>=r;)t+="	",e-=r;i=" "}for(let s=0;s<e;s++)t+=i;return t}function C1(n,e){n instanceof ye&&(n=new Tp(n));for(let r of n.state.facet(WB)){let i=r(n,e);if(i!==void 0)return i}let t=kt(n.state);return t.length>=e?qB(n,t,e):null}class Tp{constructor(e,t={}){this.state=e,this.options=t,this.unit=_d(e)}lineAt(e,t=1){let r=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=r.from&&i<=r.to?s&&i==e?{text:"",from:e}:(t<0?i<e:i<=e)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(e,t=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(e,t);return r.slice(e-i,Math.min(r.length,e+100-i))}column(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.countColumn(r,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,t=e.length){return Kl(e,this.state.tabSize,t)}lineIndent(e,t=1){let{text:r,from:i}=this.lineAt(e,t),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const zI=new pe;function qB(n,e,t){let r=e.resolveStack(t),i=e.resolveInner(t,-1).resolve(t,0).enterUnfinishedNodesBefore(t);if(i!=r.node){let s=[];for(let o=i;o&&!(o.from==r.node.from&&o.type==r.node.type);o=o.parent)s.push(o);for(let o=s.length-1;o>=0;o--)r={node:s[o],next:r}}return $I(r,n,t)}function $I(n,e,t){for(let r=n;r;r=r.next){let i=QB(r.node);if(i)return i(A1.create(e,t,r))}return 0}function KB(n){return n.pos==n.options.simulateBreak&&n.options.simulateDoubleBreak}function QB(n){let e=n.type.prop(zI);if(e)return e;let t=n.firstChild,r;if(t&&(r=t.type.prop(pe.closedBy))){let i=n.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>JB(o,!0,1,void 0,s&&!KB(o)?i.from:void 0)}return n.parent==null?GB:null}function GB(){return 0}class A1 extends Tp{constructor(e,t,r){super(e.state,e.options),this.base=e,this.pos=t,this.context=r}get node(){return this.context.node}static create(e,t,r){return new A1(e,t,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let t=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(t.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(YB(r,e))break;t=this.state.doc.lineAt(r.from)}return this.lineIndent(t.from)}continue(){return $I(this.context.next,this.base,this.pos)}}function YB(n,e){for(let t=e;t;t=t.parent)if(n==t)return!0;return!1}function XB(n){let e=n.node,t=e.childAfter(e.from),r=e.lastChild;if(!t)return null;let i=n.options.simulateBreak,s=n.state.doc.lineAt(t.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let l=t.to;;){let a=e.childAfter(l);if(!a||a==r)return null;if(!a.type.isSkipped){if(a.from>=o)return null;let u=/^ */.exec(s.text.slice(t.to-s.from))[0].length;return{from:t.from,to:t.to+u}}l=a.to}}function JB(n,e,t,r,i){let s=n.textAfter,o=s.match(/^\s*/)[0].length,l=r&&s.slice(o,o+r.length)==r||i==n.pos+o,a=XB(n);return a?l?n.column(a.from):n.column(a.to):n.baseIndent+(l?0:n.unit*t)}function ZB({except:n,units:e=1}={}){return t=>{let r=n&&n.test(t.textAfter);return t.baseIndent+(r?0:e*t.unit)}}const eF=200;function tF(){return ye.transactionFilter.of(n=>{if(!n.docChanged||!n.isUserEvent("input.type")&&!n.isUserEvent("input.complete"))return n;let e=n.startState.languageDataAt("indentOnInput",n.startState.selection.main.head);if(!e.length)return n;let t=n.newDoc,{head:r}=n.newSelection.main,i=t.lineAt(r);if(r>i.from+eF)return n;let s=t.sliceString(i.from,r);if(!e.some(u=>u.test(s)))return n;let{state:o}=n,l=-1,a=[];for(let{head:u}of o.selection.ranges){let c=o.doc.lineAt(u);if(c.from==l)continue;l=c.from;let f=C1(o,c.from);if(f==null)continue;let d=/^\s*/.exec(c.text)[0],p=Ku(o,f);d!=p&&a.push({from:c.from,to:c.from+d.length,insert:p})}return a.length?[n,{changes:a,sequential:!0}]:n})}const nF=G.define(),UI=new pe;function rF(n,e,t){let r=kt(n);if(r.length<t)return null;let i=r.resolveStack(t,1),s=null;for(let o=i;o;o=o.next){let l=o.node;if(l.to<=t||l.from>t)continue;if(s&&l.from<e)break;let a=l.type.prop(UI);if(a&&(l.to<r.length-50||r.length==n.doc.length||!iF(l))){let u=a(l,n);u&&u.from<=t&&u.from>=e&&u.to>t&&(s=u)}}return s}function iF(n){let e=n.lastChild;return e&&e.to==n.to&&e.type.isError}function xd(n,e,t){for(let r of n.facet(nF)){let i=r(n,e,t);if(i)return i}return rF(n,e,t)}function jI(n,e){let t=e.mapPos(n.from,1),r=e.mapPos(n.to,-1);return t>=r?void 0:{from:t,to:r}}const Cp=ue.define({map:jI}),bc=ue.define({map:jI});function HI(n){let e=[];for(let{head:t}of n.state.selection.ranges)e.some(r=>r.from<=t&&r.to>=t)||e.push(n.lineBlockAt(t));return e}const ro=Vt.define({create(){return ne.none},update(n,e){n=n.map(e.changes);for(let t of e.effects)if(t.is(Cp)&&!sF(n,t.value.from,t.value.to)){let{preparePlaceholder:r}=e.state.facet(KI),i=r?ne.replace({widget:new fF(r(e.state,t.value))}):ib;n=n.update({add:[i.range(t.value.from,t.value.to)]})}else t.is(bc)&&(n=n.update({filter:(r,i)=>t.value.from!=r||t.value.to!=i,filterFrom:t.value.from,filterTo:t.value.to}));if(e.selection){let t=!1,{head:r}=e.selection.main;n.between(r,r,(i,s)=>{i<r&&s>r&&(t=!0)}),t&&(n=n.update({filterFrom:r,filterTo:r,filter:(i,s)=>s<=r||i>=r}))}return n},provide:n=>q.decorations.from(n),toJSON(n,e){let t=[];return n.between(0,e.doc.length,(r,i)=>{t.push(r,i)}),t},fromJSON(n){if(!Array.isArray(n)||n.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let t=0;t<n.length;){let r=n[t++],i=n[t++];if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(ib.range(r,i))}return ne.set(e,!0)}});function Sd(n,e,t){var r;let i=null;return(r=n.field(ro,!1))===null||r===void 0||r.between(e,t,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function sF(n,e,t){let r=!1;return n.between(e,e,(i,s)=>{i==e&&s==t&&(r=!0)}),r}function WI(n,e){return n.field(ro,!1)?e:e.concat(ue.appendConfig.of(QI()))}const oF=n=>{for(let e of HI(n)){let t=xd(n.state,e.from,e.to);if(t)return n.dispatch({effects:WI(n.state,[Cp.of(t),qI(n,t)])}),!0}return!1},lF=n=>{if(!n.state.field(ro,!1))return!1;let e=[];for(let t of HI(n)){let r=Sd(n.state,t.from,t.to);r&&e.push(bc.of(r),qI(n,r,!1))}return e.length&&n.dispatch({effects:e}),e.length>0};function qI(n,e,t=!0){let r=n.state.doc.lineAt(e.from).number,i=n.state.doc.lineAt(e.to).number;return q.announce.of(`${n.state.phrase(t?"Folded lines":"Unfolded lines")} ${r} ${n.state.phrase("to")} ${i}.`)}const aF=n=>{let{state:e}=n,t=[];for(let r=0;r<e.doc.length;){let i=n.lineBlockAt(r),s=xd(e,i.from,i.to);s&&t.push(Cp.of(s)),r=(s?n.lineBlockAt(s.to):i).to+1}return t.length&&n.dispatch({effects:WI(n.state,t)}),!!t.length},uF=n=>{let e=n.state.field(ro,!1);if(!e||!e.size)return!1;let t=[];return e.between(0,n.state.doc.length,(r,i)=>{t.push(bc.of({from:r,to:i}))}),n.dispatch({effects:t}),!0},cF=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:oF},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:lF},{key:"Ctrl-Alt-[",run:aF},{key:"Ctrl-Alt-]",run:uF}],hF={placeholderDOM:null,preparePlaceholder:null,placeholderText:""},KI=G.define({combine(n){return Lr(n,hF)}});function QI(n){return[ro,mF]}function GI(n,e){let{state:t}=n,r=t.facet(KI),i=o=>{let l=n.lineBlockAt(n.posAtDOM(o.target)),a=Sd(n.state,l.from,l.to);a&&n.dispatch({effects:bc.of(a)}),o.preventDefault()};if(r.placeholderDOM)return r.placeholderDOM(n,i,e);let s=document.createElement("span");return s.textContent=r.placeholderText,s.setAttribute("aria-label",t.phrase("folded code")),s.title=t.phrase("unfold"),s.className="cm-foldPlaceholder",s.onclick=i,s}const ib=ne.replace({widget:new class extends fi{toDOM(n){return GI(n,null)}}});class fF extends fi{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return GI(e,this.value)}}const dF={openText:"",closedText:"",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class hg extends li{constructor(e,t){super(),this.config=e,this.open=t}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let t=document.createElement("span");return t.textContent=this.open?this.config.openText:this.config.closedText,t.title=e.state.phrase(this.open?"Fold line":"Unfold line"),t}}function pF(n={}){let e=Object.assign(Object.assign({},dF),n),t=new hg(e,!0),r=new hg(e,!1),i=st.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(rs)!=o.state.facet(rs)||o.startState.field(ro,!1)!=o.state.field(ro,!1)||kt(o.startState)!=kt(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let l=new si;for(let a of o.viewportLineBlocks){let u=Sd(o.state,a.from,a.to)?r:xd(o.state,a.from,a.to)?t:null;u&&l.add(a.from,a.from,u)}return l.finish()}}),{domEventHandlers:s}=e;return[i,pB({class:"cm-foldGutter",markers(o){var l;return((l=o.plugin(i))===null||l===void 0?void 0:l.markers)||xe.empty},initialSpacer(){return new hg(e,!1)},domEventHandlers:Object.assign(Object.assign({},s),{click:(o,l,a)=>{if(s.click&&s.click(o,l,a))return!0;let u=Sd(o.state,l.from,l.to);if(u)return o.dispatch({effects:bc.of(u)}),!0;let c=xd(o.state,l.from,l.to);return c?(o.dispatch({effects:Cp.of(c)}),!0):!1}})}),QI()]}const mF=q.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Ql{constructor(e,t){this.specs=e;let r;function i(l){let a=Zi.newName();return(r||(r=Object.create(null)))["."+a]=l,a}const s=typeof t.all=="string"?t.all:t.all?i(t.all):void 0,o=t.scope;this.scope=o instanceof or?l=>l.prop(Jo)==o.data:o?l=>l==o:void 0,this.style=BI(e.map(l=>({tag:l.tag,class:l.class||i(Object.assign({},l,{tag:null}))})),{all:s}).style,this.module=r?new Zi(r):null,this.themeType=t.themeType}static define(e,t){return new Ql(e,t||{})}}const w0=G.define(),YI=G.define({combine(n){return n.length?[n[0]]:null}});function fg(n){let e=n.facet(w0);return e.length?e:n.facet(YI)}function I1(n,e){let t=[yF],r;return n instanceof Ql&&(n.module&&t.push(q.styleModule.of(n.module)),r=n.themeType),e!=null&&e.fallback?t.push(YI.of(n)):r?t.push(w0.computeN([q.darkTheme],i=>i.facet(q.darkTheme)==(r=="dark")?[n]:[])):t.push(w0.of(n)),t}class gF{constructor(e){this.markCache=Object.create(null),this.tree=kt(e.state),this.decorations=this.buildDeco(e,fg(e.state)),this.decoratedTo=e.viewport.to}update(e){let t=kt(e.state),r=fg(e.state),i=r!=fg(e.startState),{viewport:s}=e.view,o=e.changes.mapPos(this.decoratedTo,1);t.length<s.to&&!i&&t.type==this.tree.type&&o>=s.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(t!=this.tree||e.viewportChanged||i)&&(this.tree=t,this.decorations=this.buildDeco(e.view,r),this.decoratedTo=s.to)}buildDeco(e,t){if(!t||!this.tree.length)return ne.none;let r=new si;for(let{from:i,to:s}of e.visibleRanges)LB(this.tree,t,(o,l,a)=>{r.add(o,l,this.markCache[a]||(this.markCache[a]=ne.mark({class:a})))},i,s);return r.finish()}}const yF=mo.high(st.fromClass(gF,{decorations:n=>n.decorations})),vF=Ql.define([{tag:O.meta,color:"#404740"},{tag:O.link,textDecoration:"underline"},{tag:O.heading,textDecoration:"underline",fontWeight:"bold"},{tag:O.emphasis,fontStyle:"italic"},{tag:O.strong,fontWeight:"bold"},{tag:O.strikethrough,textDecoration:"line-through"},{tag:O.keyword,color:"#708"},{tag:[O.atom,O.bool,O.url,O.contentSeparator,O.labelName],color:"#219"},{tag:[O.literal,O.inserted],color:"#164"},{tag:[O.string,O.deleted],color:"#a11"},{tag:[O.regexp,O.escape,O.special(O.string)],color:"#e40"},{tag:O.definition(O.variableName),color:"#00f"},{tag:O.local(O.variableName),color:"#30a"},{tag:[O.typeName,O.namespace],color:"#085"},{tag:O.className,color:"#167"},{tag:[O.special(O.variableName),O.macroName],color:"#256"},{tag:O.definition(O.propertyName),color:"#00c"},{tag:O.comment,color:"#940"},{tag:O.invalid,color:"#f00"}]),wF=q.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),XI=1e4,JI="()[]{}",ZI=G.define({combine(n){return Lr(n,{afterCursor:!0,brackets:JI,maxScanDistance:XI,renderMatch:SF})}}),_F=ne.mark({class:"cm-matchingBracket"}),xF=ne.mark({class:"cm-nonmatchingBracket"});function SF(n){let e=[],t=n.matched?_F:xF;return e.push(t.range(n.start.from,n.start.to)),n.end&&e.push(t.range(n.end.from,n.end.to)),e}const bF=Vt.define({create(){return ne.none},update(n,e){if(!e.docChanged&&!e.selection)return n;let t=[],r=e.state.facet(ZI);for(let i of e.state.selection.ranges){if(!i.empty)continue;let s=Cr(e.state,i.head,-1,r)||i.head>0&&Cr(e.state,i.head-1,1,r)||r.afterCursor&&(Cr(e.state,i.head,1,r)||i.head<e.state.doc.length&&Cr(e.state,i.head+1,-1,r));s&&(t=t.concat(r.renderMatch(s,e.state)))}return ne.set(t,!0)},provide:n=>q.decorations.from(n)}),kF=[bF,wF];function EF(n={}){return[ZI.of(n),kF]}const TF=new pe;function _0(n,e,t){let r=n.prop(e<0?pe.openedBy:pe.closedBy);if(r)return r;if(n.name.length==1){let i=t.indexOf(n.name);if(i>-1&&i%2==(e<0?1:0))return[t[i+e]]}return null}function x0(n){let e=n.type.prop(TF);return e?e(n.node):n}function Cr(n,e,t,r={}){let i=r.maxScanDistance||XI,s=r.brackets||JI,o=kt(n),l=o.resolveInner(e,t);for(let a=l;a;a=a.parent){let u=_0(a.type,t,s);if(u&&a.from<a.to){let c=x0(a);if(c&&(t>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return CF(n,e,t,a,c,u,s)}}return AF(n,e,t,o,l.type,i,s)}function CF(n,e,t,r,i,s,o){let l=r.parent,a={from:i.from,to:i.to},u=0,c=l==null?void 0:l.cursor();if(c&&(t<0?c.childBefore(r.from):c.childAfter(r.to)))do if(t<0?c.to<=r.from:c.from>=r.to){if(u==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let f=x0(c);return{start:a,end:f?{from:f.from,to:f.to}:void 0,matched:!0}}else if(_0(c.type,t,o))u++;else if(_0(c.type,-t,o)){if(u==0){let f=x0(c);return{start:a,end:f&&f.from<f.to?{from:f.from,to:f.to}:void 0,matched:!1}}u--}}while(t<0?c.prevSibling():c.nextSibling());return{start:a,matched:!1}}function AF(n,e,t,r,i,s,o){let l=t<0?n.sliceDoc(e-1,e):n.sliceDoc(e,e+1),a=o.indexOf(l);if(a<0||a%2==0!=t>0)return null;let u={from:t<0?e-1:e,to:t>0?e+1:e},c=n.doc.iterRange(e,t>0?n.doc.length:0),f=0;for(let d=0;!c.next().done&&d<=s;){let p=c.value;t<0&&(d+=p.length);let y=e+d*t;for(let v=t>0?0:p.length-1,E=t>0?p.length:-1;v!=E;v+=t){let w=o.indexOf(p[v]);if(!(w<0||r.resolveInner(y+v,1).type!=i))if(w%2==0==t>0)f++;else{if(f==1)return{start:u,end:{from:y+v,to:y+v+1},matched:w>>1==a>>1};f--}}t>0&&(d+=p.length)}return c.done?{start:u,matched:!1}:null}const IF=Object.create(null),sb=[xn.none],ob=[],lb=Object.create(null),PF=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])PF[n]=RF(IF,e);function dg(n,e){ob.indexOf(n)>-1||(ob.push(n),console.warn(e))}function RF(n,e){let t=[];for(let l of e.split(" ")){let a=[];for(let u of l.split(".")){let c=n[u]||O[u];c?typeof c=="function"?a.length?a=a.map(c):dg(u,`Modifier ${u} used at start of tag`):a.length?dg(u,`Tag ${u} used as modifier`):a=Array.isArray(c)?c:[c]:dg(u,`Unknown highlighting tag ${u}`)}for(let u of a)t.push(u)}if(!t.length)return 0;let r=e.replace(/ /g,"_"),i=r+" "+t.map(l=>l.id),s=lb[i];if(s)return s.id;let o=lb[i]=xn.define({id:sb.length,name:r,props:[VI({[r]:t})]});return sb.push(o),o.id}Ue.RTL,Ue.LTR;const DF=n=>{let{state:e}=n,t=e.doc.lineAt(e.selection.main.from),r=R1(n.state,t.from);return r.line?OF(n):r.block?NF(n):!1};function P1(n,e){return({state:t,dispatch:r})=>{if(t.readOnly)return!1;let i=n(e,t);return i?(r(t.update(i)),!0):!1}}const OF=P1(BF,0),MF=P1(eP,0),NF=P1((n,e)=>eP(n,e,LF(e)),0);function R1(n,e){let t=n.languageDataAt("commentTokens",e);return t.length?t[0]:{}}const Aa=50;function VF(n,{open:e,close:t},r,i){let s=n.sliceDoc(r-Aa,r),o=n.sliceDoc(i,i+Aa),l=/\s*$/.exec(s)[0].length,a=/^\s*/.exec(o)[0].length,u=s.length-l;if(s.slice(u-e.length,u)==e&&o.slice(a,a+t.length)==t)return{open:{pos:r-l,margin:l&&1},close:{pos:i+a,margin:a&&1}};let c,f;i-r<=2*Aa?c=f=n.sliceDoc(r,i):(c=n.sliceDoc(r,r+Aa),f=n.sliceDoc(i-Aa,i));let d=/^\s*/.exec(c)[0].length,p=/\s*$/.exec(f)[0].length,y=f.length-p-t.length;return c.slice(d,d+e.length)==e&&f.slice(y,y+t.length)==t?{open:{pos:r+d+e.length,margin:/\s/.test(c.charAt(d+e.length))?1:0},close:{pos:i-p-t.length,margin:/\s/.test(f.charAt(y-1))?1:0}}:null}function LF(n){let e=[];for(let t of n.selection.ranges){let r=n.doc.lineAt(t.from),i=t.to<=r.to?r:n.doc.lineAt(t.to);i.from>r.from&&i.from==t.to&&(i=t.to==r.to+1?r:n.doc.lineAt(t.to-1));let s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=i.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:i.to})}return e}function eP(n,e,t=e.selection.ranges){let r=t.map(s=>R1(e,s.from).block);if(!r.every(s=>s))return null;let i=t.map((s,o)=>VF(e,r[o],s.from,s.to));if(n!=2&&!i.every(s=>s))return{changes:e.changes(t.map((s,o)=>i[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(n!=1&&i.some(s=>s)){let s=[];for(let o=0,l;o<i.length;o++)if(l=i[o]){let a=r[o],{open:u,close:c}=l;s.push({from:u.pos-a.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+a.close.length})}return{changes:s}}return null}function BF(n,e,t=e.selection.ranges){let r=[],i=-1;for(let{from:s,to:o}of t){let l=r.length,a=1e9,u=R1(e,s).line;if(u){for(let c=s;c<=o;){let f=e.doc.lineAt(c);if(f.from>i&&(s==o||o>f.from)){i=f.from;let d=/^\s*/.exec(f.text)[0].length,p=d==f.length,y=f.text.slice(d,d+u.length)==u?d:-1;d<f.text.length&&d<a&&(a=d),r.push({line:f,comment:y,token:u,indent:d,empty:p,single:!1})}c=f.to+1}if(a<1e9)for(let c=l;c<r.length;c++)r[c].indent<r[c].line.text.length&&(r[c].indent=a);r.length==l+1&&(r[l].single=!0)}}if(n!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:l,token:a,indent:u,empty:c,single:f}of r)(f||!c)&&s.push({from:l.from+u,insert:a+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(n!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:l,token:a}of r)if(l>=0){let u=o.from+l,c=u+a.length;o.text[c-o.from]==" "&&c++,s.push({from:u,to:c})}return{changes:s}}return null}const S0=Vr.define(),FF=Vr.define(),zF=G.define(),tP=G.define({combine(n){return Lr(n,{minDepth:100,newGroupDelay:500,joinToEvent:(e,t)=>t},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,t)=>(r,i)=>e(r,i)||t(r,i)})}}),nP=Vt.define({create(){return Ar.empty},update(n,e){let t=e.state.facet(tP),r=e.annotation(S0);if(r){let a=yn.fromTransaction(e,r.selection),u=r.side,c=u==0?n.undone:n.done;return a?c=bd(c,c.length,t.minDepth,a):c=sP(c,e.startState.selection),new Ar(u==0?r.rest:c,u==0?c:r.rest)}let i=e.annotation(FF);if((i=="full"||i=="before")&&(n=n.isolate()),e.annotation(gt.addToHistory)===!1)return e.changes.empty?n:n.addMapping(e.changes.desc);let s=yn.fromTransaction(e),o=e.annotation(gt.time),l=e.annotation(gt.userEvent);return s?n=n.addChanges(s,o,l,t,e):e.selection&&(n=n.addSelection(e.startState.selection,o,l,t.newGroupDelay)),(i=="full"||i=="after")&&(n=n.isolate()),n},toJSON(n){return{done:n.done.map(e=>e.toJSON()),undone:n.undone.map(e=>e.toJSON())}},fromJSON(n){return new Ar(n.done.map(yn.fromJSON),n.undone.map(yn.fromJSON))}});function $F(n={}){return[nP,tP.of(n),q.domEventHandlers({beforeinput(e,t){let r=e.inputType=="historyUndo"?rP:e.inputType=="historyRedo"?b0:null;return r?(e.preventDefault(),r(t)):!1}})]}function Ap(n,e){return function({state:t,dispatch:r}){if(!e&&t.readOnly)return!1;let i=t.field(nP,!1);if(!i)return!1;let s=i.pop(n,t,e);return s?(r(s),!0):!1}}const rP=Ap(0,!1),b0=Ap(1,!1),UF=Ap(0,!0),jF=Ap(1,!0);class yn{constructor(e,t,r,i,s){this.changes=e,this.effects=t,this.mapped=r,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new yn(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,t,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(t=this.mapped)===null||t===void 0?void 0:t.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new yn(e.changes&&pt.fromJSON(e.changes),[],e.mapped&&Or.fromJSON(e.mapped),e.startSelection&&B.fromJSON(e.startSelection),e.selectionsAfter.map(B.fromJSON))}static fromTransaction(e,t){let r=Un;for(let i of e.startState.facet(zF)){let s=i(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new yn(e.changes.invert(e.startState.doc),r,void 0,t||e.startState.selection,Un)}static selection(e){return new yn(void 0,Un,void 0,void 0,e)}}function bd(n,e,t,r){let i=e+1>t+20?e-t-1:0,s=n.slice(i,e);return s.push(r),s}function HF(n,e){let t=[],r=!1;return n.iterChangedRanges((i,s)=>t.push(i,s)),e.iterChangedRanges((i,s,o,l)=>{for(let a=0;a<t.length;){let u=t[a++],c=t[a++];l>=u&&o<=c&&(r=!0)}}),r}function WF(n,e){return n.ranges.length==e.ranges.length&&n.ranges.filter((t,r)=>t.empty!=e.ranges[r].empty).length===0}function iP(n,e){return n.length?e.length?n.concat(e):n:e}const Un=[],qF=200;function sP(n,e){if(n.length){let t=n[n.length-1],r=t.selectionsAfter.slice(Math.max(0,t.selectionsAfter.length-qF));return r.length&&r[r.length-1].eq(e)?n:(r.push(e),bd(n,n.length-1,1e9,t.setSelAfter(r)))}else return[yn.selection([e])]}function KF(n){let e=n[n.length-1],t=n.slice();return t[n.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),t}function pg(n,e){if(!n.length)return n;let t=n.length,r=Un;for(;t;){let i=QF(n[t-1],e,r);if(i.changes&&!i.changes.empty||i.effects.length){let s=n.slice(0,t);return s[t-1]=i,s}else e=i.mapped,t--,r=i.selectionsAfter}return r.length?[yn.selection(r)]:Un}function QF(n,e,t){let r=iP(n.selectionsAfter.length?n.selectionsAfter.map(l=>l.map(e)):Un,t);if(!n.changes)return yn.selection(r);let i=n.changes.map(e),s=e.mapDesc(n.changes,!0),o=n.mapped?n.mapped.composeDesc(s):s;return new yn(i,ue.mapEffects(n.effects,e),o,n.startSelection.map(s),r)}const GF=/^(input\.type|delete)($|\.)/;class Ar{constructor(e,t,r=0,i=void 0){this.done=e,this.undone=t,this.prevTime=r,this.prevUserEvent=i}isolate(){return this.prevTime?new Ar(this.done,this.undone):this}addChanges(e,t,r,i,s){let o=this.done,l=o[o.length-1];return l&&l.changes&&!l.changes.empty&&e.changes&&(!r||GF.test(r))&&(!l.selectionsAfter.length&&t-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,HF(l.changes,e.changes))||r=="input.type.compose")?o=bd(o,o.length-1,i.minDepth,new yn(e.changes.compose(l.changes),iP(ue.mapEffects(e.effects,l.changes),l.effects),l.mapped,l.startSelection,Un)):o=bd(o,o.length,i.minDepth,e),new Ar(o,Un,t,r)}addSelection(e,t,r,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Un;return s.length>0&&t-this.prevTime<i&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&WF(s[s.length-1],e)?this:new Ar(sP(this.done,e),this.undone,t,r)}addMapping(e){return new Ar(pg(this.done,e),pg(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,t,r){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1],o=s.selectionsAfter[0]||t.selection;if(r&&s.selectionsAfter.length)return t.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:S0.of({side:e,rest:KF(i),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let l=i.length==1?Un:i.slice(0,i.length-1);return s.mapped&&(l=pg(l,s.mapped)),t.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:S0.of({side:e,rest:l,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ar.empty=new Ar(Un,Un);const YF=[{key:"Mod-z",run:rP,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:b0,preventDefault:!0},{linux:"Ctrl-Shift-z",run:b0,preventDefault:!0},{key:"Mod-u",run:UF,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:jF,preventDefault:!0}];function Gl(n,e){return B.create(n.ranges.map(e),n.mainIndex)}function Br(n,e){return n.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function pr({state:n,dispatch:e},t){let r=Gl(n.selection,t);return r.eq(n.selection,!0)?!1:(e(Br(n,r)),!0)}function Ip(n,e){return B.cursor(e?n.to:n.from)}function oP(n,e){return pr(n,t=>t.empty?n.moveByChar(t,e):Ip(t,e))}function Qt(n){return n.textDirectionAt(n.state.selection.main.head)==Ue.LTR}const lP=n=>oP(n,!Qt(n)),aP=n=>oP(n,Qt(n));function uP(n,e){return pr(n,t=>t.empty?n.moveByGroup(t,e):Ip(t,e))}const XF=n=>uP(n,!Qt(n)),JF=n=>uP(n,Qt(n));function ZF(n,e,t){if(e.type.prop(t))return!0;let r=e.to-e.from;return r&&(r>2||/[^\s,.;:]/.test(n.sliceDoc(e.from,e.to)))||e.firstChild}function Pp(n,e,t){let r=kt(n).resolveInner(e.head),i=t?pe.closedBy:pe.openedBy;for(let a=e.head;;){let u=t?r.childAfter(a):r.childBefore(a);if(!u)break;ZF(n,u,i)?r=u:a=t?u.to:u.from}let s=r.type.prop(i),o,l;return s&&(o=t?Cr(n,r.from,1):Cr(n,r.to,-1))&&o.matched?l=t?o.end.to:o.end.from:l=t?r.to:r.from,B.cursor(l,t?-1:1)}const e3=n=>pr(n,e=>Pp(n.state,e,!Qt(n))),t3=n=>pr(n,e=>Pp(n.state,e,Qt(n)));function cP(n,e){return pr(n,t=>{if(!t.empty)return Ip(t,e);let r=n.moveVertically(t,e);return r.head!=t.head?r:n.moveToLineBoundary(t,e)})}const hP=n=>cP(n,!1),fP=n=>cP(n,!0);function dP(n){let e=n.scrollDOM.clientHeight<n.scrollDOM.scrollHeight-2,t=0,r=0,i;if(e){for(let s of n.state.facet(q.scrollMargins)){let o=s(n);o!=null&&o.top&&(t=Math.max(o==null?void 0:o.top,t)),o!=null&&o.bottom&&(r=Math.max(o==null?void 0:o.bottom,r))}i=n.scrollDOM.clientHeight-t-r}else i=(n.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:t,marginBottom:r,selfScroll:e,height:Math.max(n.defaultLineHeight,i-5)}}function pP(n,e){let t=dP(n),{state:r}=n,i=Gl(r.selection,o=>o.empty?n.moveVertically(o,e,t.height):Ip(o,e));if(i.eq(r.selection))return!1;let s;if(t.selfScroll){let o=n.coordsAtPos(r.selection.main.head),l=n.scrollDOM.getBoundingClientRect(),a=l.top+t.marginTop,u=l.bottom-t.marginBottom;o&&o.top>a&&o.bottom<u&&(s=q.scrollIntoView(i.main.head,{y:"start",yMargin:o.top-a}))}return n.dispatch(Br(r,i),{effects:s}),!0}const ab=n=>pP(n,!1),k0=n=>pP(n,!0);function cs(n,e,t){let r=n.lineBlockAt(e.head),i=n.moveToLineBoundary(e,t);if(i.head==e.head&&i.head!=(t?r.to:r.from)&&(i=n.moveToLineBoundary(e,t,!1)),!t&&i.head==r.from&&r.length){let s=/^\s*/.exec(n.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(i=B.cursor(r.from+s))}return i}const n3=n=>pr(n,e=>cs(n,e,!0)),r3=n=>pr(n,e=>cs(n,e,!1)),i3=n=>pr(n,e=>cs(n,e,!Qt(n))),s3=n=>pr(n,e=>cs(n,e,Qt(n))),o3=n=>pr(n,e=>B.cursor(n.lineBlockAt(e.head).from,1)),l3=n=>pr(n,e=>B.cursor(n.lineBlockAt(e.head).to,-1));function a3(n,e,t){let r=!1,i=Gl(n.selection,s=>{let o=Cr(n,s.head,-1)||Cr(n,s.head,1)||s.head>0&&Cr(n,s.head-1,1)||s.head<n.doc.length&&Cr(n,s.head+1,-1);if(!o||!o.end)return s;r=!0;let l=o.start.from==s.head?o.end.to:o.end.from;return B.cursor(l)});return r?(e(Br(n,i)),!0):!1}const u3=({state:n,dispatch:e})=>a3(n,e);function er(n,e){let t=Gl(n.state.selection,r=>{let i=e(r);return B.range(r.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return t.eq(n.state.selection)?!1:(n.dispatch(Br(n.state,t)),!0)}function mP(n,e){return er(n,t=>n.moveByChar(t,e))}const gP=n=>mP(n,!Qt(n)),yP=n=>mP(n,Qt(n));function vP(n,e){return er(n,t=>n.moveByGroup(t,e))}const c3=n=>vP(n,!Qt(n)),h3=n=>vP(n,Qt(n)),f3=n=>er(n,e=>Pp(n.state,e,!Qt(n))),d3=n=>er(n,e=>Pp(n.state,e,Qt(n)));function wP(n,e){return er(n,t=>n.moveVertically(t,e))}const _P=n=>wP(n,!1),xP=n=>wP(n,!0);function SP(n,e){return er(n,t=>n.moveVertically(t,e,dP(n).height))}const ub=n=>SP(n,!1),cb=n=>SP(n,!0),p3=n=>er(n,e=>cs(n,e,!0)),m3=n=>er(n,e=>cs(n,e,!1)),g3=n=>er(n,e=>cs(n,e,!Qt(n))),y3=n=>er(n,e=>cs(n,e,Qt(n))),v3=n=>er(n,e=>B.cursor(n.lineBlockAt(e.head).from)),w3=n=>er(n,e=>B.cursor(n.lineBlockAt(e.head).to)),hb=({state:n,dispatch:e})=>(e(Br(n,{anchor:0})),!0),fb=({state:n,dispatch:e})=>(e(Br(n,{anchor:n.doc.length})),!0),db=({state:n,dispatch:e})=>(e(Br(n,{anchor:n.selection.main.anchor,head:0})),!0),pb=({state:n,dispatch:e})=>(e(Br(n,{anchor:n.selection.main.anchor,head:n.doc.length})),!0),_3=({state:n,dispatch:e})=>(e(n.update({selection:{anchor:0,head:n.doc.length},userEvent:"select"})),!0),x3=({state:n,dispatch:e})=>{let t=Rp(n).map(({from:r,to:i})=>B.range(r,Math.min(i+1,n.doc.length)));return e(n.update({selection:B.create(t),userEvent:"select"})),!0},S3=({state:n,dispatch:e})=>{let t=Gl(n.selection,r=>{let i=kt(n),s=i.resolveStack(r.from,1);if(r.empty){let o=i.resolveStack(r.from,-1);o.node.from>=s.node.from&&o.node.to<=s.node.to&&(s=o)}for(let o=s;o;o=o.next){let{node:l}=o;if((l.from<r.from&&l.to>=r.to||l.to>r.to&&l.from<=r.from)&&o.next)return B.range(l.to,l.from)}return r});return t.eq(n.selection)?!1:(e(Br(n,t)),!0)},b3=({state:n,dispatch:e})=>{let t=n.selection,r=null;return t.ranges.length>1?r=B.create([t.main]):t.main.empty||(r=B.create([B.cursor(t.main.head)])),r?(e(Br(n,r)),!0):!1};function kc(n,e){if(n.state.readOnly)return!1;let t="delete.selection",{state:r}=n,i=r.changeByRange(s=>{let{from:o,to:l}=s;if(o==l){let a=e(s);a<o?(t="delete.backward",a=Dh(n,a,!1)):a>o&&(t="delete.forward",a=Dh(n,a,!0)),o=Math.min(o,a),l=Math.max(l,a)}else o=Dh(n,o,!1),l=Dh(n,l,!0);return o==l?{range:s}:{changes:{from:o,to:l},range:B.cursor(o,o<s.head?-1:1)}});return i.changes.empty?!1:(n.dispatch(r.update(i,{scrollIntoView:!0,userEvent:t,effects:t=="delete.selection"?q.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function Dh(n,e,t){if(n instanceof q)for(let r of n.state.facet(q.atomicRanges).map(i=>i(n)))r.between(e,e,(i,s)=>{i<e&&s>e&&(e=t?s:i)});return e}const bP=(n,e,t)=>kc(n,r=>{let i=r.from,{state:s}=n,o=s.doc.lineAt(i),l,a;if(t&&!e&&i>o.from&&i<o.from+200&&!/[^ \t]/.test(l=o.text.slice(0,i-o.from))){if(l[l.length-1]=="	")return i-1;let u=Kl(l,s.tabSize),c=u%_d(s)||_d(s);for(let f=0;f<c&&l[l.length-1-f]==" ";f++)i--;a=i}else a=Dt(o.text,i-o.from,e,e)+o.from,a==i&&o.number!=(e?s.doc.lines:1)?a+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(a-o.from,i-o.from))&&(a=Dt(o.text,a-o.from,!1,!1)+o.from);return a}),E0=n=>bP(n,!1,!0),kP=n=>bP(n,!0,!1),EP=(n,e)=>kc(n,t=>{let r=t.head,{state:i}=n,s=i.doc.lineAt(r),o=i.charCategorizer(r);for(let l=null;;){if(r==(e?s.to:s.from)){r==t.head&&s.number!=(e?i.doc.lines:1)&&(r+=e?1:-1);break}let a=Dt(s.text,r-s.from,e)+s.from,u=s.text.slice(Math.min(r,a)-s.from,Math.max(r,a)-s.from),c=o(u);if(l!=null&&c!=l)break;(u!=" "||r!=t.head)&&(l=c),r=a}return r}),TP=n=>EP(n,!1),k3=n=>EP(n,!0),E3=n=>kc(n,e=>{let t=n.lineBlockAt(e.head).to;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),T3=n=>kc(n,e=>{let t=n.moveToLineBoundary(e,!1).head;return e.head>t?t:Math.max(0,e.head-1)}),C3=n=>kc(n,e=>{let t=n.moveToLineBoundary(e,!0).head;return e.head<t?t:Math.min(n.state.doc.length,e.head+1)}),A3=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:Se.of(["",""])},range:B.cursor(r.from)}));return e(n.update(t,{scrollIntoView:!0,userEvent:"input"})),!0},I3=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=n.changeByRange(r=>{if(!r.empty||r.from==0||r.from==n.doc.length)return{range:r};let i=r.from,s=n.doc.lineAt(i),o=i==s.from?i-1:Dt(s.text,i-s.from,!1)+s.from,l=i==s.to?i+1:Dt(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:l,insert:n.doc.slice(i,l).append(n.doc.slice(o,i))},range:B.cursor(l)}});return t.changes.empty?!1:(e(n.update(t,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Rp(n){let e=[],t=-1;for(let r of n.selection.ranges){let i=n.doc.lineAt(r.from),s=n.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=n.doc.lineAt(r.to-1)),t>=i.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:i.from,to:s.to,ranges:[r]});t=s.number+1}return e}function CP(n,e,t){if(n.readOnly)return!1;let r=[],i=[];for(let s of Rp(n)){if(t?s.to==n.doc.length:s.from==0)continue;let o=n.doc.lineAt(t?s.to+1:s.from-1),l=o.length+1;if(t){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+n.lineBreak});for(let a of s.ranges)i.push(B.range(Math.min(n.doc.length,a.anchor+l),Math.min(n.doc.length,a.head+l)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:n.lineBreak+o.text});for(let a of s.ranges)i.push(B.range(a.anchor-l,a.head-l))}}return r.length?(e(n.update({changes:r,scrollIntoView:!0,selection:B.create(i,n.selection.mainIndex),userEvent:"move.line"})),!0):!1}const P3=({state:n,dispatch:e})=>CP(n,e,!1),R3=({state:n,dispatch:e})=>CP(n,e,!0);function AP(n,e,t){if(n.readOnly)return!1;let r=[];for(let i of Rp(n))t?r.push({from:i.from,insert:n.doc.slice(i.from,i.to)+n.lineBreak}):r.push({from:i.to,insert:n.lineBreak+n.doc.slice(i.from,i.to)});return e(n.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const D3=({state:n,dispatch:e})=>AP(n,e,!1),O3=({state:n,dispatch:e})=>AP(n,e,!0),M3=n=>{if(n.state.readOnly)return!1;let{state:e}=n,t=e.changes(Rp(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),r=Gl(e.selection,i=>{let s;if(n.lineWrapping){let o=n.lineBlockAt(i.head),l=n.coordsAtPos(i.head,i.assoc||1);l&&(s=o.bottom+n.documentTop-l.bottom+n.defaultLineHeight/2)}return n.moveVertically(i,!0,s)}).map(t);return n.dispatch({changes:t,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function N3(n,e){if(/\(\)|\[\]|\{\}/.test(n.sliceDoc(e-1,e+1)))return{from:e,to:e};let t=kt(n).resolveInner(e),r=t.childBefore(e),i=t.childAfter(e),s;return r&&i&&r.to<=e&&i.from>=e&&(s=r.type.prop(pe.closedBy))&&s.indexOf(i.name)>-1&&n.doc.lineAt(r.to).from==n.doc.lineAt(i.from).from&&!/\S/.test(n.sliceDoc(r.to,i.from))?{from:r.to,to:i.from}:null}const mb=IP(!1),V3=IP(!0);function IP(n){return({state:e,dispatch:t})=>{if(e.readOnly)return!1;let r=e.changeByRange(i=>{let{from:s,to:o}=i,l=e.doc.lineAt(s),a=!n&&s==o&&N3(e,s);n&&(s=o=(o<=l.to?l:e.doc.lineAt(o)).to);let u=new Tp(e,{simulateBreak:s,simulateDoubleBreak:!!a}),c=C1(u,s);for(c==null&&(c=Kl(/^\s*/.exec(e.doc.lineAt(s).text)[0],e.tabSize));o<l.to&&/\s/.test(l.text[o-l.from]);)o++;a?{from:s,to:o}=a:s>l.from&&s<l.from+100&&!/\S/.test(l.text.slice(0,s))&&(s=l.from);let f=["",Ku(e,c)];return a&&f.push(Ku(e,u.lineIndent(l.from,-1))),{changes:{from:s,to:o,insert:Se.of(f)},range:B.cursor(s+1+f[1].length)}});return t(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function D1(n,e){let t=-1;return n.changeByRange(r=>{let i=[];for(let o=r.from;o<=r.to;){let l=n.doc.lineAt(o);l.number>t&&(r.empty||r.to>l.from)&&(e(l,i,r),t=l.number),o=l.to+1}let s=n.changes(i);return{changes:i,range:B.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const L3=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let t=Object.create(null),r=new Tp(n,{overrideIndentation:s=>{let o=t[s];return o??-1}}),i=D1(n,(s,o,l)=>{let a=C1(r,s.from);if(a==null)return;/\S/.test(s.text)||(a=0);let u=/^\s*/.exec(s.text)[0],c=Ku(n,a);(u!=c||l.from<s.from+u.length)&&(t[s.from]=a,o.push({from:s.from,to:s.from+u.length,insert:c}))});return i.changes.empty||e(n.update(i,{userEvent:"indent"})),!0},PP=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(D1(n,(t,r)=>{r.push({from:t.from,insert:n.facet(Ep)})}),{userEvent:"input.indent"})),!0),RP=({state:n,dispatch:e})=>n.readOnly?!1:(e(n.update(D1(n,(t,r)=>{let i=/^\s*/.exec(t.text)[0];if(!i)return;let s=Kl(i,n.tabSize),o=0,l=Ku(n,Math.max(0,s-_d(n)));for(;o<i.length&&o<l.length&&i.charCodeAt(o)==l.charCodeAt(o);)o++;r.push({from:t.from+o,to:t.from+i.length,insert:l.slice(o)})}),{userEvent:"delete.dedent"})),!0),B3=n=>(n.setTabFocusMode(),!0),F3=[{key:"Ctrl-b",run:lP,shift:gP,preventDefault:!0},{key:"Ctrl-f",run:aP,shift:yP},{key:"Ctrl-p",run:hP,shift:_P},{key:"Ctrl-n",run:fP,shift:xP},{key:"Ctrl-a",run:o3,shift:v3},{key:"Ctrl-e",run:l3,shift:w3},{key:"Ctrl-d",run:kP},{key:"Ctrl-h",run:E0},{key:"Ctrl-k",run:E3},{key:"Ctrl-Alt-h",run:TP},{key:"Ctrl-o",run:A3},{key:"Ctrl-t",run:I3},{key:"Ctrl-v",run:k0}],z3=[{key:"ArrowLeft",run:lP,shift:gP,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:XF,shift:c3,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:i3,shift:g3,preventDefault:!0},{key:"ArrowRight",run:aP,shift:yP,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:JF,shift:h3,preventDefault:!0},{mac:"Cmd-ArrowRight",run:s3,shift:y3,preventDefault:!0},{key:"ArrowUp",run:hP,shift:_P,preventDefault:!0},{mac:"Cmd-ArrowUp",run:hb,shift:db},{mac:"Ctrl-ArrowUp",run:ab,shift:ub},{key:"ArrowDown",run:fP,shift:xP,preventDefault:!0},{mac:"Cmd-ArrowDown",run:fb,shift:pb},{mac:"Ctrl-ArrowDown",run:k0,shift:cb},{key:"PageUp",run:ab,shift:ub},{key:"PageDown",run:k0,shift:cb},{key:"Home",run:r3,shift:m3,preventDefault:!0},{key:"Mod-Home",run:hb,shift:db},{key:"End",run:n3,shift:p3,preventDefault:!0},{key:"Mod-End",run:fb,shift:pb},{key:"Enter",run:mb,shift:mb},{key:"Mod-a",run:_3},{key:"Backspace",run:E0,shift:E0},{key:"Delete",run:kP},{key:"Mod-Backspace",mac:"Alt-Backspace",run:TP},{key:"Mod-Delete",mac:"Alt-Delete",run:k3},{mac:"Mod-Backspace",run:T3},{mac:"Mod-Delete",run:C3}].concat(F3.map(n=>({mac:n.key,run:n.run,shift:n.shift}))),$3=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:e3,shift:f3},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:t3,shift:d3},{key:"Alt-ArrowUp",run:P3},{key:"Shift-Alt-ArrowUp",run:D3},{key:"Alt-ArrowDown",run:R3},{key:"Shift-Alt-ArrowDown",run:O3},{key:"Escape",run:b3},{key:"Mod-Enter",run:V3},{key:"Alt-l",mac:"Ctrl-l",run:x3},{key:"Mod-i",run:S3,preventDefault:!0},{key:"Mod-[",run:RP},{key:"Mod-]",run:PP},{key:"Mod-Alt-\\",run:L3},{key:"Shift-Mod-k",run:M3},{key:"Shift-Mod-\\",run:u3},{key:"Mod-/",run:DF},{key:"Alt-A",run:MF},{key:"Ctrl-m",mac:"Shift-Alt-m",run:B3}].concat(z3),U3={key:"Tab",run:PP,shift:RP};function Oe(){var n=arguments[0];typeof n=="string"&&(n=document.createElement(n));var e=1,t=arguments[1];if(t&&typeof t=="object"&&t.nodeType==null&&!Array.isArray(t)){for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var i=t[r];typeof i=="string"?n.setAttribute(r,i):i!=null&&(n[r]=i)}e++}for(;e<arguments.length;e++)DP(n,arguments[e]);return n}function DP(n,e){if(typeof e=="string")n.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)n.appendChild(e);else if(Array.isArray(e))for(var t=0;t<e.length;t++)DP(n,e[t]);else throw new RangeError("Unsupported child node: "+e)}const gb=typeof String.prototype.normalize=="function"?n=>n.normalize("NFKD"):n=>n;class Dl{constructor(e,t,r=0,i=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,i),this.bufferStart=r,this.normalize=s?l=>s(gb(l)):gb,this.query=this.normalize(t)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return hn(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let t=l1(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=kr(e);let i=this.normalize(t);if(i.length)for(let s=0,o=r;;s++){let l=i.charCodeAt(s),a=this.match(l,o,this.bufferPos+this.bufferStart);if(s==i.length-1){if(a)return this.value=a,this;break}o==r&&s<t.length&&t.charCodeAt(s)==l&&o++}}}match(e,t,r){let i=null;for(let s=0;s<this.matches.length;s+=2){let o=this.matches[s],l=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?i={from:this.matches[s+1],to:r}:(this.matches[s]++,l=!0)),l||(this.matches.splice(s,2),s-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?i={from:t,to:r}:this.matches.push(1,t)),i&&this.test&&!this.test(i.from,i.to,this.buffer,this.bufferStart)&&(i=null),i}}typeof Symbol<"u"&&(Dl.prototype[Symbol.iterator]=function(){return this});const OP={from:-1,to:-1,match:/.*/.exec("")},O1="gm"+(/x/.unicode==null?"":"u");class MP{constructor(e,t,r,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=OP,/\\[sWDnr]|\n|\r|\[\^/.test(t))return new NP(e,t,r,i,s);this.re=new RegExp(t,O1+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=e.iter();let o=e.lineAt(i);this.curLineStart=o.from,this.matchPos=kd(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let t=this.matchPos<=this.to&&this.re.exec(this.curLine);if(t){let r=this.curLineStart+t.index,i=r+t[0].length;if(this.matchPos=kd(this.text,i+(r==i?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<i||r>this.value.to)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const mg=new WeakMap;class ul{constructor(e,t){this.from=e,this.text=t}get to(){return this.from+this.text.length}static get(e,t,r){let i=mg.get(e);if(!i||i.from>=r||i.to<=t){let l=new ul(t,e.sliceString(t,r));return mg.set(e,l),l}if(i.from==t&&i.to==r)return i;let{text:s,from:o}=i;return o>t&&(s=e.sliceString(t,o)+s,o=t),i.to<r&&(s+=e.sliceString(i.to,r)),mg.set(e,new ul(o,s)),new ul(t,s.slice(t-o,r-o))}}class NP{constructor(e,t,r,i,s){this.text=e,this.to=s,this.done=!1,this.value=OP,this.matchPos=kd(e,i),this.re=new RegExp(t,O1+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=ul.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,t=this.re.exec(this.flat.text);if(t&&!t[0]&&t.index==e&&(this.re.lastIndex=e+1,t=this.re.exec(this.flat.text)),t){let r=this.flat.from+t.index,i=r+t[0].length;if((this.flat.to>=this.to||t.index+t[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,i,t)))return this.value={from:r,to:i,match:t},this.matchPos=kd(this.text,i+(r==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=ul.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(MP.prototype[Symbol.iterator]=NP.prototype[Symbol.iterator]=function(){return this});function j3(n){try{return new RegExp(n,O1),!0}catch{return!1}}function kd(n,e){if(e>=n.length)return e;let t=n.lineAt(e),r;for(;e<t.to&&(r=t.text.charCodeAt(e-t.from))>=56320&&r<57344;)e++;return e}function T0(n){let e=String(n.state.doc.lineAt(n.state.selection.main.head).number),t=Oe("input",{class:"cm-textfield",name:"line",value:e}),r=Oe("form",{class:"cm-gotoLine",onkeydown:s=>{s.keyCode==27?(s.preventDefault(),n.dispatch({effects:hu.of(!1)}),n.focus()):s.keyCode==13&&(s.preventDefault(),i())},onsubmit:s=>{s.preventDefault(),i()}},Oe("label",n.state.phrase("Go to line"),": ",t)," ",Oe("button",{class:"cm-button",type:"submit"},n.state.phrase("go")),Oe("button",{name:"close",onclick:()=>{n.dispatch({effects:hu.of(!1)}),n.focus()},"aria-label":n.state.phrase("close"),type:"button"},[""]));function i(){let s=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(t.value);if(!s)return;let{state:o}=n,l=o.doc.lineAt(o.selection.main.head),[,a,u,c,f]=s,d=c?+c.slice(1):0,p=u?+u:l.number;if(u&&f){let E=p/100;a&&(E=E*(a=="-"?-1:1)+l.number/o.doc.lines),p=Math.round(o.doc.lines*E)}else u&&a&&(p=p*(a=="-"?-1:1)+l.number);let y=o.doc.line(Math.max(1,Math.min(o.doc.lines,p))),v=B.cursor(y.from+Math.max(0,Math.min(d,y.length)));n.dispatch({effects:[hu.of(!1),q.scrollIntoView(v.from,{y:"center"})],selection:v}),n.focus()}return{dom:r}}const hu=ue.define(),yb=Vt.define({create(){return!0},update(n,e){for(let t of e.effects)t.is(hu)&&(n=t.value);return n},provide:n=>Wu.from(n,e=>e?T0:null)}),H3=n=>{let e=Hu(n,T0);if(!e){let t=[hu.of(!0)];n.state.field(yb,!1)==null&&t.push(ue.appendConfig.of([yb,W3])),n.dispatch({effects:t}),e=Hu(n,T0)}return e&&e.dom.querySelector("input").select(),!0},W3=q.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),q3={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},K3=G.define({combine(n){return Lr(n,q3,{highlightWordAroundCursor:(e,t)=>e||t,minSelectionLength:Math.min,maxMatches:Math.min})}});function Q3(n){return[Z3,J3]}const G3=ne.mark({class:"cm-selectionMatch"}),Y3=ne.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function vb(n,e,t,r){return(t==0||n(e.sliceDoc(t-1,t))!=We.Word)&&(r==e.doc.length||n(e.sliceDoc(r,r+1))!=We.Word)}function X3(n,e,t,r){return n(e.sliceDoc(t,t+1))==We.Word&&n(e.sliceDoc(r-1,r))==We.Word}const J3=st.fromClass(class{constructor(n){this.decorations=this.getDeco(n)}update(n){(n.selectionSet||n.docChanged||n.viewportChanged)&&(this.decorations=this.getDeco(n.view))}getDeco(n){let e=n.state.facet(K3),{state:t}=n,r=t.selection;if(r.ranges.length>1)return ne.none;let i=r.main,s,o=null;if(i.empty){if(!e.highlightWordAroundCursor)return ne.none;let a=t.wordAt(i.head);if(!a)return ne.none;o=t.charCategorizer(i.head),s=t.sliceDoc(a.from,a.to)}else{let a=i.to-i.from;if(a<e.minSelectionLength||a>200)return ne.none;if(e.wholeWords){if(s=t.sliceDoc(i.from,i.to),o=t.charCategorizer(i.head),!(vb(o,t,i.from,i.to)&&X3(o,t,i.from,i.to)))return ne.none}else if(s=t.sliceDoc(i.from,i.to),!s)return ne.none}let l=[];for(let a of n.visibleRanges){let u=new Dl(t.doc,s,a.from,a.to);for(;!u.next().done;){let{from:c,to:f}=u.value;if((!o||vb(o,t,c,f))&&(i.empty&&c<=i.from&&f>=i.to?l.push(Y3.range(c,f)):(c>=i.to||f<=i.from)&&l.push(G3.range(c,f)),l.length>e.maxMatches))return ne.none}}return ne.set(l)}},{decorations:n=>n.decorations}),Z3=q.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),e5=({state:n,dispatch:e})=>{let{selection:t}=n,r=B.create(t.ranges.map(i=>n.wordAt(i.head)||B.cursor(i.head)),t.mainIndex);return r.eq(t)?!1:(e(n.update({selection:r})),!0)};function t5(n,e){let{main:t,ranges:r}=n.selection,i=n.wordAt(t.head),s=i&&i.from==t.from&&i.to==t.to;for(let o=!1,l=new Dl(n.doc,e,r[r.length-1].to);;)if(l.next(),l.done){if(o)return null;l=new Dl(n.doc,e,0,Math.max(0,r[r.length-1].from-1)),o=!0}else{if(o&&r.some(a=>a.from==l.value.from))continue;if(s){let a=n.wordAt(l.value.from);if(!a||a.from!=l.value.from||a.to!=l.value.to)continue}return l.value}}const n5=({state:n,dispatch:e})=>{let{ranges:t}=n.selection;if(t.some(s=>s.from===s.to))return e5({state:n,dispatch:e});let r=n.sliceDoc(t[0].from,t[0].to);if(n.selection.ranges.some(s=>n.sliceDoc(s.from,s.to)!=r))return!1;let i=t5(n,r);return i?(e(n.update({selection:n.selection.addRange(B.range(i.from,i.to),!1),effects:q.scrollIntoView(i.to)})),!0):!1},Yl=G.define({combine(n){return Lr(n,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new p5(e),scrollToMatch:e=>q.scrollIntoView(e)})}});class VP{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||j3(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(t,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new o5(this):new i5(this)}getCursor(e,t=0,r){let i=e.doc?e:ye.create({doc:e});return r==null&&(r=i.doc.length),this.regexp?Do(this,i,t,r):Ro(this,i,t,r)}}class LP{constructor(e){this.spec=e}}function Ro(n,e,t,r){return new Dl(e.doc,n.unquoted,t,r,n.caseSensitive?void 0:i=>i.toLowerCase(),n.wholeWord?r5(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function r5(n,e){return(t,r,i,s)=>((s>t||s+i.length<r)&&(s=Math.max(0,t-2),i=n.sliceString(s,Math.min(n.length,r+2))),(e(Ed(i,t-s))!=We.Word||e(Td(i,t-s))!=We.Word)&&(e(Td(i,r-s))!=We.Word||e(Ed(i,r-s))!=We.Word))}class i5 extends LP{constructor(e){super(e)}nextMatch(e,t,r){let i=Ro(this.spec,e,r,e.doc.length).nextOverlapping();if(i.done){let s=Math.min(e.doc.length,t+this.spec.unquoted.length);i=Ro(this.spec,e,0,s).nextOverlapping()}return i.done||i.value.from==t&&i.value.to==r?null:i.value}prevMatchInRange(e,t,r){for(let i=r;;){let s=Math.max(t,i-1e4-this.spec.unquoted.length),o=Ro(this.spec,e,s,i),l=null;for(;!o.nextOverlapping().done;)l=o.value;if(l)return l;if(s==t)return null;i-=1e4}}prevMatch(e,t,r){let i=this.prevMatchInRange(e,0,t);return i||(i=this.prevMatchInRange(e,Math.max(0,r-this.spec.unquoted.length),e.doc.length)),i&&(i.from!=t||i.to!=r)?i:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,t){let r=Ro(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=Ro(this.spec,e,Math.max(0,t-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function Do(n,e,t,r){return new MP(e.doc,n.search,{ignoreCase:!n.caseSensitive,test:n.wholeWord?s5(e.charCategorizer(e.selection.main.head)):void 0},t,r)}function Ed(n,e){return n.slice(Dt(n,e,!1),e)}function Td(n,e){return n.slice(e,Dt(n,e))}function s5(n){return(e,t,r)=>!r[0].length||(n(Ed(r.input,r.index))!=We.Word||n(Td(r.input,r.index))!=We.Word)&&(n(Td(r.input,r.index+r[0].length))!=We.Word||n(Ed(r.input,r.index+r[0].length))!=We.Word)}class o5 extends LP{nextMatch(e,t,r){let i=Do(this.spec,e,r,e.doc.length).next();return i.done&&(i=Do(this.spec,e,0,t).next()),i.done?null:i.value}prevMatchInRange(e,t,r){for(let i=1;;i++){let s=Math.max(t,r-i*1e4),o=Do(this.spec,e,s,r),l=null;for(;!o.next().done;)l=o.value;if(l&&(s==t||l.from>s+10))return l;if(s==t)return null}}prevMatch(e,t,r){return this.prevMatchInRange(e,0,t)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(t,r)=>{if(r=="&")return e.match[0];if(r=="$")return"$";for(let i=r.length;i>0;i--){let s=+r.slice(0,i);if(s>0&&s<e.match.length)return e.match[s]+r.slice(i)}return t})}matchAll(e,t){let r=Do(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=t)return null;i.push(r.value)}return i}highlight(e,t,r,i){let s=Do(this.spec,e,Math.max(0,t-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Qu=ue.define(),M1=ue.define(),qi=Vt.define({create(n){return new gg(C0(n).create(),null)},update(n,e){for(let t of e.effects)t.is(Qu)?n=new gg(t.value.create(),n.panel):t.is(M1)&&(n=new gg(n.query,t.value?N1:null));return n},provide:n=>Wu.from(n,e=>e.panel)});class gg{constructor(e,t){this.query=e,this.panel=t}}const l5=ne.mark({class:"cm-searchMatch"}),a5=ne.mark({class:"cm-searchMatch cm-searchMatch-selected"}),u5=st.fromClass(class{constructor(n){this.view=n,this.decorations=this.highlight(n.state.field(qi))}update(n){let e=n.state.field(qi);(e!=n.startState.field(qi)||n.docChanged||n.selectionSet||n.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:n,panel:e}){if(!e||!n.spec.valid)return ne.none;let{view:t}=this,r=new si;for(let i=0,s=t.visibleRanges,o=s.length;i<o;i++){let{from:l,to:a}=s[i];for(;i<o-1&&a>s[i+1].from-2*250;)a=s[++i].to;n.highlight(t.state,l,a,(u,c)=>{let f=t.state.selection.ranges.some(d=>d.from==u&&d.to==c);r.add(u,c,f?a5:l5)})}return r.finish()}},{decorations:n=>n.decorations});function Ec(n){return e=>{let t=e.state.field(qi,!1);return t&&t.query.spec.valid?n(e,t):zP(e)}}const Cd=Ec((n,{query:e})=>{let{to:t}=n.state.selection.main,r=e.nextMatch(n.state,t,t);if(!r)return!1;let i=B.single(r.from,r.to),s=n.state.facet(Yl);return n.dispatch({selection:i,effects:[V1(n,r),s.scrollToMatch(i.main,n)],userEvent:"select.search"}),FP(n),!0}),Ad=Ec((n,{query:e})=>{let{state:t}=n,{from:r}=t.selection.main,i=e.prevMatch(t,r,r);if(!i)return!1;let s=B.single(i.from,i.to),o=n.state.facet(Yl);return n.dispatch({selection:s,effects:[V1(n,i),o.scrollToMatch(s.main,n)],userEvent:"select.search"}),FP(n),!0}),c5=Ec((n,{query:e})=>{let t=e.matchAll(n.state,1e3);return!t||!t.length?!1:(n.dispatch({selection:B.create(t.map(r=>B.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),h5=({state:n,dispatch:e})=>{let t=n.selection;if(t.ranges.length>1||t.main.empty)return!1;let{from:r,to:i}=t.main,s=[],o=0;for(let l=new Dl(n.doc,n.sliceDoc(r,i));!l.next().done;){if(s.length>1e3)return!1;l.value.from==r&&(o=s.length),s.push(B.range(l.value.from,l.value.to))}return e(n.update({selection:B.create(s,o),userEvent:"select.search.matches"})),!0},wb=Ec((n,{query:e})=>{let{state:t}=n,{from:r,to:i}=t.selection.main;if(t.readOnly)return!1;let s=e.nextMatch(t,r,r);if(!s)return!1;let o=s,l=[],a,u,c=[];if(o.from==r&&o.to==i&&(u=t.toText(e.getReplacement(o)),l.push({from:o.from,to:o.to,insert:u}),o=e.nextMatch(t,o.from,o.to),c.push(q.announce.of(t.phrase("replaced match on line $",t.doc.lineAt(r).number)+"."))),o){let f=l.length==0||l[0].from>=s.to?0:s.to-s.from-u.length;a=B.single(o.from-f,o.to-f),c.push(V1(n,o)),c.push(t.facet(Yl).scrollToMatch(a.main,n))}return n.dispatch({changes:l,selection:a,effects:c,userEvent:"input.replace"}),!0}),f5=Ec((n,{query:e})=>{if(n.state.readOnly)return!1;let t=e.matchAll(n.state,1e9).map(i=>{let{from:s,to:o}=i;return{from:s,to:o,insert:e.getReplacement(i)}});if(!t.length)return!1;let r=n.state.phrase("replaced $ matches",t.length)+".";return n.dispatch({changes:t,effects:q.announce.of(r),userEvent:"input.replace.all"}),!0});function N1(n){return n.state.facet(Yl).createPanel(n)}function C0(n,e){var t,r,i,s,o;let l=n.selection.main,a=l.empty||l.to>l.from+100?"":n.sliceDoc(l.from,l.to);if(e&&!a)return e;let u=n.facet(Yl);return new VP({search:((t=e==null?void 0:e.literal)!==null&&t!==void 0?t:u.literal)?a:a.replace(/\n/g,"\\n"),caseSensitive:(r=e==null?void 0:e.caseSensitive)!==null&&r!==void 0?r:u.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:u.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:u.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:u.wholeWord})}function BP(n){let e=Hu(n,N1);return e&&e.dom.querySelector("[main-field]")}function FP(n){let e=BP(n);e&&e==n.root.activeElement&&e.select()}const zP=n=>{let e=n.state.field(qi,!1);if(e&&e.panel){let t=BP(n);if(t&&t!=n.root.activeElement){let r=C0(n.state,e.query.spec);r.valid&&n.dispatch({effects:Qu.of(r)}),t.focus(),t.select()}}else n.dispatch({effects:[M1.of(!0),e?Qu.of(C0(n.state,e.query.spec)):ue.appendConfig.of(g5)]});return!0},$P=n=>{let e=n.state.field(qi,!1);if(!e||!e.panel)return!1;let t=Hu(n,N1);return t&&t.dom.contains(n.root.activeElement)&&n.focus(),n.dispatch({effects:M1.of(!1)}),!0},d5=[{key:"Mod-f",run:zP,scope:"editor search-panel"},{key:"F3",run:Cd,shift:Ad,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Cd,shift:Ad,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:$P,scope:"editor search-panel"},{key:"Mod-Shift-l",run:h5},{key:"Mod-Alt-g",run:H3},{key:"Mod-d",run:n5,preventDefault:!0}];class p5{constructor(e){this.view=e;let t=this.query=e.state.field(qi).query.spec;this.commit=this.commit.bind(this),this.searchField=Oe("input",{value:t.search,placeholder:bn(e,"Find"),"aria-label":bn(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Oe("input",{value:t.replace,placeholder:bn(e,"Replace"),"aria-label":bn(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Oe("input",{type:"checkbox",name:"case",form:"",checked:t.caseSensitive,onchange:this.commit}),this.reField=Oe("input",{type:"checkbox",name:"re",form:"",checked:t.regexp,onchange:this.commit}),this.wordField=Oe("input",{type:"checkbox",name:"word",form:"",checked:t.wholeWord,onchange:this.commit});function r(i,s,o){return Oe("button",{class:"cm-button",name:i,onclick:s,type:"button"},o)}this.dom=Oe("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,r("next",()=>Cd(e),[bn(e,"next")]),r("prev",()=>Ad(e),[bn(e,"previous")]),r("select",()=>c5(e),[bn(e,"all")]),Oe("label",null,[this.caseField,bn(e,"match case")]),Oe("label",null,[this.reField,bn(e,"regexp")]),Oe("label",null,[this.wordField,bn(e,"by word")]),...e.state.readOnly?[]:[Oe("br"),this.replaceField,r("replace",()=>wb(e),[bn(e,"replace")]),r("replaceAll",()=>f5(e),[bn(e,"replace all")])],Oe("button",{name:"close",onclick:()=>$P(e),"aria-label":bn(e,"close"),type:"button"},[""])])}commit(){let e=new VP({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Qu.of(e)}))}keydown(e){S4(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?Ad:Cd)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),wb(this.view))}update(e){for(let t of e.transactions)for(let r of t.effects)r.is(Qu)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Yl).top}}function bn(n,e){return n.state.phrase(e)}const Oh=30,Mh=/[\s\.,:;?!]/;function V1(n,{from:e,to:t}){let r=n.state.doc.lineAt(e),i=n.state.doc.lineAt(t).to,s=Math.max(r.from,e-Oh),o=Math.min(i,t+Oh),l=n.state.sliceDoc(s,o);if(s!=r.from){for(let a=0;a<Oh;a++)if(!Mh.test(l[a+1])&&Mh.test(l[a])){l=l.slice(a);break}}if(o!=i){for(let a=l.length-1;a>l.length-Oh;a--)if(!Mh.test(l[a-1])&&Mh.test(l[a])){l=l.slice(0,a);break}}return q.announce.of(`${n.state.phrase("current match")}. ${l} ${n.state.phrase("on line")} ${r.number}.`)}const m5=q.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),g5=[qi,mo.low(u5),m5];class UP{constructor(e,t,r,i){this.state=e,this.pos=t,this.explicit=r,this.view=i,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let t=kt(this.state).resolveInner(this.pos,-1);for(;t&&e.indexOf(t.name)<0;)t=t.parent;return t?{from:t.from,to:this.pos,text:this.state.sliceDoc(t.from,this.pos),type:t.type}:null}matchBefore(e){let t=this.state.doc.lineAt(this.pos),r=Math.max(t.from,this.pos-250),i=t.text.slice(r-t.from,this.pos-t.from),s=i.search(HP(e,!1));return s<0?null:{from:r+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,t,r){e=="abort"&&this.abortListeners&&(this.abortListeners.push(t),r&&r.onDocChange&&(this.abortOnDocChange=!0))}}function _b(n){let e=Object.keys(n).join(""),t=/\w/.test(e);return t&&(e=e.replace(/\w/g,"")),`[${t?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function y5(n){let e=Object.create(null),t=Object.create(null);for(let{label:i}of n){e[i[0]]=!0;for(let s=1;s<i.length;s++)t[i[s]]=!0}let r=_b(e)+_b(t)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function jP(n){let e=n.map(i=>typeof i=="string"?{label:i}:i),[t,r]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:y5(e);return i=>{let s=i.matchBefore(r);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:t}:null}}function v5(n,e){return t=>{for(let r=kt(t.state).resolveInner(t.pos,-1);r;r=r.parent){if(n.indexOf(r.name)>-1)return null;if(r.type.isTop)break}return e(t)}}class xb{constructor(e,t,r,i){this.completion=e,this.source=t,this.match=r,this.score=i}}function Ws(n){return n.selection.main.from}function HP(n,e){var t;let{source:r}=n,i=e&&r[0]!="^",s=r[r.length-1]!="$";return!i&&!s?n:new RegExp(`${i?"^":""}(?:${r})${s?"$":""}`,(t=n.flags)!==null&&t!==void 0?t:n.ignoreCase?"i":"")}const WP=Vr.define();function w5(n,e,t,r){let{main:i}=n.selection,s=t-i.from,o=r-i.from;return Object.assign(Object.assign({},n.changeByRange(l=>{if(l!=i&&t!=r&&n.sliceDoc(l.from+s,l.from+o)!=n.sliceDoc(t,r))return{range:l};let a=n.toText(e);return{changes:{from:l.from+s,to:r==i.from?l.to:l.from+o,insert:a},range:B.cursor(l.from+s+a.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const Sb=new WeakMap;function _5(n){if(!Array.isArray(n))return n;let e=Sb.get(n);return e||Sb.set(n,e=jP(n)),e}const Id=ue.define(),Gu=ue.define();class x5{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let t=0;t<e.length;){let r=hn(e,t),i=kr(r);this.chars.push(r);let s=e.slice(t,t+i),o=s.toUpperCase();this.folded.push(hn(o==s?s.toLowerCase():o,0)),t+=i}this.astral=e.length!=this.chars.length}ret(e,t){return this.score=e,this.matched=t,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:t,folded:r,any:i,precise:s,byWord:o}=this;if(t.length==1){let _=hn(e,0),b=kr(_),I=b==e.length?0:-100;if(_!=t[0])if(_==r[0])I+=-200;else return null;return this.ret(I,[0,b])}let l=e.indexOf(this.pattern);if(l==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let a=t.length,u=0;if(l<0){for(let _=0,b=Math.min(e.length,200);_<b&&u<a;){let I=hn(e,_);(I==t[u]||I==r[u])&&(i[u++]=_),_+=kr(I)}if(u<a)return null}let c=0,f=0,d=!1,p=0,y=-1,v=-1,E=/[a-z]/.test(e),w=!0;for(let _=0,b=Math.min(e.length,200),I=0;_<b&&f<a;){let D=hn(e,_);l<0&&(c<a&&D==t[c]&&(s[c++]=_),p<a&&(D==t[p]||D==r[p]?(p==0&&(y=_),v=_+1,p++):p=0));let M,x=D<255?D>=48&&D<=57||D>=97&&D<=122?2:D>=65&&D<=90?1:0:(M=l1(D))!=M.toLowerCase()?1:M!=M.toUpperCase()?2:0;(!_||x==1&&E||I==0&&x!=0)&&(t[f]==D||r[f]==D&&(d=!0)?o[f++]=_:o.length&&(w=!1)),I=x,_+=kr(D)}return f==a&&o[0]==0&&w?this.result(-100+(d?-200:0),o,e):p==a&&y==0?this.ret(-200-e.length+(v==e.length?0:-100),[0,v]):l>-1?this.ret(-700-e.length,[l,l+this.pattern.length]):p==a?this.ret(-900-e.length,[y,v]):f==a?this.result(-100+(d?-200:0)+-700+(w?0:-1100),o,e):t.length==2?null:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,t,r){let i=[],s=0;for(let o of t){let l=o+(this.astral?kr(hn(r,o)):1);s&&i[s-1]==o?i[s-1]=l:(i[s++]=o,i[s++]=l)}return this.ret(e-r.length,i)}}class S5{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let t=e.slice(0,this.pattern.length),r=t==this.pattern?0:t.toLowerCase()==this.folded?-200:null;return r==null?null:(this.matched=[0,t.length],this.score=r+(e.length==this.pattern.length?0:-100),this)}}const St=G.define({combine(n){return Lr(n,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:b5,filterStrict:!1,compareCompletions:(e,t)=>e.label.localeCompare(t.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,t)=>e&&t,closeOnBlur:(e,t)=>e&&t,icons:(e,t)=>e&&t,tooltipClass:(e,t)=>r=>bb(e(r),t(r)),optionClass:(e,t)=>r=>bb(e(r),t(r)),addToOptions:(e,t)=>e.concat(t),filterStrict:(e,t)=>e||t})}});function bb(n,e){return n?e?n+" "+e:n:e}function b5(n,e,t,r,i,s){let o=n.textDirection==Ue.RTL,l=o,a=!1,u="top",c,f,d=e.left-i.left,p=i.right-e.right,y=r.right-r.left,v=r.bottom-r.top;if(l&&d<Math.min(y,p)?l=!1:!l&&p<Math.min(y,d)&&(l=!0),y<=(l?d:p))c=Math.max(i.top,Math.min(t.top,i.bottom-v))-e.top,f=Math.min(400,l?d:p);else{a=!0,f=Math.min(400,(o?e.right:i.right-e.left)-30);let _=i.bottom-e.bottom;_>=v||_>e.top?c=t.bottom-e.top:(u="bottom",c=e.bottom-t.top)}let E=(e.bottom-e.top)/s.offsetHeight,w=(e.right-e.left)/s.offsetWidth;return{style:`${u}: ${c/E}px; max-width: ${f/w}px`,class:"cm-completionInfo-"+(a?o?"left-narrow":"right-narrow":l?"left":"right")}}function k5(n){let e=n.addToOptions.slice();return n.icons&&e.push({render(t){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),t.type&&r.classList.add(...t.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),r.setAttribute("aria-hidden","true"),r},position:20}),e.push({render(t,r,i,s){let o=document.createElement("span");o.className="cm-completionLabel";let l=t.displayLabel||t.label,a=0;for(let u=0;u<s.length;){let c=s[u++],f=s[u++];c>a&&o.appendChild(document.createTextNode(l.slice(a,c)));let d=o.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(l.slice(c,f))),d.className="cm-completionMatchedText",a=f}return a<l.length&&o.appendChild(document.createTextNode(l.slice(a))),o},position:50},{render(t){if(!t.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=t.detail,r},position:80}),e.sort((t,r)=>t.position-r.position).map(t=>t.render)}function yg(n,e,t){if(n<=t)return{from:0,to:n};if(e<0&&(e=0),e<=n>>1){let i=Math.floor(e/t);return{from:i*t,to:(i+1)*t}}let r=Math.floor((n-e)/t);return{from:n-(r+1)*t,to:n-r*t}}class E5{constructor(e,t,r){this.view=e,this.stateField=t,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:a=>this.placeInfo(a),key:this},this.space=null,this.currentClass="";let i=e.state.field(t),{options:s,selected:o}=i.open,l=e.state.facet(St);this.optionContent=k5(l),this.optionClass=l.optionClass,this.tooltipClass=l.tooltipClass,this.range=yg(s.length,o,l.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",a=>{let{options:u}=e.state.field(t).open;for(let c=a.target,f;c&&c!=this.dom;c=c.parentNode)if(c.nodeName=="LI"&&(f=/-(\d+)$/.exec(c.id))&&+f[1]<u.length){this.applyCompletion(e,u[+f[1]]),a.preventDefault();return}}),this.dom.addEventListener("focusout",a=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(St).closeOnBlur&&a.relatedTarget!=e.contentDOM&&e.dispatch({effects:Gu.of(null)})}),this.showOptions(s,i.id)}mount(){this.updateSel()}showOptions(e,t){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,t,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var t;let r=e.state.field(this.stateField),i=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),r!=i){let{options:s,selected:o,disabled:l}=r.open;(!i.open||i.open.options!=s)&&(this.range=yg(s.length,o,e.state.facet(St).maxRenderedOptions),this.showOptions(s,r.id)),this.updateSel(),l!=((t=i.open)===null||t===void 0?void 0:t.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!l)}}updateTooltipClass(e){let t=this.tooltipClass(e);if(t!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of t.split(" "))r&&this.dom.classList.add(r);this.currentClass=t}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),t=e.open;if((t.selected>-1&&t.selected<this.range.from||t.selected>=this.range.to)&&(this.range=yg(t.options.length,t.selected,this.view.state.facet(St).maxRenderedOptions),this.showOptions(t.options,e.id)),this.updateSelectedOption(t.selected)){this.destroyInfo();let{completion:r}=t.options[t.selected],{info:i}=r;if(!i)return;let s=typeof i=="string"?document.createTextNode(i):i(r);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,r)}).catch(o=>gn(this.view.state,o,"completion info")):this.addInfoPane(s,r)}}addInfoPane(e,t){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",e.nodeType!=null)r.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;r.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let t=null;for(let r=this.list.firstChild,i=this.range.from;r;r=r.nextSibling,i++)r.nodeName!="LI"||!r.id?i--:i==e?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),t=r):r.hasAttribute("aria-selected")&&r.removeAttribute("aria-selected");return t&&C5(this.list,t),t}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let t=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.documentElement;s={left:0,top:0,right:o.clientWidth,bottom:o.clientHeight}}return i.top>Math.min(s.bottom,t.bottom)-10||i.bottom<Math.max(s.top,t.top)+10?null:this.view.state.facet(St).positionInfo(this.view,t,i,r,s,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,t,r){const i=document.createElement("ul");i.id=t,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions")),i.addEventListener("mousedown",o=>{o.target==i&&o.preventDefault()});let s=null;for(let o=r.from;o<r.to;o++){let{completion:l,match:a}=e[o],{section:u}=l;if(u){let d=typeof u=="string"?u:u.name;if(d!=s&&(o>r.from||r.from==0))if(s=d,typeof u!="string"&&u.header)i.appendChild(u.header(u));else{let p=i.appendChild(document.createElement("completion-section"));p.textContent=d}}const c=i.appendChild(document.createElement("li"));c.id=t+"-"+o,c.setAttribute("role","option");let f=this.optionClass(l);f&&(c.className=f);for(let d of this.optionContent){let p=d(l,this.view.state,this.view,a);p&&c.appendChild(p)}}return r.from&&i.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function T5(n,e){return t=>new E5(t,n,e)}function C5(n,e){let t=n.getBoundingClientRect(),r=e.getBoundingClientRect(),i=t.height/n.offsetHeight;r.top<t.top?n.scrollTop-=(t.top-r.top)/i:r.bottom>t.bottom&&(n.scrollTop+=(r.bottom-t.bottom)/i)}function kb(n){return(n.boost||0)*100+(n.apply?10:0)+(n.info?5:0)+(n.type?1:0)}function A5(n,e){let t=[],r=null,i=u=>{t.push(u);let{section:c}=u.completion;if(c){r||(r=[]);let f=typeof c=="string"?c:c.name;r.some(d=>d.name==f)||r.push(typeof c=="string"?{name:f}:c)}},s=e.facet(St);for(let u of n)if(u.hasResult()){let c=u.result.getMatch;if(u.result.filter===!1)for(let f of u.result.options)i(new xb(f,u.source,c?c(f):[],1e9-t.length));else{let f=e.sliceDoc(u.from,u.to),d,p=s.filterStrict?new S5(f):new x5(f);for(let y of u.result.options)if(d=p.match(y.label)){let v=y.displayLabel?c?c(y,d.matched):[]:d.matched;i(new xb(y,u.source,v,d.score+(y.boost||0)))}}}if(r){let u=Object.create(null),c=0,f=(d,p)=>{var y,v;return((y=d.rank)!==null&&y!==void 0?y:1e9)-((v=p.rank)!==null&&v!==void 0?v:1e9)||(d.name<p.name?-1:1)};for(let d of r.sort(f))c-=1e5,u[d.name]=c;for(let d of t){let{section:p}=d.completion;p&&(d.score+=u[typeof p=="string"?p:p.name])}}let o=[],l=null,a=s.compareCompletions;for(let u of t.sort((c,f)=>f.score-c.score||a(c.completion,f.completion))){let c=u.completion;!l||l.label!=c.label||l.detail!=c.detail||l.type!=null&&c.type!=null&&l.type!=c.type||l.apply!=c.apply||l.boost!=c.boost?o.push(u):kb(u.completion)>kb(l)&&(o[o.length-1]=u),l=u.completion}return o}class Zo{constructor(e,t,r,i,s,o){this.options=e,this.attrs=t,this.tooltip=r,this.timestamp=i,this.selected=s,this.disabled=o}setSelected(e,t){return e==this.selected||e>=this.options.length?this:new Zo(this.options,Eb(t,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,t,r,i,s,o){if(i&&!o&&e.some(u=>u.isPending))return i.setDisabled();let l=A5(e,t);if(!l.length)return i&&e.some(u=>u.isPending)?i.setDisabled():null;let a=t.facet(St).selectOnOpen?0:-1;if(i&&i.selected!=a&&i.selected!=-1){let u=i.options[i.selected].completion;for(let c=0;c<l.length;c++)if(l[c].completion==u){a=c;break}}return new Zo(l,Eb(r,a),{pos:e.reduce((u,c)=>c.hasResult()?Math.min(u,c.from):u,1e8),create:M5,above:s.aboveCursor},i?i.timestamp:Date.now(),a,!1)}map(e){return new Zo(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new Zo(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class Pd{constructor(e,t,r){this.active=e,this.id=t,this.open=r}static start(){return new Pd(D5,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:t}=e,r=t.facet(St),s=(r.override||t.languageDataAt("autocomplete",Ws(t)).map(_5)).map(a=>(this.active.find(c=>c.source==a)||new jn(a,this.active.some(c=>c.state!=0)?1:0)).update(e,r));s.length==this.active.length&&s.every((a,u)=>a==this.active[u])&&(s=this.active);let o=this.open,l=e.effects.some(a=>a.is(L1));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!I5(s,this.active)||l?o=Zo.build(s,t,this.id,o,r,l):o&&o.disabled&&!s.some(a=>a.isPending)&&(o=null),!o&&s.every(a=>!a.isPending)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new jn(a.source,0):a));for(let a of e.effects)a.is(KP)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new Pd(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?P5:R5}}function I5(n,e){if(n==e)return!0;for(let t=0,r=0;;){for(;t<n.length&&!n[t].hasResult();)t++;for(;r<e.length&&!e[r].hasResult();)r++;let i=t==n.length,s=r==e.length;if(i||s)return i==s;if(n[t++].result!=e[r++].result)return!1}}const P5={"aria-autocomplete":"list"},R5={};function Eb(n,e){let t={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":n};return e>-1&&(t["aria-activedescendant"]=n+"-"+e),t}const D5=[];function qP(n,e){if(n.isUserEvent("input.complete")){let r=n.annotation(WP);if(r&&e.activateOnCompletion(r))return 12}let t=n.isUserEvent("input.type");return t&&e.activateOnTyping?5:t?1:n.isUserEvent("delete.backward")?2:n.selection?8:n.docChanged?16:0}class jn{constructor(e,t,r=!1){this.source=e,this.state=t,this.explicit=r}hasResult(){return!1}get isPending(){return this.state==1}update(e,t){let r=qP(e,t),i=this;(r&8||r&16&&this.touches(e))&&(i=new jn(i.source,0)),r&4&&i.state==0&&(i=new jn(this.source,1)),i=i.updateFor(e,r);for(let s of e.effects)if(s.is(Id))i=new jn(i.source,1,s.value);else if(s.is(Gu))i=new jn(i.source,0);else if(s.is(L1))for(let o of s.value)o.source==i.source&&(i=o);return i}updateFor(e,t){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Ws(e.state))}}class cl extends jn{constructor(e,t,r,i,s,o){super(e,3,t),this.limit=r,this.result=i,this.from=s,this.to=o}hasResult(){return!0}updateFor(e,t){var r;if(!(t&3))return this.map(e.changes);let i=this.result;i.map&&!e.changes.empty&&(i=i.map(i,e.changes));let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),l=Ws(e.state);if(l>o||!i||t&2&&(Ws(e.startState)==this.from||l<this.limit))return new jn(this.source,t&4?1:0);let a=e.changes.mapPos(this.limit);return O5(i.validFor,e.state,s,o)?new cl(this.source,this.explicit,a,i,s,o):i.update&&(i=i.update(i,s,o,new UP(e.state,l,!1)))?new cl(this.source,this.explicit,a,i,i.from,(r=i.to)!==null&&r!==void 0?r:Ws(e.state)):new jn(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new cl(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new jn(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function O5(n,e,t,r){if(!n)return!1;let i=e.sliceDoc(t,r);return typeof n=="function"?n(i,t,r,e):HP(n,!0).test(i)}const L1=ue.define({map(n,e){return n.map(t=>t.map(e))}}),KP=ue.define(),dn=Vt.define({create(){return Pd.start()},update(n,e){return n.update(e)},provide:n=>[S1.from(n,e=>e.tooltip),q.contentAttributes.from(n,e=>e.attrs)]});function B1(n,e){const t=e.completion.apply||e.completion.label;let r=n.state.field(dn).active.find(i=>i.source==e.source);return r instanceof cl?(typeof t=="string"?n.dispatch(Object.assign(Object.assign({},w5(n.state,t,r.from,r.to)),{annotations:WP.of(e.completion)})):t(n,e.completion,r.from,r.to),!0):!1}const M5=T5(dn,B1);function Nh(n,e="option"){return t=>{let r=t.state.field(dn,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<t.state.facet(St).interactionDelay)return!1;let i=1,s;e=="page"&&(s=CI(t,r.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=r.open.options,l=r.open.selected>-1?r.open.selected+i*(n?1:-1):n?0:o-1;return l<0?l=e=="page"?0:o-1:l>=o&&(l=e=="page"?o-1:0),t.dispatch({effects:KP.of(l)}),!0}}const N5=n=>{let e=n.state.field(dn,!1);return n.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<n.state.facet(St).interactionDelay?!1:B1(n,e.open.options[e.open.selected])},Tb=n=>n.state.field(dn,!1)?(n.dispatch({effects:Id.of(!0)}),!0):!1,V5=n=>{let e=n.state.field(dn,!1);return!e||!e.active.some(t=>t.state!=0)?!1:(n.dispatch({effects:Gu.of(null)}),!0)};class L5{constructor(e,t){this.active=e,this.context=t,this.time=Date.now(),this.updates=[],this.done=void 0}}const B5=50,F5=1e3,z5=st.fromClass(class{constructor(n){this.view=n,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of n.state.field(dn).active)e.isPending&&this.startQuery(e)}update(n){let e=n.state.field(dn),t=n.state.facet(St);if(!n.selectionSet&&!n.docChanged&&n.startState.field(dn)==e)return;let r=n.transactions.some(s=>{let o=qP(s,t);return o&8||(s.selection||s.docChanged)&&!(o&3)});for(let s=0;s<this.running.length;s++){let o=this.running[s];if(r||o.context.abortOnDocChange&&n.docChanged||o.updates.length+n.transactions.length>B5&&Date.now()-o.time>F5){for(let l of o.context.abortListeners)try{l()}catch(a){gn(this.view.state,a)}o.context.abortListeners=null,this.running.splice(s--,1)}else o.updates.push(...n.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),n.transactions.some(s=>s.effects.some(o=>o.is(Id)))&&(this.pendingStart=!0);let i=this.pendingStart?50:t.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(s=>s.isPending&&!this.running.some(o=>o.active.source==s.source))?setTimeout(()=>this.startUpdate(),i):-1,this.composing!=0)for(let s of n.transactions)s.isUserEvent("input.type")?this.composing=2:this.composing==2&&s.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:n}=this.view,e=n.field(dn);for(let t of e.active)t.isPending&&!this.running.some(r=>r.active.source==t.source)&&this.startQuery(t);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(St).updateSyncTime))}startQuery(n){let{state:e}=this.view,t=Ws(e),r=new UP(e,t,n.explicit,this.view),i=new L5(n,r);this.running.push(i),Promise.resolve(n.source(r)).then(s=>{i.context.aborted||(i.done=s||null,this.scheduleAccept())},s=>{this.view.dispatch({effects:Gu.of(null)}),gn(this.view.state,s)})}scheduleAccept(){this.running.every(n=>n.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(St).updateSyncTime))}accept(){var n;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],t=this.view.state.facet(St),r=this.view.state.field(dn);for(let i=0;i<this.running.length;i++){let s=this.running[i];if(s.done===void 0)continue;if(this.running.splice(i--,1),s.done){let l=Ws(s.updates.length?s.updates[0].startState:this.view.state),a=Math.min(l,s.done.from+(s.active.explicit?0:1)),u=new cl(s.active.source,s.active.explicit,a,s.done,s.done.from,(n=s.done.to)!==null&&n!==void 0?n:l);for(let c of s.updates)u=u.update(c,t);if(u.hasResult()){e.push(u);continue}}let o=r.active.find(l=>l.source==s.active.source);if(o&&o.isPending)if(s.done==null){let l=new jn(s.active.source,0);for(let a of s.updates)l=l.update(a,t);l.isPending||e.push(l)}else this.startQuery(o)}(e.length||r.open&&r.open.disabled)&&this.view.dispatch({effects:L1.of(e)})}},{eventHandlers:{blur(n){let e=this.view.state.field(dn,!1);if(e&&e.tooltip&&this.view.state.facet(St).closeOnBlur){let t=e.open&&CI(this.view,e.open.tooltip);(!t||!t.dom.contains(n.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Gu.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Id.of(!1)}),20),this.composing=0}}}),$5=typeof navigator=="object"&&/Win/.test(navigator.platform),U5=mo.highest(q.domEventHandlers({keydown(n,e){let t=e.state.field(dn,!1);if(!t||!t.open||t.open.disabled||t.open.selected<0||n.key.length>1||n.ctrlKey&&!($5&&n.altKey)||n.metaKey)return!1;let r=t.open.options[t.open.selected],i=t.active.find(o=>o.source==r.source),s=r.completion.commitCharacters||i.result.commitCharacters;return s&&s.indexOf(n.key)>-1&&B1(e,r),!1}})),j5=q.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'""',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"''"}},".cm-completionIcon-class":{"&:after":{content:"''"}},".cm-completionIcon-interface":{"&:after":{content:"''"}},".cm-completionIcon-variable":{"&:after":{content:"''"}},".cm-completionIcon-constant":{"&:after":{content:"''"}},".cm-completionIcon-type":{"&:after":{content:"''"}},".cm-completionIcon-enum":{"&:after":{content:"''"}},".cm-completionIcon-property":{"&:after":{content:"''"}},".cm-completionIcon-keyword":{"&:after":{content:"''"}},".cm-completionIcon-namespace":{"&:after":{content:"''"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}}),Yu={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Fs=ue.define({map(n,e){let t=e.mapPos(n,-1,Zt.TrackAfter);return t??void 0}}),F1=new class extends Zs{};F1.startSide=1;F1.endSide=-1;const QP=Vt.define({create(){return xe.empty},update(n,e){if(n=n.map(e.changes),e.selection){let t=e.state.doc.lineAt(e.selection.main.head);n=n.update({filter:r=>r>=t.from&&r<=t.to})}for(let t of e.effects)t.is(Fs)&&(n=n.update({add:[F1.range(t.value,t.value+1)]}));return n}});function H5(){return[q5,QP]}const vg="()[]{}<>";function GP(n){for(let e=0;e<vg.length;e+=2)if(vg.charCodeAt(e)==n)return vg.charAt(e+1);return l1(n<128?n:n+1)}function YP(n,e){return n.languageDataAt("closeBrackets",e)[0]||Yu}const W5=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),q5=q.inputHandler.of((n,e,t,r)=>{if((W5?n.composing:n.compositionStarted)||n.state.readOnly)return!1;let i=n.state.selection.main;if(r.length>2||r.length==2&&kr(hn(r,0))==1||e!=i.from||t!=i.to)return!1;let s=G5(n.state,r);return s?(n.dispatch(s),!0):!1}),K5=({state:n,dispatch:e})=>{if(n.readOnly)return!1;let r=YP(n,n.selection.main.head).brackets||Yu.brackets,i=null,s=n.changeByRange(o=>{if(o.empty){let l=Y5(n.doc,o.head);for(let a of r)if(a==l&&Dp(n.doc,o.head)==GP(hn(a,0)))return{changes:{from:o.head-a.length,to:o.head+a.length},range:B.cursor(o.head-a.length)}}return{range:i=o}});return i||e(n.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i},Q5=[{key:"Backspace",run:K5}];function G5(n,e){let t=YP(n,n.selection.main.head),r=t.brackets||Yu.brackets;for(let i of r){let s=GP(hn(i,0));if(e==i)return s==i?Z5(n,i,r.indexOf(i+i+i)>-1,t):X5(n,i,s,t.before||Yu.before);if(e==s&&XP(n,n.selection.main.from))return J5(n,i,s)}return null}function XP(n,e){let t=!1;return n.field(QP).between(0,n.doc.length,r=>{r==e&&(t=!0)}),t}function Dp(n,e){let t=n.sliceString(e,e+2);return t.slice(0,kr(hn(t,0)))}function Y5(n,e){let t=n.sliceString(e-2,e);return kr(hn(t,0))==t.length?t:t.slice(1)}function X5(n,e,t,r){let i=null,s=n.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:t,from:o.to}],effects:Fs.of(o.to+e.length),range:B.range(o.anchor+e.length,o.head+e.length)};let l=Dp(n.doc,o.head);return!l||/\s/.test(l)||r.indexOf(l)>-1?{changes:{insert:e+t,from:o.head},effects:Fs.of(o.head+e.length),range:B.cursor(o.head+e.length)}:{range:i=o}});return i?null:n.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function J5(n,e,t){let r=null,i=n.changeByRange(s=>s.empty&&Dp(n.doc,s.head)==t?{changes:{from:s.head,to:s.head+t.length,insert:t},range:B.cursor(s.head+t.length)}:r={range:s});return r?null:n.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function Z5(n,e,t,r){let i=r.stringPrefixes||Yu.stringPrefixes,s=null,o=n.changeByRange(l=>{if(!l.empty)return{changes:[{insert:e,from:l.from},{insert:e,from:l.to}],effects:Fs.of(l.to+e.length),range:B.range(l.anchor+e.length,l.head+e.length)};let a=l.head,u=Dp(n.doc,a),c;if(u==e){if(Cb(n,a))return{changes:{insert:e+e,from:a},effects:Fs.of(a+e.length),range:B.cursor(a+e.length)};if(XP(n,a)){let d=t&&n.sliceDoc(a,a+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:a,to:a+d.length,insert:d},range:B.cursor(a+d.length)}}}else{if(t&&n.sliceDoc(a-2*e.length,a)==e+e&&(c=Ab(n,a-2*e.length,i))>-1&&Cb(n,c))return{changes:{insert:e+e+e+e,from:a},effects:Fs.of(a+e.length),range:B.cursor(a+e.length)};if(n.charCategorizer(a)(u)!=We.Word&&Ab(n,a,i)>-1&&!e9(n,a,e,i))return{changes:{insert:e+e,from:a},effects:Fs.of(a+e.length),range:B.cursor(a+e.length)}}return{range:s=l}});return s?null:n.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function Cb(n,e){let t=kt(n).resolveInner(e+1);return t.parent&&t.from==e}function e9(n,e,t,r){let i=kt(n).resolveInner(e,-1),s=r.reduce((o,l)=>Math.max(o,l.length),0);for(let o=0;o<5;o++){let l=n.sliceDoc(i.from,Math.min(i.to,i.from+t.length+s)),a=l.indexOf(t);if(!a||a>-1&&r.indexOf(l.slice(0,a))>-1){let c=i.firstChild;for(;c&&c.from==i.from&&c.to-c.from>t.length+a;){if(n.sliceDoc(c.to-t.length,c.to)==t)return!1;c=c.firstChild}return!0}let u=i.to==e&&i.parent;if(!u)break;i=u}return!1}function Ab(n,e,t){let r=n.charCategorizer(e);if(r(n.sliceDoc(e-1,e))!=We.Word)return e;for(let i of t){let s=e-i.length;if(n.sliceDoc(s,e)==i&&r(n.sliceDoc(s-1,s))!=We.Word)return s}return-1}function t9(n={}){return[U5,dn,St.of(n),z5,n9,j5]}const JP=[{key:"Ctrl-Space",run:Tb},{mac:"Alt-`",run:Tb},{key:"Escape",run:V5},{key:"ArrowDown",run:Nh(!0)},{key:"ArrowUp",run:Nh(!1)},{key:"PageDown",run:Nh(!0,"page")},{key:"PageUp",run:Nh(!1,"page")},{key:"Enter",run:N5}],n9=mo.highest(bp.computeN([St],n=>n.facet(St).defaultKeymap?[JP]:[]));class Ib{constructor(e,t,r){this.from=e,this.to=t,this.diagnostic=r}}class Is{constructor(e,t,r){this.diagnostics=e,this.panel=t,this.selected=r}static init(e,t,r){let i=r.facet(Xu).markerFilter;i&&(e=i(e,r));let s=e.slice().sort((c,f)=>c.from-f.from||c.to-f.to),o=new si,l=[],a=0;for(let c=0;;){let f=c==s.length?null:s[c];if(!f&&!l.length)break;let d,p;for(l.length?(d=a,p=l.reduce((v,E)=>Math.min(v,E.to),f&&f.from>d?f.from:1e8)):(d=f.from,p=f.to,l.push(f),c++);c<s.length;){let v=s[c];if(v.from==d&&(v.to>v.from||v.to==d))l.push(v),c++,p=Math.min(v.to,p);else{p=Math.min(v.from,p);break}}let y=m9(l);if(l.some(v=>v.from==v.to||v.from==v.to-1&&r.doc.lineAt(v.from).to==v.from))o.add(d,d,ne.widget({widget:new h9(y),diagnostics:l.slice()}));else{let v=l.reduce((E,w)=>w.markClass?E+" "+w.markClass:E,"");o.add(d,p,ne.mark({class:"cm-lintRange cm-lintRange-"+y+v,diagnostics:l.slice(),inclusiveEnd:l.some(E=>E.to>p)}))}a=p;for(let v=0;v<l.length;v++)l[v].to<=a&&l.splice(v--,1)}let u=o.finish();return new Is(u,t,Ol(u))}}function Ol(n,e=null,t=0){let r=null;return n.between(t,1e9,(i,s,{spec:o})=>{if(!(e&&o.diagnostics.indexOf(e)<0))if(!r)r=new Ib(i,s,e||o.diagnostics[0]);else{if(o.diagnostics.indexOf(r.diagnostic)<0)return!1;r=new Ib(r.from,s,r.diagnostic)}}),r}function r9(n,e){let t=e.pos,r=e.end||t,i=n.state.facet(Xu).hideOn(n,t,r);if(i!=null)return i;let s=n.startState.doc.lineAt(e.pos);return!!(n.effects.some(o=>o.is(ZP))||n.changes.touchesRange(s.from,Math.max(s.to,r)))}function i9(n,e){return n.field(In,!1)?e:e.concat(ue.appendConfig.of(g9))}const ZP=ue.define(),z1=ue.define(),eR=ue.define(),In=Vt.define({create(){return new Is(ne.none,null,null)},update(n,e){if(e.docChanged&&n.diagnostics.size){let t=n.diagnostics.map(e.changes),r=null,i=n.panel;if(n.selected){let s=e.changes.mapPos(n.selected.from,1);r=Ol(t,n.selected.diagnostic,s)||Ol(t,null,s)}!t.size&&i&&e.state.facet(Xu).autoPanel&&(i=null),n=new Is(t,i,r)}for(let t of e.effects)if(t.is(ZP)){let r=e.state.facet(Xu).autoPanel?t.value.length?Ju.open:null:n.panel;n=Is.init(t.value,r,e.state)}else t.is(z1)?n=new Is(n.diagnostics,t.value?Ju.open:null,n.selected):t.is(eR)&&(n=new Is(n.diagnostics,n.panel,t.value));return n},provide:n=>[Wu.from(n,e=>e.panel),q.decorations.from(n,e=>e.diagnostics)]}),s9=ne.mark({class:"cm-lintRange cm-lintRange-active"});function o9(n,e,t){let{diagnostics:r}=n.state.field(In),i,s=-1,o=-1;r.between(e-(t<0?1:0),e+(t>0?1:0),(a,u,{spec:c})=>{if(e>=a&&e<=u&&(a==u||(e>a||t>0)&&(e<u||t<0)))return i=c.diagnostics,s=a,o=u,!1});let l=n.state.facet(Xu).tooltipFilter;return i&&l&&(i=l(i,n.state)),i?{pos:s,end:o,above:n.state.doc.lineAt(s).to<o,create(){return{dom:l9(n,i)}}}:null}function l9(n,e){return Oe("ul",{class:"cm-tooltip-lint"},e.map(t=>nR(n,t,!1)))}const a9=n=>{let e=n.state.field(In,!1);(!e||!e.panel)&&n.dispatch({effects:i9(n.state,[z1.of(!0)])});let t=Hu(n,Ju.open);return t&&t.dom.querySelector(".cm-panel-lint ul").focus(),!0},Pb=n=>{let e=n.state.field(In,!1);return!e||!e.panel?!1:(n.dispatch({effects:z1.of(!1)}),!0)},u9=n=>{let e=n.state.field(In,!1);if(!e)return!1;let t=n.state.selection.main,r=e.diagnostics.iter(t.to+1);return!r.value&&(r=e.diagnostics.iter(0),!r.value||r.from==t.from&&r.to==t.to)?!1:(n.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},c9=[{key:"Mod-Shift-m",run:a9,preventDefault:!0},{key:"F8",run:u9}],Xu=G.define({combine(n){return Object.assign({sources:n.map(e=>e.source).filter(e=>e!=null)},Lr(n.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>e?t?r=>e(r)||t(r):e:t}))}});function tR(n){let e=[];if(n)e:for(let{name:t}of n){for(let r=0;r<t.length;r++){let i=t[r];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function nR(n,e,t){var r;let i=t?tR(e.actions):[];return Oe("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},Oe("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage(n):e.message),(r=e.actions)===null||r===void 0?void 0:r.map((s,o)=>{let l=!1,a=d=>{if(d.preventDefault(),l)return;l=!0;let p=Ol(n.state.field(In).diagnostics,e);p&&s.apply(n,p.from,p.to)},{name:u}=s,c=i[o]?u.indexOf(i[o]):-1,f=c<0?u:[u.slice(0,c),Oe("u",u.slice(c,c+1)),u.slice(c+1)];return Oe("button",{type:"button",class:"cm-diagnosticAction",onclick:a,onmousedown:a,"aria-label":` Action: ${u}${c<0?"":` (access key "${i[o]})"`}.`},f)}),e.source&&Oe("div",{class:"cm-diagnosticSource"},e.source))}class h9 extends fi{constructor(e){super(),this.sev=e}eq(e){return e.sev==this.sev}toDOM(){return Oe("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Rb{constructor(e,t){this.diagnostic=t,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=nR(e,t,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Ju{constructor(e){this.view=e,this.items=[];let t=i=>{if(i.keyCode==27)Pb(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=tR(s.actions);for(let l=0;l<o.length;l++)if(o[l].toUpperCase().charCodeAt(0)==i.keyCode){let a=Ol(this.view.state.field(In).diagnostics,s);a&&s.actions[l].apply(e,a.from,a.to)}}else return;i.preventDefault()},r=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=Oe("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:r}),this.dom=Oe("div",{class:"cm-panel-lint"},this.list,Oe("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Pb(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(In).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(In),r=0,i=!1,s=null,o=new Set;for(e.between(0,this.view.state.doc.length,(l,a,{spec:u})=>{for(let c of u.diagnostics){if(o.has(c))continue;o.add(c);let f=-1,d;for(let p=r;p<this.items.length;p++)if(this.items[p].diagnostic==c){f=p;break}f<0?(d=new Rb(this.view,c),this.items.splice(r,0,d),i=!0):(d=this.items[f],f>r&&(this.items.splice(r,f-r),i=!0)),t&&d.diagnostic==t.diagnostic?d.dom.hasAttribute("aria-selected")||(d.dom.setAttribute("aria-selected","true"),s=d):d.dom.hasAttribute("aria-selected")&&d.dom.removeAttribute("aria-selected"),r++}});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new Rb(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:l,panel:a})=>{let u=a.height/this.list.offsetHeight;l.top<a.top?this.list.scrollTop-=(a.top-l.top)/u:l.bottom>a.bottom&&(this.list.scrollTop+=(l.bottom-a.bottom)/u)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function t(){let r=e;e=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)t();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(In),r=Ol(t.diagnostics,this.items[e].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:eR.of(r)})}static open(e){return new Ju(e)}}function f9(n,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(n)}</svg>')`}function Vh(n){return f9(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${n}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const d9=q.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Vh("#d11")},".cm-lintRange-warning":{backgroundImage:Vh("orange")},".cm-lintRange-info":{backgroundImage:Vh("#999")},".cm-lintRange-hint":{backgroundImage:Vh("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function p9(n){return n=="error"?4:n=="warning"?3:n=="info"?2:1}function m9(n){let e="hint",t=1;for(let r of n){let i=p9(r.severity);i>t&&(t=i,e=r.severity)}return e}const g9=[In,q.decorations.compute([In],n=>{let{selected:e,panel:t}=n.field(In);return!e||!t||e.from==e.to?ne.none:ne.set([s9.range(e.from,e.to)])}),cB(o9,{hideOn:r9}),d9];var Db=function(e){e===void 0&&(e={});var{crosshairCursor:t=!1}=e,r=[];e.closeBracketsKeymap!==!1&&(r=r.concat(Q5)),e.defaultKeymap!==!1&&(r=r.concat($3)),e.searchKeymap!==!1&&(r=r.concat(d5)),e.historyKeymap!==!1&&(r=r.concat(YF)),e.foldKeymap!==!1&&(r=r.concat(cF)),e.completionKeymap!==!1&&(r=r.concat(JP)),e.lintKeymap!==!1&&(r=r.concat(c9));var i=[];return e.lineNumbers!==!1&&i.push(xB()),e.highlightActiveLineGutter!==!1&&i.push(kB()),e.highlightSpecialChars!==!1&&i.push(F4()),e.history!==!1&&i.push($F()),e.foldGutter!==!1&&i.push(pF()),e.drawSelection!==!1&&i.push(A4()),e.dropCursor!==!1&&i.push(O4()),e.allowMultipleSelections!==!1&&i.push(ye.allowMultipleSelections.of(!0)),e.indentOnInput!==!1&&i.push(tF()),e.syntaxHighlighting!==!1&&i.push(I1(vF,{fallback:!0})),e.bracketMatching!==!1&&i.push(EF()),e.closeBrackets!==!1&&i.push(H5()),e.autocompletion!==!1&&i.push(t9()),e.rectangularSelection!==!1&&i.push(Z4()),t!==!1&&i.push(nB()),e.highlightActiveLine!==!1&&i.push(W4()),e.highlightSelectionMatches!==!1&&i.push(Q3()),e.tabSize&&typeof e.tabSize=="number"&&i.push(Ep.of(" ".repeat(e.tabSize))),i.concat([bp.of(r.flat())]).filter(Boolean)};const y9="#e5c07b",Ob="#e06c75",v9="#56b6c2",w9="#ffffff",_f="#abb2bf",A0="#7d8799",_9="#61afef",x9="#98c379",Mb="#d19a66",S9="#c678dd",b9="#21252b",Nb="#2c313a",Vb="#282c34",wg="#353a42",k9="#3E4451",Lb="#528bff",E9=q.theme({"&":{color:_f,backgroundColor:Vb},".cm-content":{caretColor:Lb},".cm-cursor, .cm-dropCursor":{borderLeftColor:Lb},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:k9},".cm-panels":{backgroundColor:b9,color:_f},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Vb,color:A0,border:"none"},".cm-activeLineGutter":{backgroundColor:Nb},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:wg},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:wg,borderBottomColor:wg},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Nb,color:_f}}},{dark:!0}),T9=Ql.define([{tag:O.keyword,color:S9},{tag:[O.name,O.deleted,O.character,O.propertyName,O.macroName],color:Ob},{tag:[O.function(O.variableName),O.labelName],color:_9},{tag:[O.color,O.constant(O.name),O.standard(O.name)],color:Mb},{tag:[O.definition(O.name),O.separator],color:_f},{tag:[O.typeName,O.className,O.number,O.changed,O.annotation,O.modifier,O.self,O.namespace],color:y9},{tag:[O.operator,O.operatorKeyword,O.url,O.escape,O.regexp,O.link,O.special(O.string)],color:v9},{tag:[O.meta,O.comment],color:A0},{tag:O.strong,fontWeight:"bold"},{tag:O.emphasis,fontStyle:"italic"},{tag:O.strikethrough,textDecoration:"line-through"},{tag:O.link,color:A0,textDecoration:"underline"},{tag:O.heading,fontWeight:"bold",color:Ob},{tag:[O.atom,O.bool,O.special(O.variableName)],color:Mb},{tag:[O.processingInstruction,O.string,O.inserted],color:x9},{tag:O.invalid,color:w9}]),C9=[E9,I1(T9)];var A9=q.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),I9=function(e){e===void 0&&(e={});var{indentWithTab:t=!0,editable:r=!0,readOnly:i=!1,theme:s="light",placeholder:o="",basicSetup:l=!0}=e,a=[];switch(t&&a.unshift(bp.of([U3])),l&&(typeof l=="boolean"?a.unshift(Db()):a.unshift(Db(l))),o&&a.unshift(G4(o)),s){case"light":a.push(A9);break;case"dark":a.push(C9);break;case"none":break;default:a.push(s);break}return r===!1&&a.push(q.editable.of(!1)),i&&a.push(ye.readOnly.of(!0)),[...a]},P9=n=>({line:n.state.doc.lineAt(n.state.selection.main.from),lineCount:n.state.doc.lines,lineBreak:n.state.lineBreak,length:n.state.doc.length,readOnly:n.state.readOnly,tabSize:n.state.tabSize,selection:n.state.selection,selectionAsSingle:n.state.selection.asSingle().main,ranges:n.state.selection.ranges,selectionCode:n.state.sliceDoc(n.state.selection.main.from,n.state.selection.main.to),selections:n.state.selection.ranges.map(e=>n.state.sliceDoc(e.from,e.to)),selectedText:n.state.selection.ranges.some(e=>!e.empty)}),Bb=Vr.define(),R9=[];function D9(n){var{value:e,selection:t,onChange:r,onStatistics:i,onCreateEditor:s,onUpdate:o,extensions:l=R9,autoFocus:a,theme:u="light",height:c=null,minHeight:f=null,maxHeight:d=null,width:p=null,minWidth:y=null,maxWidth:v=null,placeholder:E="",editable:w=!0,readOnly:_=!1,indentWithTab:b=!0,basicSetup:I=!0,root:D,initialState:M}=n,[x,S]=se.useState(),[T,C]=se.useState(),[P,R]=se.useState(),A=q.theme({"&":{height:c,minHeight:f,maxHeight:d,width:p,minWidth:y,maxWidth:v},"& .cm-scroller":{height:"100% !important"}}),re=q.updateListener.of(ae=>{if(ae.docChanged&&typeof r=="function"&&!ae.transactions.some(J=>J.annotation(Bb))){var U=ae.state.doc,H=U.toString();r(H,ae)}i&&i(P9(ae))}),ce=I9({theme:u,editable:w,readOnly:_,placeholder:E,indentWithTab:b,basicSetup:I}),Te=[re,A,...ce];return o&&typeof o=="function"&&Te.push(q.updateListener.of(o)),Te=Te.concat(l),se.useLayoutEffect(()=>{if(x&&!P){var ae={doc:e,selection:t,extensions:Te},U=M?ye.fromJSON(M.json,ae,M.fields):ye.create(ae);if(R(U),!T){var H=new q({state:U,parent:x,root:D});C(H),s&&s(H,U)}}return()=>{T&&(R(void 0),C(void 0))}},[x,P]),se.useEffect(()=>{n.container&&S(n.container)},[n.container]),se.useEffect(()=>()=>{T&&(T.destroy(),C(void 0))},[T]),se.useEffect(()=>{a&&T&&T.focus()},[a,T]),se.useEffect(()=>{T&&T.dispatch({effects:ue.reconfigure.of(Te)})},[u,l,c,f,d,p,y,v,E,w,_,b,I,r,o]),se.useEffect(()=>{if(e!==void 0){var ae=T?T.state.doc.toString():"";T&&e!==ae&&T.dispatch({changes:{from:0,to:ae.length,insert:e||""},annotations:[Bb.of(!0)]})}},[e,T]),{state:P,setState:R,view:T,setView:C,container:x,setContainer:S}}var O9=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],rR=se.forwardRef((n,e)=>{var{className:t,value:r="",selection:i,extensions:s=[],onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:u,autoFocus:c,theme:f="light",height:d,minHeight:p,maxHeight:y,width:v,minWidth:E,maxWidth:w,basicSetup:_,placeholder:b,indentWithTab:I,editable:D,readOnly:M,root:x,initialState:S}=n,T=EV(n,O9),C=se.useRef(null),{state:P,view:R,container:A,setContainer:re}=D9({root:x,value:r,autoFocus:c,theme:f,height:d,minHeight:p,maxHeight:y,width:v,minWidth:E,maxWidth:w,basicSetup:_,placeholder:b,indentWithTab:I,editable:D,readOnly:M,selection:i,onChange:o,onStatistics:l,onCreateEditor:a,onUpdate:u,extensions:s,initialState:S});se.useImperativeHandle(e,()=>({editor:C.current,state:P,view:R}),[C,A,P,R]);var ce=se.useCallback(ae=>{C.current=ae,re(ae)},[re]);if(typeof r!="string")throw new Error("value must be typeof string but got "+typeof r);var Te=typeof f=="string"?"cm-theme-"+f:"cm-theme";return Ee.jsx("div",Lu({ref:ce,className:""+Te+(t?" "+t:"")},T))});rR.displayName="CodeMirror";var Fb={};class Rd{constructor(e,t,r,i,s,o,l,a,u,c=0,f){this.p=e,this.stack=t,this.state=r,this.reducePos=i,this.pos=s,this.score=o,this.buffer=l,this.bufferBase=a,this.curContext=u,this.lookAhead=c,this.parent=f}toString(){return`[${this.stack.filter((e,t)=>t%3==0).concat(this.state)}]@${this.pos}${this.score?"!"+this.score:""}`}static start(e,t,r=0){let i=e.parser.context;return new Rd(e,[],t,r,r,0,[],0,i?new zb(i,i.start):null,0,null)}get context(){return this.curContext?this.curContext.context:null}pushState(e,t){this.stack.push(this.state,t,this.bufferBase+this.buffer.length),this.state=e}reduce(e){var t;let r=e>>19,i=e&65535,{parser:s}=this.p,o=this.reducePos<this.pos-25;o&&this.setLookAhead(this.pos);let l=s.dynamicPrecedence(i);if(l&&(this.score+=l),r==0){this.pushState(s.getGoto(this.state,i,!0),this.reducePos),i<s.minRepeatTerm&&this.storeNode(i,this.reducePos,this.reducePos,o?8:4,!0),this.reduceContext(i,this.reducePos);return}let a=this.stack.length-(r-1)*3-(e&262144?6:0),u=a?this.stack[a-2]:this.p.ranges[0].from,c=this.reducePos-u;c>=2e3&&!(!((t=this.p.parser.nodeSet.types[i])===null||t===void 0)&&t.isAnonymous)&&(u==this.p.lastBigReductionStart?(this.p.bigReductionCount++,this.p.lastBigReductionSize=c):this.p.lastBigReductionSize<c&&(this.p.bigReductionCount=1,this.p.lastBigReductionStart=u,this.p.lastBigReductionSize=c));let f=a?this.stack[a-1]:0,d=this.bufferBase+this.buffer.length-f;if(i<s.minRepeatTerm||e&131072){let p=s.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(i,u,p,d+4,!0)}if(e&262144)this.state=this.stack[a];else{let p=this.stack[a-3];this.state=s.getGoto(p,i,!0)}for(;this.stack.length>a;)this.stack.pop();this.reduceContext(i,u)}storeNode(e,t,r,i=4,s=!1){if(e==0&&(!this.stack.length||this.stack[this.stack.length-1]<this.buffer.length+this.bufferBase)){let o=this,l=this.buffer.length;if(l==0&&o.parent&&(l=o.bufferBase-o.parent.bufferBase,o=o.parent),l>0&&o.buffer[l-4]==0&&o.buffer[l-1]>-1){if(t==r)return;if(o.buffer[l-2]>=t){o.buffer[l-2]=r;return}}}if(!s||this.pos==r)this.buffer.push(e,t,r,i);else{let o=this.buffer.length;if(o>0&&this.buffer[o-4]!=0){let l=!1;for(let a=o;a>0&&this.buffer[a-2]>r;a-=4)if(this.buffer[a-1]>=0){l=!0;break}if(l)for(;o>0&&this.buffer[o-2]>r;)this.buffer[o]=this.buffer[o-4],this.buffer[o+1]=this.buffer[o-3],this.buffer[o+2]=this.buffer[o-2],this.buffer[o+3]=this.buffer[o-1],o-=4,i>4&&(i-=4)}this.buffer[o]=e,this.buffer[o+1]=t,this.buffer[o+2]=r,this.buffer[o+3]=i}}shift(e,t,r,i){if(e&131072)this.pushState(e&65535,this.pos);else if(e&262144)this.pos=i,this.shiftContext(t,r),t<=this.p.parser.maxNode&&this.buffer.push(t,r,i,4);else{let s=e,{parser:o}=this.p;(i>this.pos||t<=o.maxNode)&&(this.pos=i,o.stateFlag(s,1)||(this.reducePos=i)),this.pushState(s,r),this.shiftContext(t,r),t<=o.maxNode&&this.buffer.push(t,r,i,4)}}apply(e,t,r,i){e&65536?this.reduce(e):this.shift(e,t,r,i)}useNode(e,t){let r=this.p.reused.length-1;(r<0||this.p.reused[r]!=e)&&(this.p.reused.push(e),r++);let i=this.pos;this.reducePos=this.pos=i+e.length,this.pushState(t,i),this.buffer.push(r,i,this.reducePos,-1),this.curContext&&this.updateContext(this.curContext.tracker.reuse(this.curContext.context,e,this,this.p.stream.reset(this.pos-e.length)))}split(){let e=this,t=e.buffer.length;for(;t>0&&e.buffer[t-2]>e.reducePos;)t-=4;let r=e.buffer.slice(t),i=e.bufferBase+t;for(;e&&i==e.bufferBase;)e=e.parent;return new Rd(this.p,this.stack.slice(),this.state,this.reducePos,this.pos,this.score,r,i,this.curContext,this.lookAhead,e)}recoverByDelete(e,t){let r=e<=this.p.parser.maxNode;r&&this.storeNode(e,this.pos,t,4),this.storeNode(0,this.pos,t,r?8:4),this.pos=this.reducePos=t,this.score-=190}canShift(e){for(let t=new M9(this);;){let r=this.p.parser.stateSlot(t.state,4)||this.p.parser.hasAction(t.state,e);if(r==0)return!1;if(!(r&65536))return!0;t.reduce(r)}}recoverByInsert(e){if(this.stack.length>=300)return[];let t=this.p.parser.nextStates(this.state);if(t.length>8||this.stack.length>=120){let i=[];for(let s=0,o;s<t.length;s+=2)(o=t[s+1])!=this.state&&this.p.parser.hasAction(o,e)&&i.push(t[s],o);if(this.stack.length<120)for(let s=0;i.length<8&&s<t.length;s+=2){let o=t[s+1];i.some((l,a)=>a&1&&l==o)||i.push(t[s],o)}t=i}let r=[];for(let i=0;i<t.length&&r.length<4;i+=2){let s=t[i+1];if(s==this.state)continue;let o=this.split();o.pushState(s,this.pos),o.storeNode(0,o.pos,o.pos,4,!0),o.shiftContext(t[i],this.pos),o.reducePos=this.pos,o.score-=200,r.push(o)}return r}forceReduce(){let{parser:e}=this.p,t=e.stateSlot(this.state,5);if(!(t&65536))return!1;if(!e.validAction(this.state,t)){let r=t>>19,i=t&65535,s=this.stack.length-r*3;if(s<0||e.getGoto(this.stack[s],i,!1)<0){let o=this.findForcedReduction();if(o==null)return!1;t=o}this.storeNode(0,this.pos,this.pos,4,!0),this.score-=100}return this.reducePos=this.pos,this.reduce(t),!0}findForcedReduction(){let{parser:e}=this.p,t=[],r=(i,s)=>{if(!t.includes(i))return t.push(i),e.allActions(i,o=>{if(!(o&393216))if(o&65536){let l=(o>>19)-s;if(l>1){let a=o&65535,u=this.stack.length-l*3;if(u>=0&&e.getGoto(this.stack[u],a,!1)>=0)return l<<19|65536|a}}else{let l=r(o,s+1);if(l!=null)return l}})};return r(this.state,0)}forceAll(){for(;!this.p.parser.stateFlag(this.state,2);)if(!this.forceReduce()){this.storeNode(0,this.pos,this.pos,4,!0);break}return this}get deadEnd(){if(this.stack.length!=3)return!1;let{parser:e}=this.p;return e.data[e.stateSlot(this.state,1)]==65535&&!e.stateSlot(this.state,4)}restart(){this.storeNode(0,this.pos,this.pos,4,!0),this.state=this.stack[0],this.stack.length=0}sameState(e){if(this.state!=e.state||this.stack.length!=e.stack.length)return!1;for(let t=0;t<this.stack.length;t+=3)if(this.stack[t]!=e.stack[t])return!1;return!0}get parser(){return this.p.parser}dialectEnabled(e){return this.p.parser.dialect.flags[e]}shiftContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.shift(this.curContext.context,e,this,this.p.stream.reset(t)))}reduceContext(e,t){this.curContext&&this.updateContext(this.curContext.tracker.reduce(this.curContext.context,e,this,this.p.stream.reset(t)))}emitContext(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-3)&&this.buffer.push(this.curContext.hash,this.pos,this.pos,-3)}emitLookAhead(){let e=this.buffer.length-1;(e<0||this.buffer[e]!=-4)&&this.buffer.push(this.lookAhead,this.pos,this.pos,-4)}updateContext(e){if(e!=this.curContext.context){let t=new zb(this.curContext.tracker,e);t.hash!=this.curContext.hash&&this.emitContext(),this.curContext=t}}setLookAhead(e){e>this.lookAhead&&(this.emitLookAhead(),this.lookAhead=e)}close(){this.curContext&&this.curContext.tracker.strict&&this.emitContext(),this.lookAhead>0&&this.emitLookAhead()}}class zb{constructor(e,t){this.tracker=e,this.context=t,this.hash=e.strict?e.hash(t):0}}class M9{constructor(e){this.start=e,this.state=e.state,this.stack=e.stack,this.base=this.stack.length}reduce(e){let t=e&65535,r=e>>19;r==0?(this.stack==this.start.stack&&(this.stack=this.stack.slice()),this.stack.push(this.state,0,0),this.base+=3):this.base-=(r-1)*3;let i=this.start.p.parser.getGoto(this.stack[this.base-3],t,!0);this.state=i}}class Dd{constructor(e,t,r){this.stack=e,this.pos=t,this.index=r,this.buffer=e.buffer,this.index==0&&this.maybeNext()}static create(e,t=e.bufferBase+e.buffer.length){return new Dd(e,t,t-e.bufferBase)}maybeNext(){let e=this.stack.parent;e!=null&&(this.index=this.stack.bufferBase-e.bufferBase,this.stack=e,this.buffer=e.buffer)}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}next(){this.index-=4,this.pos-=4,this.index==0&&this.maybeNext()}fork(){return new Dd(this.stack,this.pos,this.index)}}function Lh(n,e=Uint16Array){if(typeof n!="string")return n;let t=null;for(let r=0,i=0;r<n.length;){let s=0;for(;;){let o=n.charCodeAt(r++),l=!1;if(o==126){s=65535;break}o>=92&&o--,o>=34&&o--;let a=o-32;if(a>=46&&(a-=46,l=!0),s+=a,l)break;s*=46}t?t[i++]=s:t=new e(s)}return t}class xf{constructor(){this.start=-1,this.value=-1,this.end=-1,this.extended=-1,this.lookAhead=0,this.mask=0,this.context=0}}const $b=new xf;class N9{constructor(e,t){this.input=e,this.ranges=t,this.chunk="",this.chunkOff=0,this.chunk2="",this.chunk2Pos=0,this.next=-1,this.token=$b,this.rangeIndex=0,this.pos=this.chunkPos=t[0].from,this.range=t[0],this.end=t[t.length-1].to,this.readNext()}resolveOffset(e,t){let r=this.range,i=this.rangeIndex,s=this.pos+e;for(;s<r.from;){if(!i)return null;let o=this.ranges[--i];s-=r.from-o.to,r=o}for(;t<0?s>r.to:s>=r.to;){if(i==this.ranges.length-1)return null;let o=this.ranges[++i];s+=o.from-r.to,r=o}return s}clipPos(e){if(e>=this.range.from&&e<this.range.to)return e;for(let t of this.ranges)if(t.to>e)return Math.max(e,t.from);return this.end}peek(e){let t=this.chunkOff+e,r,i;if(t>=0&&t<this.chunk.length)r=this.pos+e,i=this.chunk.charCodeAt(t);else{let s=this.resolveOffset(e,1);if(s==null)return-1;if(r=s,r>=this.chunk2Pos&&r<this.chunk2Pos+this.chunk2.length)i=this.chunk2.charCodeAt(r-this.chunk2Pos);else{let o=this.rangeIndex,l=this.range;for(;l.to<=r;)l=this.ranges[++o];this.chunk2=this.input.chunk(this.chunk2Pos=r),r+this.chunk2.length>l.to&&(this.chunk2=this.chunk2.slice(0,l.to-r)),i=this.chunk2.charCodeAt(0)}}return r>=this.token.lookAhead&&(this.token.lookAhead=r+1),i}acceptToken(e,t=0){let r=t?this.resolveOffset(t,-1):this.pos;if(r==null||r<this.token.start)throw new RangeError("Token end out of bounds");this.token.value=e,this.token.end=r}acceptTokenTo(e,t){this.token.value=e,this.token.end=t}getChunk(){if(this.pos>=this.chunk2Pos&&this.pos<this.chunk2Pos+this.chunk2.length){let{chunk:e,chunkPos:t}=this;this.chunk=this.chunk2,this.chunkPos=this.chunk2Pos,this.chunk2=e,this.chunk2Pos=t,this.chunkOff=this.pos-this.chunkPos}else{this.chunk2=this.chunk,this.chunk2Pos=this.chunkPos;let e=this.input.chunk(this.pos),t=this.pos+e.length;this.chunk=t>this.range.to?e.slice(0,this.range.to-this.pos):e,this.chunkPos=this.pos,this.chunkOff=0}}readNext(){return this.chunkOff>=this.chunk.length&&(this.getChunk(),this.chunkOff==this.chunk.length)?this.next=-1:this.next=this.chunk.charCodeAt(this.chunkOff)}advance(e=1){for(this.chunkOff+=e;this.pos+e>=this.range.to;){if(this.rangeIndex==this.ranges.length-1)return this.setDone();e-=this.range.to-this.pos,this.range=this.ranges[++this.rangeIndex],this.pos=this.range.from}return this.pos+=e,this.pos>=this.token.lookAhead&&(this.token.lookAhead=this.pos+1),this.readNext()}setDone(){return this.pos=this.chunkPos=this.end,this.range=this.ranges[this.rangeIndex=this.ranges.length-1],this.chunk="",this.next=-1}reset(e,t){if(t?(this.token=t,t.start=e,t.lookAhead=e+1,t.value=t.extended=-1):this.token=$b,this.pos!=e){if(this.pos=e,e==this.end)return this.setDone(),this;for(;e<this.range.from;)this.range=this.ranges[--this.rangeIndex];for(;e>=this.range.to;)this.range=this.ranges[++this.rangeIndex];e>=this.chunkPos&&e<this.chunkPos+this.chunk.length?this.chunkOff=e-this.chunkPos:(this.chunk="",this.chunkOff=0),this.readNext()}return this}read(e,t){if(e>=this.chunkPos&&t<=this.chunkPos+this.chunk.length)return this.chunk.slice(e-this.chunkPos,t-this.chunkPos);if(e>=this.chunk2Pos&&t<=this.chunk2Pos+this.chunk2.length)return this.chunk2.slice(e-this.chunk2Pos,t-this.chunk2Pos);if(e>=this.range.from&&t<=this.range.to)return this.input.read(e,t);let r="";for(let i of this.ranges){if(i.from>=t)break;i.to>e&&(r+=this.input.read(Math.max(i.from,e),Math.min(i.to,t)))}return r}}class hl{constructor(e,t){this.data=e,this.id=t}token(e,t){let{parser:r}=t.p;L9(this.data,e,t,this.id,r.data,r.tokenPrecTable)}}hl.prototype.contextual=hl.prototype.fallback=hl.prototype.extend=!1;hl.prototype.fallback=hl.prototype.extend=!1;class V9{constructor(e,t={}){this.token=e,this.contextual=!!t.contextual,this.fallback=!!t.fallback,this.extend=!!t.extend}}function L9(n,e,t,r,i,s){let o=0,l=1<<r,{dialect:a}=t.p.parser;e:for(;l&n[o];){let u=n[o+1];for(let p=o+3;p<u;p+=2)if((n[p+1]&l)>0){let y=n[p];if(a.allows(y)&&(e.token.value==-1||e.token.value==y||B9(y,e.token.value,i,s))){e.acceptToken(y);break}}let c=e.next,f=0,d=n[o+2];if(e.next<0&&d>f&&n[u+d*3-3]==65535){o=n[u+d*3-1];continue e}for(;f<d;){let p=f+d>>1,y=u+p+(p<<1),v=n[y],E=n[y+1]||65536;if(c<v)d=p;else if(c>=E)f=p+1;else{o=n[y+2],e.advance();continue e}}break}}function Ub(n,e,t){for(let r=e,i;(i=n[r])!=65535;r++)if(i==t)return r-e;return-1}function B9(n,e,t,r){let i=Ub(t,r,e);return i<0||Ub(t,r,n)<i}const kn=typeof process<"u"&&Fb&&/\bparse\b/.test(Fb.LOG);let _g=null;function jb(n,e,t){let r=n.cursor(xt.IncludeAnonymous);for(r.moveTo(e);;)if(!(t<0?r.childBefore(e):r.childAfter(e)))for(;;){if((t<0?r.to<e:r.from>e)&&!r.type.isError)return t<0?Math.max(0,Math.min(r.to-1,e-25)):Math.min(n.length,Math.max(r.from+1,e+25));if(t<0?r.prevSibling():r.nextSibling())break;if(!r.parent())return t<0?0:n.length}}class F9{constructor(e,t){this.fragments=e,this.nodeSet=t,this.i=0,this.fragment=null,this.safeFrom=-1,this.safeTo=-1,this.trees=[],this.start=[],this.index=[],this.nextFragment()}nextFragment(){let e=this.fragment=this.i==this.fragments.length?null:this.fragments[this.i++];if(e){for(this.safeFrom=e.openStart?jb(e.tree,e.from+e.offset,1)-e.offset:e.from,this.safeTo=e.openEnd?jb(e.tree,e.to+e.offset,-1)-e.offset:e.to;this.trees.length;)this.trees.pop(),this.start.pop(),this.index.pop();this.trees.push(e.tree),this.start.push(-e.offset),this.index.push(0),this.nextStart=this.safeFrom}else this.nextStart=1e9}nodeAt(e){if(e<this.nextStart)return null;for(;this.fragment&&this.safeTo<=e;)this.nextFragment();if(!this.fragment)return null;for(;;){let t=this.trees.length-1;if(t<0)return this.nextFragment(),null;let r=this.trees[t],i=this.index[t];if(i==r.children.length){this.trees.pop(),this.start.pop(),this.index.pop();continue}let s=r.children[i],o=this.start[t]+r.positions[i];if(o>e)return this.nextStart=o,null;if(s instanceof ht){if(o==e){if(o<this.safeFrom)return null;let l=o+s.length;if(l<=this.safeTo){let a=s.prop(pe.lookAhead);if(!a||l+a<this.fragment.to)return s}}this.index[t]++,o+s.length>=Math.max(this.safeFrom,e)&&(this.trees.push(s),this.start.push(o),this.index.push(0))}else this.index[t]++,this.nextStart=o+s.length}}}class z9{constructor(e,t){this.stream=t,this.tokens=[],this.mainToken=null,this.actions=[],this.tokens=e.tokenizers.map(r=>new xf)}getActions(e){let t=0,r=null,{parser:i}=e.p,{tokenizers:s}=i,o=i.stateSlot(e.state,3),l=e.curContext?e.curContext.hash:0,a=0;for(let u=0;u<s.length;u++){if(!(1<<u&o))continue;let c=s[u],f=this.tokens[u];if(!(r&&!c.fallback)&&((c.contextual||f.start!=e.pos||f.mask!=o||f.context!=l)&&(this.updateCachedToken(f,c,e),f.mask=o,f.context=l),f.lookAhead>f.end+25&&(a=Math.max(f.lookAhead,a)),f.value!=0)){let d=t;if(f.extended>-1&&(t=this.addActions(e,f.extended,f.end,t)),t=this.addActions(e,f.value,f.end,t),!c.extend&&(r=f,t>d))break}}for(;this.actions.length>t;)this.actions.pop();return a&&e.setLookAhead(a),!r&&e.pos==this.stream.end&&(r=new xf,r.value=e.p.parser.eofTerm,r.start=r.end=e.pos,t=this.addActions(e,r.value,r.end,t)),this.mainToken=r,this.actions}getMainToken(e){if(this.mainToken)return this.mainToken;let t=new xf,{pos:r,p:i}=e;return t.start=r,t.end=Math.min(r+1,i.stream.end),t.value=r==i.stream.end?i.parser.eofTerm:0,t}updateCachedToken(e,t,r){let i=this.stream.clipPos(r.pos);if(t.token(this.stream.reset(i,e),r),e.value>-1){let{parser:s}=r.p;for(let o=0;o<s.specialized.length;o++)if(s.specialized[o]==e.value){let l=s.specializers[o](this.stream.read(e.start,e.end),r);if(l>=0&&r.p.parser.dialect.allows(l>>1)){l&1?e.extended=l>>1:e.value=l>>1;break}}}else e.value=0,e.end=this.stream.clipPos(i+1)}putAction(e,t,r,i){for(let s=0;s<i;s+=3)if(this.actions[s]==e)return i;return this.actions[i++]=e,this.actions[i++]=t,this.actions[i++]=r,i}addActions(e,t,r,i){let{state:s}=e,{parser:o}=e.p,{data:l}=o;for(let a=0;a<2;a++)for(let u=o.stateSlot(s,a?2:1);;u+=3){if(l[u]==65535)if(l[u+1]==1)u=Kr(l,u+2);else{i==0&&l[u+1]==2&&(i=this.putAction(Kr(l,u+2),t,r,i));break}l[u]==t&&(i=this.putAction(Kr(l,u+1),t,r,i))}return i}}class $9{constructor(e,t,r,i){this.parser=e,this.input=t,this.ranges=i,this.recovering=0,this.nextStackID=9812,this.minStackPos=0,this.reused=[],this.stoppedAt=null,this.lastBigReductionStart=-1,this.lastBigReductionSize=0,this.bigReductionCount=0,this.stream=new N9(t,i),this.tokens=new z9(e,this.stream),this.topTerm=e.top[1];let{from:s}=i[0];this.stacks=[Rd.start(this,e.top[0],s)],this.fragments=r.length&&this.stream.end-s>e.bufferLength*4?new F9(r,e.nodeSet):null}get parsedPos(){return this.minStackPos}advance(){let e=this.stacks,t=this.minStackPos,r=this.stacks=[],i,s;if(this.bigReductionCount>300&&e.length==1){let[o]=e;for(;o.forceReduce()&&o.stack.length&&o.stack[o.stack.length-2]>=this.lastBigReductionStart;);this.bigReductionCount=this.lastBigReductionSize=0}for(let o=0;o<e.length;o++){let l=e[o];for(;;){if(this.tokens.mainToken=null,l.pos>t)r.push(l);else{if(this.advanceStack(l,r,e))continue;{i||(i=[],s=[]),i.push(l);let a=this.tokens.getMainToken(l);s.push(a.value,a.end)}}break}}if(!r.length){let o=i&&j9(i);if(o)return kn&&console.log("Finish with "+this.stackID(o)),this.stackToTree(o);if(this.parser.strict)throw kn&&i&&console.log("Stuck with token "+(this.tokens.mainToken?this.parser.getName(this.tokens.mainToken.value):"none")),new SyntaxError("No parse at "+t);this.recovering||(this.recovering=5)}if(this.recovering&&i){let o=this.stoppedAt!=null&&i[0].pos>this.stoppedAt?i[0]:this.runRecovery(i,s,r);if(o)return kn&&console.log("Force-finish "+this.stackID(o)),this.stackToTree(o.forceAll())}if(this.recovering){let o=this.recovering==1?1:this.recovering*3;if(r.length>o)for(r.sort((l,a)=>a.score-l.score);r.length>o;)r.pop();r.some(l=>l.reducePos>t)&&this.recovering--}else if(r.length>1){e:for(let o=0;o<r.length-1;o++){let l=r[o];for(let a=o+1;a<r.length;a++){let u=r[a];if(l.sameState(u)||l.buffer.length>500&&u.buffer.length>500)if((l.score-u.score||l.buffer.length-u.buffer.length)>0)r.splice(a--,1);else{r.splice(o--,1);continue e}}}r.length>12&&r.splice(12,r.length-12)}this.minStackPos=r[0].pos;for(let o=1;o<r.length;o++)r[o].pos<this.minStackPos&&(this.minStackPos=r[o].pos);return null}stopAt(e){if(this.stoppedAt!=null&&this.stoppedAt<e)throw new RangeError("Can't move stoppedAt forward");this.stoppedAt=e}advanceStack(e,t,r){let i=e.pos,{parser:s}=this,o=kn?this.stackID(e)+" -> ":"";if(this.stoppedAt!=null&&i>this.stoppedAt)return e.forceReduce()?e:null;if(this.fragments){let u=e.curContext&&e.curContext.tracker.strict,c=u?e.curContext.hash:0;for(let f=this.fragments.nodeAt(i);f;){let d=this.parser.nodeSet.types[f.type.id]==f.type?s.getGoto(e.state,f.type.id):-1;if(d>-1&&f.length&&(!u||(f.prop(pe.contextHash)||0)==c))return e.useNode(f,d),kn&&console.log(o+this.stackID(e)+` (via reuse of ${s.getName(f.type.id)})`),!0;if(!(f instanceof ht)||f.children.length==0||f.positions[0]>0)break;let p=f.children[0];if(p instanceof ht&&f.positions[0]==0)f=p;else break}}let l=s.stateSlot(e.state,4);if(l>0)return e.reduce(l),kn&&console.log(o+this.stackID(e)+` (via always-reduce ${s.getName(l&65535)})`),!0;if(e.stack.length>=8400)for(;e.stack.length>6e3&&e.forceReduce(););let a=this.tokens.getActions(e);for(let u=0;u<a.length;){let c=a[u++],f=a[u++],d=a[u++],p=u==a.length||!r,y=p?e:e.split(),v=this.tokens.mainToken;if(y.apply(c,f,v?v.start:y.pos,d),kn&&console.log(o+this.stackID(y)+` (via ${c&65536?`reduce of ${s.getName(c&65535)}`:"shift"} for ${s.getName(f)} @ ${i}${y==e?"":", split"})`),p)return!0;y.pos>i?t.push(y):r.push(y)}return!1}advanceFully(e,t){let r=e.pos;for(;;){if(!this.advanceStack(e,null,null))return!1;if(e.pos>r)return Hb(e,t),!0}}runRecovery(e,t,r){let i=null,s=!1;for(let o=0;o<e.length;o++){let l=e[o],a=t[o<<1],u=t[(o<<1)+1],c=kn?this.stackID(l)+" -> ":"";if(l.deadEnd&&(s||(s=!0,l.restart(),kn&&console.log(c+this.stackID(l)+" (restarted)"),this.advanceFully(l,r))))continue;let f=l.split(),d=c;for(let p=0;f.forceReduce()&&p<10&&(kn&&console.log(d+this.stackID(f)+" (via force-reduce)"),!this.advanceFully(f,r));p++)kn&&(d=this.stackID(f)+" -> ");for(let p of l.recoverByInsert(a))kn&&console.log(c+this.stackID(p)+" (via recover-insert)"),this.advanceFully(p,r);this.stream.end>l.pos?(u==l.pos&&(u++,a=0),l.recoverByDelete(a,u),kn&&console.log(c+this.stackID(l)+` (via recover-delete ${this.parser.getName(a)})`),Hb(l,r)):(!i||i.score<l.score)&&(i=l)}return i}stackToTree(e){return e.close(),ht.build({buffer:Dd.create(e),nodeSet:this.parser.nodeSet,topID:this.topTerm,maxBufferLength:this.parser.bufferLength,reused:this.reused,start:this.ranges[0].from,length:e.pos-this.ranges[0].from,minRepeatType:this.parser.minRepeatTerm})}stackID(e){let t=(_g||(_g=new WeakMap)).get(e);return t||_g.set(e,t=String.fromCodePoint(this.nextStackID++)),t+e}}function Hb(n,e){for(let t=0;t<e.length;t++){let r=e[t];if(r.pos==n.pos&&r.sameState(n)){e[t].score<n.score&&(e[t]=n);return}}e.push(n)}class U9{constructor(e,t,r){this.source=e,this.flags=t,this.disabled=r}allows(e){return!this.disabled||this.disabled[e]==0}}class Od extends NI{constructor(e){if(super(),this.wrappers=[],e.version!=14)throw new RangeError(`Parser version (${e.version}) doesn't match runtime version (14)`);let t=e.nodeNames.split(" ");this.minRepeatTerm=t.length;for(let l=0;l<e.repeatNodeCount;l++)t.push("");let r=Object.keys(e.topRules).map(l=>e.topRules[l][1]),i=[];for(let l=0;l<t.length;l++)i.push([]);function s(l,a,u){i[l].push([a,a.deserialize(String(u))])}if(e.nodeProps)for(let l of e.nodeProps){let a=l[0];typeof a=="string"&&(a=pe[a]);for(let u=1;u<l.length;){let c=l[u++];if(c>=0)s(c,a,l[u++]);else{let f=l[u+-c];for(let d=-c;d>0;d--)s(l[u++],a,f);u++}}}this.nodeSet=new b1(t.map((l,a)=>xn.define({name:a>=this.minRepeatTerm?void 0:l,id:a,props:i[a],top:r.indexOf(a)>-1,error:a==0,skipped:e.skippedNodes&&e.skippedNodes.indexOf(a)>-1}))),e.propSources&&(this.nodeSet=this.nodeSet.extend(...e.propSources)),this.strict=!1,this.bufferLength=RI;let o=Lh(e.tokenData);this.context=e.context,this.specializerSpecs=e.specialized||[],this.specialized=new Uint16Array(this.specializerSpecs.length);for(let l=0;l<this.specializerSpecs.length;l++)this.specialized[l]=this.specializerSpecs[l].term;this.specializers=this.specializerSpecs.map(Wb),this.states=Lh(e.states,Uint32Array),this.data=Lh(e.stateData),this.goto=Lh(e.goto),this.maxTerm=e.maxTerm,this.tokenizers=e.tokenizers.map(l=>typeof l=="number"?new hl(o,l):l),this.topRules=e.topRules,this.dialects=e.dialects||{},this.dynamicPrecedences=e.dynamicPrecedences||null,this.tokenPrecTable=e.tokenPrec,this.termNames=e.termNames||null,this.maxNode=this.nodeSet.types.length-1,this.dialect=this.parseDialect(),this.top=this.topRules[Object.keys(this.topRules)[0]]}createParse(e,t,r){let i=new $9(this,e,t,r);for(let s of this.wrappers)i=s(i,e,t,r);return i}getGoto(e,t,r=!1){let i=this.goto;if(t>=i[0])return-1;for(let s=i[t+1];;){let o=i[s++],l=o&1,a=i[s++];if(l&&r)return a;for(let u=s+(o>>1);s<u;s++)if(i[s]==e)return a;if(l)return-1}}hasAction(e,t){let r=this.data;for(let i=0;i<2;i++)for(let s=this.stateSlot(e,i?2:1),o;;s+=3){if((o=r[s])==65535)if(r[s+1]==1)o=r[s=Kr(r,s+2)];else{if(r[s+1]==2)return Kr(r,s+2);break}if(o==t||o==0)return Kr(r,s+1)}return 0}stateSlot(e,t){return this.states[e*6+t]}stateFlag(e,t){return(this.stateSlot(e,0)&t)>0}validAction(e,t){return!!this.allActions(e,r=>r==t?!0:null)}allActions(e,t){let r=this.stateSlot(e,4),i=r?t(r):void 0;for(let s=this.stateSlot(e,1);i==null;s+=3){if(this.data[s]==65535)if(this.data[s+1]==1)s=Kr(this.data,s+2);else break;i=t(Kr(this.data,s+1))}return i}nextStates(e){let t=[];for(let r=this.stateSlot(e,1);;r+=3){if(this.data[r]==65535)if(this.data[r+1]==1)r=Kr(this.data,r+2);else break;if(!(this.data[r+2]&1)){let i=this.data[r+1];t.some((s,o)=>o&1&&s==i)||t.push(this.data[r],i)}}return t}configure(e){let t=Object.assign(Object.create(Od.prototype),this);if(e.props&&(t.nodeSet=this.nodeSet.extend(...e.props)),e.top){let r=this.topRules[e.top];if(!r)throw new RangeError(`Invalid top rule name ${e.top}`);t.top=r}return e.tokenizers&&(t.tokenizers=this.tokenizers.map(r=>{let i=e.tokenizers.find(s=>s.from==r);return i?i.to:r})),e.specializers&&(t.specializers=this.specializers.slice(),t.specializerSpecs=this.specializerSpecs.map((r,i)=>{let s=e.specializers.find(l=>l.from==r.external);if(!s)return r;let o=Object.assign(Object.assign({},r),{external:s.to});return t.specializers[i]=Wb(o),o})),e.contextTracker&&(t.context=e.contextTracker),e.dialect&&(t.dialect=this.parseDialect(e.dialect)),e.strict!=null&&(t.strict=e.strict),e.wrap&&(t.wrappers=t.wrappers.concat(e.wrap)),e.bufferLength!=null&&(t.bufferLength=e.bufferLength),t}hasWrappers(){return this.wrappers.length>0}getName(e){return this.termNames?this.termNames[e]:String(e<=this.maxNode&&this.nodeSet.types[e].name||e)}get eofTerm(){return this.maxNode+1}get topNode(){return this.nodeSet.types[this.top[1]]}dynamicPrecedence(e){let t=this.dynamicPrecedences;return t==null?0:t[e]||0}parseDialect(e){let t=Object.keys(this.dialects),r=t.map(()=>!1);if(e)for(let s of e.split(" ")){let o=t.indexOf(s);o>=0&&(r[o]=!0)}let i=null;for(let s=0;s<t.length;s++)if(!r[s])for(let o=this.dialects[t[s]],l;(l=this.data[o++])!=65535;)(i||(i=new Uint8Array(this.maxTerm+1)))[l]=1;return new U9(e,r,i)}static deserialize(e){return new Od(e)}}function Kr(n,e){return n[e]|n[e+1]<<16}function j9(n){let e=null;for(let t of n){let r=t.p.stoppedAt;(t.pos==t.p.stream.end||r!=null&&t.pos>r)&&t.p.parser.stateFlag(t.state,2)&&(!e||e.score<t.score)&&(e=t)}return e}function Wb(n){if(n.external){let e=n.extend?1:0;return(t,r)=>n.external(t,r)<<1|e}return n.get}const H9=36,qb=1,W9=2,To=3,xg=4,q9=5,K9=6,Q9=7,G9=8,Y9=9,X9=10,J9=11,Z9=12,e6=13,t6=14,n6=15,r6=16,i6=17,Kb=18,s6=19,iR=20,sR=21,Qb=22,o6=23,l6=24;function I0(n){return n>=65&&n<=90||n>=97&&n<=122||n>=48&&n<=57}function a6(n){return n>=48&&n<=57||n>=97&&n<=102||n>=65&&n<=70}function Es(n,e,t){for(let r=!1;;){if(n.next<0)return;if(n.next==e&&!r){n.advance();return}r=t&&!r&&n.next==92,n.advance()}}function u6(n,e){e:for(;;){if(n.next<0)return;if(n.next==36){n.advance();for(let t=0;t<e.length;t++){if(n.next!=e.charCodeAt(t))continue e;n.advance()}if(n.next==36){n.advance();return}}else n.advance()}}function c6(n,e){let t="[{<(".indexOf(String.fromCharCode(e)),r=t<0?e:"]}>)".charCodeAt(t);for(;;){if(n.next<0)return;if(n.next==r&&n.peek(1)==39){n.advance(2);return}n.advance()}}function P0(n,e){for(;!(n.next!=95&&!I0(n.next));)e!=null&&(e+=String.fromCharCode(n.next)),n.advance();return e}function h6(n){if(n.next==39||n.next==34||n.next==96){let e=n.next;n.advance(),Es(n,e,!1)}else P0(n)}function Gb(n,e){for(;n.next==48||n.next==49;)n.advance();e&&n.next==e&&n.advance()}function Yb(n,e){for(;;){if(n.next==46){if(e)break;e=!0}else if(n.next<48||n.next>57)break;n.advance()}if(n.next==69||n.next==101)for(n.advance(),(n.next==43||n.next==45)&&n.advance();n.next>=48&&n.next<=57;)n.advance()}function Xb(n){for(;!(n.next<0||n.next==10);)n.advance()}function xs(n,e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)==n)return!0;return!1}const Sg=` 	\r
`;function oR(n,e,t){let r=Object.create(null);r.true=r.false=q9,r.null=r.unknown=K9;for(let i of n.split(" "))i&&(r[i]=iR);for(let i of e.split(" "))i&&(r[i]=sR);for(let i of(t||"").split(" "))i&&(r[i]=l6);return r}const f6="array binary bit boolean char character clob date decimal double float int integer interval large national nchar nclob numeric object precision real smallint time timestamp varchar varying ",d6="absolute action add after all allocate alter and any are as asc assertion at authorization before begin between both breadth by call cascade cascaded case cast catalog check close collate collation column commit condition connect connection constraint constraints constructor continue corresponding count create cross cube current current_date current_default_transform_group current_transform_group_for_type current_path current_role current_time current_timestamp current_user cursor cycle data day deallocate declare default deferrable deferred delete depth deref desc describe descriptor deterministic diagnostics disconnect distinct do domain drop dynamic each else elseif end end-exec equals escape except exception exec execute exists exit external fetch first for foreign found from free full function general get global go goto grant group grouping handle having hold hour identity if immediate in indicator initially inner inout input insert intersect into is isolation join key language last lateral leading leave left level like limit local localtime localtimestamp locator loop map match method minute modifies module month names natural nesting new next no none not of old on only open option or order ordinality out outer output overlaps pad parameter partial path prepare preserve primary prior privileges procedure public read reads recursive redo ref references referencing relative release repeat resignal restrict result return returns revoke right role rollback rollup routine row rows savepoint schema scroll search second section select session session_user set sets signal similar size some space specific specifictype sql sqlexception sqlstate sqlwarning start state static system_user table temporary then timezone_hour timezone_minute to trailing transaction translation treat trigger under undo union unique unnest until update usage user using value values view when whenever where while with without work write year zone ",R0={backslashEscapes:!1,hashComments:!1,spaceAfterDashes:!1,slashComments:!1,doubleQuotedStrings:!1,doubleDollarQuotedStrings:!1,unquotedBitLiterals:!1,treatBitsAsBytes:!1,charSetCasts:!1,plsqlQuotingMechanism:!1,operatorChars:"*+-%<>!=&|~^/",specialVar:"?",identifierQuotes:'"',caseInsensitiveIdentifiers:!1,words:oR(d6,f6)};function p6(n,e,t,r){let i={};for(let s in R0)i[s]=(n.hasOwnProperty(s)?n:R0)[s];return e&&(i.words=oR(e,t||"",r)),i}function lR(n){return new V9(e=>{var t;let{next:r}=e;if(e.advance(),xs(r,Sg)){for(;xs(e.next,Sg);)e.advance();e.acceptToken(H9)}else if(r==36&&n.doubleDollarQuotedStrings){let i=P0(e,"");e.next==36&&(e.advance(),u6(e,i),e.acceptToken(To))}else if(r==39||r==34&&n.doubleQuotedStrings)Es(e,r,n.backslashEscapes),e.acceptToken(To);else if(r==35&&n.hashComments||r==47&&e.next==47&&n.slashComments)Xb(e),e.acceptToken(qb);else if(r==45&&e.next==45&&(!n.spaceAfterDashes||e.peek(1)==32))Xb(e),e.acceptToken(qb);else if(r==47&&e.next==42){e.advance();for(let i=1;;){let s=e.next;if(e.next<0)break;if(e.advance(),s==42&&e.next==47){if(i--,e.advance(),!i)break}else s==47&&e.next==42&&(i++,e.advance())}e.acceptToken(W9)}else if((r==101||r==69)&&e.next==39)e.advance(),Es(e,39,!0),e.acceptToken(To);else if((r==110||r==78)&&e.next==39&&n.charSetCasts)e.advance(),Es(e,39,n.backslashEscapes),e.acceptToken(To);else if(r==95&&n.charSetCasts)for(let i=0;;i++){if(e.next==39&&i>1){e.advance(),Es(e,39,n.backslashEscapes),e.acceptToken(To);break}if(!I0(e.next))break;e.advance()}else if(n.plsqlQuotingMechanism&&(r==113||r==81)&&e.next==39&&e.peek(1)>0&&!xs(e.peek(1),Sg)){let i=e.peek(1);e.advance(2),c6(e,i),e.acceptToken(To)}else if(r==40)e.acceptToken(Q9);else if(r==41)e.acceptToken(G9);else if(r==123)e.acceptToken(Y9);else if(r==125)e.acceptToken(X9);else if(r==91)e.acceptToken(J9);else if(r==93)e.acceptToken(Z9);else if(r==59)e.acceptToken(e6);else if(n.unquotedBitLiterals&&r==48&&e.next==98)e.advance(),Gb(e),e.acceptToken(Qb);else if((r==98||r==66)&&(e.next==39||e.next==34)){const i=e.next;e.advance(),n.treatBitsAsBytes?(Es(e,i,n.backslashEscapes),e.acceptToken(o6)):(Gb(e,i),e.acceptToken(Qb))}else if(r==48&&(e.next==120||e.next==88)||(r==120||r==88)&&e.next==39){let i=e.next==39;for(e.advance();a6(e.next);)e.advance();i&&e.next==39&&e.advance(),e.acceptToken(xg)}else if(r==46&&e.next>=48&&e.next<=57)Yb(e,!0),e.acceptToken(xg);else if(r==46)e.acceptToken(t6);else if(r>=48&&r<=57)Yb(e,!1),e.acceptToken(xg);else if(xs(r,n.operatorChars)){for(;xs(e.next,n.operatorChars);)e.advance();e.acceptToken(n6)}else if(xs(r,n.specialVar))e.next==r&&e.advance(),h6(e),e.acceptToken(i6);else if(xs(r,n.identifierQuotes))Es(e,r,!1),e.acceptToken(s6);else if(r==58||r==44)e.acceptToken(r6);else if(I0(r)){let i=P0(e,String.fromCharCode(r));e.acceptToken(e.next==46||e.peek(-i.length-1)==46?Kb:(t=n.words[i.toLowerCase()])!==null&&t!==void 0?t:Kb)}})}const aR=lR(R0),m6=Od.deserialize({version:14,states:"%vQ]QQOOO#wQRO'#DSO$OQQO'#CwO%eQQO'#CxO%lQQO'#CyO%sQQO'#CzOOQQ'#DS'#DSOOQQ'#C}'#C}O'UQRO'#C{OOQQ'#Cv'#CvOOQQ'#C|'#C|Q]QQOOQOQQOOO'`QQO'#DOO(xQRO,59cO)PQQO,59cO)UQQO'#DSOOQQ,59d,59dO)cQQO,59dOOQQ,59e,59eO)jQQO,59eOOQQ,59f,59fO)qQQO,59fOOQQ-E6{-E6{OOQQ,59b,59bOOQQ-E6z-E6zOOQQ,59j,59jOOQQ-E6|-E6|O+VQRO1G.}O+^QQO,59cOOQQ1G/O1G/OOOQQ1G/P1G/POOQQ1G/Q1G/QP+kQQO'#C}O+rQQO1G.}O)PQQO,59cO,PQQO'#Cw",stateData:",[~OtOSPOSQOS~ORUOSUOTUOUUOVROXSOZTO]XO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O^]ORvXSvXTvXUvXVvXXvXZvX]vX_vX`vXavXbvXcvXdvXevXfvXgvXhvX~OsvX~P!jOa_Ob_Oc_O~ORUOSUOTUOUUOVROXSOZTO^tO_UO`UOa`Ob`Oc`OdUOeUOfUOgUOhUO~OWaO~P$ZOYcO~P$ZO[eO~P$ZORUOSUOTUOUUOVROXSOZTO^QO_UO`UOaPObPOcPOdUOeUOfUOgUOhUO~O]hOsoX~P%zOajObjOcjO~O^]ORkaSkaTkaUkaVkaXkaZka]ka_ka`kaakabkackadkaekafkagkahka~Oska~P'kO^]O~OWvXYvX[vX~P!jOWnO~P$ZOYoO~P$ZO[pO~P$ZO^]ORkiSkiTkiUkiVkiXkiZki]ki_ki`kiakibkickidkiekifkigkihki~Oski~P)xOWkaYka[ka~P'kO]hO~P$ZOWkiYki[ki~P)xOasObsOcsO~O",goto:"#hwPPPPPPPPPPPPPPPPPPPPPPPPPPx||||!Y!^!d!xPPP#[TYOZeUORSTWZbdfqT[OZQZORiZSWOZQbRQdSQfTZgWbdfqQ^PWk^lmrQl_Qm`RrseVORSTWZbdfq",nodeNames:" LineComment BlockComment String Number Bool Null ( ) { } [ ] ; . Operator Punctuation SpecialVar Identifier QuotedIdentifier Keyword Type Bits Bytes Builtin Script Statement CompositeIdentifier Parens Braces Brackets Statement",maxTerm:38,nodeProps:[["isolate",-4,1,2,3,19,""]],skippedNodes:[0,1,2],repeatNodeCount:3,tokenData:"RORO",tokenizers:[0,aR],topRules:{Script:[0,25]},tokenPrec:0});function D0(n){let e=n.cursor().moveTo(n.from,-1);for(;/Comment/.test(e.name);)e.moveTo(e.from,-1);return e.node}function Zu(n,e){let t=n.sliceString(e.from,e.to),r=/^([`'"])(.*)\1$/.exec(t);return r?r[2]:t}function Md(n){return n&&(n.name=="Identifier"||n.name=="QuotedIdentifier")}function g6(n,e){if(e.name=="CompositeIdentifier"){let t=[];for(let r=e.firstChild;r;r=r.nextSibling)Md(r)&&t.push(Zu(n,r));return t}return[Zu(n,e)]}function Jb(n,e){for(let t=[];;){if(!e||e.name!=".")return t;let r=D0(e);if(!Md(r))return t;t.unshift(Zu(n,r)),e=D0(r)}}function y6(n,e){let t=kt(n).resolveInner(e,-1),r=w6(n.doc,t);return t.name=="Identifier"||t.name=="QuotedIdentifier"||t.name=="Keyword"?{from:t.from,quoted:t.name=="QuotedIdentifier"?n.doc.sliceString(t.from,t.from+1):null,parents:Jb(n.doc,D0(t)),aliases:r}:t.name=="."?{from:e,quoted:null,parents:Jb(n.doc,t),aliases:r}:{from:e,quoted:null,parents:[],empty:!0,aliases:r}}const v6=new Set("where group having order union intersect except all distinct limit offset fetch for".split(" "));function w6(n,e){let t;for(let i=e;!t;i=i.parent){if(!i)return null;i.name=="Statement"&&(t=i)}let r=null;for(let i=t.firstChild,s=!1,o=null;i;i=i.nextSibling){let l=i.name=="Keyword"?n.sliceString(i.from,i.to).toLowerCase():null,a=null;if(!s)s=l=="from";else if(l=="as"&&o&&Md(i.nextSibling))a=Zu(n,i.nextSibling);else{if(l&&v6.has(l))break;o&&Md(i)&&(a=Zu(n,i))}a&&(r||(r=Object.create(null)),r[a]=g6(n,o)),o=/Identifier$/.test(i.name)?i:null}return r}function _6(n,e){return n?e.map(t=>Object.assign(Object.assign({},t),{label:t.label[0]==n?t.label:n+t.label+n,apply:void 0})):e}const x6=/^\w*$/,S6=/^[`'"]?\w*[`'"]?$/;function Zb(n){return n.self&&typeof n.self.label=="string"}class $1{constructor(e,t){this.idQuote=e,this.idCaseInsensitive=t,this.list=[],this.children=void 0}child(e){let t=this.children||(this.children=Object.create(null)),r=t[e];return r||(e&&!this.list.some(i=>i.label==e)&&this.list.push(ek(e,"type",this.idQuote,this.idCaseInsensitive)),t[e]=new $1(this.idQuote,this.idCaseInsensitive))}maybeChild(e){return this.children?this.children[e]:null}addCompletion(e){let t=this.list.findIndex(r=>r.label==e.label);t>-1?this.list[t]=e:this.list.push(e)}addCompletions(e){for(let t of e)this.addCompletion(typeof t=="string"?ek(t,"property",this.idQuote,this.idCaseInsensitive):t)}addNamespace(e){Array.isArray(e)?this.addCompletions(e):Zb(e)?this.addNamespace(e.children):this.addNamespaceObject(e)}addNamespaceObject(e){for(let t of Object.keys(e)){let r=e[t],i=null,s=t.replace(/\\?\./g,l=>l=="."?"\0":l).split("\0"),o=this;Zb(r)&&(i=r.self,r=r.children);for(let l=0;l<s.length;l++)i&&l==s.length-1&&o.addCompletion(i),o=o.child(s[l].replace(/\\\./g,"."));o.addNamespace(r)}}}function ek(n,e,t,r){return new RegExp("^[a-z_][a-z_\\d]*$",r?"i":"").test(n)?{label:n,type:e}:{label:n,type:e,apply:t+n+t}}function b6(n,e,t,r,i,s){var o;let l=((o=s==null?void 0:s.spec.identifierQuotes)===null||o===void 0?void 0:o[0])||'"',a=new $1(l,!!(s!=null&&s.spec.caseInsensitiveIdentifiers)),u=i?a.child(i):null;return a.addNamespace(n),e&&(u||a).addCompletions(e),t&&a.addCompletions(t),u&&a.addCompletions(u.list),r&&a.addCompletions((u||a).child(r).list),c=>{let{parents:f,from:d,quoted:p,empty:y,aliases:v}=y6(c.state,c.pos);if(y&&!c.explicit)return null;v&&f.length==1&&(f=v[f[0]]||f);let E=a;for(let b of f){for(;!E.children||!E.children[b];)if(E==a&&u)E=u;else if(E==u&&r)E=E.child(r);else return null;let I=E.maybeChild(b);if(!I)return null;E=I}let w=p&&c.state.sliceDoc(c.pos,c.pos+1)==p,_=E.list;return E==a&&v&&(_=_.concat(Object.keys(v).map(b=>({label:b,type:"constant"})))),{from:d,to:w?c.pos+1:void 0,options:_6(p,_),validFor:p?S6:x6}}}function k6(n){return n==sR?"type":n==iR?"keyword":"variable"}function E6(n,e,t){let r=Object.keys(n).map(i=>t(e?i.toUpperCase():i,k6(n[i])));return v5(["QuotedIdentifier","SpecialVar","String","LineComment","BlockComment","."],jP(r))}let T6=m6.configure({props:[zI.add({Statement:ZB()}),UI.add({Statement(n,e){return{from:Math.min(n.from+100,e.doc.lineAt(n.from).to),to:n.to}},BlockComment(n){return{from:n.from+2,to:n.to-2}}}),VI({Keyword:O.keyword,Type:O.typeName,Builtin:O.standard(O.name),Bits:O.number,Bytes:O.string,Bool:O.bool,Null:O.null,Number:O.number,String:O.string,Identifier:O.name,QuotedIdentifier:O.special(O.string),SpecialVar:O.special(O.name),LineComment:O.lineComment,BlockComment:O.blockComment,Operator:O.operator,"Semi Punctuation":O.punctuation,"( )":O.paren,"{ }":O.brace,"[ ]":O.squareBracket})]});class U1{constructor(e,t,r){this.dialect=e,this.language=t,this.spec=r}get extension(){return this.language.extension}static define(e){let t=p6(e,e.keywords,e.types,e.builtin),r=vd.define({name:"sql",parser:T6.configure({tokenizers:[{from:aR,to:lR(t)}]}),languageData:{commentTokens:{line:"--",block:{open:"/*",close:"*/"}},closeBrackets:{brackets:["(","[","{","'",'"',"`"]}}});return new U1(t,r,e)}}function C6(n,e){return{label:n,type:e,boost:-1}}function A6(n,e=!1,t){return E6(n.dialect.words,e,t||C6)}function I6(n){return n.schema?b6(n.schema,n.tables,n.schemas,n.defaultTable,n.defaultSchema,n.dialect||j1):()=>null}function P6(n){return n.schema?(n.dialect||j1).language.data.of({autocomplete:I6(n)}):[]}function R6(n={}){let e=n.dialect||j1;return new HB(e.language,[P6(n),e.language.data.of({autocomplete:A6(e,n.upperCaseKeywords,n.keywordCompletion)})])}const j1=U1.define({});var uR=n=>{var{theme:e,settings:t={},styles:r=[]}=n,i={".cm-gutters":{}},s={};t.background&&(s.backgroundColor=t.background),t.backgroundImage&&(s.backgroundImage=t.backgroundImage),t.foreground&&(s.color=t.foreground),t.fontSize&&(s.fontSize=t.fontSize),(t.background||t.foreground)&&(i["&"]=s),t.fontFamily&&(i["&.cm-editor .cm-scroller"]={fontFamily:t.fontFamily}),t.gutterBackground&&(i[".cm-gutters"].backgroundColor=t.gutterBackground),t.gutterForeground&&(i[".cm-gutters"].color=t.gutterForeground),t.gutterBorder&&(i[".cm-gutters"].borderRightColor=t.gutterBorder),t.caret&&(i[".cm-content"]={caretColor:t.caret},i[".cm-cursor, .cm-dropCursor"]={borderLeftColor:t.caret});var o={};t.gutterActiveForeground&&(o.color=t.gutterActiveForeground),t.lineHighlight&&(i[".cm-activeLine"]={backgroundColor:t.lineHighlight},o.backgroundColor=t.lineHighlight),i[".cm-activeLineGutter"]=o,t.selection&&(i["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:t.selection+" !important"}),t.selectionMatch&&(i["& .cm-selectionMatch"]={backgroundColor:t.selectionMatch});var l=q.theme(i,{dark:e==="dark"}),a=Ql.define(r),u=[l,I1(a)];return u},D6={background:"#fff",foreground:"#24292e",selection:"#BBDFFF",selectionMatch:"#BBDFFF",gutterBackground:"#fff",gutterForeground:"#6e7781"},O6=[{tag:[O.standard(O.tagName),O.tagName],color:"#116329"},{tag:[O.comment,O.bracket],color:"#6a737d"},{tag:[O.className,O.propertyName],color:"#6f42c1"},{tag:[O.variableName,O.attributeName,O.number,O.operator],color:"#005cc5"},{tag:[O.keyword,O.typeName,O.typeOperator,O.typeName],color:"#d73a49"},{tag:[O.string,O.meta,O.regexp],color:"#032f62"},{tag:[O.name,O.quote],color:"#22863a"},{tag:[O.heading,O.strong],color:"#24292e",fontWeight:"bold"},{tag:[O.emphasis],color:"#24292e",fontStyle:"italic"},{tag:[O.deleted],color:"#b31d28",backgroundColor:"ffeef0"},{tag:[O.atom,O.bool,O.special(O.variableName)],color:"#e36209"},{tag:[O.url,O.escape,O.regexp,O.link],color:"#032f62"},{tag:O.link,textDecoration:"underline"},{tag:O.strikethrough,textDecoration:"line-through"},{tag:O.invalid,color:"#cb2431"}],M6=n=>{var{theme:e="light",settings:t={},styles:r=[]}={};return uR({theme:e,settings:Lu({},D6,t),styles:[...O6,...r]})},N6=M6(),V6={background:"#0d1117",foreground:"#c9d1d9",caret:"#c9d1d9",selection:"#003d73",selectionMatch:"#003d73",lineHighlight:"#36334280"},L6=[{tag:[O.standard(O.tagName),O.tagName],color:"#7ee787"},{tag:[O.comment,O.bracket],color:"#8b949e"},{tag:[O.className,O.propertyName],color:"#d2a8ff"},{tag:[O.variableName,O.attributeName,O.number,O.operator],color:"#79c0ff"},{tag:[O.keyword,O.typeName,O.typeOperator,O.typeName],color:"#ff7b72"},{tag:[O.string,O.meta,O.regexp],color:"#a5d6ff"},{tag:[O.name,O.quote],color:"#7ee787"},{tag:[O.heading,O.strong],color:"#d2a8ff",fontWeight:"bold"},{tag:[O.emphasis],color:"#d2a8ff",fontStyle:"italic"},{tag:[O.deleted],color:"#ffdcd7",backgroundColor:"ffeef0"},{tag:[O.atom,O.bool,O.special(O.variableName)],color:"#ffab70"},{tag:O.link,textDecoration:"underline"},{tag:O.strikethrough,textDecoration:"line-through"},{tag:O.invalid,color:"#f97583"}],B6=n=>{var{theme:e="dark",settings:t={},styles:r=[]}={};return uR({theme:e,settings:Lu({},V6,t),styles:[...L6,...r]})};B6();const Sf=[{id:"select-all-users",name:"Select All Users",query:"SELECT * FROM users;"},{id:"user-orders",name:"User Orders (Amount > $100)",query:`SELECT 
  users.name,
  orders.order_date,
  orders.total_amount
FROM users
JOIN orders ON users.id = orders.user_id
WHERE orders.total_amount > 100
ORDER BY orders.order_date DESC;`},{id:"product-inventory",name:"Low Stock Products",query:`SELECT 
  products.name,
  products.price,
  inventory.quantity
FROM products
JOIN inventory ON products.id = inventory.product_id
WHERE inventory.quantity < 50;`},{id:"user-order-stats",name:"User Order Statistics",query:`SELECT 
  users.name,
  COUNT(orders.id) as total_orders,
  SUM(orders.total_amount) as total_spent,
  AVG(orders.total_amount) as avg_order_value
FROM users
LEFT JOIN orders ON users.id = orders.user_id
GROUP BY users.id, users.name
HAVING COUNT(orders.id) > 0
ORDER BY total_spent DESC;`},{id:"product-sales",name:"Top Selling Products",query:`SELECT 
  products.name,
  COUNT(order_items.id) as times_sold,
  SUM(order_items.quantity) as total_quantity,
  SUM(order_items.quantity * products.price) as total_revenue
FROM products
JOIN order_items ON products.id = order_items.product_id
GROUP BY products.id, products.name
ORDER BY total_revenue DESC
LIMIT 5;`},{id:"recent-activity",name:"Recent User Activity",query:`SELECT 
  users.name,
  orders.order_date,
  products.name as product_name,
  order_items.quantity,
  orders.total_amount
FROM users
JOIN orders ON users.id = orders.user_id
JOIN order_items ON orders.id = order_items.order_id
JOIN products ON order_items.product_id = products.id
WHERE orders.order_date >= DATE_SUB(NOW(), INTERVAL 7 DAY)
ORDER BY orders.order_date DESC;`}],Ia={users:[{id:1,name:"John Doe",email:"john@example.com",created_at:"2023-01-15"},{id:2,name:"Jane Smith",email:"jane@example.com",created_at:"2023-02-20"},{id:3,name:"Bob Johnson",email:"bob@example.com",created_at:"2023-03-10"}],orders:[{id:1,user_id:1,order_date:"2023-04-15",total_amount:150},{id:2,user_id:2,order_date:"2023-04-16",total_amount:75.5},{id:3,user_id:1,order_date:"2023-04-17",total_amount:200}],products:[{id:1,name:"Laptop",price:999.99},{id:2,name:"Mouse",price:29.99},{id:3,name:"Keyboard",price:59.99}],inventory:[{product_id:1,quantity:45},{product_id:2,quantity:100},{product_id:3,quantity:30}]},F6=n=>n.toLowerCase().includes("from users")?Ia.users:n.toLowerCase().includes("from orders")?Ia.orders.map(e=>{var t;return{name:(t=Ia.users.find(r=>r.id===e.user_id))==null?void 0:t.name,order_date:e.order_date,total_amount:e.total_amount}}):n.toLowerCase().includes("from products")?Ia.products.map(e=>{var t;return{name:e.name,price:e.price,quantity:(t=Ia.inventory.find(r=>r.product_id===e.id))==null?void 0:t.quantity}}):[],z6=Nt.div`
  margin-bottom: 1rem;
  position: relative;
`,$6=Nt.div`
  position: relative;
  &:after {
    content: '';
    position: absolute;
    top: 50%;
    right: 1rem;
    transform: translateY(-50%);
    color: #4CAF50;
    pointer-events: none;
  }
`,U6=Nt.select`
  width: 100%;
  padding: 1rem;
  border: 2px solid rgba(76,175,80,0.3);
  border-radius: 12px;
  font-size: 1rem;
  background: rgba(16,16,28,0.9);
  color: #ffffff;
  cursor: pointer;
  appearance: none;
  transition: all 0.3s ease;

  &:focus {
    outline: none;
    border-color: #4CAF50;
    box-shadow: 0 0 15px rgba(76,175,80,0.2);
  }

  option {
    background: #10101c;
    color: white;
    padding: 1rem;
  }

  optgroup {
    background: #10101c;
    color: #4CAF50;
    font-weight: bold;
    padding: 0.5rem;
  }
`,j6=({onSelect:n,customQueries:e})=>{const t=r=>{const s=[...Sf,...e].find(o=>o.id===r.target.value);s&&n(s.query)};return Ee.jsx(z6,{children:Ee.jsx($6,{children:Ee.jsxs(U6,{onChange:t,defaultValue:Sf[0].id,children:[Ee.jsx("optgroup",{label:"Predefined Queries",children:Sf.map(r=>Ee.jsx("option",{value:r.id,children:r.name},r.id))}),e.length>0&&Ee.jsx("optgroup",{label:"Saved Queries",children:e.map(r=>Ee.jsx("option",{value:r.id,children:r.name},r.id))})]})})})},H6=Nt.div`
  margin-top: 2rem;
  overflow-x: auto;
  border: 1px solid rgba(76,175,80,0.3);
  border-radius: 12px;
  background: rgba(255,255,255,0.03);
  box-shadow: 0 0 20px rgba(0,0,0,0.2);
`,W6=Nt.table`
  width: 100%;
  border-collapse: collapse;
  color: #ffffff;
`,q6=Nt.th`
  background: rgba(76,175,80,0.1);
  padding: 1rem;
  text-align: left;
  border-bottom: 2px solid rgba(76,175,80,0.3);
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-size: 0.9rem;
`,K6=Nt.td`
  padding: 0.75rem 1rem;
  border-bottom: 1px solid rgba(76,175,80,0.1);
`,Q6=Nt.tr`
  transition: all 0.3s ease;

  &:hover {
    background: rgba(76,175,80,0.1);
  }
`,G6=({results:n})=>{if(!n.length)return null;const e=Object.keys(n[0]);return Ee.jsx(H6,{children:Ee.jsxs(W6,{children:[Ee.jsx("thead",{children:Ee.jsx("tr",{children:e.map(t=>Ee.jsx(q6,{children:t},t))})}),Ee.jsx("tbody",{children:n.map((t,r)=>Ee.jsx(Q6,{children:e.map(i=>Ee.jsx(K6,{children:t[i]},`${r}-${i}`))},r))})]})})};var tk={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cR=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Y6=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],l=n[t++],a=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(a&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},hR={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,a=i+2<n.length,u=a?n[i+2]:0,c=s>>2,f=(s&3)<<4|l>>4;let d=(l&15)<<2|u>>6,p=u&63;a||(p=64,o||(d=64)),r.push(t[c],t[f],t[d],t[p])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(cR(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):Y6(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const f=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||u==null||f==null)throw new X6;const d=s<<2|l>>4;if(r.push(d),u!==64){const p=l<<4&240|u>>2;if(r.push(p),f!==64){const y=u<<6&192|f;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class X6 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const J6=function(n){const e=cR(n);return hR.encodeByteArray(e,!0)},Nd=function(n){return J6(n).replace(/\./g,"")},Z6=function(n){try{return hR.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ez(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tz=()=>ez().__FIREBASE_DEFAULTS__,nz=()=>{if(typeof process>"u"||typeof tk>"u")return;const n=tk.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},rz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Z6(n[1]);return e&&JSON.parse(e)},H1=()=>{try{return tz()||nz()||rz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},iz=n=>{var e,t;return(t=(e=H1())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},sz=n=>{const e=iz(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},fR=()=>{var n;return(n=H1())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oz{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lz(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Nd(JSON.stringify(t)),Nd(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function az(){var n;const e=(n=H1())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function dR(){return!az()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pR(){try{return typeof indexedDB=="object"}catch{return!1}}function uz(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cz="FirebaseError";class Xl extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=cz,Object.setPrototypeOf(this,Xl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mR.prototype.create)}}class mR{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?hz(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Xl(i,l,r)}}function hz(n,e){return n.replace(fz,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const fz=/\{\$([^}]+)}/g;function O0(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(nk(s)&&nk(o)){if(!O0(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function nk(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ec(n){return n&&n._delegate?n._delegate:n}class tc{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dz{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new oz;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mz(e))try{this.getOrInitializeService({instanceIdentifier:Ts})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ts){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ts){return this.instances.has(e)}getOptions(e=Ts){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pz(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ts){return this.component?this.component.multipleInstances?e:Ts:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pz(n){return n===Ts?void 0:n}function mz(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new dz(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _e;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(_e||(_e={}));const yz={debug:_e.DEBUG,verbose:_e.VERBOSE,info:_e.INFO,warn:_e.WARN,error:_e.ERROR,silent:_e.SILENT},vz=_e.INFO,wz={[_e.DEBUG]:"log",[_e.VERBOSE]:"log",[_e.INFO]:"info",[_e.WARN]:"warn",[_e.ERROR]:"error"},_z=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=wz[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class gR{constructor(e){this.name=e,this._logLevel=vz,this._logHandler=_z,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in _e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,_e.DEBUG,...e),this._logHandler(this,_e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,_e.VERBOSE,...e),this._logHandler(this,_e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,_e.INFO,...e),this._logHandler(this,_e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,_e.WARN,...e),this._logHandler(this,_e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,_e.ERROR,...e),this._logHandler(this,_e.ERROR,...e)}}const xz=(n,e)=>e.some(t=>n instanceof t);let rk,ik;function Sz(){return rk||(rk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bz(){return ik||(ik=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yR=new WeakMap,M0=new WeakMap,vR=new WeakMap,bg=new WeakMap,W1=new WeakMap;function kz(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Ki(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&yR.set(t,n)}).catch(()=>{}),W1.set(e,n),e}function Ez(n){if(M0.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});M0.set(n,e)}let N0={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return M0.get(n);if(e==="objectStoreNames")return n.objectStoreNames||vR.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ki(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Tz(n){N0=n(N0)}function Cz(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(kg(this),e,...t);return vR.set(r,e.sort?e.sort():[e]),Ki(r)}:bz().includes(n)?function(...e){return n.apply(kg(this),e),Ki(yR.get(this))}:function(...e){return Ki(n.apply(kg(this),e))}}function Az(n){return typeof n=="function"?Cz(n):(n instanceof IDBTransaction&&Ez(n),xz(n,Sz())?new Proxy(n,N0):n)}function Ki(n){if(n instanceof IDBRequest)return kz(n);if(bg.has(n))return bg.get(n);const e=Az(n);return e!==n&&(bg.set(n,e),W1.set(e,n)),e}const kg=n=>W1.get(n);function Iz(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),l=Ki(o);return r&&o.addEventListener("upgradeneeded",a=>{r(Ki(o.result),a.oldVersion,a.newVersion,Ki(o.transaction),a)}),t&&o.addEventListener("blocked",a=>t(a.oldVersion,a.newVersion,a)),l.then(a=>{s&&a.addEventListener("close",()=>s()),i&&a.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Pz=["get","getKey","getAll","getAllKeys","count"],Rz=["put","add","delete","clear"],Eg=new Map;function sk(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Eg.get(e))return Eg.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=Rz.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Pz.includes(t)))return;const s=async function(o,...l){const a=this.transaction(o,i?"readwrite":"readonly");let u=a.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[t](...l),i&&a.done]))[0]};return Eg.set(e,s),s}Tz(n=>({...n,get:(e,t,r)=>sk(e,t)||n.get(e,t,r),has:(e,t)=>!!sk(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dz{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Oz(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Oz(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const V0="@firebase/app",ok="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=new gR("@firebase/app"),Mz="@firebase/app-compat",Nz="@firebase/analytics-compat",Vz="@firebase/analytics",Lz="@firebase/app-check-compat",Bz="@firebase/app-check",Fz="@firebase/auth",zz="@firebase/auth-compat",$z="@firebase/database",Uz="@firebase/data-connect",jz="@firebase/database-compat",Hz="@firebase/functions",Wz="@firebase/functions-compat",qz="@firebase/installations",Kz="@firebase/installations-compat",Qz="@firebase/messaging",Gz="@firebase/messaging-compat",Yz="@firebase/performance",Xz="@firebase/performance-compat",Jz="@firebase/remote-config",Zz="@firebase/remote-config-compat",e$="@firebase/storage",t$="@firebase/storage-compat",n$="@firebase/firestore",r$="@firebase/vertexai-preview",i$="@firebase/firestore-compat",s$="firebase",o$="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L0="[DEFAULT]",l$={[V0]:"fire-core",[Mz]:"fire-core-compat",[Vz]:"fire-analytics",[Nz]:"fire-analytics-compat",[Bz]:"fire-app-check",[Lz]:"fire-app-check-compat",[Fz]:"fire-auth",[zz]:"fire-auth-compat",[$z]:"fire-rtdb",[Uz]:"fire-data-connect",[jz]:"fire-rtdb-compat",[Hz]:"fire-fn",[Wz]:"fire-fn-compat",[qz]:"fire-iid",[Kz]:"fire-iid-compat",[Qz]:"fire-fcm",[Gz]:"fire-fcm-compat",[Yz]:"fire-perf",[Xz]:"fire-perf-compat",[Jz]:"fire-rc",[Zz]:"fire-rc-compat",[e$]:"fire-gcs",[t$]:"fire-gcs-compat",[n$]:"fire-fst",[i$]:"fire-fst-compat",[r$]:"fire-vertex","fire-js":"fire-js",[s$]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=new Map,a$=new Map,B0=new Map;function lk(n,e){try{n.container.addComponent(e)}catch(t){ai.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Bd(n){const e=n.name;if(B0.has(e))return ai.debug(`There were multiple attempts to register component ${e}.`),!1;B0.set(e,n);for(const t of Ld.values())lk(t,n);for(const t of a$.values())lk(t,n);return!0}function u$(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Qi=new mR("app","Firebase",c$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new tc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Qi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f$=o$;function wR(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:L0,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Qi.create("bad-app-name",{appName:String(i)});if(t||(t=fR()),!t)throw Qi.create("no-options");const s=Ld.get(i);if(s){if(O0(t,s.options)&&O0(r,s.config))return s;throw Qi.create("duplicate-app",{appName:i})}const o=new gz(i);for(const a of B0.values())o.addComponent(a);const l=new h$(t,r,o);return Ld.set(i,l),l}function d$(n=L0){const e=Ld.get(n);if(!e&&n===L0&&fR())return wR();if(!e)throw Qi.create("no-app",{appName:n});return e}function fl(n,e,t){var r;let i=(r=l$[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ai.warn(l.join(" "));return}Bd(new tc(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$="firebase-heartbeat-database",m$=1,nc="firebase-heartbeat-store";let Tg=null;function _R(){return Tg||(Tg=Iz(p$,m$,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(nc)}catch(t){console.warn(t)}}}}).catch(n=>{throw Qi.create("idb-open",{originalErrorMessage:n.message})})),Tg}async function g$(n){try{const t=(await _R()).transaction(nc),r=await t.objectStore(nc).get(xR(n));return await t.done,r}catch(e){if(e instanceof Xl)ai.warn(e.message);else{const t=Qi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ai.warn(t.message)}}}async function ak(n,e){try{const r=(await _R()).transaction(nc,"readwrite");await r.objectStore(nc).put(e,xR(n)),await r.done}catch(t){if(t instanceof Xl)ai.warn(t.message);else{const r=Qi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ai.warn(r.message)}}}function xR(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y$=1024,v$=30*24*60*60*1e3;class w${constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new x$(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=uk();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=v$}),this._storage.overwrite(this._heartbeatsCache))}catch(r){ai.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=uk(),{heartbeatsToSend:r,unsentEntries:i}=_$(this._heartbeatsCache.heartbeats),s=Nd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ai.warn(t),""}}}function uk(){return new Date().toISOString().substring(0,10)}function _$(n,e=y$){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),ck(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),ck(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class x${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return pR()?uz().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await g$(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return ak(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return ak(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ck(n){return Nd(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S$(n){Bd(new tc("platform-logger",e=>new Dz(e),"PRIVATE")),Bd(new tc("heartbeat",e=>new w$(e),"PRIVATE")),fl(V0,ok,n),fl(V0,ok,"esm2017"),fl("fire-js","")}S$("");var b$="firebase",k$="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fl(b$,k$,"app");var hk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qs,SR;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,S){function T(){}T.prototype=S.prototype,x.D=S.prototype,x.prototype=new T,x.prototype.constructor=x,x.C=function(C,P,R){for(var A=Array(arguments.length-2),re=2;re<arguments.length;re++)A[re-2]=arguments[re];return S.prototype[P].apply(C,A)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,S,T){T||(T=0);var C=Array(16);if(typeof S=="string")for(var P=0;16>P;++P)C[P]=S.charCodeAt(T++)|S.charCodeAt(T++)<<8|S.charCodeAt(T++)<<16|S.charCodeAt(T++)<<24;else for(P=0;16>P;++P)C[P]=S[T++]|S[T++]<<8|S[T++]<<16|S[T++]<<24;S=x.g[0],T=x.g[1],P=x.g[2];var R=x.g[3],A=S+(R^T&(P^R))+C[0]+3614090360&4294967295;S=T+(A<<7&4294967295|A>>>25),A=R+(P^S&(T^P))+C[1]+3905402710&4294967295,R=S+(A<<12&4294967295|A>>>20),A=P+(T^R&(S^T))+C[2]+606105819&4294967295,P=R+(A<<17&4294967295|A>>>15),A=T+(S^P&(R^S))+C[3]+3250441966&4294967295,T=P+(A<<22&4294967295|A>>>10),A=S+(R^T&(P^R))+C[4]+4118548399&4294967295,S=T+(A<<7&4294967295|A>>>25),A=R+(P^S&(T^P))+C[5]+1200080426&4294967295,R=S+(A<<12&4294967295|A>>>20),A=P+(T^R&(S^T))+C[6]+2821735955&4294967295,P=R+(A<<17&4294967295|A>>>15),A=T+(S^P&(R^S))+C[7]+4249261313&4294967295,T=P+(A<<22&4294967295|A>>>10),A=S+(R^T&(P^R))+C[8]+1770035416&4294967295,S=T+(A<<7&4294967295|A>>>25),A=R+(P^S&(T^P))+C[9]+2336552879&4294967295,R=S+(A<<12&4294967295|A>>>20),A=P+(T^R&(S^T))+C[10]+4294925233&4294967295,P=R+(A<<17&4294967295|A>>>15),A=T+(S^P&(R^S))+C[11]+2304563134&4294967295,T=P+(A<<22&4294967295|A>>>10),A=S+(R^T&(P^R))+C[12]+1804603682&4294967295,S=T+(A<<7&4294967295|A>>>25),A=R+(P^S&(T^P))+C[13]+4254626195&4294967295,R=S+(A<<12&4294967295|A>>>20),A=P+(T^R&(S^T))+C[14]+2792965006&4294967295,P=R+(A<<17&4294967295|A>>>15),A=T+(S^P&(R^S))+C[15]+1236535329&4294967295,T=P+(A<<22&4294967295|A>>>10),A=S+(P^R&(T^P))+C[1]+4129170786&4294967295,S=T+(A<<5&4294967295|A>>>27),A=R+(T^P&(S^T))+C[6]+3225465664&4294967295,R=S+(A<<9&4294967295|A>>>23),A=P+(S^T&(R^S))+C[11]+643717713&4294967295,P=R+(A<<14&4294967295|A>>>18),A=T+(R^S&(P^R))+C[0]+3921069994&4294967295,T=P+(A<<20&4294967295|A>>>12),A=S+(P^R&(T^P))+C[5]+3593408605&4294967295,S=T+(A<<5&4294967295|A>>>27),A=R+(T^P&(S^T))+C[10]+38016083&4294967295,R=S+(A<<9&4294967295|A>>>23),A=P+(S^T&(R^S))+C[15]+3634488961&4294967295,P=R+(A<<14&4294967295|A>>>18),A=T+(R^S&(P^R))+C[4]+3889429448&4294967295,T=P+(A<<20&4294967295|A>>>12),A=S+(P^R&(T^P))+C[9]+568446438&4294967295,S=T+(A<<5&4294967295|A>>>27),A=R+(T^P&(S^T))+C[14]+3275163606&4294967295,R=S+(A<<9&4294967295|A>>>23),A=P+(S^T&(R^S))+C[3]+4107603335&4294967295,P=R+(A<<14&4294967295|A>>>18),A=T+(R^S&(P^R))+C[8]+1163531501&4294967295,T=P+(A<<20&4294967295|A>>>12),A=S+(P^R&(T^P))+C[13]+2850285829&4294967295,S=T+(A<<5&4294967295|A>>>27),A=R+(T^P&(S^T))+C[2]+4243563512&4294967295,R=S+(A<<9&4294967295|A>>>23),A=P+(S^T&(R^S))+C[7]+1735328473&4294967295,P=R+(A<<14&4294967295|A>>>18),A=T+(R^S&(P^R))+C[12]+2368359562&4294967295,T=P+(A<<20&4294967295|A>>>12),A=S+(T^P^R)+C[5]+4294588738&4294967295,S=T+(A<<4&4294967295|A>>>28),A=R+(S^T^P)+C[8]+2272392833&4294967295,R=S+(A<<11&4294967295|A>>>21),A=P+(R^S^T)+C[11]+1839030562&4294967295,P=R+(A<<16&4294967295|A>>>16),A=T+(P^R^S)+C[14]+4259657740&4294967295,T=P+(A<<23&4294967295|A>>>9),A=S+(T^P^R)+C[1]+2763975236&4294967295,S=T+(A<<4&4294967295|A>>>28),A=R+(S^T^P)+C[4]+1272893353&4294967295,R=S+(A<<11&4294967295|A>>>21),A=P+(R^S^T)+C[7]+4139469664&4294967295,P=R+(A<<16&4294967295|A>>>16),A=T+(P^R^S)+C[10]+3200236656&4294967295,T=P+(A<<23&4294967295|A>>>9),A=S+(T^P^R)+C[13]+681279174&4294967295,S=T+(A<<4&4294967295|A>>>28),A=R+(S^T^P)+C[0]+3936430074&4294967295,R=S+(A<<11&4294967295|A>>>21),A=P+(R^S^T)+C[3]+3572445317&4294967295,P=R+(A<<16&4294967295|A>>>16),A=T+(P^R^S)+C[6]+76029189&4294967295,T=P+(A<<23&4294967295|A>>>9),A=S+(T^P^R)+C[9]+3654602809&4294967295,S=T+(A<<4&4294967295|A>>>28),A=R+(S^T^P)+C[12]+3873151461&4294967295,R=S+(A<<11&4294967295|A>>>21),A=P+(R^S^T)+C[15]+530742520&4294967295,P=R+(A<<16&4294967295|A>>>16),A=T+(P^R^S)+C[2]+3299628645&4294967295,T=P+(A<<23&4294967295|A>>>9),A=S+(P^(T|~R))+C[0]+4096336452&4294967295,S=T+(A<<6&4294967295|A>>>26),A=R+(T^(S|~P))+C[7]+1126891415&4294967295,R=S+(A<<10&4294967295|A>>>22),A=P+(S^(R|~T))+C[14]+2878612391&4294967295,P=R+(A<<15&4294967295|A>>>17),A=T+(R^(P|~S))+C[5]+4237533241&4294967295,T=P+(A<<21&4294967295|A>>>11),A=S+(P^(T|~R))+C[12]+1700485571&4294967295,S=T+(A<<6&4294967295|A>>>26),A=R+(T^(S|~P))+C[3]+2399980690&4294967295,R=S+(A<<10&4294967295|A>>>22),A=P+(S^(R|~T))+C[10]+4293915773&4294967295,P=R+(A<<15&4294967295|A>>>17),A=T+(R^(P|~S))+C[1]+2240044497&4294967295,T=P+(A<<21&4294967295|A>>>11),A=S+(P^(T|~R))+C[8]+1873313359&4294967295,S=T+(A<<6&4294967295|A>>>26),A=R+(T^(S|~P))+C[15]+4264355552&4294967295,R=S+(A<<10&4294967295|A>>>22),A=P+(S^(R|~T))+C[6]+2734768916&4294967295,P=R+(A<<15&4294967295|A>>>17),A=T+(R^(P|~S))+C[13]+1309151649&4294967295,T=P+(A<<21&4294967295|A>>>11),A=S+(P^(T|~R))+C[4]+4149444226&4294967295,S=T+(A<<6&4294967295|A>>>26),A=R+(T^(S|~P))+C[11]+3174756917&4294967295,R=S+(A<<10&4294967295|A>>>22),A=P+(S^(R|~T))+C[2]+718787259&4294967295,P=R+(A<<15&4294967295|A>>>17),A=T+(R^(P|~S))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+S&4294967295,x.g[1]=x.g[1]+(P+(A<<21&4294967295|A>>>11))&4294967295,x.g[2]=x.g[2]+P&4294967295,x.g[3]=x.g[3]+R&4294967295}r.prototype.u=function(x,S){S===void 0&&(S=x.length);for(var T=S-this.blockSize,C=this.B,P=this.h,R=0;R<S;){if(P==0)for(;R<=T;)i(this,x,R),R+=this.blockSize;if(typeof x=="string"){for(;R<S;)if(C[P++]=x.charCodeAt(R++),P==this.blockSize){i(this,C),P=0;break}}else for(;R<S;)if(C[P++]=x[R++],P==this.blockSize){i(this,C),P=0;break}}this.h=P,this.o+=S},r.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var S=1;S<x.length-8;++S)x[S]=0;var T=8*this.o;for(S=x.length-8;S<x.length;++S)x[S]=T&255,T/=256;for(this.u(x),x=Array(16),S=T=0;4>S;++S)for(var C=0;32>C;C+=8)x[T++]=this.g[S]>>>C&255;return x};function s(x,S){var T=l;return Object.prototype.hasOwnProperty.call(T,x)?T[x]:T[x]=S(x)}function o(x,S){this.h=S;for(var T=[],C=!0,P=x.length-1;0<=P;P--){var R=x[P]|0;C&&R==S||(T[P]=R,C=!1)}this.g=T}var l={};function a(x){return-128<=x&&128>x?s(x,function(S){return new o([S|0],0>S?-1:0)}):new o([x|0],0>x?-1:0)}function u(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return E(u(-x));for(var S=[],T=1,C=0;x>=T;C++)S[C]=x/T|0,T*=4294967296;return new o(S,0)}function c(x,S){if(x.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(x.charAt(0)=="-")return E(c(x.substring(1),S));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=u(Math.pow(S,8)),C=f,P=0;P<x.length;P+=8){var R=Math.min(8,x.length-P),A=parseInt(x.substring(P,P+R),S);8>R?(R=u(Math.pow(S,R)),C=C.j(R).add(u(A))):(C=C.j(T),C=C.add(u(A)))}return C}var f=a(0),d=a(1),p=a(16777216);n=o.prototype,n.m=function(){if(v(this))return-E(this).m();for(var x=0,S=1,T=0;T<this.g.length;T++){var C=this.i(T);x+=(0<=C?C:4294967296+C)*S,S*=4294967296}return x},n.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(y(this))return"0";if(v(this))return"-"+E(this).toString(x);for(var S=u(Math.pow(x,6)),T=this,C="";;){var P=I(T,S).g;T=w(T,P.j(S));var R=((0<T.g.length?T.g[0]:T.h)>>>0).toString(x);if(T=P,y(T))return R+C;for(;6>R.length;)R="0"+R;C=R+C}},n.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function y(x){if(x.h!=0)return!1;for(var S=0;S<x.g.length;S++)if(x.g[S]!=0)return!1;return!0}function v(x){return x.h==-1}n.l=function(x){return x=w(this,x),v(x)?-1:y(x)?0:1};function E(x){for(var S=x.g.length,T=[],C=0;C<S;C++)T[C]=~x.g[C];return new o(T,~x.h).add(d)}n.abs=function(){return v(this)?E(this):this},n.add=function(x){for(var S=Math.max(this.g.length,x.g.length),T=[],C=0,P=0;P<=S;P++){var R=C+(this.i(P)&65535)+(x.i(P)&65535),A=(R>>>16)+(this.i(P)>>>16)+(x.i(P)>>>16);C=A>>>16,R&=65535,A&=65535,T[P]=A<<16|R}return new o(T,T[T.length-1]&-2147483648?-1:0)};function w(x,S){return x.add(E(S))}n.j=function(x){if(y(this)||y(x))return f;if(v(this))return v(x)?E(this).j(E(x)):E(E(this).j(x));if(v(x))return E(this.j(E(x)));if(0>this.l(p)&&0>x.l(p))return u(this.m()*x.m());for(var S=this.g.length+x.g.length,T=[],C=0;C<2*S;C++)T[C]=0;for(C=0;C<this.g.length;C++)for(var P=0;P<x.g.length;P++){var R=this.i(C)>>>16,A=this.i(C)&65535,re=x.i(P)>>>16,ce=x.i(P)&65535;T[2*C+2*P]+=A*ce,_(T,2*C+2*P),T[2*C+2*P+1]+=R*ce,_(T,2*C+2*P+1),T[2*C+2*P+1]+=A*re,_(T,2*C+2*P+1),T[2*C+2*P+2]+=R*re,_(T,2*C+2*P+2)}for(C=0;C<S;C++)T[C]=T[2*C+1]<<16|T[2*C];for(C=S;C<2*S;C++)T[C]=0;return new o(T,0)};function _(x,S){for(;(x[S]&65535)!=x[S];)x[S+1]+=x[S]>>>16,x[S]&=65535,S++}function b(x,S){this.g=x,this.h=S}function I(x,S){if(y(S))throw Error("division by zero");if(y(x))return new b(f,f);if(v(x))return S=I(E(x),S),new b(E(S.g),E(S.h));if(v(S))return S=I(x,E(S)),new b(E(S.g),S.h);if(30<x.g.length){if(v(x)||v(S))throw Error("slowDivide_ only works with positive integers.");for(var T=d,C=S;0>=C.l(x);)T=D(T),C=D(C);var P=M(T,1),R=M(C,1);for(C=M(C,2),T=M(T,2);!y(C);){var A=R.add(C);0>=A.l(x)&&(P=P.add(T),R=A),C=M(C,1),T=M(T,1)}return S=w(x,P.j(S)),new b(P,S)}for(P=f;0<=x.l(S);){for(T=Math.max(1,Math.floor(x.m()/S.m())),C=Math.ceil(Math.log(T)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),R=u(T),A=R.j(S);v(A)||0<A.l(x);)T-=C,R=u(T),A=R.j(S);y(R)&&(R=d),P=P.add(R),x=w(x,A)}return new b(P,x)}n.A=function(x){return I(this,x).h},n.and=function(x){for(var S=Math.max(this.g.length,x.g.length),T=[],C=0;C<S;C++)T[C]=this.i(C)&x.i(C);return new o(T,this.h&x.h)},n.or=function(x){for(var S=Math.max(this.g.length,x.g.length),T=[],C=0;C<S;C++)T[C]=this.i(C)|x.i(C);return new o(T,this.h|x.h)},n.xor=function(x){for(var S=Math.max(this.g.length,x.g.length),T=[],C=0;C<S;C++)T[C]=this.i(C)^x.i(C);return new o(T,this.h^x.h)};function D(x){for(var S=x.g.length+1,T=[],C=0;C<S;C++)T[C]=x.i(C)<<1|x.i(C-1)>>>31;return new o(T,x.h)}function M(x,S){var T=S>>5;S%=32;for(var C=x.g.length-T,P=[],R=0;R<C;R++)P[R]=0<S?x.i(R+T)>>>S|x.i(R+T+1)<<32-S:x.i(R+T);return new o(P,x.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,SR=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=c,qs=o}).apply(typeof hk<"u"?hk:typeof self<"u"?self:typeof window<"u"?window:{});var Bh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var bR,qa,kR,bf,F0,ER,TR,CR;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,m,g){return h==Array.prototype||h==Object.prototype||(h[m]=g.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Bh=="object"&&Bh];for(var m=0;m<h.length;++m){var g=h[m];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=t(this);function i(h,m){if(m)e:{var g=r;h=h.split(".");for(var k=0;k<h.length-1;k++){var N=h[k];if(!(N in g))break e;g=g[N]}h=h[h.length-1],k=g[h],m=m(k),m!=k&&m!=null&&e(g,h,{configurable:!0,writable:!0,value:m})}}function s(h,m){h instanceof String&&(h+="");var g=0,k=!1,N={next:function(){if(!k&&g<h.length){var L=g++;return{value:m(L,h[L]),done:!1}}return k=!0,{done:!0,value:void 0}}};return N[Symbol.iterator]=function(){return N},N}i("Array.prototype.values",function(h){return h||function(){return s(this,function(m,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function a(h){var m=typeof h;return m=m!="object"?m:h?Array.isArray(h)?"array":m:"null",m=="array"||m=="object"&&typeof h.length=="number"}function u(h){var m=typeof h;return m=="object"&&h!=null||m=="function"}function c(h,m,g){return h.call.apply(h.bind,arguments)}function f(h,m,g){if(!h)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var N=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(N,k),h.apply(m,N)}}return function(){return h.apply(m,arguments)}}function d(h,m,g){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?c:f,d.apply(null,arguments)}function p(h,m){var g=Array.prototype.slice.call(arguments,1);return function(){var k=g.slice();return k.push.apply(k,arguments),h.apply(this,k)}}function y(h,m){function g(){}g.prototype=m.prototype,h.aa=m.prototype,h.prototype=new g,h.prototype.constructor=h,h.Qb=function(k,N,L){for(var j=Array(arguments.length-2),De=2;De<arguments.length;De++)j[De-2]=arguments[De];return m.prototype[N].apply(k,j)}}function v(h){const m=h.length;if(0<m){const g=Array(m);for(let k=0;k<m;k++)g[k]=h[k];return g}return[]}function E(h,m){for(let g=1;g<arguments.length;g++){const k=arguments[g];if(a(k)){const N=h.length||0,L=k.length||0;h.length=N+L;for(let j=0;j<L;j++)h[N+j]=k[j]}else h.push(k)}}class w{constructor(m,g){this.i=m,this.j=g,this.h=0,this.g=null}get(){let m;return 0<this.h?(this.h--,m=this.g,this.g=m.next,m.next=null):m=this.i(),m}}function _(h){return/^[\s\xa0]*$/.test(h)}function b(){var h=l.navigator;return h&&(h=h.userAgent)?h:""}function I(h){return I[" "](h),h}I[" "]=function(){};var D=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function M(h,m,g){for(const k in h)m.call(g,h[k],k,h)}function x(h,m){for(const g in h)m.call(void 0,h[g],g,h)}function S(h){const m={};for(const g in h)m[g]=h[g];return m}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(h,m){let g,k;for(let N=1;N<arguments.length;N++){k=arguments[N];for(g in k)h[g]=k[g];for(let L=0;L<T.length;L++)g=T[L],Object.prototype.hasOwnProperty.call(k,g)&&(h[g]=k[g])}}function P(h){var m=1;h=h.split(":");const g=[];for(;0<m&&h.length;)g.push(h.shift()),m--;return h.length&&g.push(h.join(":")),g}function R(h){l.setTimeout(()=>{throw h},0)}function A(){var h=H;let m=null;return h.g&&(m=h.g,h.g=h.g.next,h.g||(h.h=null),m.next=null),m}class re{constructor(){this.h=this.g=null}add(m,g){const k=ce.get();k.set(m,g),this.h?this.h.next=k:this.g=k,this.h=k}}var ce=new w(()=>new Te,h=>h.reset());class Te{constructor(){this.next=this.g=this.h=null}set(m,g){this.h=m,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let ae,U=!1,H=new re,J=()=>{const h=l.Promise.resolve(void 0);ae=()=>{h.then(fe)}};var fe=()=>{for(var h;h=A();){try{h.h.call(h.g)}catch(g){R(g)}var m=ce;m.j(h),100>m.h&&(m.h++,h.next=m.g,m.g=h)}U=!1};function ie(){this.s=this.s,this.C=this.C}ie.prototype.s=!1,ie.prototype.ma=function(){this.s||(this.s=!0,this.N())},ie.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ge(h,m){this.type=h,this.g=this.target=m,this.defaultPrevented=!1}ge.prototype.h=function(){this.defaultPrevented=!0};var tt=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var h=!1,m=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const g=()=>{};l.addEventListener("test",g,m),l.removeEventListener("test",g,m)}catch{}return h}();function nt(h,m){if(ge.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var g=this.type=h.type,k=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=m,m=h.relatedTarget){if(D){e:{try{I(m.nodeName);var N=!0;break e}catch{}N=!1}N||(m=null)}}else g=="mouseover"?m=h.fromElement:g=="mouseout"&&(m=h.toElement);this.relatedTarget=m,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ot[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&nt.aa.h.call(this)}}y(nt,ge);var ot={2:"touch",3:"pen",4:"mouse"};nt.prototype.h=function(){nt.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Et="closure_listenable_"+(1e6*Math.random()|0),ms=0;function Fr(h,m,g,k,N){this.listener=h,this.proxy=null,this.src=m,this.type=g,this.capture=!!k,this.ha=N,this.key=++ms,this.da=this.fa=!1}function di(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function zr(h){this.src=h,this.g={},this.h=0}zr.prototype.add=function(h,m,g,k,N){var L=h.toString();h=this.g[L],h||(h=this.g[L]=[],this.h++);var j=Yp(h,m,k,N);return-1<j?(m=h[j],g||(m.fa=!1)):(m=new Fr(m,this.src,L,!!k,N),m.fa=g,h.push(m)),m};function Ln(h,m){var g=m.type;if(g in h.g){var k=h.g[g],N=Array.prototype.indexOf.call(k,m,void 0),L;(L=0<=N)&&Array.prototype.splice.call(k,N,1),L&&(di(m),h.g[g].length==0&&(delete h.g[g],h.h--))}}function Yp(h,m,g,k){for(var N=0;N<h.length;++N){var L=h[N];if(!L.da&&L.listener==m&&L.capture==!!g&&L.ha==k)return N}return-1}var Xp="closure_lm_"+(1e6*Math.random()|0),Jp={};function Tw(h,m,g,k,N){if(Array.isArray(m)){for(var L=0;L<m.length;L++)Tw(h,m[L],g,k,N);return null}return g=Iw(g),h&&h[Et]?h.K(m,g,u(k)?!!k.capture:!1,N):SD(h,m,g,!1,k,N)}function SD(h,m,g,k,N,L){if(!m)throw Error("Invalid event type");var j=u(N)?!!N.capture:!!N,De=em(h);if(De||(h[Xp]=De=new zr(h)),g=De.add(m,g,k,j,L),g.proxy)return g;if(k=bD(),g.proxy=k,k.src=h,k.listener=g,h.addEventListener)tt||(N=j),N===void 0&&(N=!1),h.addEventListener(m.toString(),k,N);else if(h.attachEvent)h.attachEvent(Aw(m.toString()),k);else if(h.addListener&&h.removeListener)h.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return g}function bD(){function h(g){return m.call(h.src,h.listener,g)}const m=kD;return h}function Cw(h,m,g,k,N){if(Array.isArray(m))for(var L=0;L<m.length;L++)Cw(h,m[L],g,k,N);else k=u(k)?!!k.capture:!!k,g=Iw(g),h&&h[Et]?(h=h.i,m=String(m).toString(),m in h.g&&(L=h.g[m],g=Yp(L,g,k,N),-1<g&&(di(L[g]),Array.prototype.splice.call(L,g,1),L.length==0&&(delete h.g[m],h.h--)))):h&&(h=em(h))&&(m=h.g[m.toString()],h=-1,m&&(h=Yp(m,g,k,N)),(g=-1<h?m[h]:null)&&Zp(g))}function Zp(h){if(typeof h!="number"&&h&&!h.da){var m=h.src;if(m&&m[Et])Ln(m.i,h);else{var g=h.type,k=h.proxy;m.removeEventListener?m.removeEventListener(g,k,h.capture):m.detachEvent?m.detachEvent(Aw(g),k):m.addListener&&m.removeListener&&m.removeListener(k),(g=em(m))?(Ln(g,h),g.h==0&&(g.src=null,m[Xp]=null)):di(h)}}}function Aw(h){return h in Jp?Jp[h]:Jp[h]="on"+h}function kD(h,m){if(h.da)h=!0;else{m=new nt(m,this);var g=h.listener,k=h.ha||h.src;h.fa&&Zp(h),h=g.call(k,m)}return h}function em(h){return h=h[Xp],h instanceof zr?h:null}var tm="__closure_events_fn_"+(1e9*Math.random()>>>0);function Iw(h){return typeof h=="function"?h:(h[tm]||(h[tm]=function(m){return h.handleEvent(m)}),h[tm])}function Lt(){ie.call(this),this.i=new zr(this),this.M=this,this.F=null}y(Lt,ie),Lt.prototype[Et]=!0,Lt.prototype.removeEventListener=function(h,m,g,k){Cw(this,h,m,g,k)};function Gt(h,m){var g,k=h.F;if(k)for(g=[];k;k=k.F)g.push(k);if(h=h.M,k=m.type||m,typeof m=="string")m=new ge(m,h);else if(m instanceof ge)m.target=m.target||h;else{var N=m;m=new ge(k,h),C(m,N)}if(N=!0,g)for(var L=g.length-1;0<=L;L--){var j=m.g=g[L];N=Oc(j,k,!0,m)&&N}if(j=m.g=h,N=Oc(j,k,!0,m)&&N,N=Oc(j,k,!1,m)&&N,g)for(L=0;L<g.length;L++)j=m.g=g[L],N=Oc(j,k,!1,m)&&N}Lt.prototype.N=function(){if(Lt.aa.N.call(this),this.i){var h=this.i,m;for(m in h.g){for(var g=h.g[m],k=0;k<g.length;k++)di(g[k]);delete h.g[m],h.h--}}this.F=null},Lt.prototype.K=function(h,m,g,k){return this.i.add(String(h),m,!1,g,k)},Lt.prototype.L=function(h,m,g,k){return this.i.add(String(h),m,!0,g,k)};function Oc(h,m,g,k){if(m=h.i.g[String(m)],!m)return!0;m=m.concat();for(var N=!0,L=0;L<m.length;++L){var j=m[L];if(j&&!j.da&&j.capture==g){var De=j.listener,Tt=j.ha||j.src;j.fa&&Ln(h.i,j),N=De.call(Tt,k)!==!1&&N}}return N&&!k.defaultPrevented}function Pw(h,m,g){if(typeof h=="function")g&&(h=d(h,g));else if(h&&typeof h.handleEvent=="function")h=d(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(m)?-1:l.setTimeout(h,m||0)}function Rw(h){h.g=Pw(()=>{h.g=null,h.i&&(h.i=!1,Rw(h))},h.l);const m=h.h;h.h=null,h.m.apply(null,m)}class ED extends ie{constructor(m,g){super(),this.m=m,this.l=g,this.h=null,this.i=!1,this.g=null}j(m){this.h=arguments,this.g?this.i=!0:Rw(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function na(h){ie.call(this),this.h=h,this.g={}}y(na,ie);var Dw=[];function Ow(h){M(h.g,function(m,g){this.g.hasOwnProperty(g)&&Zp(m)},h),h.g={}}na.prototype.N=function(){na.aa.N.call(this),Ow(this)},na.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nm=l.JSON.stringify,TD=l.JSON.parse,CD=class{stringify(h){return l.JSON.stringify(h,void 0)}parse(h){return l.JSON.parse(h,void 0)}};function rm(){}rm.prototype.h=null;function Mw(h){return h.h||(h.h=h.i())}function Nw(){}var ra={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function im(){ge.call(this,"d")}y(im,ge);function sm(){ge.call(this,"c")}y(sm,ge);var gs={},Vw=null;function Mc(){return Vw=Vw||new Lt}gs.La="serverreachability";function Lw(h){ge.call(this,gs.La,h)}y(Lw,ge);function ia(h){const m=Mc();Gt(m,new Lw(m))}gs.STAT_EVENT="statevent";function Bw(h,m){ge.call(this,gs.STAT_EVENT,h),this.stat=m}y(Bw,ge);function Yt(h){const m=Mc();Gt(m,new Bw(m,h))}gs.Ma="timingevent";function Fw(h,m){ge.call(this,gs.Ma,h),this.size=m}y(Fw,ge);function sa(h,m){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){h()},m)}function oa(){this.g=!0}oa.prototype.xa=function(){this.g=!1};function AD(h,m,g,k,N,L){h.info(function(){if(h.g)if(L)for(var j="",De=L.split("&"),Tt=0;Tt<De.length;Tt++){var ke=De[Tt].split("=");if(1<ke.length){var Bt=ke[0];ke=ke[1];var Ft=Bt.split("_");j=2<=Ft.length&&Ft[1]=="type"?j+(Bt+"="+ke+"&"):j+(Bt+"=redacted&")}}else j=null;else j=L;return"XMLHTTP REQ ("+k+") [attempt "+N+"]: "+m+`
`+g+`
`+j})}function ID(h,m,g,k,N,L,j){h.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+N+"]: "+m+`
`+g+`
`+L+" "+j})}function wo(h,m,g,k){h.info(function(){return"XMLHTTP TEXT ("+m+"): "+RD(h,g)+(k?" "+k:"")})}function PD(h,m){h.info(function(){return"TIMEOUT: "+m})}oa.prototype.info=function(){};function RD(h,m){if(!h.g)return m;if(!m)return null;try{var g=JSON.parse(m);if(g){for(h=0;h<g.length;h++)if(Array.isArray(g[h])){var k=g[h];if(!(2>k.length)){var N=k[1];if(Array.isArray(N)&&!(1>N.length)){var L=N[0];if(L!="noop"&&L!="stop"&&L!="close")for(var j=1;j<N.length;j++)N[j]=""}}}}return nm(g)}catch{return m}}var Nc={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},zw={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},om;function Vc(){}y(Vc,rm),Vc.prototype.g=function(){return new XMLHttpRequest},Vc.prototype.i=function(){return{}},om=new Vc;function pi(h,m,g,k){this.j=h,this.i=m,this.l=g,this.R=k||1,this.U=new na(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $w}function $w(){this.i=null,this.g="",this.h=!1}var Uw={},lm={};function am(h,m,g){h.L=1,h.v=zc($r(m)),h.m=g,h.P=!0,jw(h,null)}function jw(h,m){h.F=Date.now(),Lc(h),h.A=$r(h.v);var g=h.A,k=h.R;Array.isArray(k)||(k=[String(k)]),r_(g.i,"t",k),h.C=0,g=h.j.J,h.h=new $w,h.g=x_(h.j,g?m:null,!h.m),0<h.O&&(h.M=new ED(d(h.Y,h,h.g),h.O)),m=h.U,g=h.g,k=h.ca;var N="readystatechange";Array.isArray(N)||(N&&(Dw[0]=N.toString()),N=Dw);for(var L=0;L<N.length;L++){var j=Tw(g,N[L],k||m.handleEvent,!1,m.h||m);if(!j)break;m.g[j.key]=j}m=h.H?S(h.H):{},h.m?(h.u||(h.u="POST"),m["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,m)):(h.u="GET",h.g.ea(h.A,h.u,null,m)),ia(),AD(h.i,h.u,h.A,h.l,h.R,h.m)}pi.prototype.ca=function(h){h=h.target;const m=this.M;m&&Ur(h)==3?m.j():this.Y(h)},pi.prototype.Y=function(h){try{if(h==this.g)e:{const Ft=Ur(this.g);var m=this.g.Ba();const So=this.g.Z();if(!(3>Ft)&&(Ft!=3||this.g&&(this.h.h||this.g.oa()||c_(this.g)))){this.J||Ft!=4||m==7||(m==8||0>=So?ia(3):ia(2)),um(this);var g=this.g.Z();this.X=g;t:if(Hw(this)){var k=c_(this.g);h="";var N=k.length,L=Ur(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ys(this),la(this);var j="";break t}this.h.i=new l.TextDecoder}for(m=0;m<N;m++)this.h.h=!0,h+=this.h.i.decode(k[m],{stream:!(L&&m==N-1)});k.length=0,this.h.g+=h,this.C=0,j=this.h.g}else j=this.g.oa();if(this.o=g==200,ID(this.i,this.u,this.A,this.l,this.R,Ft,g),this.o){if(this.T&&!this.K){t:{if(this.g){var De,Tt=this.g;if((De=Tt.g?Tt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(De)){var ke=De;break t}}ke=null}if(g=ke)wo(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,cm(this,g);else{this.o=!1,this.s=3,Yt(12),ys(this),la(this);break e}}if(this.P){g=!0;let tr;for(;!this.J&&this.C<j.length;)if(tr=DD(this,j),tr==lm){Ft==4&&(this.s=4,Yt(14),g=!1),wo(this.i,this.l,null,"[Incomplete Response]");break}else if(tr==Uw){this.s=4,Yt(15),wo(this.i,this.l,j,"[Invalid Chunk]"),g=!1;break}else wo(this.i,this.l,tr,null),cm(this,tr);if(Hw(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ft!=4||j.length!=0||this.h.h||(this.s=1,Yt(16),g=!1),this.o=this.o&&g,!g)wo(this.i,this.l,j,"[Invalid Chunked Response]"),ys(this),la(this);else if(0<j.length&&!this.W){this.W=!0;var Bt=this.j;Bt.g==this&&Bt.ba&&!Bt.M&&(Bt.j.info("Great, no buffering proxy detected. Bytes received: "+j.length),gm(Bt),Bt.M=!0,Yt(11))}}else wo(this.i,this.l,j,null),cm(this,j);Ft==4&&ys(this),this.o&&!this.J&&(Ft==4?y_(this.j,this):(this.o=!1,Lc(this)))}else GD(this.g),g==400&&0<j.indexOf("Unknown SID")?(this.s=3,Yt(12)):(this.s=0,Yt(13)),ys(this),la(this)}}}catch{}finally{}};function Hw(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function DD(h,m){var g=h.C,k=m.indexOf(`
`,g);return k==-1?lm:(g=Number(m.substring(g,k)),isNaN(g)?Uw:(k+=1,k+g>m.length?lm:(m=m.slice(k,k+g),h.C=k+g,m)))}pi.prototype.cancel=function(){this.J=!0,ys(this)};function Lc(h){h.S=Date.now()+h.I,Ww(h,h.I)}function Ww(h,m){if(h.B!=null)throw Error("WatchDog timer not null");h.B=sa(d(h.ba,h),m)}function um(h){h.B&&(l.clearTimeout(h.B),h.B=null)}pi.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(PD(this.i,this.A),this.L!=2&&(ia(),Yt(17)),ys(this),this.s=2,la(this)):Ww(this,this.S-h)};function la(h){h.j.G==0||h.J||y_(h.j,h)}function ys(h){um(h);var m=h.M;m&&typeof m.ma=="function"&&m.ma(),h.M=null,Ow(h.U),h.g&&(m=h.g,h.g=null,m.abort(),m.ma())}function cm(h,m){try{var g=h.j;if(g.G!=0&&(g.g==h||hm(g.h,h))){if(!h.K&&hm(g.h,h)&&g.G==3){try{var k=g.Da.g.parse(m)}catch{k=null}if(Array.isArray(k)&&k.length==3){var N=k;if(N[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<h.F)qc(g),Hc(g);else break e;mm(g),Yt(18)}}else g.za=N[1],0<g.za-g.T&&37500>N[2]&&g.F&&g.v==0&&!g.C&&(g.C=sa(d(g.Za,g),6e3));if(1>=Qw(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else ws(g,11)}else if((h.K||g.g==h)&&qc(g),!_(m))for(N=g.Da.g.parse(m),m=0;m<N.length;m++){let ke=N[m];if(g.T=ke[0],ke=ke[1],g.G==2)if(ke[0]=="c"){g.K=ke[1],g.ia=ke[2];const Bt=ke[3];Bt!=null&&(g.la=Bt,g.j.info("VER="+g.la));const Ft=ke[4];Ft!=null&&(g.Aa=Ft,g.j.info("SVER="+g.Aa));const So=ke[5];So!=null&&typeof So=="number"&&0<So&&(k=1.5*So,g.L=k,g.j.info("backChannelRequestTimeoutMs_="+k)),k=g;const tr=h.g;if(tr){const Qc=tr.g?tr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qc){var L=k.h;L.g||Qc.indexOf("spdy")==-1&&Qc.indexOf("quic")==-1&&Qc.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(fm(L,L.h),L.h=null))}if(k.D){const ym=tr.g?tr.g.getResponseHeader("X-HTTP-Session-Id"):null;ym&&(k.ya=ym,Le(k.I,k.D,ym))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-h.F,g.j.info("Handshake RTT: "+g.R+"ms")),k=g;var j=h;if(k.qa=__(k,k.J?k.ia:null,k.W),j.K){Gw(k.h,j);var De=j,Tt=k.L;Tt&&(De.I=Tt),De.B&&(um(De),Lc(De)),k.g=j}else m_(k);0<g.i.length&&Wc(g)}else ke[0]!="stop"&&ke[0]!="close"||ws(g,7);else g.G==3&&(ke[0]=="stop"||ke[0]=="close"?ke[0]=="stop"?ws(g,7):pm(g):ke[0]!="noop"&&g.l&&g.l.ta(ke),g.v=0)}}ia(4)}catch{}}var OD=class{constructor(h,m){this.g=h,this.map=m}};function qw(h){this.l=h||10,l.PerformanceNavigationTiming?(h=l.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kw(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Qw(h){return h.h?1:h.g?h.g.size:0}function hm(h,m){return h.h?h.h==m:h.g?h.g.has(m):!1}function fm(h,m){h.g?h.g.add(m):h.h=m}function Gw(h,m){h.h&&h.h==m?h.h=null:h.g&&h.g.has(m)&&h.g.delete(m)}qw.prototype.cancel=function(){if(this.i=Yw(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Yw(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let m=h.i;for(const g of h.g.values())m=m.concat(g.D);return m}return v(h.i)}function MD(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(a(h)){for(var m=[],g=h.length,k=0;k<g;k++)m.push(h[k]);return m}m=[],g=0;for(k in h)m[g++]=h[k];return m}function ND(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(a(h)||typeof h=="string"){var m=[];h=h.length;for(var g=0;g<h;g++)m.push(g);return m}m=[],g=0;for(const k in h)m[g++]=k;return m}}}function Xw(h,m){if(h.forEach&&typeof h.forEach=="function")h.forEach(m,void 0);else if(a(h)||typeof h=="string")Array.prototype.forEach.call(h,m,void 0);else for(var g=ND(h),k=MD(h),N=k.length,L=0;L<N;L++)m.call(void 0,k[L],g&&g[L],h)}var Jw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function VD(h,m){if(h){h=h.split("&");for(var g=0;g<h.length;g++){var k=h[g].indexOf("="),N=null;if(0<=k){var L=h[g].substring(0,k);N=h[g].substring(k+1)}else L=h[g];m(L,N?decodeURIComponent(N.replace(/\+/g," ")):"")}}}function vs(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof vs){this.h=h.h,Bc(this,h.j),this.o=h.o,this.g=h.g,Fc(this,h.s),this.l=h.l;var m=h.i,g=new ca;g.i=m.i,m.g&&(g.g=new Map(m.g),g.h=m.h),Zw(this,g),this.m=h.m}else h&&(m=String(h).match(Jw))?(this.h=!1,Bc(this,m[1]||"",!0),this.o=aa(m[2]||""),this.g=aa(m[3]||"",!0),Fc(this,m[4]),this.l=aa(m[5]||"",!0),Zw(this,m[6]||"",!0),this.m=aa(m[7]||"")):(this.h=!1,this.i=new ca(null,this.h))}vs.prototype.toString=function(){var h=[],m=this.j;m&&h.push(ua(m,e_,!0),":");var g=this.g;return(g||m=="file")&&(h.push("//"),(m=this.o)&&h.push(ua(m,e_,!0),"@"),h.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&h.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&h.push("/"),h.push(ua(g,g.charAt(0)=="/"?FD:BD,!0))),(g=this.i.toString())&&h.push("?",g),(g=this.m)&&h.push("#",ua(g,$D)),h.join("")};function $r(h){return new vs(h)}function Bc(h,m,g){h.j=g?aa(m,!0):m,h.j&&(h.j=h.j.replace(/:$/,""))}function Fc(h,m){if(m){if(m=Number(m),isNaN(m)||0>m)throw Error("Bad port number "+m);h.s=m}else h.s=null}function Zw(h,m,g){m instanceof ca?(h.i=m,UD(h.i,h.h)):(g||(m=ua(m,zD)),h.i=new ca(m,h.h))}function Le(h,m,g){h.i.set(m,g)}function zc(h){return Le(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function aa(h,m){return h?m?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function ua(h,m,g){return typeof h=="string"?(h=encodeURI(h).replace(m,LD),g&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function LD(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var e_=/[#\/\?@]/g,BD=/[#\?:]/g,FD=/[#\?]/g,zD=/[#\?@]/g,$D=/#/g;function ca(h,m){this.h=this.g=null,this.i=h||null,this.j=!!m}function mi(h){h.g||(h.g=new Map,h.h=0,h.i&&VD(h.i,function(m,g){h.add(decodeURIComponent(m.replace(/\+/g," ")),g)}))}n=ca.prototype,n.add=function(h,m){mi(this),this.i=null,h=_o(this,h);var g=this.g.get(h);return g||this.g.set(h,g=[]),g.push(m),this.h+=1,this};function t_(h,m){mi(h),m=_o(h,m),h.g.has(m)&&(h.i=null,h.h-=h.g.get(m).length,h.g.delete(m))}function n_(h,m){return mi(h),m=_o(h,m),h.g.has(m)}n.forEach=function(h,m){mi(this),this.g.forEach(function(g,k){g.forEach(function(N){h.call(m,N,k,this)},this)},this)},n.na=function(){mi(this);const h=Array.from(this.g.values()),m=Array.from(this.g.keys()),g=[];for(let k=0;k<m.length;k++){const N=h[k];for(let L=0;L<N.length;L++)g.push(m[k])}return g},n.V=function(h){mi(this);let m=[];if(typeof h=="string")n_(this,h)&&(m=m.concat(this.g.get(_o(this,h))));else{h=Array.from(this.g.values());for(let g=0;g<h.length;g++)m=m.concat(h[g])}return m},n.set=function(h,m){return mi(this),this.i=null,h=_o(this,h),n_(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[m]),this.h+=1,this},n.get=function(h,m){return h?(h=this.V(h),0<h.length?String(h[0]):m):m};function r_(h,m,g){t_(h,m),0<g.length&&(h.i=null,h.g.set(_o(h,m),v(g)),h.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],m=Array.from(this.g.keys());for(var g=0;g<m.length;g++){var k=m[g];const L=encodeURIComponent(String(k)),j=this.V(k);for(k=0;k<j.length;k++){var N=L;j[k]!==""&&(N+="="+encodeURIComponent(String(j[k]))),h.push(N)}}return this.i=h.join("&")};function _o(h,m){return m=String(m),h.j&&(m=m.toLowerCase()),m}function UD(h,m){m&&!h.j&&(mi(h),h.i=null,h.g.forEach(function(g,k){var N=k.toLowerCase();k!=N&&(t_(this,k),r_(this,N,g))},h)),h.j=m}function jD(h,m){const g=new oa;if(l.Image){const k=new Image;k.onload=p(gi,g,"TestLoadImage: loaded",!0,m,k),k.onerror=p(gi,g,"TestLoadImage: error",!1,m,k),k.onabort=p(gi,g,"TestLoadImage: abort",!1,m,k),k.ontimeout=p(gi,g,"TestLoadImage: timeout",!1,m,k),l.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=h}else m(!1)}function HD(h,m){const g=new oa,k=new AbortController,N=setTimeout(()=>{k.abort(),gi(g,"TestPingServer: timeout",!1,m)},1e4);fetch(h,{signal:k.signal}).then(L=>{clearTimeout(N),L.ok?gi(g,"TestPingServer: ok",!0,m):gi(g,"TestPingServer: server error",!1,m)}).catch(()=>{clearTimeout(N),gi(g,"TestPingServer: error",!1,m)})}function gi(h,m,g,k,N){try{N&&(N.onload=null,N.onerror=null,N.onabort=null,N.ontimeout=null),k(g)}catch{}}function WD(){this.g=new CD}function qD(h,m,g){const k=g||"";try{Xw(h,function(N,L){let j=N;u(N)&&(j=nm(N)),m.push(k+L+"="+encodeURIComponent(j))})}catch(N){throw m.push(k+"type="+encodeURIComponent("_badmap")),N}}function $c(h){this.l=h.Ub||null,this.j=h.eb||!1}y($c,rm),$c.prototype.g=function(){return new Uc(this.l,this.j)},$c.prototype.i=function(h){return function(){return h}}({});function Uc(h,m){Lt.call(this),this.D=h,this.o=m,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(Uc,Lt),n=Uc.prototype,n.open=function(h,m){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=m,this.readyState=1,fa(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const m={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(m.body=h),(this.D||l).fetch(new Request(this.A,m)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ha(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,fa(this)),this.g&&(this.readyState=3,fa(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;i_(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function i_(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var m=h.value?h.value:new Uint8Array(0);(m=this.v.decode(m,{stream:!h.done}))&&(this.response=this.responseText+=m)}h.done?ha(this):fa(this),this.readyState==3&&i_(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,ha(this))},n.Qa=function(h){this.g&&(this.response=h,ha(this))},n.ga=function(){this.g&&ha(this)};function ha(h){h.readyState=4,h.l=null,h.j=null,h.v=null,fa(h)}n.setRequestHeader=function(h,m){this.u.append(h,m)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],m=this.h.entries();for(var g=m.next();!g.done;)g=g.value,h.push(g[0]+": "+g[1]),g=m.next();return h.join(`\r
`)};function fa(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Uc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function s_(h){let m="";return M(h,function(g,k){m+=k,m+=":",m+=g,m+=`\r
`}),m}function dm(h,m,g){e:{for(k in g){var k=!1;break e}k=!0}k||(g=s_(g),typeof h=="string"?g!=null&&encodeURIComponent(String(g)):Le(h,m,g))}function Je(h){Lt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Je,Lt);var KD=/^https?$/i,QD=["POST","PUT"];n=Je.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,m,g,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);m=m?m.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():om.g(),this.v=this.o?Mw(this.o):Mw(om),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(m,String(h),!0),this.B=!1}catch(L){o_(this,L);return}if(h=g||"",g=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var N in k)g.set(N,k[N]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const L of k.keys())g.set(L,k.get(L));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(g.keys()).find(L=>L.toLowerCase()=="content-type"),N=l.FormData&&h instanceof l.FormData,!(0<=Array.prototype.indexOf.call(QD,m,void 0))||k||N||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,j]of g)this.g.setRequestHeader(L,j);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{u_(this),this.u=!0,this.g.send(h),this.u=!1}catch(L){o_(this,L)}};function o_(h,m){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=m,h.m=5,l_(h),jc(h)}function l_(h){h.A||(h.A=!0,Gt(h,"complete"),Gt(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Gt(this,"complete"),Gt(this,"abort"),jc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jc(this,!0)),Je.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?a_(this):this.bb())},n.bb=function(){a_(this)};function a_(h){if(h.h&&typeof o<"u"&&(!h.v[1]||Ur(h)!=4||h.Z()!=2)){if(h.u&&Ur(h)==4)Pw(h.Ea,0,h);else if(Gt(h,"readystatechange"),Ur(h)==4){h.h=!1;try{const j=h.Z();e:switch(j){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var m=!0;break e;default:m=!1}var g;if(!(g=m)){var k;if(k=j===0){var N=String(h.D).match(Jw)[1]||null;!N&&l.self&&l.self.location&&(N=l.self.location.protocol.slice(0,-1)),k=!KD.test(N?N.toLowerCase():"")}g=k}if(g)Gt(h,"complete"),Gt(h,"success");else{h.m=6;try{var L=2<Ur(h)?h.g.statusText:""}catch{L=""}h.l=L+" ["+h.Z()+"]",l_(h)}}finally{jc(h)}}}}function jc(h,m){if(h.g){u_(h);const g=h.g,k=h.v[0]?()=>{}:null;h.g=null,h.v=null,m||Gt(h,"ready");try{g.onreadystatechange=k}catch{}}}function u_(h){h.I&&(l.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Ur(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Ur(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var m=this.g.responseText;return h&&m.indexOf(h)==0&&(m=m.substring(h.length)),TD(m)}};function c_(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function GD(h){const m={};h=(h.g&&2<=Ur(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<h.length;k++){if(_(h[k]))continue;var g=P(h[k]);const N=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const L=m[N]||[];m[N]=L,L.push(g)}x(m,function(k){return k.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function da(h,m,g){return g&&g.internalChannelParams&&g.internalChannelParams[h]||m}function h_(h){this.Aa=0,this.i=[],this.j=new oa,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=da("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=da("baseRetryDelayMs",5e3,h),this.cb=da("retryDelaySeedMs",1e4,h),this.Wa=da("forwardChannelMaxRetries",2,h),this.wa=da("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new qw(h&&h.concurrentRequestLimit),this.Da=new WD,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=h_.prototype,n.la=8,n.G=1,n.connect=function(h,m,g,k){Yt(0),this.W=h,this.H=m||{},g&&k!==void 0&&(this.H.OSID=g,this.H.OAID=k),this.F=this.X,this.I=__(this,null,this.W),Wc(this)};function pm(h){if(f_(h),h.G==3){var m=h.U++,g=$r(h.I);if(Le(g,"SID",h.K),Le(g,"RID",m),Le(g,"TYPE","terminate"),pa(h,g),m=new pi(h,h.j,m),m.L=2,m.v=zc($r(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(m.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=m.v,g=!0),g||(m.g=x_(m.j,null),m.g.ea(m.v)),m.F=Date.now(),Lc(m)}w_(h)}function Hc(h){h.g&&(gm(h),h.g.cancel(),h.g=null)}function f_(h){Hc(h),h.u&&(l.clearTimeout(h.u),h.u=null),qc(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&l.clearTimeout(h.s),h.s=null)}function Wc(h){if(!Kw(h.h)&&!h.s){h.s=!0;var m=h.Ga;ae||J(),U||(ae(),U=!0),H.add(m,h),h.B=0}}function YD(h,m){return Qw(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=m.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=sa(d(h.Ga,h,m),v_(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const N=new pi(this,this.j,h);let L=this.o;if(this.S&&(L?(L=S(L),C(L,this.S)):L=this.S),this.m!==null||this.O||(N.H=L,L=null),this.P)e:{for(var m=0,g=0;g<this.i.length;g++){t:{var k=this.i[g];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(m+=k,4096<m){m=g;break e}if(m===4096||g===this.i.length-1){m=g+1;break e}}m=1e3}else m=1e3;m=p_(this,N,m),g=$r(this.I),Le(g,"RID",h),Le(g,"CVER",22),this.D&&Le(g,"X-HTTP-Session-Id",this.D),pa(this,g),L&&(this.O?m="headers="+encodeURIComponent(String(s_(L)))+"&"+m:this.m&&dm(g,this.m,L)),fm(this.h,N),this.Ua&&Le(g,"TYPE","init"),this.P?(Le(g,"$req",m),Le(g,"SID","null"),N.T=!0,am(N,g,null)):am(N,g,m),this.G=2}}else this.G==3&&(h?d_(this,h):this.i.length==0||Kw(this.h)||d_(this))};function d_(h,m){var g;m?g=m.l:g=h.U++;const k=$r(h.I);Le(k,"SID",h.K),Le(k,"RID",g),Le(k,"AID",h.T),pa(h,k),h.m&&h.o&&dm(k,h.m,h.o),g=new pi(h,h.j,g,h.B+1),h.m===null&&(g.H=h.o),m&&(h.i=m.D.concat(h.i)),m=p_(h,g,1e3),g.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),fm(h.h,g),am(g,k,m)}function pa(h,m){h.H&&M(h.H,function(g,k){Le(m,k,g)}),h.l&&Xw({},function(g,k){Le(m,k,g)})}function p_(h,m,g){g=Math.min(h.i.length,g);var k=h.l?d(h.l.Na,h.l,h):null;e:{var N=h.i;let L=-1;for(;;){const j=["count="+g];L==-1?0<g?(L=N[0].g,j.push("ofs="+L)):L=0:j.push("ofs="+L);let De=!0;for(let Tt=0;Tt<g;Tt++){let ke=N[Tt].g;const Bt=N[Tt].map;if(ke-=L,0>ke)L=Math.max(0,N[Tt].g-100),De=!1;else try{qD(Bt,j,"req"+ke+"_")}catch{k&&k(Bt)}}if(De){k=j.join("&");break e}}}return h=h.i.splice(0,g),m.D=h,k}function m_(h){if(!h.g&&!h.u){h.Y=1;var m=h.Fa;ae||J(),U||(ae(),U=!0),H.add(m,h),h.v=0}}function mm(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=sa(d(h.Fa,h),v_(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,g_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=sa(d(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Yt(10),Hc(this),g_(this))};function gm(h){h.A!=null&&(l.clearTimeout(h.A),h.A=null)}function g_(h){h.g=new pi(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var m=$r(h.qa);Le(m,"RID","rpc"),Le(m,"SID",h.K),Le(m,"AID",h.T),Le(m,"CI",h.F?"0":"1"),!h.F&&h.ja&&Le(m,"TO",h.ja),Le(m,"TYPE","xmlhttp"),pa(h,m),h.m&&h.o&&dm(m,h.m,h.o),h.L&&(h.g.I=h.L);var g=h.g;h=h.ia,g.L=1,g.v=zc($r(m)),g.m=null,g.P=!0,jw(g,h)}n.Za=function(){this.C!=null&&(this.C=null,Hc(this),mm(this),Yt(19))};function qc(h){h.C!=null&&(l.clearTimeout(h.C),h.C=null)}function y_(h,m){var g=null;if(h.g==m){qc(h),gm(h),h.g=null;var k=2}else if(hm(h.h,m))g=m.D,Gw(h.h,m),k=1;else return;if(h.G!=0){if(m.o)if(k==1){g=m.m?m.m.length:0,m=Date.now()-m.F;var N=h.B;k=Mc(),Gt(k,new Fw(k,g)),Wc(h)}else m_(h);else if(N=m.s,N==3||N==0&&0<m.X||!(k==1&&YD(h,m)||k==2&&mm(h)))switch(g&&0<g.length&&(m=h.h,m.i=m.i.concat(g)),N){case 1:ws(h,5);break;case 4:ws(h,10);break;case 3:ws(h,6);break;default:ws(h,2)}}}function v_(h,m){let g=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(g*=2),g*m}function ws(h,m){if(h.j.info("Error code "+m),m==2){var g=d(h.fb,h),k=h.Xa;const N=!k;k=new vs(k||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Bc(k,"https"),zc(k),N?jD(k.toString(),g):HD(k.toString(),g)}else Yt(2);h.G=0,h.l&&h.l.sa(m),w_(h),f_(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Yt(2)):(this.j.info("Failed to ping google.com"),Yt(1))};function w_(h){if(h.G=0,h.ka=[],h.l){const m=Yw(h.h);(m.length!=0||h.i.length!=0)&&(E(h.ka,m),E(h.ka,h.i),h.h.i.length=0,v(h.i),h.i.length=0),h.l.ra()}}function __(h,m,g){var k=g instanceof vs?$r(g):new vs(g);if(k.g!="")m&&(k.g=m+"."+k.g),Fc(k,k.s);else{var N=l.location;k=N.protocol,m=m?m+"."+N.hostname:N.hostname,N=+N.port;var L=new vs(null);k&&Bc(L,k),m&&(L.g=m),N&&Fc(L,N),g&&(L.l=g),k=L}return g=h.D,m=h.ya,g&&m&&Le(k,g,m),Le(k,"VER",h.la),pa(h,k),k}function x_(h,m,g){if(m&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return m=h.Ca&&!h.pa?new Je(new $c({eb:g})):new Je(h.pa),m.Ha(h.J),m}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function S_(){}n=S_.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Kc(){}Kc.prototype.g=function(h,m){return new Sn(h,m)};function Sn(h,m){Lt.call(this),this.g=new h_(m),this.l=h,this.h=m&&m.messageUrlParams||null,h=m&&m.messageHeaders||null,m&&m.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=m&&m.initMessageHeaders||null,m&&m.messageContentType&&(h?h["X-WebChannel-Content-Type"]=m.messageContentType:h={"X-WebChannel-Content-Type":m.messageContentType}),m&&m.va&&(h?h["X-WebChannel-Client-Profile"]=m.va:h={"X-WebChannel-Client-Profile":m.va}),this.g.S=h,(h=m&&m.Sb)&&!_(h)&&(this.g.m=h),this.v=m&&m.supportsCrossDomainXhr||!1,this.u=m&&m.sendRawJson||!1,(m=m&&m.httpSessionIdParam)&&!_(m)&&(this.g.D=m,h=this.h,h!==null&&m in h&&(h=this.h,m in h&&delete h[m])),this.j=new xo(this)}y(Sn,Lt),Sn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Sn.prototype.close=function(){pm(this.g)},Sn.prototype.o=function(h){var m=this.g;if(typeof h=="string"){var g={};g.__data__=h,h=g}else this.u&&(g={},g.__data__=nm(h),h=g);m.i.push(new OD(m.Ya++,h)),m.G==3&&Wc(m)},Sn.prototype.N=function(){this.g.l=null,delete this.j,pm(this.g),delete this.g,Sn.aa.N.call(this)};function b_(h){im.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var m=h.__sm__;if(m){e:{for(const g in m){h=g;break e}h=void 0}(this.i=h)&&(h=this.i,m=m!==null&&h in m?m[h]:void 0),this.data=m}else this.data=h}y(b_,im);function k_(){sm.call(this),this.status=1}y(k_,sm);function xo(h){this.g=h}y(xo,S_),xo.prototype.ua=function(){Gt(this.g,"a")},xo.prototype.ta=function(h){Gt(this.g,new b_(h))},xo.prototype.sa=function(h){Gt(this.g,new k_)},xo.prototype.ra=function(){Gt(this.g,"b")},Kc.prototype.createWebChannel=Kc.prototype.g,Sn.prototype.send=Sn.prototype.o,Sn.prototype.open=Sn.prototype.m,Sn.prototype.close=Sn.prototype.close,CR=function(){return new Kc},TR=function(){return Mc()},ER=gs,F0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Nc.NO_ERROR=0,Nc.TIMEOUT=8,Nc.HTTP_ERROR=6,bf=Nc,zw.COMPLETE="complete",kR=zw,Nw.EventType=ra,ra.OPEN="a",ra.CLOSE="b",ra.ERROR="c",ra.MESSAGE="d",Lt.prototype.listen=Lt.prototype.K,qa=Nw,Je.prototype.listenOnce=Je.prototype.L,Je.prototype.getLastError=Je.prototype.Ka,Je.prototype.getLastErrorCode=Je.prototype.Ba,Je.prototype.getStatus=Je.prototype.Z,Je.prototype.getResponseJson=Je.prototype.Oa,Je.prototype.getResponseText=Je.prototype.oa,Je.prototype.send=Je.prototype.ea,Je.prototype.setWithCredentials=Je.prototype.Ha,bR=Je}).apply(typeof Bh<"u"?Bh:typeof self<"u"?self:typeof window<"u"?window:{});const fk="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}It.UNAUTHENTICATED=new It(null),It.GOOGLE_CREDENTIALS=new It("google-credentials-uid"),It.FIRST_PARTY=new It("first-party-uid"),It.MOCK_USER=new It("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=new gR("@firebase/firestore");function Oo(){return io.logLevel}function z(n,...e){if(io.logLevel<=_e.DEBUG){const t=e.map(q1);io.debug(`Firestore (${Jl}): ${n}`,...t)}}function en(n,...e){if(io.logLevel<=_e.ERROR){const t=e.map(q1);io.error(`Firestore (${Jl}): ${n}`,...t)}}function so(n,...e){if(io.logLevel<=_e.WARN){const t=e.map(q1);io.warn(`Firestore (${Jl}): ${n}`,...t)}}function q1(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z(n="Unexpected state"){const e=`FIRESTORE (${Jl}) INTERNAL ASSERTION FAILED: `+n;throw en(e),new Error(e)}function ee(n,e){n||Z()}function oe(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class X extends Xl{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class E${getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(It.UNAUTHENTICATED))}shutdown(){}}class T${constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class C${constructor(e){this.t=e,this.currentUser=It.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ee(this.o===void 0);let r=this.i;const i=a=>this.i!==r?(r=this.i,t(a)):Promise.resolve();let s=new ei;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ei,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const a=s;e.enqueueRetryable(async()=>{await a.promise,await i(this.currentUser)})},l=a=>{z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(a=>l(a)),setTimeout(()=>{if(!this.auth){const a=this.t.getImmediate({optional:!0});a?l(a):(z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ei)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string"),new AR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string"),new It(e)}}class A${constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=It.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class I${constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new A$(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(It.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class P${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class R${constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ee(this.o===void 0);const r=s=>{s.error!=null&&z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ee(typeof t.token=="string"),this.R=t.token,new P$(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D$(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=D$(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}}function le(n,e){return n<e?-1:n>e?1:0}function Ml(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function PR(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new X(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new X(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new X(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new X(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ye.fromMillis(Date.now())}static fromDate(e){return Ye.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Ye(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class te{constructor(e){this.timestamp=e}static fromTimestamp(e){return new te(e)}static min(){return new te(new Ye(0,0))}static max(){return new te(new Ye(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rc{constructor(e,t,r){t===void 0?t=0:t>e.length&&Z(),r===void 0?r=e.length-t:r>e.length-t&&Z(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return rc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof rc?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ae extends rc{construct(e,t,r){return new Ae(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new X(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Ae(t)}static emptyPath(){return new Ae([])}}const O$=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qe extends rc{construct(e,t,r){return new Qe(e,t,r)}static isValidIdentifier(e){return O$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Qe(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new X(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new X(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const a=e[i+1];if(a!=="\\"&&a!=="."&&a!=="`")throw new X(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=a,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new X(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qe(t)}static emptyPath(){return new Qe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.path=e}static fromPath(e){return new K(Ae.fromString(e))}static fromName(e){return new K(Ae.fromString(e).popFirst(5))}static empty(){return new K(Ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ae.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new K(new Ae(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function z0(n){return n.fields.find(e=>e.kind===2)}function Cs(n){return n.fields.filter(e=>e.kind!==2)}Fd.UNKNOWN_ID=-1;class kf{constructor(e,t){this.fieldPath=e,this.kind=t}}class ic{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ic(0,Mn.min())}}function M$(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=te.fromTimestamp(r===1e9?new Ye(t+1,0):new Ye(t,r));return new Mn(i,K.empty(),e)}function RR(n){return new Mn(n.readTime,n.key,-1)}class Mn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Mn(te.min(),K.empty(),-1)}static max(){return new Mn(te.max(),K.empty(),-1)}}function K1(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=K.comparator(n.documentKey,e.documentKey),t!==0?t:le(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class OR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function go(n){if(n.code!==F.FAILED_PRECONDITION||n.message!==DR)throw n;z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Z(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new V((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof V?t:V.resolve(t)}catch(t){return V.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):V.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):V.reject(t)}static resolve(e){return new V((t,r)=>{t(e)})}static reject(e){return new V((t,r)=>{r(e)})}static waitFor(e){return new V((t,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},a=>r(a))}),o=!0,s===i&&t()})}static or(e){let t=V.resolve(!1);for(const r of e)t=t.next(i=>i?V.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new V((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let a=0;a<s;a++){const u=a;t(e[u]).next(c=>{o[u]=c,++l,l===s&&r(o)},c=>i(c))}})}static doWhile(e,t){return new V((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Op{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new ei,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new fu(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Q1(r.target.error);this.V.reject(new fu(e,i))}}static open(e,t,r,i){try{return new Op(t,e.transaction(i,r))}catch(s){throw new fu(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(z("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new V$(t)}}class Gi{constructor(e,t,r){this.name=e,this.version=t,this.p=r,Gi.S(Vd())===12.2&&en("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return z("SimpleDb","Removing database:",e),Ps(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!pR())return!1;if(Gi.v())return!0;const e=Vd(),t=Gi.S(e),r=0<t&&t<10,i=MR(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(z("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new fu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new X(F.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new X(F.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new fu(e,o))},i.onupgradeneeded=s=>{z("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{z("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=Op.open(this.db,e,s?"readonly":"readwrite",r),a=i(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),V.reject(u))).toPromise();return a.catch(()=>{}),await l.m,a}catch(l){const a=l,u=a.name!=="FirebaseError"&&o<3;if(z("SimpleDb","Transaction failed with error:",a.message,"Retrying:",u),this.close(),!u)return Promise.reject(a)}}}close(){this.db&&this.db.close(),this.db=void 0}}function MR(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class N${constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ps(this.B.delete())}}class fu extends X{constructor(e,t){super(F.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function hs(n){return n.name==="IndexedDbTransactionError"}class V${constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(z("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(z("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ps(r)}add(e){return z("SimpleDb","ADD",this.store.name,e,e),Ps(this.store.add(e))}get(e){return Ps(this.store.get(e)).next(t=>(t===void 0&&(t=null),z("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return z("SimpleDb","DELETE",this.store.name,e),Ps(this.store.delete(e))}count(){return z("SimpleDb","COUNT",this.store.name),Ps(this.store.count())}U(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new V((o,l)=>{s.onerror=a=>{l(a.target.error)},s.onsuccess=a=>{o(a.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(l,a)=>{o.push(a)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new V((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){z("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,l)=>l.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Y(e){const t=this.cursor({});return new V((r,i)=>{t.onerror=s=>{const o=Q1(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}W(e,t){const r=[];return new V((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const a=new N$(l),u=t(l.primaryKey,l.value,a);if(u instanceof V){const c=u.catch(f=>(a.done(),V.reject(f)));r.push(c)}a.isDone?i():a.K===null?l.continue():l.continue(a.K)}}).next(()=>V.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ps(n){return new V((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Q1(r.target.error);t(i)}})}let dk=!1;function Q1(n){const e=Gi.S(Vd());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new X("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return dk||(dk=!0,setTimeout(()=>{throw r},0)),r}}return n}class L${constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){z("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{z("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){hs(t)?z("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await go(t)}await this.X(6e4)})}}class B${constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let i=t,s=!0;return V.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return z("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(l=>{i-=l,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(l=>(z("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=RR(s);K1(o,r)>0&&(r=o)}),new Mn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Hn.oe=-1;function Mp(n){return n==null}function sc(n){return n===0&&1/n==-1/0}function F$(n){return typeof n=="number"&&Number.isInteger(n)&&!sc(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pk(e)),e=z$(n.get(t),e);return pk(e)}function z$(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function pk(n){return n+""}function Ir(n){const e=n.length;if(ee(e>=2),e===2)return ee(n.charAt(0)===""&&n.charAt(1)===""),Ae.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("",s);switch((o<0||o>t)&&Z(),n.charAt(o+1)){case"":const l=n.substring(s,o);let a;i.length===0?a=l:(i+=l,a=i,i=""),r.push(a);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:Z()}s=o+2}return new Ae(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ef(n,e){return[n,sn(e)]}function NR(n,e,t){return[n,sn(e),t]}const $$={},U$=["prefixPath","collectionGroup","readTime","documentId"],j$=["prefixPath","collectionGroup","documentId"],H$=["collectionGroup","readTime","prefixPath","documentId"],W$=["canonicalId","targetId"],q$=["targetId","path"],K$=["path","targetId"],Q$=["collectionId","parent"],G$=["indexId","uid"],Y$=["uid","sequenceNumber"],X$=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],J$=["indexId","uid","orderedDocumentKey"],Z$=["userId","collectionPath","documentId"],e8=["userId","collectionPath","largestBatchId"],t8=["userId","collectionGroup","largestBatchId"],VR=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],n8=[...VR,"documentOverlays"],LR=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],BR=LR,G1=[...BR,"indexConfiguration","indexState","indexEntries"],r8=G1,i8=[...G1,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0 extends OR{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function yt(n,e){const t=oe(n);return Gi.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gk(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Zl(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function FR(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e,t){this.comparator=e,this.root=t||Pt.EMPTY}insert(e,t){return new qe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Pt.BLACK,null,null))}remove(e){return new qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Pt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Fh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Fh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Fh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Fh(this.root,e,this.comparator,!0)}}class Fh{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Pt{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Pt.RED,this.left=i??Pt.EMPTY,this.right=s??Pt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Pt(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Pt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Pt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Pt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Pt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Z();const e=this.left.check();if(e!==this.right.check())throw Z();return e+(this.isRed()?0:1)}}Pt.EMPTY=null,Pt.RED=!0,Pt.BLACK=!1;Pt.EMPTY=new class{constructor(){this.size=0}get key(){throw Z()}get value(){throw Z()}get color(){throw Z()}get left(){throw Z()}get right(){throw Z()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Pt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.comparator=e,this.data=new qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yk(this.data.getIterator())}getIteratorFrom(e){return new yk(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Re(this.comparator);return t.data=e,t}}class yk{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Co(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.fields=e,e.sort(Qe.comparator)}static empty(){return new Wn([])}unionWith(e){let t=new Re(Qe.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Wn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ml(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zR extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new zR("Invalid base64 string: "+s):s}}(e);return new ft(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new ft(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ft.EMPTY_BYTE_STRING=new ft("");const s8=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(n){if(ee(!!n),typeof n=="string"){let e=0;const t=s8.exec(n);if(ee(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:je(n.seconds),nanos:je(n.nanos)}}function je(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function is(n){return typeof n=="string"?ft.fromBase64String(n):ft.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function X1(n){const e=n.mapValue.fields.__previous_value__;return Y1(e)?X1(e):e}function oc(n){const e=ui(n.mapValue.fields.__local_write_time__.timestampValue);return new Ye(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e,t,r,i,s,o,l,a,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=a,this.useFetchStreams=u}}class oo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new oo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Tf={nullValue:"NULL_VALUE"};function lo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Y1(n)?4:$R(n)?9007199254740991:Np(n)?10:11:Z()}function Nr(n,e){if(n===e)return!0;const t=lo(n);if(t!==lo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return oc(n).isEqual(oc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=ui(i.timestampValue),l=ui(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return is(i.bytesValue).isEqual(is(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return je(i.geoPointValue.latitude)===je(s.geoPointValue.latitude)&&je(i.geoPointValue.longitude)===je(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return je(i.integerValue)===je(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=je(i.doubleValue),l=je(s.doubleValue);return o===l?sc(o)===sc(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return Ml(n.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(gk(o)!==gk(l))return!1;for(const a in o)if(o.hasOwnProperty(a)&&(l[a]===void 0||!Nr(o[a],l[a])))return!1;return!0}(n,e);default:return Z()}}function lc(n,e){return(n.values||[]).find(t=>Nr(t,e))!==void 0}function ss(n,e){if(n===e)return 0;const t=lo(n),r=lo(e);if(t!==r)return le(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return le(n.booleanValue,e.booleanValue);case 2:return function(s,o){const l=je(s.integerValue||s.doubleValue),a=je(o.integerValue||o.doubleValue);return l<a?-1:l>a?1:l===a?0:isNaN(l)?isNaN(a)?0:-1:1}(n,e);case 3:return vk(n.timestampValue,e.timestampValue);case 4:return vk(oc(n),oc(e));case 5:return le(n.stringValue,e.stringValue);case 6:return function(s,o){const l=is(s),a=is(o);return l.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),a=o.split("/");for(let u=0;u<l.length&&u<a.length;u++){const c=le(l[u],a[u]);if(c!==0)return c}return le(l.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const l=le(je(s.latitude),je(o.latitude));return l!==0?l:le(je(s.longitude),je(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return wk(n.arrayValue,e.arrayValue);case 10:return function(s,o){var l,a,u,c;const f=s.fields||{},d=o.fields||{},p=(l=f.value)===null||l===void 0?void 0:l.arrayValue,y=(a=d.value)===null||a===void 0?void 0:a.arrayValue,v=le(((u=p==null?void 0:p.values)===null||u===void 0?void 0:u.length)||0,((c=y==null?void 0:y.values)===null||c===void 0?void 0:c.length)||0);return v!==0?v:wk(p,y)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===Vi.mapValue&&o===Vi.mapValue)return 0;if(s===Vi.mapValue)return 1;if(o===Vi.mapValue)return-1;const l=s.fields||{},a=Object.keys(l),u=o.fields||{},c=Object.keys(u);a.sort(),c.sort();for(let f=0;f<a.length&&f<c.length;++f){const d=le(a[f],c[f]);if(d!==0)return d;const p=ss(l[a[f]],u[c[f]]);if(p!==0)return p}return le(a.length,c.length)}(n.mapValue,e.mapValue);default:throw Z()}}function vk(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return le(n,e);const t=ui(n),r=ui(e),i=le(t.seconds,r.seconds);return i!==0?i:le(t.nanos,r.nanos)}function wk(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=ss(t[i],r[i]);if(s)return s}return le(t.length,r.length)}function Nl(n){return U0(n)}function U0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=ui(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return is(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return K.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=U0(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${U0(t.fields[o])}`;return i+"}"}(n.mapValue):Z()}function J1(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function j0(n){return!!n&&"integerValue"in n}function ac(n){return!!n&&"arrayValue"in n}function _k(n){return!!n&&"nullValue"in n}function xk(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cf(n){return!!n&&"mapValue"in n}function Np(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function du(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Zl(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=du(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=du(n.arrayValue.values[t]);return e}return Object.assign({},n)}function $R(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const UR={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function l8(n){return"nullValue"in n?Tf:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?J1(oo.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Np(n)?UR:{mapValue:{}}:Z()}function a8(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?J1(oo.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?UR:"mapValue"in n?Np(n)?{mapValue:{}}:Vi:Z()}function Sk(n,e){const t=ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function bk(n,e){const t=ss(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.value=e}static empty(){return new pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Cf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=du(t)}setAll(e){let t=Qe.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const a=this.getFieldsMap(t);this.applyChanges(a,r,i),r={},i=[],t=l.popLast()}o?r[l.lastSegment()]=du(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());Cf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Cf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Zl(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new pn(du(this.value))}}function jR(n){const e=[];return Zl(n.fields,(t,r)=>{const i=new Qe([t]);if(Cf(r)){const s=jR(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{constructor(e,t,r,i,s,o,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new et(e,0,te.min(),te.min(),te.min(),pn.empty(),0)}static newFoundDocument(e,t,r,i){return new et(e,1,t,te.min(),r,i,0)}static newNoDocument(e,t){return new et(e,2,t,te.min(),te.min(),pn.empty(),0)}static newUnknownDocument(e,t){return new et(e,3,t,te.min(),te.min(),pn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e,t){this.position=e,this.inclusive=t}}function kk(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=K.comparator(K.fromName(o.referenceValue),t.key):r=ss(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ek(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Nr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,t="asc"){this.field=e,this.dir=t}}function u8(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HR{}class ve extends HR{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new c8(e,t,r):t==="array-contains"?new d8(e,r):t==="in"?new YR(e,r):t==="not-in"?new p8(e,r):t==="array-contains-any"?new m8(e,r):new ve(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new h8(e,r):new f8(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ss(t,this.value)):t!==null&&lo(this.value)===lo(t)&&this.matchesComparison(ss(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Z()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pe extends HR{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Pe(e,t)}matches(e){return Ll(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ll(n){return n.op==="and"}function H0(n){return n.op==="or"}function Z1(n){return WR(n)&&Ll(n)}function WR(n){for(const e of n.filters)if(e instanceof Pe)return!1;return!0}function W0(n){if(n instanceof ve)return n.field.canonicalString()+n.op.toString()+Nl(n.value);if(Z1(n))return n.filters.map(e=>W0(e)).join(",");{const e=n.filters.map(t=>W0(t)).join(",");return`${n.op}(${e})`}}function qR(n,e){return n instanceof ve?function(r,i){return i instanceof ve&&r.op===i.op&&r.field.isEqual(i.field)&&Nr(r.value,i.value)}(n,e):n instanceof Pe?function(r,i){return i instanceof Pe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&qR(o,i.filters[l]),!0):!1}(n,e):void Z()}function KR(n,e){const t=n.filters.concat(e);return Pe.create(t,n.op)}function QR(n){return n instanceof ve?function(t){return`${t.field.canonicalString()} ${t.op} ${Nl(t.value)}`}(n):n instanceof Pe?function(t){return t.op.toString()+" {"+t.getFilters().map(QR).join(" ,")+"}"}(n):"Filter"}class c8 extends ve{constructor(e,t,r){super(e,t,r),this.key=K.fromName(r.referenceValue)}matches(e){const t=K.comparator(e.key,this.key);return this.matchesComparison(t)}}class h8 extends ve{constructor(e,t){super(e,"in",t),this.keys=GR("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class f8 extends ve{constructor(e,t){super(e,"not-in",t),this.keys=GR("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function GR(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>K.fromName(r.referenceValue))}class d8 extends ve{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ac(t)&&lc(t.arrayValue,this.value)}}class YR extends ve{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&lc(this.value.arrayValue,t)}}class p8 extends ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(lc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!lc(this.value.arrayValue,t)}}class m8 extends ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ac(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>lc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g8{constructor(e,t=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function q0(n,e=null,t=[],r=[],i=null,s=null,o=null){return new g8(n,e,t,r,i,s,o)}function ao(n){const e=oe(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>W0(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Mp(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Nl(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Nl(r)).join(",")),e.ue=t}return e.ue}function Tc(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!u8(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!qR(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ek(n.startAt,e.startAt)&&Ek(n.endAt,e.endAt)}function $d(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ud(n,e){return n.filters.filter(t=>t instanceof ve&&t.field.isEqual(e))}function Tk(n,e,t){let r=Tf,i=!0;for(const s of Ud(n,e)){let o=Tf,l=!0;switch(s.op){case"<":case"<=":o=l8(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=Tf}Sk({value:r,inclusive:i},{value:o,inclusive:l})<0&&(r=o,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Sk({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function Ck(n,e,t){let r=Vi,i=!0;for(const s of Ud(n,e)){let o=Vi,l=!0;switch(s.op){case">=":case">":o=a8(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Vi}bk({value:r,inclusive:i},{value:o,inclusive:l})>0&&(r=o,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];bk({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,t=null,r=[],i=[],s=null,o="F",l=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function y8(n,e,t,r,i,s,o,l){return new Vp(n,e,t,r,i,s,o,l)}function ew(n){return new Vp(n)}function Ak(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function v8(n){return n.collectionGroup!==null}function pu(n){const e=oe(n);if(e.ce===null){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Re(Qe.comparator);return o.filters.forEach(a=>{a.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new zd(s,r))}),t.has(Qe.keyField().canonicalString())||e.ce.push(new zd(Qe.keyField(),r))}return e.ce}function Gn(n){const e=oe(n);return e.le||(e.le=w8(e,pu(n))),e.le}function w8(n,e){if(n.limitType==="F")return q0(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new zd(i.field,s)});const t=n.endAt?new Vl(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Vl(n.startAt.position,n.startAt.inclusive):null;return q0(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function K0(n,e,t){return new Vp(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Lp(n,e){return Tc(Gn(n),Gn(e))&&n.limitType===e.limitType}function XR(n){return`${ao(Gn(n))}|lt:${n.limitType}`}function Mo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>QR(i)).join(", ")}]`),Mp(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Nl(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Nl(i)).join(",")),`Target(${r})`}(Gn(n))}; limitType=${n.limitType})`}function Cc(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):K.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of pu(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,l,a){const u=kk(o,l,a);return o.inclusive?u<=0:u<0}(r.startAt,pu(r),i)||r.endAt&&!function(o,l,a){const u=kk(o,l,a);return o.inclusive?u>=0:u>0}(r.endAt,pu(r),i))}(n,e)}function _8(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function JR(n){return(e,t)=>{let r=!1;for(const i of pu(n)){const s=x8(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function x8(n,e,t){const r=n.field.isKeyField()?K.comparator(e.key,t.key):function(s,o,l){const a=o.data.field(s),u=l.data.field(s);return a!==null&&u!==null?ss(a,u):Z()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Z()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zl(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return FR(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S8=new qe(K.comparator);function Pn(){return S8}const ZR=new qe(K.comparator);function Ka(...n){let e=ZR;for(const t of n)e=e.insert(t.key,t);return e}function e2(n){let e=ZR;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Pr(){return mu()}function t2(){return mu()}function mu(){return new fs(n=>n.toString(),(n,e)=>n.isEqual(e))}const b8=new qe(K.comparator),k8=new Re(K.comparator);function de(...n){let e=k8;for(const t of n)e=e.add(t);return e}const E8=new Re(le);function T8(){return E8}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sc(e)?"-0":e}}function n2(n){return{integerValue:""+n}}function C8(n,e){return F$(e)?n2(e):tw(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(){this._=void 0}}function A8(n,e,t){return n instanceof uc?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Y1(s)&&(s=X1(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Bl?i2(n,e):n instanceof Fl?s2(n,e):function(i,s){const o=r2(i,s),l=Ik(o)+Ik(i.Pe);return j0(o)&&j0(i.Pe)?n2(l):tw(i.serializer,l)}(n,e)}function I8(n,e,t){return n instanceof Bl?i2(n,e):n instanceof Fl?s2(n,e):t}function r2(n,e){return n instanceof cc?function(r){return j0(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class uc extends Bp{}class Bl extends Bp{constructor(e){super(),this.elements=e}}function i2(n,e){const t=o2(e);for(const r of n.elements)t.some(i=>Nr(i,r))||t.push(r);return{arrayValue:{values:t}}}class Fl extends Bp{constructor(e){super(),this.elements=e}}function s2(n,e){let t=o2(e);for(const r of n.elements)t=t.filter(i=>!Nr(i,r));return{arrayValue:{values:t}}}class cc extends Bp{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Ik(n){return je(n.integerValue||n.doubleValue)}function o2(n){return ac(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P8{constructor(e,t){this.field=e,this.transform=t}}function R8(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Bl&&i instanceof Bl||r instanceof Fl&&i instanceof Fl?Ml(r.elements,i.elements,Nr):r instanceof cc&&i instanceof cc?Nr(r.Pe,i.Pe):r instanceof uc&&i instanceof uc}(n.transform,e.transform)}class D8{constructor(e,t){this.version=e,this.transformResults=t}}class Rn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Rn}static exists(e){return new Rn(void 0,e)}static updateTime(e){return new Rn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Af(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Fp{}function l2(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new nw(n.key,Rn.none()):new ea(n.key,n.data,Rn.none());{const t=n.data,r=pn.empty();let i=new Re(Qe.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ds(n.key,r,new Wn(i.toArray()),Rn.none())}}function O8(n,e,t){n instanceof ea?function(i,s,o){const l=i.value.clone(),a=Rk(i.fieldTransforms,s,o.transformResults);l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof ds?function(i,s,o){if(!Af(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=Rk(i.fieldTransforms,s,o.transformResults),a=s.data;a.setAll(a2(i)),a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function gu(n,e,t,r){return n instanceof ea?function(s,o,l,a){if(!Af(s.precondition,o))return l;const u=s.value.clone(),c=Dk(s.fieldTransforms,a,o);return u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof ds?function(s,o,l,a){if(!Af(s.precondition,o))return l;const u=Dk(s.fieldTransforms,a,o),c=o.data;return c.setAll(a2(s)),c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(s,o,l){return Af(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function M8(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=r2(r.transform,i||null);s!=null&&(t===null&&(t=pn.empty()),t.set(r.field,s))}return t||null}function Pk(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ml(r,i,(s,o)=>R8(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ea extends Fp{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ds extends Fp{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function a2(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Rk(n,e,t){const r=new Map;ee(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,I8(o,l,t[i]))}return r}function Dk(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,A8(s,o,e))}return r}class nw extends Fp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class u2 extends Fp{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&O8(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=gu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=gu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=t2();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const a=l2(o,l);a!==null&&r.set(i.key,a),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),de())}isEqual(e){return this.batchId===e.batchId&&Ml(this.mutations,e.mutations,(t,r)=>Pk(t,r))&&Ml(this.baseMutations,e.baseMutations,(t,r)=>Pk(t,r))}}class iw{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ee(e.mutations.length===r.length);let i=function(){return b8}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new iw(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sw{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N8{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt,we;function V8(n){switch(n){default:return Z();case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0}}function c2(n){if(n===void 0)return en("GRPC error has no .code"),F.UNKNOWN;switch(n){case lt.OK:return F.OK;case lt.CANCELLED:return F.CANCELLED;case lt.UNKNOWN:return F.UNKNOWN;case lt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case lt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case lt.INTERNAL:return F.INTERNAL;case lt.UNAVAILABLE:return F.UNAVAILABLE;case lt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case lt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case lt.NOT_FOUND:return F.NOT_FOUND;case lt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case lt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case lt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case lt.ABORTED:return F.ABORTED;case lt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case lt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case lt.DATA_LOSS:return F.DATA_LOSS;default:return Z()}}(we=lt||(lt={}))[we.OK=0]="OK",we[we.CANCELLED=1]="CANCELLED",we[we.UNKNOWN=2]="UNKNOWN",we[we.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",we[we.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",we[we.NOT_FOUND=5]="NOT_FOUND",we[we.ALREADY_EXISTS=6]="ALREADY_EXISTS",we[we.PERMISSION_DENIED=7]="PERMISSION_DENIED",we[we.UNAUTHENTICATED=16]="UNAUTHENTICATED",we[we.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",we[we.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",we[we.ABORTED=10]="ABORTED",we[we.OUT_OF_RANGE=11]="OUT_OF_RANGE",we[we.UNIMPLEMENTED=12]="UNIMPLEMENTED",we[we.INTERNAL=13]="INTERNAL",we[we.UNAVAILABLE=14]="UNAVAILABLE",we[we.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L8(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8=new qs([4294967295,4294967295],0);function Ok(n){const e=L8().encode(n),t=new SR;return t.update(e),new Uint8Array(t.digest())}function Mk(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new qs([t,r],0),new qs([i,s],0)]}class ow{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Qa(`Invalid padding: ${t}`);if(r<0)throw new Qa(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Qa(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Qa(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=qs.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(qs.fromNumber(r)));return i.compare(B8)===1&&(i=new qs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=Ok(e),[r,i]=Mk(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new ow(s,i,t);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const t=Ok(e),[r,i]=Mk(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Qa extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,Ac.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new zp(te.min(),i,new qe(le),Pn(),de())}}class Ac{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ac(r,t,de(),de(),de())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class h2{constructor(e,t){this.targetId=e,this.me=t}}class f2{constructor(e,t,r=ft.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Nk{constructor(){this.fe=0,this.ge=Lk(),this.pe=ft.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=de(),t=de(),r=de();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Z()}}),new Ac(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Lk()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ee(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class F8{constructor(e){this.Le=e,this.Be=new Map,this.ke=Pn(),this.qe=Vk(),this.Qe=new qe(le)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Z()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if($d(s))if(r===0){const o=new K(s.path);this.Ue(t,o,et.newNoDocument(o,te.min()))}else ee(r===1);else{const o=this.Ye(t);if(o!==r){const l=this.Ze(e),a=l?this.Xe(l,e,o):1;if(a!==0){this.je(t);const u=a===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=is(r).toUint8Array()}catch(a){if(a instanceof zR)return so("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{l=new ow(o,i,s)}catch(a){return so(a instanceof Qa?"BloomFilter error: ":"Applying bloom filter failed: ",a),null}return l.Ie===0?null:l}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&$d(l.target)){const a=new K(l.target.path);this.ke.get(a)!==null||this.it(o,a)||this.Ue(o,a,et.newNoDocument(a,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=de();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(a=>{const u=this.Je(a);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new zp(e,t,this.Qe,this.ke,r);return this.ke=Pn(),this.qe=Vk(),this.Qe=new qe(le),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Nk,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Re(le),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||z("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Nk),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Vk(){return new qe(K.comparator)}function Lk(){return new qe(K.comparator)}const z8={asc:"ASCENDING",desc:"DESCENDING"},$8={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},U8={and:"AND",or:"OR"};class j8{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Q0(n,e){return n.useProto3Json||Mp(e)?e:{value:e}}function zl(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function d2(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function H8(n,e){return zl(n,e.toTimestamp())}function on(n){return ee(!!n),te.fromTimestamp(function(t){const r=ui(t);return new Ye(r.seconds,r.nanos)}(n))}function lw(n,e){return G0(n,e).canonicalString()}function G0(n,e){const t=function(i){return new Ae(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function p2(n){const e=Ae.fromString(n);return ee(b2(e)),e}function jd(n,e){return lw(n.databaseId,e.path)}function Ks(n,e){const t=p2(e);if(t.get(1)!==n.databaseId.projectId)throw new X(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new X(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new K(y2(t))}function m2(n,e){return lw(n.databaseId,e)}function g2(n){const e=p2(n);return e.length===4?Ae.emptyPath():y2(e)}function Y0(n){return new Ae(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function y2(n){return ee(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Bk(n,e,t){return{name:jd(n,e),fields:t.value.mapValue.fields}}function W8(n,e,t){const r=Ks(n,e.name),i=on(e.updateTime),s=e.createTime?on(e.createTime):te.min(),o=new pn({mapValue:{fields:e.fields}}),l=et.newFoundDocument(r,i,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function q8(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Z()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,c){return u.useProto3Json?(ee(c===void 0||typeof c=="string"),ft.fromBase64String(c||"")):(ee(c===void 0||c instanceof Buffer||c instanceof Uint8Array),ft.fromUint8Array(c||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const c=u.code===void 0?F.UNKNOWN:c2(u.code);return new X(c,u.message||"")}(o);t=new f2(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ks(n,r.document.name),s=on(r.document.updateTime),o=r.document.createTime?on(r.document.createTime):te.min(),l=new pn({mapValue:{fields:r.document.fields}}),a=et.newFoundDocument(i,s,o,l),u=r.targetIds||[],c=r.removedTargetIds||[];t=new If(u,c,a.key,a)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ks(n,r.document),s=r.readTime?on(r.readTime):te.min(),o=et.newNoDocument(i,s),l=r.removedTargetIds||[];t=new If([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ks(n,r.document),s=r.removedTargetIds||[];t=new If([],s,i,null)}else{if(!("filter"in e))return Z();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new N8(i,s),l=r.targetId;t=new h2(l,o)}}return t}function Hd(n,e){let t;if(e instanceof ea)t={update:Bk(n,e.key,e.value)};else if(e instanceof nw)t={delete:jd(n,e.key)};else if(e instanceof ds)t={update:Bk(n,e.key,e.data),updateMask:J8(e.fieldMask)};else{if(!(e instanceof u2))return Z();t={verify:jd(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof uc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Bl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Fl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof cc)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw Z()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:H8(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Z()}(n,e.precondition)),t}function X0(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Rn.updateTime(on(s.updateTime)):s.exists!==void 0?Rn.exists(s.exists):Rn.none()}(e.currentDocument):Rn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,l){let a=null;if("setToServerValue"in l)ee(l.setToServerValue==="REQUEST_TIME"),a=new uc;else if("appendMissingElements"in l){const c=l.appendMissingElements.values||[];a=new Bl(c)}else if("removeAllFromArray"in l){const c=l.removeAllFromArray.values||[];a=new Fl(c)}else"increment"in l?a=new cc(o,l.increment):Z();const u=Qe.fromServerFormat(l.fieldPath);return new P8(u,a)}(n,i)):[];if(e.update){e.update.name;const i=Ks(n,e.update.name),s=new pn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const u=a.fieldPaths||[];return new Wn(u.map(c=>Qe.fromServerFormat(c)))}(e.updateMask);return new ds(i,s,o,t,r)}return new ea(i,s,t,r)}if(e.delete){const i=Ks(n,e.delete);return new nw(i,t)}if(e.verify){const i=Ks(n,e.verify);return new u2(i,t)}return Z()}function K8(n,e){return n&&n.length>0?(ee(e!==void 0),n.map(t=>function(i,s){let o=i.updateTime?on(i.updateTime):on(s);return o.isEqual(te.min())&&(o=on(s)),new D8(o,i.transformResults||[])}(t,e))):[]}function v2(n,e){return{documents:[m2(n,e.path)]}}function w2(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=m2(n,i);const s=function(u){if(u.length!==0)return S2(Pe.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(c=>function(d){return{field:No(d.field),direction:G8(d.dir)}}(c))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=Q0(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i}}function _2(n){let e=g2(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){ee(r===1);const c=t.from[0];c.allDescendants?i=c.collectionId:e=e.child(c.collectionId)}let s=[];t.where&&(s=function(f){const d=x2(f);return d instanceof Pe&&Z1(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(d=>function(y){return new zd(Vo(y.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(d))}(t.orderBy));let l=null;t.limit&&(l=function(f){let d;return d=typeof f=="object"?f.value:f,Mp(d)?null:d}(t.limit));let a=null;t.startAt&&(a=function(f){const d=!!f.before,p=f.values||[];return new Vl(p,d)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const d=!f.before,p=f.values||[];return new Vl(p,d)}(t.endAt)),y8(e,i,o,s,l,"F",a,u)}function Q8(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Z()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function x2(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Vo(t.unaryFilter.field);return ve.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Vo(t.unaryFilter.field);return ve.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Vo(t.unaryFilter.field);return ve.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Vo(t.unaryFilter.field);return ve.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Z()}}(n):n.fieldFilter!==void 0?function(t){return ve.create(Vo(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Z()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Pe.create(t.compositeFilter.filters.map(r=>x2(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Z()}}(t.compositeFilter.op))}(n):Z()}function G8(n){return z8[n]}function Y8(n){return $8[n]}function X8(n){return U8[n]}function No(n){return{fieldPath:n.canonicalString()}}function Vo(n){return Qe.fromServerFormat(n.fieldPath)}function S2(n){return n instanceof ve?function(t){if(t.op==="=="){if(xk(t.value))return{unaryFilter:{field:No(t.field),op:"IS_NAN"}};if(_k(t.value))return{unaryFilter:{field:No(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(xk(t.value))return{unaryFilter:{field:No(t.field),op:"IS_NOT_NAN"}};if(_k(t.value))return{unaryFilter:{field:No(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:No(t.field),op:Y8(t.op),value:t.value}}}(n):n instanceof Pe?function(t){const r=t.getFilters().map(i=>S2(i));return r.length===1?r[0]:{compositeFilter:{op:X8(t.op),filters:r}}}(n):Z()}function J8(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function b2(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr{constructor(e,t,r,i,s=te.min(),o=te.min(),l=ft.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=a}withSequenceNumber(e){return new Xr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Xr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k2{constructor(e){this.ct=e}}function Z8(n,e){let t;if(e.document)t=W8(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=K.fromSegments(e.noDocument.path),i=co(e.noDocument.readTime);t=et.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Z();{const r=K.fromSegments(e.unknownDocument.path),i=co(e.unknownDocument.version);t=et.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Ye(i[0],i[1]);return te.fromTimestamp(s)}(e.readTime)),t}function Fk(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Wd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:jd(s,o.key),fields:o.data.value.mapValue.fields,updateTime:zl(s,o.version.toTimestamp()),createTime:zl(s,o.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:uo(e.version)};else{if(!e.isUnknownDocument())return Z();r.unknownDocument={path:t.path.toArray(),version:uo(e.version)}}return r}function Wd(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function uo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function co(n){const e=new Ye(n.seconds,n.nanoseconds);return te.fromTimestamp(e)}function Rs(n,e){const t=(e.baseMutations||[]).map(s=>X0(n.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>X0(n.ct,s)),i=Ye.fromMillis(e.localWriteTimeMs);return new rw(e.batchId,i,t,r)}function Ga(n){const e=co(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?co(n.lastLimboFreeSnapshotVersion):te.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){return ee(s.documents.length===1),Gn(ew(g2(s.documents[0])))}(n.query):function(s){return Gn(_2(s))}(n.query),new Xr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,ft.fromBase64String(n.resumeToken))}function E2(n,e){const t=uo(e.snapshotVersion),r=uo(e.lastLimboFreeSnapshotVersion);let i;i=$d(e.target)?v2(n.ct,e.target):w2(n.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ao(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function T2(n){const e=_2({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?K0(e,e.limit,"L"):e}function Cg(n,e){return new sw(e.largestBatchId,X0(n.ct,e.overlayMutation))}function zk(n,e){const t=e.path.lastSegment();return[n,sn(e.path.popLast()),t]}function $k(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:uo(r.readTime),documentKey:sn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{getBundleMetadata(e,t){return Uk(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:co(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return Uk(e).put(function(i){return{bundleId:i.id,createTime:uo(on(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return jk(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:T2(s.bundledQuery),readTime:co(s.readTime)}}(r)})}saveNamedQuery(e,t){return jk(e).put(function(i){return{name:i.name,readTime:uo(on(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function Uk(n){return yt(n,"bundles")}function jk(n){return yt(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new $p(e,r)}getOverlay(e,t){return Pa(e).get(zk(this.userId,t)).next(r=>r?Cg(this.serializer,r):null)}getOverlays(e,t){const r=Pr();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const l=new sw(t,o);i.push(this.ht(e,l))}),V.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(sn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Pa(e).j("collectionPathOverlayIndex",l))}),V.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Pr(),s=sn(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Pa(e).U("collectionPathOverlayIndex",o).next(l=>{for(const a of l){const u=Cg(this.serializer,a);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Pr();let o;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Pa(e).J({index:"collectionGroupOverlayIndex",range:l},(a,u,c)=>{const f=Cg(this.serializer,u);s.size()<i||f.largestBatchId===o?(s.set(f.getKey(),f),o=f.largestBatchId):c.done()}).next(()=>s)}ht(e,t){return Pa(e).put(function(i,s,o){const[l,a,u]=zk(s,o.mutation.key);return{userId:s,collectionPath:a,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Hd(i.ct,o.mutation)}}(this.serializer,this.userId,t))}}function Pa(n){return yt(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{Pt(e){return yt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?ft.fromUint8Array(r):ft.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(je(e.integerValue));else if("doubleValue"in e){const r=je(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),sc(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=ui(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(is(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?$R(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Np(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Z()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;const s=e.fields||{};this.dt(t,53);const o="value",l=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(je(l)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),K.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Ds.vt=new Ds;function nU(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function Hk(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=nU(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}class rU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),r=Hk(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),r=Hk(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class iU{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class sU{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Ra{constructor(){this.jt=new rU,this.Ht=new iU(this.jt),this.Jt=new sU(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Os(this.indexId,this.documentKey,this.arrayValue,r)}}function vi(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=Wk(n.arrayValue,e.arrayValue),t!==0?t:(t=Wk(n.directionalValue,e.directionalValue),t!==0?t:K.comparator(n.documentKey,e.documentKey)))}function Wk(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qk{constructor(e){this.Xt=new Re((t,r)=>Qe.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ee(e.collectionGroup===this.collectionId),this.nn)return!1;const t=z0(e);if(t!==void 0&&!this.sn(t))return!1;const r=Cs(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const a=r[s];if(!this.on(l,a)||!this._n(this.en[o++],a))return!1}++s}for(;s<r.length;++s){const l=r[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Re(Qe.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new kf(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new kf(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new kf(r.field,r.dir==="asc"?0:1)));return new Fd(Fd.UNKNOWN_ID,this.collectionId,t,ic.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C2(n){var e,t;if(ee(n instanceof ve||n instanceof Pe),n instanceof ve){if(n instanceof YR){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>ve.create(n.field,"==",s)))||[];return Pe.create(i,"or")}return n}const r=n.filters.map(i=>C2(i));return Pe.create(r,n.op)}function oU(n){if(n.getFilters().length===0)return[];const e=ev(C2(n));return ee(A2(e)),J0(e)||Z0(e)?[e]:e.getFilters()}function J0(n){return n instanceof ve}function Z0(n){return n instanceof Pe&&Z1(n)}function A2(n){return J0(n)||Z0(n)||function(t){if(t instanceof Pe&&H0(t)){for(const r of t.getFilters())if(!J0(r)&&!Z0(r))return!1;return!0}return!1}(n)}function ev(n){if(ee(n instanceof ve||n instanceof Pe),n instanceof ve)return n;if(n.filters.length===1)return ev(n.filters[0]);const e=n.filters.map(r=>ev(r));let t=Pe.create(e,n.op);return t=qd(t),A2(t)?t:(ee(t instanceof Pe),ee(Ll(t)),ee(t.filters.length>1),t.filters.reduce((r,i)=>aw(r,i)))}function aw(n,e){let t;return ee(n instanceof ve||n instanceof Pe),ee(e instanceof ve||e instanceof Pe),t=n instanceof ve?e instanceof ve?function(i,s){return Pe.create([i,s],"and")}(n,e):Kk(n,e):e instanceof ve?Kk(e,n):function(i,s){if(ee(i.filters.length>0&&s.filters.length>0),Ll(i)&&Ll(s))return KR(i,s.getFilters());const o=H0(i)?i:s,l=H0(i)?s:i,a=o.filters.map(u=>aw(u,l));return Pe.create(a,"or")}(n,e),qd(t)}function Kk(n,e){if(Ll(e))return KR(e,n.getFilters());{const t=e.filters.map(r=>aw(n,r));return Pe.create(t,"or")}}function qd(n){if(ee(n instanceof ve||n instanceof Pe),n instanceof ve)return n;const e=n.getFilters();if(e.length===1)return qd(e[0]);if(WR(n))return n;const t=e.map(i=>qd(i)),r=[];return t.forEach(i=>{i instanceof ve?r.push(i):i instanceof Pe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Pe.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lU{constructor(){this.un=new uw}addToCollectionParentIndex(e,t){return this.un.add(t),V.resolve()}getCollectionParents(e,t){return V.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return V.resolve()}deleteFieldIndex(e,t){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,t){return V.resolve()}getDocumentsMatchingTarget(e,t){return V.resolve(null)}getIndexType(e,t){return V.resolve(0)}getFieldIndexes(e,t){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,t){return V.resolve(Mn.min())}getMinOffsetFromCollectionGroup(e,t){return V.resolve(Mn.min())}updateCollectionGroup(e,t,r){return V.resolve()}updateIndexEntries(e,t){return V.resolve()}}class uw{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Re(Ae.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Re(Ae.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zh=new Uint8Array(0);class aU{constructor(e,t){this.databaseId=t,this.cn=new uw,this.ln=new fs(r=>ao(r),(r,i)=>Tc(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:r,parent:sn(i)};return Qk(e).put(s)}return V.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[PR(t),""],!1,!0);return Qk(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(Ir(o.parent))}return r})}addFieldIndex(e,t){const r=Da(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=Io(e);return s.next(l=>{o.put($k(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Da(e),i=Io(e),s=Ao(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Da(e),r=Ao(e),i=Io(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return V.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new qk(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=Ao(e);let i=!0;const s=new Map;return V.forEach(this.hn(t),o=>this.Pn(e,o).next(l=>{i&&(i=!!l),s.set(o,l)})).next(()=>{if(i){let o=de();const l=[];return V.forEach(s,(a,u)=>{z("IndexedDbIndexManager",`Using index ${function(b){return`id=${b.indexId}|cg=${b.collectionGroup}|f=${b.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(a)} to execute ${ao(t)}`);const c=function(b,I){const D=z0(I);if(D===void 0)return null;for(const M of Ud(b,D.fieldPath))switch(M.op){case"array-contains-any":return M.value.arrayValue.values||[];case"array-contains":return[M.value]}return null}(u,a),f=function(b,I){const D=new Map;for(const M of Cs(I))for(const x of Ud(b,M.fieldPath))switch(x.op){case"==":case"in":D.set(M.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return D.set(M.fieldPath.canonicalString(),x.value),Array.from(D.values())}return null}(u,a),d=function(b,I){const D=[];let M=!0;for(const x of Cs(I)){const S=x.kind===0?Tk(b,x.fieldPath,b.startAt):Ck(b,x.fieldPath,b.startAt);D.push(S.value),M&&(M=S.inclusive)}return new Vl(D,M)}(u,a),p=function(b,I){const D=[];let M=!0;for(const x of Cs(I)){const S=x.kind===0?Ck(b,x.fieldPath,b.endAt):Tk(b,x.fieldPath,b.endAt);D.push(S.value),M&&(M=S.inclusive)}return new Vl(D,M)}(u,a),y=this.In(a,u,d),v=this.In(a,u,p),E=this.Tn(a,u,f),w=this.En(a.indexId,c,y,d.inclusive,v,p.inclusive,E);return V.forEach(w,_=>r.G(_,t.limit).next(b=>{b.forEach(I=>{const D=K.fromSegments(I.documentKey);o.has(D)||(o=o.add(D),l.push(D))})}))}).next(()=>l)}return V.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=oU(Pe.create(e.filters,"and")).map(r=>q0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,l){const a=(t!=null?t.length:1)*Math.max(r.length,s.length),u=a/(t!=null?t.length:1),c=[];for(let f=0;f<a;++f){const d=t?this.dn(t[f/u]):zh,p=this.An(e,d,r[f%u],i),y=this.Rn(e,d,s[f%u],o),v=l.map(E=>this.An(e,d,E,!0));c.push(...this.createRange(p,y,v))}return c}An(e,t,r,i){const s=new Os(e,K.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){const s=new Os(e,K.empty(),t,r);return i?s.Zt():s}Pn(e,t){const r=new qk(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const l of s)r.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let r=2;const i=this.hn(t);return V.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(a){let u=new Re(Qe.comparator),c=!1;for(const f of a.filters)for(const d of f.getFlattenedFilters())d.field.isKeyField()||(d.op==="array-contains"||d.op==="array-contains-any"?c=!0:u=u.add(d.field));for(const f of a.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(c?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){const r=new Ra;for(const i of Cs(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);Ds.vt.It(s,o)}return r.zt()}dn(e){const t=new Ra;return Ds.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new Ra;return Ds.vt.It(J1(this.databaseId,t),r.Yt(function(s){const o=Cs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new Ra);let s=0;for(const o of Cs(e)){const l=r[s++];for(const a of i)if(this.fn(t,o.fieldPath)&&ac(l))i=this.gn(i,o,l);else{const u=a.Yt(o.kind);Ds.vt.It(l,u)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const l of i){const a=new Ra;a.seed(l.zt()),Ds.vt.It(o,a.Yt(t.kind)),s.push(a)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof ve&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Da(e),i=Io(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{const o=[];return V.forEach(s,l=>i.get([l.indexId,this.uid]).next(a=>{o.push(function(c,f){const d=f?new ic(f.sequenceNumber,new Mn(co(f.readTime),new K(Ir(f.documentKey)),f.largestBatchId)):ic.empty(),p=c.fields.map(([y,v])=>new kf(Qe.fromServerFormat(y),v));return new Fd(c.indexId,c.collectionGroup,p,d)}(l,a))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:le(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Da(e),s=Io(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(l=>V.forEach(l,a=>s.put($k(a.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return V.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),V.forEach(l,a=>this.wn(e,i,a).next(u=>{const c=this.Sn(s,a);return u.isEqual(c)?V.resolve():this.bn(e,s,a,u,c)}))))})}Dn(e,t,r,i){return Ao(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Ao(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=Ao(e);let s=new Re(vi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,l)=>{s=s.add(new Os(r.indexId,t,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,t){let r=new Re(vi);const i=this.Vn(t,e);if(i==null)return r;const s=z0(t);if(s!=null){const o=e.data.field(s.fieldPath);if(ac(o))for(const l of o.arrayValue.values||[])r=r.add(new Os(t.indexId,e.key,this.dn(l),i))}else r=r.add(new Os(t.indexId,e.key,zh,i));return r}bn(e,t,r,i,s){z("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(a,u,c,f,d){const p=a.getIterator(),y=u.getIterator();let v=Co(p),E=Co(y);for(;v||E;){let w=!1,_=!1;if(v&&E){const b=c(v,E);b<0?_=!0:b>0&&(w=!0)}else v!=null?_=!0:w=!0;w?(f(E),E=Co(y)):_?(d(v),v=Co(p)):(v=Co(p),E=Co(y))}}(i,s,vi,l=>{o.push(this.Dn(e,t,r,l))},l=>{o.push(this.vn(e,t,r,l))}),V.waitFor(o)}yn(e){let t=1;return Io(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,l)=>vi(o,l)).filter((o,l,a)=>!l||vi(o,a[l-1])!==0);const i=[];i.push(e);for(const o of r){const l=vi(o,e),a=vi(o,t);if(l===0)i[0]=e.Zt();else if(l>0&&a<0)i.push(o),i.push(o.Zt());else if(a>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const l=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,zh,[]],a=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,zh,[]];s.push(IDBKeyRange.bound(l,a))}return s}Cn(e,t){return vi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Gk)}getMinOffset(e,t){return V.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||Z())).next(Gk)}}function Qk(n){return yt(n,"collectionParents")}function Ao(n){return yt(n,"indexEntries")}function Da(n){return yt(n,"indexConfiguration")}function Io(n){return yt(n,"indexState")}function Gk(n){ee(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;K1(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Mn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class un{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new un(e,un.DEFAULT_COLLECTION_PERCENTILE,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const a=r.J({range:o},(c,f,d)=>(l++,d.delete()));s.push(a.next(()=>{ee(l===1)}));const u=[];for(const c of t.mutations){const f=NR(e,c.key.path,t.batchId);s.push(i.delete(f)),u.push(c.key)}return V.waitFor(s).next(()=>u)}function Kd(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Z();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */un.DEFAULT_COLLECTION_PERCENTILE=10,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,un.DEFAULT=new un(41943040,un.DEFAULT_COLLECTION_PERCENTILE,un.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),un.DISABLED=new un(-1,0,0);class Up{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){ee(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Up(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return wi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=Lo(e),o=wi(e);return o.add({}).next(l=>{ee(typeof l=="number");const a=new rw(l,t,r,i),u=function(p,y,v){const E=v.baseMutations.map(_=>Hd(p.ct,_)),w=v.mutations.map(_=>Hd(p.ct,_));return{userId:y,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:E,mutations:w}}(this.serializer,this.userId,a),c=[];let f=new Re((d,p)=>le(d.canonicalString(),p.canonicalString()));for(const d of i){const p=NR(this.userId,d.key.path,l);f=f.add(d.key.path.popLast()),c.push(o.put(u)),c.push(s.put(p,$$))}return f.forEach(d=>{c.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Fn[l]=a.keys()}),V.waitFor(c).next(()=>a)})}lookupMutationBatch(e,t){return wi(e).get(t).next(r=>r?(ee(r.userId===this.userId),Rs(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?V.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return wi(e).J({index:"userMutationsIndex",range:i},(o,l,a)=>{l.userId===this.userId&&(ee(l.batchId>=r),s=Rs(this.serializer,l)),a.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return wi(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return wi(e).U("userMutationsIndex",t).next(r=>r.map(i=>Rs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Ef(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Lo(e).J({range:i},(o,l,a)=>{const[u,c,f]=o,d=Ir(c);if(u===this.userId&&t.path.isEqual(d))return wi(e).get(f).next(p=>{if(!p)throw Z();ee(p.userId===this.userId),s.push(Rs(this.serializer,p))});a.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(le);const i=[];return t.forEach(s=>{const o=Ef(this.userId,s.path),l=IDBKeyRange.lowerBound(o),a=Lo(e).J({range:l},(u,c,f)=>{const[d,p,y]=u,v=Ir(p);d===this.userId&&s.path.isEqual(v)?r=r.add(y):f.done()});i.push(a)}),V.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=Ef(this.userId,r),o=IDBKeyRange.lowerBound(s);let l=new Re(le);return Lo(e).J({range:o},(a,u,c)=>{const[f,d,p]=a,y=Ir(d);f===this.userId&&r.isPrefixOf(y)?y.length===i&&(l=l.add(p)):c.done()}).next(()=>this.xn(e,l))}xn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(wi(e).get(s).next(o=>{if(o===null)throw Z();ee(o.userId===this.userId),r.push(Rs(this.serializer,o))}))}),V.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return I2(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),V.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Lo(e).J({range:r},(s,o,l)=>{if(s[0]===this.userId){const a=Ir(s[1]);i.push(a)}else l.done()}).next(()=>{ee(i.length===0)})})}containsKey(e,t){return P2(e,this.userId,t)}Nn(e){return R2(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function P2(n,e,t){const r=Ef(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Lo(n).J({range:s,H:!0},(l,a,u)=>{const[c,f,d]=l;c===e&&f===i&&(o=!0),u.done()}).next(()=>o)}function wi(n){return yt(n,"mutations")}function Lo(n){return yt(n,"documentMutations")}function R2(n){return yt(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ho(0)}static kn(){return new ho(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uU{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new ho(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>te.fromTimestamp(new Ye(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Po(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(ee(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Po(e).J((o,l)=>{const a=Ga(l);a.sequenceNumber<=t&&r.get(a.targetId)===null&&(i++,s.push(this.removeTargetData(e,a)))}).next(()=>V.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Po(e).J((r,i)=>{const s=Ga(i);t(s)})}qn(e){return Xk(e).get("targetGlobalKey").next(t=>(ee(t!==null),t))}Qn(e,t){return Xk(e).put("targetGlobalKey",t)}Kn(e,t){return Po(e).put(E2(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=ao(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Po(e).J({range:i,index:"queryTargetsIndex"},(o,l,a)=>{const u=Ga(l);Tc(t,u.target)&&(s=u,a.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Ai(e);return t.forEach(o=>{const l=sn(o.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(i)}removeMatchingKeys(e,t,r){const i=Ai(e);return V.forEach(t,s=>{const o=sn(s.path);return V.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Ai(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ai(e);let s=de();return i.J({range:r,H:!0},(o,l,a)=>{const u=Ir(o[1]),c=new K(u);s=s.add(c)}).next(()=>s)}containsKey(e,t){const r=sn(t.path),i=IDBKeyRange.bound([r],[PR(r)],!1,!0);let s=0;return Ai(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,l],a,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,t){return Po(e).get(t).next(r=>r?Ga(r):null)}}function Po(n){return yt(n,"targets")}function Xk(n){return yt(n,"targetGlobal")}function Ai(n){return yt(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk([n,e],[t,r]){const i=le(n,t);return i===0?le(e,r):i}class cU{constructor(e){this.Un=e,this.buffer=new Re(Jk),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Jk(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class hU{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){z("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hs(t)?z("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await go(t)}await this.Hn(3e5)})}}class fU{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return V.resolve(Hn.oe);const r=new cU(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(z("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(Yk)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Yk):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,l,a,u;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,o=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,l=Date.now(),this.removeTargets(e,r,t))).next(f=>(s=f,a=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),Oo()<=_e.DEBUG&&z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-c}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(a-l)+`ms
	Removed ${f} documents in `+(u-a)+`ms
Total Duration: ${u-c}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:f})))}}function dU(n,e){return new fU(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pU{constructor(e,t){this.db=e,this.garbageCollector=dU(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return $h(e,r)}removeReference(e,t,r){return $h(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return $h(e,t)}nr(e,t){return function(i,s){let o=!1;return R2(i).Y(l=>P2(i,l,s).next(a=>(a&&(o=!0),V.resolve(!a)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,l)=>{if(l<=t){const a=this.nr(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,te.min()),Ai(e).delete(function(f){return[0,sn(f.path)]}(o))))});i.push(a)}}).next(()=>V.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return $h(e,t)}tr(e,t){const r=Ai(e);let i,s=Hn.oe;return r.J({index:"documentTargetsIndex"},([o,l],{path:a,sequenceNumber:u})=>{o===0?(s!==Hn.oe&&t(new K(Ir(i)),s),s=u,i=a):s=Hn.oe}).next(()=>{s!==Hn.oe&&t(new K(Ir(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $h(n,e){return Ai(n).put(function(r,i){return{targetId:0,path:sn(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(){this.changes=new fs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,et.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?V.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Ss(e).put(r)}removeEntry(e,t,r){return Ss(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Wd(o),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=et.newInvalidDocument(t);return Ss(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Oa(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:et.newInvalidDocument(t)};return Ss(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Oa(t))},(i,s)=>{r={document:this.ir(t,s),size:Kd(s)}}).next(()=>r)}getEntries(e,t){let r=Pn();return this._r(e,t,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=Pn(),i=new qe(K.comparator);return this._r(e,t,(s,o)=>{const l=this.ir(s,o);r=r.insert(s,l),i=i.insert(s,Kd(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return V.resolve();let i=new Re(tE);t.forEach(a=>i=i.add(a));const s=IDBKeyRange.bound(Oa(i.first()),Oa(i.last())),o=i.getIterator();let l=o.getNext();return Ss(e).J({index:"documentKeyIndex",range:s},(a,u,c)=>{const f=K.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&tE(l,f)<0;)r(l,null),l=o.getNext();l&&l.isEqual(f)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?c.$(Oa(l)):c.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Wd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ss(e).U(IDBKeyRange.bound(l,a,!0)).next(u=>{s==null||s.incrementDocumentReadCount(u.length);let c=Pn();for(const f of u){const d=this.ir(K.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);d.isFoundDocument()&&(Cc(t,d)||i.has(d.key))&&(c=c.insert(d.key,d))}return c})}getAllFromCollectionGroup(e,t,r,i){let s=Pn();const o=eE(t,r),l=eE(t,Mn.max());return Ss(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(a,u,c)=>{const f=this.ir(K.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(f.key,f),s.size===i&&c.done()}).next(()=>s)}newChangeBuffer(e){return new gU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Zk(e).get("remoteDocumentGlobalKey").next(t=>(ee(!!t),t))}rr(e,t){return Zk(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=Z8(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(te.min())))return r}return et.newInvalidDocument(e)}}function O2(n){return new mU(n)}class gU extends D2{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new fs(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new Re((s,o)=>le(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const a=Fk(this.cr.serializer,o);i=i.add(s.path.popLast());const u=Kd(a);r+=u-l.size,t.push(this.cr.addEntry(e,s,a))}else if(r-=l.size,this.trackRemovals){const a=Fk(this.cr.serializer,o.convertToNoDocument(te.min()));t.push(this.cr.addEntry(e,s,a))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),V.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Zk(n){return yt(n,"remoteDocumentGlobal")}function Ss(n){return yt(n,"remoteDocumentsV14")}function Oa(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function eE(n,e){const t=e.documentKey.path.toArray();return[n,Wd(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function tE(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=le(t[s],r[s]),i)return i;return i=le(t.length,r.length),i||(i=le(t[t.length-2],r[r.length-2]),i||le(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yU{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&gu(r.mutation,i,Wn.empty(),Ye.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,de()).next(()=>r))}getLocalViewOfDocuments(e,t,r=de()){const i=Pr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Ka();return s.forEach((l,a)=>{o=o.insert(l,a.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Pr();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,de()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,r,i){let s=Pn();const o=mu(),l=function(){return mu()}();return t.forEach((a,u)=>{const c=r.get(u.key);i.has(u.key)&&(c===void 0||c.mutation instanceof ds)?s=s.insert(u.key,u):c!==void 0?(o.set(u.key,c.mutation.getFieldMask()),gu(c.mutation,u,c.mutation.getFieldMask(),Ye.now())):o.set(u.key,Wn.empty())}),this.recalculateAndSaveOverlays(e,s).next(a=>(a.forEach((u,c)=>o.set(u,c)),t.forEach((u,c)=>{var f;return l.set(u,new yU(c,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,t){const r=mu();let i=new qe((o,l)=>o-l),s=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(a=>{const u=t.get(a);if(u===null)return;let c=r.get(a)||Wn.empty();c=l.applyToLocalView(u,c),r.set(a,c);const f=(i.get(l.batchId)||de()).add(a);i=i.insert(l.batchId,f)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const a=l.getNext(),u=a.key,c=a.value,f=t2();c.forEach(d=>{if(!s.has(d)){const p=l2(t.get(d),r.get(d));p!==null&&f.set(d,p),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return K.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):v8(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):V.resolve(Pr());let l=-1,a=s;return o.next(u=>V.forEach(u,(c,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),s.get(c)?V.resolve():this.remoteDocumentCache.getEntry(e,c).next(d=>{a=a.insert(c,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,a,u,de())).next(c=>({batchId:l,changes:e2(c)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new K(t)).next(r=>{let i=Ka();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Ka();return this.indexManager.getCollectionParents(e,s).next(l=>V.forEach(l,a=>{const u=function(f,d){return new Vp(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(c=>{c.forEach((f,d)=>{o=o.insert(f,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((a,u)=>{const c=u.getKey();o.get(c)===null&&(o=o.insert(c,et.newInvalidDocument(c)))});let l=Ka();return o.forEach((a,u)=>{const c=s.get(a);c!==void 0&&gu(c.mutation,u,Wn.empty(),Ye.now()),Cc(t,u)&&(l=l.insert(a,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return V.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:on(i.createTime)}}(t)),V.resolve()}getNamedQuery(e,t){return V.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:T2(i.bundledQuery),readTime:on(i.readTime)}}(t)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{constructor(){this.overlays=new qe(K.comparator),this.Ir=new Map}getOverlay(e,t){return V.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Pr();return V.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),V.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),V.resolve()}getOverlaysForCollection(e,t,r){const i=Pr(),s=t.length+1,o=new K(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const a=l.getNext().value,u=a.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&a.largestBatchId>r&&i.set(a.getKey(),a)}return V.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new qe((u,c)=>u-c);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let c=s.get(u.largestBatchId);c===null&&(c=Pr(),s=s.insert(u.largestBatchId,c)),c.set(u.getKey(),u)}}const l=Pr(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((u,c)=>l.set(u,c)),!(l.size()>=i)););return V.resolve(l)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new sw(t,r));let s=this.Ir.get(t);s===void 0&&(s=de(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(){this.sessionToken=ft.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(){this.Tr=new Re(vt.Er),this.dr=new Re(vt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new vt(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new vt(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new K(new Ae([])),r=new vt(t,e),i=new vt(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new K(new Ae([])),r=new vt(t,e),i=new vt(t,e+1);let s=de();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new vt(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class vt{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return K.comparator(e.key,t.key)||le(e.wr,t.wr)}static Ar(e,t){return le(e.wr,t.wr)||K.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Re(vt.Er)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new rw(s,t,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new vt(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,t){return V.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),s=i<0?0:i;return V.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new vt(t,0),i=new vt(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),V.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Re(le);return t.forEach(i=>{const s=new vt(i,0),o=new vt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),V.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;K.isDocumentKey(s)||(s=s.child(""));const o=new vt(new K(s),0);let l=new Re(le);return this.br.forEachWhile(a=>{const u=a.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(l=l.add(a.wr)),!0)},o),V.resolve(this.Cr(l))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ee(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return V.forEach(t.mutations,i=>{const s=new vt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new vt(t,0),i=this.br.firstAfterOrEqual(r);return V.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SU{constructor(e){this.Mr=e,this.docs=function(){return new qe(K.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return V.resolve(r?r.document.mutableCopy():et.newInvalidDocument(t))}getEntries(e,t){let r=Pn();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():et.newInvalidDocument(i))}),V.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Pn();const o=t.path,l=new K(o.child("")),a=this.docs.getIteratorFrom(l);for(;a.hasNext();){const{key:u,value:{document:c}}=a.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||K1(RR(c),r)<=0||(i.has(c.key)||Cc(t,c))&&(s=s.insert(c.key,c.mutableCopy()))}return V.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Z()}Or(e,t){return V.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new bU(this)}getSize(e){return V.resolve(this.size)}}class bU extends D2{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),V.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kU{constructor(e){this.persistence=e,this.Nr=new fs(t=>ao(t),Tc),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.Lr=0,this.Br=new cw,this.targetCount=0,this.kr=ho.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),V.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new ho(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,V.resolve()}updateTargetData(e,t){return this.Kn(t),V.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),V.waitFor(s).next(()=>i)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return V.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),V.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),V.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),V.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return V.resolve(r)}containsKey(e,t){return V.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Hn(0),this.Kr=!1,this.Kr=!0,this.$r=new _U,this.referenceDelegate=e(this),this.Ur=new kU(this),this.indexManager=new lU,this.remoteDocumentCache=function(i){return new SU(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new k2(t),this.Gr=new vU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new wU,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new xU(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){z("MemoryPersistence","Starting transaction:",e);const i=new EU(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return V.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class EU extends OR{constructor(e){super(),this.currentSequenceNumber=e}}class jp{constructor(e){this.persistence=e,this.Jr=new cw,this.Yr=null}static Zr(e){return new jp(e)}get Xr(){if(this.Yr)return this.Yr;throw Z()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),V.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),V.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.Xr,r=>{const i=K.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,te.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return V.or([()=>V.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(e){this.serializer=e}O(e,t,r,i){const s=new Op("createOrUpgrade",t);r<1&&i>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mk,{unique:!0}),a.createObjectStore("documentMutations")}(e),nE(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=V.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),nE(e)),o=o.next(()=>function(a){const u=a.store("targetGlobal"),c={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:te.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",c)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(a,u){return u.store("mutations").U().next(c=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mk,{unique:!0});const f=u.store("mutations"),d=c.map(p=>f.put(p));return V.waitFor(d)})}(e,s))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(a){const u=a.createObjectStore("documentOverlays",{keyPath:Z$});u.createIndex("collectionPathOverlayIndex",e8,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",t8,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(a){const u=a.createObjectStore("remoteDocumentsV14",{keyPath:U$});u.createIndex("documentKeyIndex",j$),u.createIndex("collectionGroupIndex",H$)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:G$}).createIndex("sequenceNumberIndex",Y$,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:X$}).createIndex("documentKeyIndex",J$,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(a){a.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=Kd(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>V.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(l=>V.forEach(l,a=>{ee(a.userId===s.userId);const u=Rs(this.serializer,a);return I2(e,s.userId,u).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,l)=>{const a=new Ae(o),u=function(f){return[0,sn(f)]}(a);s.push(t.get(u).next(c=>c?V.resolve():(f=>t.put({targetId:0,path:sn(f),sequenceNumber:i.highestListenSequenceNumber}))(a)))}).next(()=>V.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:Q$});const r=t.store("collectionParents"),i=new uw,s=o=>{if(i.add(o)){const l=o.lastSegment(),a=o.popLast();return r.put({collectionId:l,parent:sn(a)})}};return t.store("remoteDocuments").J({H:!0},(o,l)=>{const a=new Ae(o);return s(a.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,l,a],u)=>{const c=Ir(l);return s(c.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,i)=>{const s=Ga(i),o=E2(this.serializer,s);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{const l=t.store("remoteDocumentsV14"),a=function(f){return f.document?new K(Ae.fromString(f.document.name).popFirst(5)):f.noDocument?K.fromSegments(f.noDocument.path):f.unknownDocument?K.fromSegments(f.unknownDocument.path):Z()}(o).path.toArray(),u={prefixPath:a.slice(0,a.length-2),collectionGroup:a[a.length-2],documentId:a[a.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(u))}).next(()=>V.waitFor(i))}ai(e,t){const r=t.store("mutations"),i=O2(this.serializer),s=new N2(jp.Zr,this.serializer.ct);return r.U().next(o=>{const l=new Map;return o.forEach(a=>{var u;let c=(u=l.get(a.userId))!==null&&u!==void 0?u:de();Rs(this.serializer,a).keys().forEach(f=>c=c.add(f)),l.set(a.userId,c)}),V.forEach(l,(a,u)=>{const c=new It(u),f=$p.lt(this.serializer,c),d=s.getIndexManager(c),p=Up.lt(c,this.serializer,d,s.referenceDelegate);return new M2(i,p,f,d).recalculateAndSaveOverlaysForDocumentKeys(new $0(t,Hn.oe),a).next()})})}}function nE(n){n.createObjectStore("targetDocuments",{keyPath:q$}).createIndex("documentTargetsIndex",K$,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",W$,{unique:!0}),n.createObjectStore("targetGlobal")}const Ag="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class hw{constructor(e,t,r,i,s,o,l,a,u,c,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=l,this.ci=u,this.li=c,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=d=>Promise.resolve(),!hw.D())throw new X(F.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new pU(this,i),this.Ai=t+"main",this.serializer=new k2(a),this.Ri=new Gi(this.Ai,this.hi,new TU(this.serializer)),this.$r=new tU,this.Ur=new uU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=O2(this.serializer),this.Gr=new eU,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,c===!1&&en("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new X(F.FAILED_PRECONDITION,Ag);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Hn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Uh(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(hs(e))return z("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return z("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Ma(e).get("owner").next(t=>V.resolve(this.vi(t)))}Ci(e){return Uh(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=yt(t,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(l=>s.indexOf(l)===-1);return V.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?V.resolve(!0):Ma(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new X(F.FAILED_PRECONDITION,Ag);return!1}}return!(!this.networkEnabled||!this.inForeground)||Uh(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&z("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new $0(e,Hn.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Uh(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Up.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new aU(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return $p.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){z("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(a){return a===17?i8:a===16?r8:a===15?G1:a===14?BR:a===13?LR:a===12?n8:a===11?VR:void Z()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,l=>(o=new $0(l,this.Qr?this.Qr.next():Hn.oe),t==="readwrite-primary"?this.wi(o).next(a=>!!a||this.Si(o)).next(a=>{if(!a)throw en(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new X(F.FAILED_PRECONDITION,DR);return r(o)}).next(a=>this.Di(o).next(()=>a)):this.Ki(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return Ma(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new X(F.FAILED_PRECONDITION,Ag)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ma(e).put("owner",t)}static D(){return Gi.D()}bi(e){const t=Ma(e);return t.get("owner").next(r=>this.vi(r)?(z("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):V.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(en(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;dR()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return z("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return en("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){en("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ma(n){return yt(n,"owner")}function Uh(n){return yt(n,"clientMetadata")}function CU(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=de(),i=de();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new fw(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return dR()?8:MR(Vd())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new AU;return this.Xi(e,t,o).next(l=>{if(s.result=l,this.zi)return this.es(e,t,o,l.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Oo()<=_e.DEBUG&&z("QueryEngine","SDK will not create cache indexes for query:",Mo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),V.resolve()):(Oo()<=_e.DEBUG&&z("QueryEngine","Query:",Mo(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Oo()<=_e.DEBUG&&z("QueryEngine","The SDK decides to create cache indexes for query:",Mo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Gn(t))):V.resolve())}Yi(e,t){if(Ak(t))return V.resolve(null);let r=Gn(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=K0(t,null,"F"),r=Gn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=de(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(a=>{const u=this.ts(t,l);return this.ns(t,u,o,a.readTime)?this.Yi(e,K0(t,null,"F")):this.rs(e,u,t,a)}))})))}Zi(e,t,r,i){return Ak(t)||i.isEqual(te.min())?V.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?V.resolve(null):(Oo()<=_e.DEBUG&&z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Mo(t)),this.rs(e,o,t,M$(i,-1)).next(l=>l))})}ts(e,t){let r=new Re(JR(e));return t.forEach((i,s)=>{Cc(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Oo()<=_e.DEBUG&&z("QueryEngine","Using full collection scan to execute query:",Mo(t)),this.Ji.getDocumentsMatchingQuery(e,t,Mn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IU{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new qe(le),this._s=new fs(s=>ao(s),Tc),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new M2(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function L2(n,e,t,r){return new IU(n,e,t,r)}async function B2(n,e){const t=oe(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let a=de();for(const u of i){o.push(u.batchId);for(const c of u.mutations)a=a.add(c.key)}for(const u of s){l.push(u.batchId);for(const c of u.mutations)a=a.add(c.key)}return t.localDocuments.getDocuments(r,a).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function PU(n,e){const t=oe(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(l,a,u,c){const f=u.batch,d=f.keys();let p=V.resolve();return d.forEach(y=>{p=p.next(()=>c.getEntry(a,y)).next(v=>{const E=u.docVersions.get(y);ee(E!==null),v.version.compareTo(E)<0&&(f.applyToRemoteDocument(v,u),v.isValidDocument()&&(v.setReadTime(u.commitVersion),c.addEntry(v)))})}),p.next(()=>l.mutationQueue.removeMutationBatch(a,f))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let a=de();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(a=a.add(l.batch.mutations[u].key));return a}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function F2(n){const e=oe(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function RU(n,e){const t=oe(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const l=[];e.targetChanges.forEach((c,f)=>{const d=i.get(f);if(!d)return;l.push(t.Ur.removeMatchingKeys(s,c.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(s,c.addedDocuments,f)));let p=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(ft.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):c.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(c.resumeToken,r)),i=i.insert(f,p),function(v,E,w){return v.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(d,p,c)&&l.push(t.Ur.updateTargetData(s,p))});let a=Pn(),u=de();if(e.documentUpdates.forEach(c=>{e.resolvedLimboDocuments.has(c)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,c))}),l.push(DU(s,o,e.documentUpdates).next(c=>{a=c.Ps,u=c.Is})),!r.isEqual(te.min())){const c=t.Ur.getLastRemoteSnapshotVersion(s).next(f=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(c)}return V.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,a,u)).next(()=>a)}).then(s=>(t.os=i,s))}function DU(n,e,t){let r=de(),i=de();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Pn();return t.forEach((l,a)=>{const u=s.get(l);a.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(l)),a.isNoDocument()&&a.version.isEqual(te.min())?(e.removeEntry(l,a.readTime),o=o.insert(l,a)):!u.isValidDocument()||a.version.compareTo(u.version)>0||a.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(a),o=o.insert(l,a)):z("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",a.version)}),{Ps:o,Is:i}})}function OU(n,e){const t=oe(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function MU(n,e){const t=oe(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,V.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Xr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function tv(n,e,t){const r=oe(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!hs(o))throw o;z("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function rE(n,e,t){const r=oe(n);let i=te.min(),s=de();return r.persistence.runTransaction("Execute query","readwrite",o=>function(a,u,c){const f=oe(a),d=f._s.get(c);return d!==void 0?V.resolve(f.os.get(d)):f.Ur.getTargetData(u,c)}(r,o,Gn(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(a=>{s=a})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:te.min(),t?s:de())).next(l=>(NU(r,_8(e),l),{documents:l,Ts:s})))}function NU(n,e,t){let r=n.us.get(e)||te.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}class iE{constructor(){this.activeTargetIds=T8()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class z2{constructor(){this.so=new iE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new iE,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jh=null;function Ig(){return jh===null?jh=function(){return 268435456+Math.round(2147483648*Math.random())}():jh++,"0x"+jh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ut="WebChannelConnection";class FU extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const l=Ig(),a=this.xo(t,r.toUriEncodedString());z("RestConnection",`Sending RPC '${t}' ${l}:`,a,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,a,u,i).then(c=>(z("RestConnection",`Received RPC '${t}' ${l}: `,c),c),c=>{throw so("RestConnection",`RPC '${t}' ${l} failed with error: `,c,"url: ",a,"request:",i),c})}Lo(t,r,i,s,o,l){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jl}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){const i=LU[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=Ig();return new Promise((o,l)=>{const a=new bR;a.setWithCredentials(!0),a.listenOnce(kR.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case bf.NO_ERROR:const c=a.getResponseJson();z(Ut,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(c)),o(c);break;case bf.TIMEOUT:z(Ut,`RPC '${e}' ${s} timed out`),l(new X(F.DEADLINE_EXCEEDED,"Request time out"));break;case bf.HTTP_ERROR:const f=a.getStatus();if(z(Ut,`RPC '${e}' ${s} failed with status:`,f,"response text:",a.getResponseText()),f>0){let d=a.getResponseJson();Array.isArray(d)&&(d=d[0]);const p=d==null?void 0:d.error;if(p&&p.status&&p.message){const y=function(E){const w=E.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(w)>=0?w:F.UNKNOWN}(p.status);l(new X(y,p.message))}else l(new X(F.UNKNOWN,"Server responded with status "+a.getStatus()))}else l(new X(F.UNAVAILABLE,"Connection failed."));break;default:Z()}}finally{z(Ut,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);z(Ut,`RPC '${e}' ${s} sending request:`,i),a.send(t,"POST",u,r,15)})}Bo(e,t,r){const i=Ig(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=CR(),l=TR(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(a.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,r),a.encodeInitMessageHeaders=!0;const c=s.join("");z(Ut,`Creating RPC '${e}' stream ${i}: ${c}`,a);const f=o.createWebChannel(c,a);let d=!1,p=!1;const y=new BU({Io:E=>{p?z(Ut,`Not sending because RPC '${e}' stream ${i} is closed:`,E):(d||(z(Ut,`Opening RPC '${e}' stream ${i} transport.`),f.open(),d=!0),z(Ut,`RPC '${e}' stream ${i} sending:`,E),f.send(E))},To:()=>f.close()}),v=(E,w,_)=>{E.listen(w,b=>{try{_(b)}catch(I){setTimeout(()=>{throw I},0)}})};return v(f,qa.EventType.OPEN,()=>{p||(z(Ut,`RPC '${e}' stream ${i} transport opened.`),y.yo())}),v(f,qa.EventType.CLOSE,()=>{p||(p=!0,z(Ut,`RPC '${e}' stream ${i} transport closed`),y.So())}),v(f,qa.EventType.ERROR,E=>{p||(p=!0,so(Ut,`RPC '${e}' stream ${i} transport errored:`,E),y.So(new X(F.UNAVAILABLE,"The operation could not be completed")))}),v(f,qa.EventType.MESSAGE,E=>{var w;if(!p){const _=E.data[0];ee(!!_);const b=_,I=b.error||((w=b[0])===null||w===void 0?void 0:w.error);if(I){z(Ut,`RPC '${e}' stream ${i} received error:`,I);const D=I.status;let M=function(T){const C=lt[T];if(C!==void 0)return c2(C)}(D),x=I.message;M===void 0&&(M=F.INTERNAL,x="Unknown error status: "+D+" with message "+I.message),p=!0,y.So(new X(M,x)),f.close()}else z(Ut,`RPC '${e}' stream ${i} received:`,_),y.bo(_)}}),v(l,ER.STAT_EVENT,E=>{E.stat===F0.PROXY?z(Ut,`RPC '${e}' stream ${i} detected buffering proxy`):E.stat===F0.NOPROXY&&z(Ut,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zU(){return typeof window<"u"?window:null}function Pf(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hp(n){return new j8(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,t,r,i,s,o,l,a){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new $2(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(en(t.toString()),en("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new X(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $U extends U2{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=q8(this.serializer,e),r=function(s){if(!("targetChange"in s))return te.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?on(o.readTime):te.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Y0(this.serializer),t.addTarget=function(s,o){let l;const a=o.target;if(l=$d(a)?{documents:v2(s,a)}:{query:w2(s,a)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=d2(s,o.resumeToken);const u=Q0(s,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(te.min())>0){l.readTime=zl(s,o.snapshotVersion.toTimestamp());const u=Q0(s,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=Q8(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Y0(this.serializer),t.removeTarget=e,this.a_(t)}}class UU extends U2{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ee(!!e.streamToken),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ee(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=K8(e.writeResults,e.commitTime),r=on(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Y0(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Hd(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new X(F.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,G0(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new X(F.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,G0(t,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new X(F.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class HU{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(en(t),this.D_=!1):z("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{yo(this)&&(z("RemoteStore","Restarting streams for network reachability change."),await async function(a){const u=oe(a);u.L_.add(4),await Ic(u),u.q_.set("Unknown"),u.L_.delete(4),await Wp(u)}(this))})}),this.q_=new HU(r,i)}}async function Wp(n){if(yo(n))for(const e of n.B_)await e(!0)}async function Ic(n){for(const e of n.B_)await e(!1)}function j2(n,e){const t=oe(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),gw(t)?mw(t):ta(t).r_()&&pw(t,e))}function dw(n,e){const t=oe(n),r=ta(t);t.N_.delete(e),r.r_()&&H2(t,e),t.N_.size===0&&(r.r_()?r.o_():yo(t)&&t.q_.set("Unknown"))}function pw(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ta(n).A_(e)}function H2(n,e){n.Q_.xe(e),ta(n).R_(e)}function mw(n){n.Q_=new F8({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),ta(n).start(),n.q_.v_()}function gw(n){return yo(n)&&!ta(n).n_()&&n.N_.size>0}function yo(n){return oe(n).L_.size===0}function W2(n){n.Q_=void 0}async function qU(n){n.q_.set("Online")}async function KU(n){n.N_.forEach((e,t)=>{pw(n,e)})}async function QU(n,e){W2(n),gw(n)?(n.q_.M_(e),mw(n)):n.q_.set("Unknown")}async function GU(n,e,t){if(n.q_.set("Online"),e instanceof f2&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(n,e)}catch(r){z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Qd(n,r)}else if(e instanceof If?n.Q_.Ke(e):e instanceof h2?n.Q_.He(e):n.Q_.We(e),!t.isEqual(te.min()))try{const r=await F2(n.localStore);t.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((a,u)=>{if(a.resumeToken.approximateByteSize()>0){const c=s.N_.get(u);c&&s.N_.set(u,c.withResumeToken(a.resumeToken,o))}}),l.targetMismatches.forEach((a,u)=>{const c=s.N_.get(a);if(!c)return;s.N_.set(a,c.withResumeToken(ft.EMPTY_BYTE_STRING,c.snapshotVersion)),H2(s,a);const f=new Xr(c.target,a,u,c.sequenceNumber);pw(s,f)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){z("RemoteStore","Failed to raise snapshot:",r),await Qd(n,r)}}async function Qd(n,e,t){if(!hs(e))throw e;n.L_.add(1),await Ic(n),n.q_.set("Offline"),t||(t=()=>F2(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{z("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Wp(n)})}function q2(n,e){return e().catch(t=>Qd(n,t,e))}async function Pc(n){const e=oe(n),t=os(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;YU(e);)try{const i=await OU(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,XU(e,i)}catch(i){await Qd(e,i)}K2(e)&&Q2(e)}function YU(n){return yo(n)&&n.O_.length<10}function XU(n,e){n.O_.push(e);const t=os(n);t.r_()&&t.V_&&t.m_(e.mutations)}function K2(n){return yo(n)&&!os(n).n_()&&n.O_.length>0}function Q2(n){os(n).start()}async function JU(n){os(n).p_()}async function ZU(n){const e=os(n);for(const t of n.O_)e.m_(t.mutations)}async function ej(n,e,t){const r=n.O_.shift(),i=iw.from(r,e,t);await q2(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await Pc(n)}async function tj(n,e){e&&os(n).V_&&await async function(r,i){if(function(o){return V8(o)&&o!==F.ABORTED}(i.code)){const s=r.O_.shift();os(r).s_(),await q2(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Pc(r)}}(n,e),K2(n)&&Q2(n)}async function oE(n,e){const t=oe(n);t.asyncQueue.verifyOperationInProgress(),z("RemoteStore","RemoteStore received new credentials");const r=yo(t);t.L_.add(3),await Ic(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Wp(t)}async function nj(n,e){const t=oe(n);e?(t.L_.delete(2),await Wp(t)):e||(t.L_.add(2),await Ic(t),t.q_.set("Unknown"))}function ta(n){return n.K_||(n.K_=function(t,r,i){const s=oe(t);return s.w_(),new $U(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:qU.bind(null,n),Ro:KU.bind(null,n),mo:QU.bind(null,n),d_:GU.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),gw(n)?mw(n):n.q_.set("Unknown")):(await n.K_.stop(),W2(n))})),n.K_}function os(n){return n.U_||(n.U_=function(t,r,i){const s=oe(t);return s.w_(),new UU(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:JU.bind(null,n),mo:tj.bind(null,n),f_:ZU.bind(null,n),g_:ej.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await Pc(n)):(await n.U_.stop(),n.O_.length>0&&(z("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ei,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,l=new yw(e,t,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new X(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vw(n,e){if(en("AsyncQueue",`${e}: ${n}`),hs(n))return new X(F.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this.comparator=e?(t,r)=>e(t,r)||K.comparator(t.key,r.key):(t,r)=>K.comparator(t.key,r.key),this.keyedMap=Ka(),this.sortedSet=new qe(this.comparator)}static emptySet(e){return new dl(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof dl)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new dl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lE{constructor(){this.W_=new qe(K.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Z():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class $l{constructor(e,t,r,i,s,o,l,a,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=a,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new $l(e,t,dl.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class ij{constructor(){this.queries=aE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=oe(t),s=i.queries;i.queries=aE(),s.forEach((o,l)=>{for(const a of l.j_)a.onError(r)})})(this,new X(F.ABORTED,"Firestore shutting down"))}}function aE(){return new fs(n=>XR(n),Lp)}async function sj(n,e){const t=oe(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new rj,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await t.onListen(i,!0);break;case 1:s.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=vw(o,`Initialization of query '${Mo(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&ww(t)}async function oj(n,e){const t=oe(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function lj(n,e){const t=oe(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&ww(t)}function aj(n,e,t){const r=oe(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function ww(n){n.Y_.forEach(e=>{e.next()})}var nv,uE;(uE=nv||(nv={})).ea="default",uE.Cache="cache";class uj{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new $l(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=$l.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==nv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(e){this.key=e}}class Y2{constructor(e){this.key=e}}class cj{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=de(),this.mutatedKeys=de(),this.Aa=JR(e),this.Ra=new dl(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new lE,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const a=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((c,f)=>{const d=i.get(c),p=Cc(this.query,f)?f:null,y=!!d&&this.mutatedKeys.has(d.key),v=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;d&&p?d.data.isEqual(p.data)?y!==v&&(r.track({type:3,doc:p}),E=!0):this.ga(d,p)||(r.track({type:2,doc:p}),E=!0,(a&&this.Aa(p,a)>0||u&&this.Aa(p,u)<0)&&(l=!0)):!d&&p?(r.track({type:0,doc:p}),E=!0):d&&!p&&(r.track({type:1,doc:d}),E=!0,(a||u)&&(l=!0)),E&&(p?(o=o.add(p),s=v?s.add(c):s.delete(c)):(o=o.delete(c),s=s.delete(c)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const c=this.query.limitType==="F"?o.last():o.first();o=o.delete(c.key),s=s.delete(c.key),r.track({type:1,doc:c})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((c,f)=>function(p,y){const v=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Z()}};return v(p)-v(y)}(c.type,f.type)||this.Aa(c.doc,f.doc)),this.pa(r),i=i!=null&&i;const l=t&&!i?this.ya():[],a=this.da.size===0&&this.current&&!i?1:0,u=a!==this.Ea;return this.Ea=a,o.length!==0||u?{snapshot:new $l(this.query,e.Ra,s,o,e.mutatedKeys,a===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new lE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=de(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Y2(r))}),this.da.forEach(r=>{e.has(r)||t.push(new G2(r))}),t}ba(e){this.Ta=e.Ts,this.da=de();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return $l.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class hj{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class fj{constructor(e){this.key=e,this.va=!1}}class dj{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new fs(l=>XR(l),Lp),this.Ma=new Map,this.xa=new Set,this.Oa=new qe(K.comparator),this.Na=new Map,this.La=new cw,this.Ba={},this.ka=new Map,this.qa=ho.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function pj(n,e,t=!0){const r=nD(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await X2(r,e,t,!0),i}async function mj(n,e){const t=nD(n);await X2(t,e,!0,!1)}async function X2(n,e,t,r){const i=await MU(n.localStore,Gn(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let l;return r&&(l=await gj(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&j2(n.remoteStore,i),l}async function gj(n,e,t,r,i){n.Ka=(f,d,p)=>async function(v,E,w,_){let b=E.view.ma(w);b.ns&&(b=await rE(v.localStore,E.query,!1).then(({documents:x})=>E.view.ma(x,b)));const I=_&&_.targetChanges.get(E.targetId),D=_&&_.targetMismatches.get(E.targetId)!=null,M=E.view.applyChanges(b,v.isPrimaryClient,I,D);return hE(v,E.targetId,M.wa),M.snapshot}(n,f,d,p);const s=await rE(n.localStore,e,!0),o=new cj(e,s.Ts),l=o.ma(s.documents),a=Ac.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(l,n.isPrimaryClient,a);hE(n,t,u.wa);const c=new hj(e,t,o);return n.Fa.set(e,c),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function yj(n,e,t){const r=oe(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Lp(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await tv(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&dw(r.remoteStore,i.targetId),rv(r,i.targetId)}).catch(go)):(rv(r,i.targetId),await tv(r.localStore,i.targetId,!0))}async function vj(n,e){const t=oe(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),dw(t.remoteStore,r.targetId))}async function wj(n,e,t){const r=rD(n);try{const i=await function(o,l){const a=oe(o),u=Ye.now(),c=l.reduce((p,y)=>p.add(y.key),de());let f,d;return a.persistence.runTransaction("Locally write mutations","readwrite",p=>{let y=Pn(),v=de();return a.cs.getEntries(p,c).next(E=>{y=E,y.forEach((w,_)=>{_.isValidDocument()||(v=v.add(w))})}).next(()=>a.localDocuments.getOverlayedDocuments(p,y)).next(E=>{f=E;const w=[];for(const _ of l){const b=M8(_,f.get(_.key).overlayedDocument);b!=null&&w.push(new ds(_.key,b,jR(b.value.mapValue),Rn.exists(!0)))}return a.mutationQueue.addMutationBatch(p,u,w,l)}).next(E=>{d=E;const w=E.applyToLocalDocumentSet(f,v);return a.documentOverlayCache.saveOverlays(p,E.batchId,w)})}).then(()=>({batchId:d.batchId,changes:e2(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,a){let u=o.Ba[o.currentUser.toKey()];u||(u=new qe(le)),u=u.insert(l,a),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,t),await Rc(r,i.changes),await Pc(r.remoteStore)}catch(i){const s=vw(i,"Failed to persist write");t.reject(s)}}async function J2(n,e){const t=oe(n);try{const r=await RU(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(ee(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?ee(o.va):i.removedDocuments.size>0&&(ee(o.va),o.va=!1))}),await Rc(t,r,e)}catch(r){await go(r)}}function cE(n,e,t){const r=oe(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const a=oe(o);a.onlineState=l;let u=!1;a.queries.forEach((c,f)=>{for(const d of f.j_)d.Z_(l)&&(u=!0)}),u&&ww(a)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function _j(n,e,t){const r=oe(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new qe(K.comparator);o=o.insert(s,et.newNoDocument(s,te.min()));const l=de().add(s),a=new zp(te.min(),new Map,new qe(le),o,l);await J2(r,a),r.Oa=r.Oa.remove(s),r.Na.delete(e),_w(r)}else await tv(r.localStore,e,!1).then(()=>rv(r,e,t)).catch(go)}async function xj(n,e){const t=oe(n),r=e.batch.batchId;try{const i=await PU(t.localStore,e);eD(t,r,null),Z2(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Rc(t,i)}catch(i){await go(i)}}async function Sj(n,e,t){const r=oe(n);try{const i=await function(o,l){const a=oe(o);return a.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let c;return a.mutationQueue.lookupMutationBatch(u,l).next(f=>(ee(f!==null),c=f.keys(),a.mutationQueue.removeMutationBatch(u,f))).next(()=>a.mutationQueue.performConsistencyCheck(u)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(u,c,l)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,c)).next(()=>a.localDocuments.getDocuments(u,c))})}(r.localStore,e);eD(r,e,t),Z2(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Rc(r,i)}catch(i){await go(i)}}function Z2(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function eD(n,e,t){const r=oe(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function rv(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||tD(n,r)})}function tD(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(dw(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),_w(n))}function hE(n,e,t){for(const r of t)r instanceof G2?(n.La.addReference(r.key,e),bj(n,r)):r instanceof Y2?(z("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||tD(n,r.key)):Z()}function bj(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(z("SyncEngine","New document in limbo: "+t),n.xa.add(r),_w(n))}function _w(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new K(Ae.fromString(e)),r=n.qa.next();n.Na.set(r,new fj(t)),n.Oa=n.Oa.insert(t,r),j2(n.remoteStore,new Xr(Gn(ew(t.path)),r,"TargetPurposeLimboResolution",Hn.oe))}}async function Rc(n,e,t){const r=oe(n),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,a)=>{o.push(r.Ka(a,e,t).then(u=>{var c;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(c=t==null?void 0:t.targetChanges.get(a.targetId))===null||c===void 0?void 0:c.current;r.sharedClientState.updateQueryState(a.targetId,f?"current":"not-current")}if(u){i.push(u);const f=fw.Wi(a.targetId,u);s.push(f)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(a,u){const c=oe(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>V.forEach(u,d=>V.forEach(d.$i,p=>c.persistence.referenceDelegate.addReference(f,d.targetId,p)).next(()=>V.forEach(d.Ui,p=>c.persistence.referenceDelegate.removeReference(f,d.targetId,p)))))}catch(f){if(!hs(f))throw f;z("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const d=f.targetId;if(!f.fromCache){const p=c.os.get(d),y=p.snapshotVersion,v=p.withLastLimboFreeSnapshotVersion(y);c.os=c.os.insert(d,v)}}}(r.localStore,s))}async function kj(n,e){const t=oe(n);if(!t.currentUser.isEqual(e)){z("SyncEngine","User change. New user:",e.toKey());const r=await B2(t.localStore,e);t.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(a=>{a.reject(new X(F.CANCELLED,o))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Rc(t,r.hs)}}function Ej(n,e){const t=oe(n),r=t.Na.get(e);if(r&&r.va)return de().add(r.key);{let i=de();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const l=t.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}function nD(n){const e=oe(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=J2.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ej.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_j.bind(null,e),e.Ca.d_=lj.bind(null,e.eventManager),e.Ca.$a=aj.bind(null,e.eventManager),e}function rD(n){const e=oe(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Sj.bind(null,e),e}class hc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return L2(this.persistence,new V2,e.initialUser,this.serializer)}Ga(e){return new N2(jp.Zr,this.serializer)}Wa(e){return new z2}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hc.provider={build:()=>new hc};class Tj extends hc{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await rD(this.Ja.syncEngine),await Pc(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return L2(this.persistence,new V2,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new hU(r,e.asyncQueue,t)}Ha(e,t){const r=new B$(t,this.persistence);return new L$(e.asyncQueue,r)}Ga(e){const t=CU(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?un.withCacheSize(this.cacheSizeBytes):un.DEFAULT;return new hw(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,zU(),Pf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new z2}}class Gd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>cE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kj.bind(null,this.syncEngine),await nj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ij}()}createDatastore(e){const t=Hp(e.databaseInfo.databaseId),r=function(s){return new FU(s)}(e.databaseInfo);return function(s,o,l,a){return new jU(s,o,l,a)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,l){return new WU(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>cE(this.syncEngine,t,0),function(){return sE.D()?new sE:new VU}())}createSyncEngine(e,t){return function(i,s,o,l,a,u,c){const f=new dj(i,s,o,l,a,u);return c&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=oe(i);z("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ic(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Gd.provider={build:()=>new Gd};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):en("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=It.UNAUTHENTICATED,this.clientId=IR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{z("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(z("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ei;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=vw(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Pg(n,e){n.asyncQueue.verifyOperationInProgress(),z("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await B2(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function fE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Ij(n);z("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>oE(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>oE(e.remoteStore,i)),n._onlineComponents=e}async function Ij(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){z("FirestoreClient","Using user provided OfflineComponentProvider");try{await Pg(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;so("Error using user provided cache. Falling back to memory cache: "+t),await Pg(n,new hc)}}else z("FirestoreClient","Using default OfflineComponentProvider"),await Pg(n,new hc);return n._offlineComponents}async function iD(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(z("FirestoreClient","Using user provided OnlineComponentProvider"),await fE(n,n._uninitializedComponentsProvider._online)):(z("FirestoreClient","Using default OnlineComponentProvider"),await fE(n,new Gd))),n._onlineComponents}function Pj(n){return iD(n).then(e=>e.syncEngine)}async function Rj(n){const e=await iD(n),t=e.eventManager;return t.onListen=pj.bind(null,e.syncEngine),t.onUnlisten=yj.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=mj.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=vj.bind(null,e.syncEngine),t}function Dj(n,e,t={}){const r=new ei;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,l,a,u){const c=new Cj({next:d=>{c.Za(),o.enqueueAndForget(()=>oj(s,f)),d.fromCache&&a.source==="server"?u.reject(new X(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(d)},error:d=>u.reject(d)}),f=new uj(l,c,{includeMetadataChanges:!0,_a:!0});return sj(s,f)}(await Rj(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sD(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oD(n,e,t){if(!t)throw new X(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Oj(n,e,t,r){if(e===!0&&r===!0)throw new X(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pE(n){if(!K.isDocumentKey(n))throw new X(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function mE(n){if(K.isDocumentKey(n))throw new X(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function xw(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Z()}function fc(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new X(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=xw(n);throw new X(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new X(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new X(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Oj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sD((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new X(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new X(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new X(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qp{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new gE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new X(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new X(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new gE(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new E$;switch(r.type){case"firstParty":return new I$(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new X(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=dE.get(t);r&&(z("ComponentProvider","Removing Datastore"),dE.delete(t),r.terminate())}(this),Promise.resolve()}}function Mj(n,e,t,r={}){var i;const s=(n=fc(n,qp))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&so("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,a;if(typeof r.mockUserToken=="string")l=r.mockUserToken,a=It.MOCK_USER;else{l=lz(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new X(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new It(u)}n._authCredentials=new T$(new AR(l,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Kp(this.firestore,e,this._query)}}class cr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new cr(this.firestore,e,this._key)}}class Yi extends Kp{constructor(e,t,r){super(e,t,ew(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new cr(this.firestore,null,new K(e))}withConverter(e){return new Yi(this.firestore,e,this._path)}}function yE(n,e,...t){if(n=ec(n),oD("collection","path",e),n instanceof qp){const r=Ae.fromString(e,...t);return mE(r),new Yi(n,null,r)}{if(!(n instanceof cr||n instanceof Yi))throw new X(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ae.fromString(e,...t));return mE(r),new Yi(n.firestore,null,r)}}function Nj(n,e,...t){if(n=ec(n),arguments.length===1&&(e=IR.newId()),oD("doc","path",e),n instanceof qp){const r=Ae.fromString(e,...t);return pE(r),new cr(n,null,new K(r))}{if(!(n instanceof cr||n instanceof Yi))throw new X(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ae.fromString(e,...t));return pE(r),new cr(n.firestore,n instanceof Yi?n.converter:null,new K(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new $2(this,"async_queue_retry"),this.Vu=()=>{const r=Pf();r&&z("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Pf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Pf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new ei;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!hs(e))throw e;z("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw en("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=yw.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Z()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Qp extends qp{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new vE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new vE(e),this._firestoreClient=void 0,await e}}}function Vj(n,e){const t=typeof n=="object"?n:d$(),r=typeof n=="string"?n:"(default)",i=u$(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=sz("firestore");s&&Mj(i,...s)}return i}function lD(n){if(n._terminated)throw new X(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||aD(n),n._firestoreClient}function aD(n){var e,t,r;const i=n._freezeSettings(),s=function(l,a,u,c){return new o8(l,a,u,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,sD(c.experimentalLongPollingOptions),c.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Aj(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(l){const a=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(a),_online:a}}(n._componentsProvider))}function Lj(n,e){so("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return Bj(n,Gd.provider,{build:r=>new Tj(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function Bj(n,e,t){if((n=fc(n,Qp))._firestoreClient||n._terminated)throw new X(F.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new X(F.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},aD(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ul{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ul(ft.fromBase64String(e))}catch(t){throw new X(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ul(ft.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new X(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new X(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new X(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=/^__.*__$/;class zj{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ds(e,this.data,this.fieldMask,t,this.fieldTransforms):new ea(e,this.data,t,this.fieldTransforms)}}function cD(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Z()}}class Ew{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Ew(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Yd(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(cD(this.Cu)&&Fj.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class $j{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Hp(e)}Qu(e,t,r,i=!1){return new Ew({Cu:e,methodName:t,qu:r,path:Qe.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Uj(n){const e=n._freezeSettings(),t=Hp(n._databaseId);return new $j(n._databaseId,!!e.ignoreUndefinedProperties,t)}function jj(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);pD("Data must be an object, but it was:",o,r);const l=fD(r,o);let a,u;if(s.merge)a=new Wn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const c=[];for(const f of s.mergeFields){const d=Hj(e,f,t);if(!o.contains(d))throw new X(F.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);qj(c,d)||c.push(d)}a=new Wn(c),u=o.fieldTransforms.filter(f=>a.covers(f.field))}else a=null,u=o.fieldTransforms;return new zj(new pn(l),a,u)}function hD(n,e){if(dD(n=ec(n)))return pD("Unsupported field value:",e,n),fD(n,e);if(n instanceof uD)return function(r,i){if(!cD(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let a=hD(l,i.Lu(o));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=ec(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return C8(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ye.fromDate(r);return{timestampValue:zl(i.serializer,s)}}if(r instanceof Ye){const s=new Ye(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:zl(i.serializer,s)}}if(r instanceof bw)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ul)return{bytesValue:d2(i.serializer,r._byteString)};if(r instanceof cr){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:lw(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof kw)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(a=>{if(typeof a!="number")throw l.Bu("VectorValues must only contain numeric values.");return tw(l.serializer,a)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${xw(r)}`)}(n,e)}function fD(n,e){const t={};return FR(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zl(n,(r,i)=>{const s=hD(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function dD(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ye||n instanceof bw||n instanceof Ul||n instanceof cr||n instanceof uD||n instanceof kw)}function pD(n,e,t){if(!dD(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=xw(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Hj(n,e,t){if((e=ec(e))instanceof Sw)return e._internalPath;if(typeof e=="string")return mD(n,e);throw Yd("Field path arguments must be of type string or ",n,!1,void 0,t)}const Wj=new RegExp("[~\\*/\\[\\]]");function mD(n,e,t){if(e.search(Wj)>=0)throw Yd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Sw(...e.split("."))._internalPath}catch{throw Yd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Yd(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let a="";return(s||o)&&(a+=" (found",s&&(a+=` in field ${r}`),o&&(a+=` in document ${i}`),a+=")"),new X(F.INVALID_ARGUMENT,l+n+a)}function qj(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new cr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Kj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(yD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class Kj extends gD{data(){return super.data()}}function yD(n,e){return typeof e=="string"?mD(n,e):e instanceof Sw?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new X(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gj{convertValue(e,t="none"){switch(lo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(is(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Z()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Zl(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>je(o.doubleValue));return new kw(s)}convertGeoPoint(e){return new bw(je(e.latitude),je(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=X1(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(oc(e));default:return null}}convertTimestamp(e){const t=ui(e);return new Ye(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ae.fromString(e);ee(b2(r));const i=new oo(r.get(1),r.get(3)),s=new K(r.popFirst(5));return i.isEqual(t)||en(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(n,e,t){let r;return r=n?n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xj extends gD{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Rf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(yD("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Rf extends Xj{data(e={}){return super.data(e)}}class Jj{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Hh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Rf(this._firestore,this._userDataWriter,r.key,r,new Hh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new X(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const a=new Rf(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Hh(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:a,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const a=new Rf(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Hh(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,c=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),c=o.indexOf(l.doc.key)),{type:Zj(l.type),doc:a,oldIndex:u,newIndex:c}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Zj(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Z()}}class e7 extends Gj{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ul(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new cr(this.firestore,null,t)}}function t7(n){n=fc(n,Kp);const e=fc(n.firestore,Qp),t=lD(e),r=new e7(e);return Qj(n._query),Dj(t,n._query).then(i=>new Jj(e,r,n,i))}function n7(n,e){const t=fc(n.firestore,Qp),r=Nj(n),i=Yj(n.converter,e);return r7(t,[jj(Uj(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Rn.exists(!1))]).then(()=>r)}function r7(n,e){return function(r,i){const s=new ei;return r.asyncQueue.enqueueAndForget(async()=>wj(await Pj(r),i,s)),s.promise}(lD(n),e)}(function(e,t=!0){(function(i){Jl=i})(f$),Bd(new tc("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new Qp(new C$(r.getProvider("auth-internal")),new R$(r.getProvider("app-check-internal")),function(u,c){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new X(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(u.options.projectId,c)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),fl(fk,"4.7.3",e),fl(fk,"4.7.3","esm2017")})();const i7={apiKey:"AIzaSyA26HTNGGs-TXbTPL_gW4aU6JQvI6Vrxgw",authDomain:"queryboard-387ae.firebaseapp.com",projectId:"queryboard-387ae",storageBucket:"queryboard-387ae.firebasestorage.app",messagingSenderId:"647025527555",appId:"1:647025527555:web:36eaa9f997875933057736"},s7=wR(i7),iv=Vj(s7);Lj(iv).catch(n=>{n.code==="failed-precondition"?console.log("Multiple tabs open, persistence can only be enabled in one tab at a time."):n.code==="unimplemented"&&console.log("The current browser doesn't support all of the features required to enable persistence")});let o7={data:""},l7=n=>typeof window=="object"?((n?n.querySelector("#_goober"):window._goober)||Object.assign((n||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:n||o7,a7=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,u7=/\/\*[^]*?\*\/|  +/g,wE=/\n+/g,Ii=(n,e)=>{let t="",r="",i="";for(let s in n){let o=n[s];s[0]=="@"?s[1]=="i"?t=s+" "+o+";":r+=s[1]=="f"?Ii(o,s):s+"{"+Ii(o,s[1]=="k"?"":e)+"}":typeof o=="object"?r+=Ii(o,e?e.replace(/([^,])+/g,l=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,a=>/&/.test(a)?a.replace(/&/g,l):l?l+" "+a:a)):s):o!=null&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=Ii.p?Ii.p(s,o):s+":"+o+";")}return t+(e&&i?e+"{"+i+"}":i)+r},jr={},vD=n=>{if(typeof n=="object"){let e="";for(let t in n)e+=t+vD(n[t]);return e}return n},c7=(n,e,t,r,i)=>{let s=vD(n),o=jr[s]||(jr[s]=(a=>{let u=0,c=11;for(;u<a.length;)c=101*c+a.charCodeAt(u++)>>>0;return"go"+c})(s));if(!jr[o]){let a=s!==n?n:(u=>{let c,f,d=[{}];for(;c=a7.exec(u.replace(u7,""));)c[4]?d.shift():c[3]?(f=c[3].replace(wE," ").trim(),d.unshift(d[0][f]=d[0][f]||{})):d[0][c[1]]=c[2].replace(wE," ").trim();return d[0]})(n);jr[o]=Ii(i?{["@keyframes "+o]:a}:a,t?"":"."+o)}let l=t&&jr.g?jr.g:null;return t&&(jr.g=jr[o]),((a,u,c,f)=>{f?u.data=u.data.replace(f,a):u.data.indexOf(a)===-1&&(u.data=c?a+u.data:u.data+a)})(jr[o],e,r,l),o},h7=(n,e,t)=>n.reduce((r,i,s)=>{let o=e[s];if(o&&o.call){let l=o(t),a=l&&l.props&&l.props.className||/^go/.test(l)&&l;o=a?"."+a:l&&typeof l=="object"?l.props?"":Ii(l,""):l===!1?"":l}return r+i+(o??"")},"");function Gp(n){let e=this||{},t=n.call?n(e.p):n;return c7(t.unshift?t.raw?h7(t,[].slice.call(arguments,1),e.p):t.reduce((r,i)=>Object.assign(r,i&&i.call?i(e.p):i),{}):t,l7(e.target),e.g,e.o,e.k)}let wD,sv,ov;Gp.bind({g:1});let ci=Gp.bind({k:1});function f7(n,e,t,r){Ii.p=e,wD=n,sv=t,ov=r}function ps(n,e){let t=this||{};return function(){let r=arguments;function i(s,o){let l=Object.assign({},s),a=l.className||i.className;t.p=Object.assign({theme:sv&&sv()},l),t.o=/ *go\d+/.test(a),l.className=Gp.apply(t,r)+(a?" "+a:"");let u=n;return n[0]&&(u=l.as||n,delete l.as),ov&&u[0]&&ov(l),wD(u,l)}return i}}var d7=n=>typeof n=="function",Xd=(n,e)=>d7(n)?n(e):n,p7=(()=>{let n=0;return()=>(++n).toString()})(),_D=(()=>{let n;return()=>{if(n===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");n=!e||e.matches}return n}})(),m7=20,xD=(n,e)=>{switch(e.type){case 0:return{...n,toasts:[e.toast,...n.toasts].slice(0,m7)};case 1:return{...n,toasts:n.toasts.map(s=>s.id===e.toast.id?{...s,...e.toast}:s)};case 2:let{toast:t}=e;return xD(n,{type:n.toasts.find(s=>s.id===t.id)?1:0,toast:t});case 3:let{toastId:r}=e;return{...n,toasts:n.toasts.map(s=>s.id===r||r===void 0?{...s,dismissed:!0,visible:!1}:s)};case 4:return e.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(s=>s.id!==e.toastId)};case 5:return{...n,pausedAt:e.time};case 6:let i=e.time-(n.pausedAt||0);return{...n,pausedAt:void 0,toasts:n.toasts.map(s=>({...s,pauseDuration:s.pauseDuration+i}))}}},Df=[],zs={toasts:[],pausedAt:void 0},vo=n=>{zs=xD(zs,n),Df.forEach(e=>{e(zs)})},g7={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},y7=(n={})=>{let[e,t]=se.useState(zs),r=se.useRef(zs);se.useEffect(()=>(r.current!==zs&&t(zs),Df.push(t),()=>{let s=Df.indexOf(t);s>-1&&Df.splice(s,1)}),[]);let i=e.toasts.map(s=>{var o,l,a;return{...n,...n[s.type],...s,removeDelay:s.removeDelay||((o=n[s.type])==null?void 0:o.removeDelay)||(n==null?void 0:n.removeDelay),duration:s.duration||((l=n[s.type])==null?void 0:l.duration)||(n==null?void 0:n.duration)||g7[s.type],style:{...n.style,...(a=n[s.type])==null?void 0:a.style,...s.style}}});return{...e,toasts:i}},v7=(n,e="blank",t)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:n,pauseDuration:0,...t,id:(t==null?void 0:t.id)||p7()}),Dc=n=>(e,t)=>{let r=v7(e,n,t);return vo({type:2,toast:r}),r.id},Jt=(n,e)=>Dc("blank")(n,e);Jt.error=Dc("error");Jt.success=Dc("success");Jt.loading=Dc("loading");Jt.custom=Dc("custom");Jt.dismiss=n=>{vo({type:3,toastId:n})};Jt.remove=n=>vo({type:4,toastId:n});Jt.promise=(n,e,t)=>{let r=Jt.loading(e.loading,{...t,...t==null?void 0:t.loading});return typeof n=="function"&&(n=n()),n.then(i=>{let s=e.success?Xd(e.success,i):void 0;return s?Jt.success(s,{id:r,...t,...t==null?void 0:t.success}):Jt.dismiss(r),i}).catch(i=>{let s=e.error?Xd(e.error,i):void 0;s?Jt.error(s,{id:r,...t,...t==null?void 0:t.error}):Jt.dismiss(r)}),n};var w7=(n,e)=>{vo({type:1,toast:{id:n,height:e}})},_7=()=>{vo({type:5,time:Date.now()})},yu=new Map,x7=1e3,S7=(n,e=x7)=>{if(yu.has(n))return;let t=setTimeout(()=>{yu.delete(n),vo({type:4,toastId:n})},e);yu.set(n,t)},b7=n=>{let{toasts:e,pausedAt:t}=y7(n);se.useEffect(()=>{if(t)return;let s=Date.now(),o=e.map(l=>{if(l.duration===1/0)return;let a=(l.duration||0)+l.pauseDuration-(s-l.createdAt);if(a<0){l.visible&&Jt.dismiss(l.id);return}return setTimeout(()=>Jt.dismiss(l.id),a)});return()=>{o.forEach(l=>l&&clearTimeout(l))}},[e,t]);let r=se.useCallback(()=>{t&&vo({type:6,time:Date.now()})},[t]),i=se.useCallback((s,o)=>{let{reverseOrder:l=!1,gutter:a=8,defaultPosition:u}=o||{},c=e.filter(p=>(p.position||u)===(s.position||u)&&p.height),f=c.findIndex(p=>p.id===s.id),d=c.filter((p,y)=>y<f&&p.visible).length;return c.filter(p=>p.visible).slice(...l?[d+1]:[0,d]).reduce((p,y)=>p+(y.height||0)+a,0)},[e]);return se.useEffect(()=>{e.forEach(s=>{if(s.dismissed)S7(s.id,s.removeDelay);else{let o=yu.get(s.id);o&&(clearTimeout(o),yu.delete(s.id))}})},[e]),{toasts:e,handlers:{updateHeight:w7,startPause:_7,endPause:r,calculateOffset:i}}},k7=ci`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,E7=ci`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,T7=ci`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,C7=ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${k7} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${E7} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${n=>n.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${T7} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,A7=ci`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,I7=ps("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${n=>n.secondary||"#e0e0e0"};
  border-right-color: ${n=>n.primary||"#616161"};
  animation: ${A7} 1s linear infinite;
`,P7=ci`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,R7=ci`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,D7=ps("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${n=>n.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${P7} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${R7} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${n=>n.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,O7=ps("div")`
  position: absolute;
`,M7=ps("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,N7=ci`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,V7=ps("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${N7} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,L7=({toast:n})=>{let{icon:e,type:t,iconTheme:r}=n;return e!==void 0?typeof e=="string"?se.createElement(V7,null,e):e:t==="blank"?null:se.createElement(M7,null,se.createElement(I7,{...r}),t!=="loading"&&se.createElement(O7,null,t==="error"?se.createElement(C7,{...r}):se.createElement(D7,{...r})))},B7=n=>`
0% {transform: translate3d(0,${n*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,F7=n=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${n*-150}%,-1px) scale(.6); opacity:0;}
`,z7="0%{opacity:0;} 100%{opacity:1;}",$7="0%{opacity:1;} 100%{opacity:0;}",U7=ps("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,j7=ps("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,H7=(n,e)=>{let t=n.includes("top")?1:-1,[r,i]=_D()?[z7,$7]:[B7(t),F7(t)];return{animation:e?`${ci(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ci(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},W7=se.memo(({toast:n,position:e,style:t,children:r})=>{let i=n.height?H7(n.position||e||"top-center",n.visible):{opacity:0},s=se.createElement(L7,{toast:n}),o=se.createElement(j7,{...n.ariaProps},Xd(n.message,n));return se.createElement(U7,{className:n.className,style:{...i,...t,...n.style}},typeof r=="function"?r({icon:s,message:o}):se.createElement(se.Fragment,null,s,o))});f7(se.createElement);var q7=({id:n,className:e,style:t,onHeightUpdate:r,children:i})=>{let s=se.useCallback(o=>{if(o){let l=()=>{let a=o.getBoundingClientRect().height;r(n,a)};l(),new MutationObserver(l).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[n,r]);return se.createElement("div",{ref:s,className:e,style:t},i)},K7=(n,e)=>{let t=n.includes("top"),r=t?{top:0}:{bottom:0},i=n.includes("center")?{justifyContent:"center"}:n.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:_D()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(t?1:-1)}px)`,...r,...i}},Q7=Gp`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Wh=16,G7=({reverseOrder:n,position:e="top-center",toastOptions:t,gutter:r,children:i,containerStyle:s,containerClassName:o})=>{let{toasts:l,handlers:a}=b7(t);return se.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Wh,left:Wh,right:Wh,bottom:Wh,pointerEvents:"none",...s},className:o,onMouseEnter:a.startPause,onMouseLeave:a.endPause},l.map(u=>{let c=u.position||e,f=a.calculateOffset(u,{reverseOrder:n,gutter:r,defaultPosition:e}),d=K7(c,f);return se.createElement(q7,{id:u.id,key:u.id,onHeightUpdate:a.updateHeight,className:u.visible?Q7:"",style:d},u.type==="custom"?Xd(u.message,u):i?i(u):se.createElement(W7,{toast:u,position:c}))}))},Na=Jt;const Y7=Nt.div`
  max-width: 1200px;
  margin: 0 auto;
  padding: 2rem;
  background: linear-gradient(180deg, rgba(16,16,28,0.8) 0%, rgba(16,16,28,0.9) 100%);
  min-height: 100vh;
  box-shadow: 0 0 40px rgba(0,0,0,0.3);
  border-radius: 20px;
  backdrop-filter: blur(10px);
`,X7=Nt.header`
  margin-bottom: 2rem;
  position: relative;
  &:after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 0;
    width: 100%;
    height: 2px;
    background: linear-gradient(90deg, #4CAF50, #45a049, #4CAF50);
    background-size: 200% 100%;
    animation: gradient 2s linear infinite;
  }

  @keyframes gradient {
    0% { background-position: 0% 50%; }
    100% { background-position: 200% 50%; }
  }
`,J7=Nt.h1`
  color: #ffffff;
  font-size: 2.5rem;
  margin-bottom: 1rem;
  text-shadow: 0 0 10px rgba(76,175,80,0.3);
  letter-spacing: 2px;
`,Z7=Nt.div`
  margin-bottom: 2rem;
  border: 1px solid rgba(76,175,80,0.3);
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 0 20px rgba(76,175,80,0.1);
  transition: all 0.3s ease;
  height: 150px;

  &:hover {
    box-shadow: 0 0 30px rgba(76,175,80,0.2);
    transform: translateY(-2px);
  }

  .cm-editor {
    height: 150px;
  }
`,eH=Nt.div`
  margin: 1rem 0;
  display: flex;
  gap: 1rem;
`,_E=Nt.button`
  background: linear-gradient(45deg, #4CAF50, #45a049);
  color: white;
  padding: 0.75rem 1.5rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1rem;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 1px;
  position: relative;
  overflow: hidden;

  &:before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      120deg,
      transparent,
      rgba(255, 255, 255, 0.2),
      transparent
    );
    transition: 0.5s;
  }

  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(76,175,80,0.3);
    &:before {
      left: 100%;
    }
  }

  &.secondary {
    background: linear-gradient(45deg, #6c757d, #5a6268);
  }
`,tH=Nt.div`
  margin-bottom: 1rem;
`,nH=Nt.input`
  width: 100%;
  padding: 0.75rem;
  border: 1px solid rgba(76,175,80,0.3);
  border-radius: 8px;
  font-size: 1rem;
  margin-bottom: 0.5rem;
  background: rgba(255,255,255,0.05);
  color: #ffffff;
  transition: all 0.3s ease;

  &:focus {
    outline: none;
    border-color: #4CAF50;
    box-shadow: 0 0 15px rgba(76,175,80,0.2);
  }

  &::placeholder {
    color: rgba(255,255,255,0.5);
  }
`;function rH(){const[n,e]=se.useState(Sf[0].query),[t,r]=se.useState([]),[i,s]=se.useState(""),[o,l]=se.useState([]);se.useEffect(()=>{(async()=>{try{const p=await t7(yE(iv,"saved_queries")),y=[];p.forEach(v=>{y.push({id:v.id,...v.data()})}),l(y)}catch(p){console.error("Error fetching saved queries:",p),Na.error("Failed to load saved queries")}})()},[]);const a=d=>{e(d)},u=d=>{e(d)},c=()=>{const d=F6(n);r(d),Na.success("Query executed successfully")},f=async()=>{if(!i.trim()){Na.error("Please enter a name for your query");return}try{const p={id:(await n7(yE(iv,"saved_queries"),{name:i,query:n})).id,name:i,query:n};l([...o,p]),s(""),Na.success("Query saved successfully")}catch(d){console.error("Error saving query:",d),Na.error("Failed to save query")}};return Ee.jsxs(Y7,{children:[Ee.jsxs(X7,{children:[Ee.jsx(J7,{children:"SQL Query Viewer"}),Ee.jsx(j6,{onSelect:u,customQueries:o})]}),Ee.jsx(tH,{children:Ee.jsx(nH,{type:"text",placeholder:"Enter a name for your query",value:i,onChange:d=>s(d.target.value)})}),Ee.jsx(Z7,{children:Ee.jsx(rR,{value:n,theme:N6,extensions:[R6()],onChange:a,height:"150px"})}),Ee.jsxs(eH,{children:[Ee.jsx(_E,{onClick:c,children:"Execute Query"}),Ee.jsx(_E,{className:"secondary",onClick:f,children:"Save Query"})]}),Ee.jsx(G6,{results:t})]})}const iH=kV`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
      Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    background: #10101c;
    color: #ffffff;
  }

  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: rgba(255,255,255,0.1);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb {
    background: rgba(76,175,80,0.5);
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: rgba(76,175,80,0.7);
  }
`;Rg.createRoot(document.getElementById("root")).render(Ee.jsxs(Tr.StrictMode,{children:[Ee.jsx(iH,{}),Ee.jsx(G7,{position:"bottom-right"}),Ee.jsx(rH,{})]}));
